"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6152],{8671:(Y,E,r)=>{r.d(E,{$:()=>D});var T=r(5972);function D(d){d.params=d.params||{},(0,T.hm)({url:"api/Lookup/get",params:{lookup_key:d.params.lookup_key||null},success:o=>{"function"==typeof d.callback&&d.callback(null==o?void 0:o.data)},error:o=>{"function"==typeof d.callback&&d.callback(),console.error(d,o)},loading:d.loading,loadingController:d.loadingController})}},8885:(Y,E,r)=>{r.r(E),r.d(E,{MediaViewerPageModule:()=>zi});var T=r(177),D=r(9417),d=r(6637),o=r(3658),v=r(467),L=r(4569),S=r(1632),H=r(7331),j=r(5312),J=r(8408),W=r(5178),K=r(2527),N=r.n(K),z=r(5972),Q=r(5781),m=r(7868),b=r(4835),p=r(6539),_=r(1312),u=r(8833),w=r(4552),li=r(1951),ri=r(5414),A=r(1400),M=r(1607),i=r(4438),si=r(345),mi=r(7704),_i=r(2706),pi=r(31);const ui=["canvas"];function gi(t,s){if(1&t){const n=i.RV6();i.j41(0,"ion-button",11),i.nI1(1,"translate"),i.bIt("click",function(a){i.eBV(n);const l=i.XpG(2);return i.Njj(l.presentModalAiImage(a))}),i.nrm(2,"ion-icon",12),i.k0s()}2&t&&i.Y8G("title",i.bMT(1,1,"CreatedWithAI"))}function fi(t,s){if(1&t){const n=i.RV6();i.j41(0,"ion-button",11),i.nI1(1,"translate"),i.bIt("click",function(){i.eBV(n);const a=i.XpG(2);return i.Njj(a.AI_recommend(a.v_functionlimit.GenAITaoHinhAnh))}),i.nrm(2,"ion-icon",12),i.k0s()}2&t&&i.Y8G("title",i.bMT(1,1,"CreatedWithAI"))}function vi(t,s){if(1&t&&i.DNE(0,gi,3,3,"ion-button",10)(1,fi,3,3),2&t){const n=i.XpG();i.vxM(0,n.membership.GenAITaoHinhAnh?0:1)}}function hi(t,s){if(1&t){const n=i.RV6();i.j41(0,"div",15)(1,"ion-item",16),i.bIt("click",function(){const a=i.eBV(n).$implicit,l=i.XpG(2);return i.Njj(l.switchMedia(a.media_id))}),i.j41(2,"ion-thumbnail"),i.nrm(3,"img",17),i.k0s()()()}if(2&t){const n=s.$implicit,e=i.XpG(2);i.R7$(3),i.Y8G("src",n.cover?e.readfileuploadurl+n.cover:"assets/image/media/image.svg",i.B4B)("alt",n.media_title)}}function bi(t,s){if(1&t&&(i.j41(0,"div",8)(1,"div",13),i.EFF(2,"T\xecm th\u1ea5y "),i.j41(3,"b"),i.EFF(4),i.k0s(),i.EFF(5,' m\u1ee5c v\u1edbi t\u1eeb kh\xf3a "'),i.j41(6,"b"),i.EFF(7),i.k0s(),i.EFF(8,'"'),i.k0s(),i.j41(9,"div",14),i.Z7z(10,hi,4,2,"div",15,i.fX1),i.k0s()()),2&t){let n;const e=i.XpG();i.R7$(4),i.JRh((null!==(n=e.medias[0].total)&&void 0!==n?n:0)<=99?e.medias[0].total:"99+"),i.R7$(3),i.JRh(e.filter.search),i.R7$(3),i.Dyx(e.medias)}}function Ci(t,s){if(1&t&&i.nrm(0,"img",17),2&t){const n=i.XpG(3);i.Y8G("src",n.viewOptions.url,i.B4B)("alt",n.media.media_title)}}function Mi(t,s){if(1&t&&(i.j41(0,"div",38),i.DNE(1,Ci,1,2,"img",39),i.k0s()),2&t){const n=i.XpG(2);i.BMQ("style",n.media.bigcover?"--bg-img:url("+n.readfileuploadurl+n.media.bigcover+")":"",i.$dS),i.R7$(),i.Y8G("ngIf",n.viewOptions.url)}}function xi(t,s){if(1&t&&(i.j41(0,"div",38),i.nrm(1,"canvas",null,0),i.k0s()),2&t){const n=i.XpG(2);i.BMQ("style",n.media.bigcover?"--bg-img:url("+n.readfileuploadurl+n.media.bigcover+")":"",i.$dS)}}function Pi(t,s){if(1&t){const n=i.RV6();i.j41(0,"iframe",42),i.nI1(1,"safe"),i.bIt("load",function(a){i.eBV(n);const l=i.XpG(3);return i.Njj(l.loadIframe(a))}),i.k0s()}if(2&t){const n=i.XpG(3);i.Y8G("src",i.i5U(1,1,n.viewOptions.url,"resourceUrl"),i.f$h)}}function wi(t,s){if(1&t&&(i.j41(0,"div",40),i.DNE(1,Pi,2,4,"iframe",41),i.k0s()),2&t){const n=i.XpG(2);i.BMQ("style",n.media.bigcover?"--bg-img:url("+n.readfileuploadurl+n.media.bigcover+")":"",i.$dS),i.R7$(),i.Y8G("ngIf",n.viewOptions.url)}}function ki(t,s){1&t&&(i.j41(0,"div",43),i.nrm(1,"ion-spinner",44),i.k0s())}function yi(t,s){if(1&t){const n=i.RV6();i.j41(0,"ion-button",48),i.nI1(1,"translate"),i.bIt("click",function(){i.eBV(n);const a=i.XpG(3);return i.Njj(a.downloadMedia())}),i.nrm(2,"ion-icon",49),i.j41(3,"ion-label"),i.EFF(4),i.nI1(5,"translate"),i.k0s()()}2&t&&(i.Y8G("title",i.bMT(1,2,"Download")),i.R7$(4),i.JRh(i.bMT(5,4,"Download")))}function Ei(t,s){1&t&&(i.j41(0,"ion-button",50),i.nrm(1,"ion-icon",51),i.j41(2,"ion-label"),i.EFF(3),i.nI1(4,"translate"),i.k0s()()),2&t&&(i.Y8G("disabled",!0),i.R7$(3),i.JRh(i.bMT(4,2,"Download")))}function Ti(t,s){if(1&t){const n=i.RV6();i.DNE(0,yi,6,6,"ion-button",45)(1,Ei,5,4),i.j41(2,"ion-button",46),i.nI1(3,"translate"),i.bIt("click",function(a){i.eBV(n);const l=i.XpG(2);return i.Njj(l.presentModalMediaShare(a))}),i.nrm(4,"ion-icon",47),i.k0s()}if(2&t){const n=i.XpG(2);i.vxM(0,n.media.isdownload?0:1),i.R7$(2),i.Y8G("title",i.bMT(3,2,"Share"))}}function ji(t,s){if(1&t){const n=i.RV6();i.j41(0,"ion-button",48),i.nI1(1,"translate"),i.bIt("click",function(){i.eBV(n);const a=i.XpG(3);return i.Njj(a.downloadMedia())}),i.nrm(2,"ion-icon",49),i.j41(3,"ion-label"),i.EFF(4),i.nI1(5,"translate"),i.k0s()()}2&t&&(i.Y8G("title",i.bMT(1,2,"Download")),i.R7$(4),i.JRh(i.bMT(5,4,"Download")))}function Ri(t,s){if(1&t){const n=i.RV6();i.j41(0,"div",53)(1,"div",54),i.nrm(2,"ion-icon",55),i.j41(3,"b",56),i.EFF(4,"Tabca Pro"),i.k0s()(),i.j41(5,"div",57),i.EFF(6,"N\xe2ng c\u1ea5p t\xe0i kho\u1ea3n Pro \u0111\u1ec3 t\u1ea3i v\u1ec1 v\xe0 t\u1ea1o h\xecnh \u1ea3nh b\u1eb1ng AI."),i.k0s(),i.j41(7,"ion-button",58),i.nI1(8,"translate"),i.bIt("click",function(){i.eBV(n);const a=i.XpG(3);return i.Njj(a.AI_recommend(a.v_functionlimit.TaiVeCacHocLieuHeThongCungCap))}),i.j41(9,"ion-label"),i.EFF(10),i.nI1(11,"translate"),i.k0s()()()}2&t&&(i.R7$(7),i.Y8G("title",i.bMT(8,2,"UpgradeTabcaProNow")),i.R7$(3),i.JRh(i.bMT(11,4,"Upgrade")))}function Ii(t,s){1&t&&(i.j41(0,"ion-button",50),i.nrm(1,"ion-icon",51),i.j41(2,"ion-label"),i.EFF(3),i.nI1(4,"translate"),i.k0s()()),2&t&&(i.Y8G("disabled",!0),i.R7$(3),i.JRh(i.bMT(4,2,"Download")))}function Oi(t,s){if(1&t&&(i.DNE(0,ji,6,6,"ion-button",45)(1,Ri,12,6)(2,Ii,5,4),i.j41(3,"ion-button",52),i.nI1(4,"translate"),i.nrm(5,"ion-icon",47),i.k0s()),2&t){const n=i.XpG(2);i.vxM(0,n.media.isdownload&&n.media.ispublic&&n.membership.TaiVeCacHocLieuHeThongCungCap?0:n.media.isdownload&&n.media.ispublic&&!n.membership.TaiVeCacHocLieuHeThongCungCap?1:2),i.R7$(3),i.Y8G("title",i.bMT(4,3,"Share"))("disabled",!0)}}function Vi(t,s){if(1&t&&(i.j41(0,"p"),i.EFF(1),i.nI1(2,"translate"),i.k0s()),2&t){const n=i.XpG(2);i.R7$(),i.E5c("",i.bMT(2,3,"Size"),": ",n.media.width," x ",n.media.height," px")}}function Gi(t,s){if(1&t&&(i.j41(0,"p"),i.EFF(1),i.nI1(2,"translate"),i.k0s()),2&t){const n=i.XpG(2);i.R7$(),i.Lme("",i.bMT(2,2,"MediaType"),": ",n.media.ext,"")}}function Fi(t,s){if(1&t&&(i.j41(0,"div",35),i.nrm(1,"ion-icon",59),i.j41(2,"span",60),i.EFF(3),i.k0s()()),2&t){const n=i.XpG(2);i.Y8G("title",n.media.topic_titles),i.R7$(3),i.JRh(n.media.topic_titles.split(";").reverse().join(" / "))}}function Di(t,s){if(1&t&&(i.j41(0,"div",35),i.nrm(1,"ion-icon",61),i.j41(2,"span",60),i.EFF(3),i.k0s()()),2&t){const n=i.XpG(2);i.Y8G("title",n.media.category_titles),i.R7$(3),i.JRh(n.media.category_titles.split(";").reverse().join(" / "))}}function $i(t,s){if(1&t&&(i.j41(0,"div",35),i.nrm(1,"ion-icon",62),i.j41(2,"span",60),i.EFF(3),i.k0s()()),2&t){const n=i.XpG(2);i.Y8G("title",n.media.directory_titles),i.R7$(3),i.JRh(n.media.directory_titles.split(";").reverse().join(" / "))}}function Ai(t,s){if(1&t&&(i.j41(0,"ion-button",64),i.nrm(1,"ion-icon",65),i.j41(2,"ion-label",66),i.EFF(3),i.k0s()()),2&t){const n=s.$implicit;i.Y8G("title",n),i.R7$(3),i.JRh(n)}}function Xi(t,s){if(1&t&&(i.j41(0,"ion-button",64),i.nrm(1,"ion-icon",67),i.j41(2,"ion-label",66),i.EFF(3),i.k0s()()),2&t){const n=s.$implicit;i.Y8G("title",n),i.R7$(3),i.JRh(n)}}function Bi(t,s){if(1&t&&(i.j41(0,"ion-button",64),i.nrm(1,"ion-icon",68),i.j41(2,"ion-label",66),i.EFF(3),i.k0s()()),2&t){const n=s.$implicit;i.Y8G("title",n),i.R7$(3),i.JRh(n)}}function Li(t,s){if(1&t&&(i.j41(0,"ion-button",64),i.nrm(1,"ion-icon",69),i.j41(2,"ion-label",66),i.EFF(3),i.k0s()()),2&t){const n=s.$implicit;i.Y8G("title",n),i.R7$(3),i.JRh(n)}}function Ni(t,s){if(1&t&&(i.j41(0,"div",37)(1,"h5",63),i.EFF(2),i.nI1(3,"translate"),i.k0s(),i.j41(4,"div",28)(5,"div",29)(6,"div",14),i.Z7z(7,Ai,4,2,"ion-button",64,i.fX1),i.Z7z(9,Xi,4,2,"ion-button",64,i.fX1),i.Z7z(11,Bi,4,2,"ion-button",64,i.fX1),i.Z7z(13,Li,4,2,"ion-button",64,i.fX1),i.k0s()()()()),2&t){let n,e,a;const l=i.XpG(2);i.R7$(2),i.JRh(i.bMT(3,1,"Tag")),i.R7$(5),i.Dyx(null==l.media.tags?null:l.media.tags.split(";")),i.R7$(2),i.Dyx(null==l.media.topic_titles||null==(n=l.media.topic_titles.split(";"))?null:n.reverse()),i.R7$(2),i.Dyx(null==l.media.category_titles||null==(e=l.media.category_titles.split(";"))?null:e.reverse()),i.R7$(2),i.Dyx(null==l.media.directory_titles||null==(a=l.media.directory_titles.split(";"))?null:a.reverse())}}function Ui(t,s){if(1&t){const n=i.RV6();i.j41(0,"div",15)(1,"ion-item",16),i.bIt("click",function(){const a=i.eBV(n).$implicit,l=i.XpG(3);return i.Njj(l.switchMedia(a.media_id))}),i.j41(2,"ion-thumbnail"),i.nrm(3,"img",17),i.k0s()(),i.nrm(4,"a",70),i.k0s()}if(2&t){let n;const e=s.$implicit,a=i.XpG(3);i.R7$(3),i.Y8G("src",e.cover?a.readfileuploadurl+e.cover:"assets/image/media/image.svg",i.B4B)("alt",e.media_title),i.R7$(),i.Y8G("href",a.siteurl+"/"+a.APP_ROUTE.VIEWER_ID.replace(":id",null!==(n=null==a.media.media_id?null:a.media.media_id.toString())&&void 0!==n?n:""),i.B4B)("title",e.media_title)}}function Yi(t,s){if(1&t&&(i.j41(0,"div",8)(1,"h5",63),i.EFF(2),i.nI1(3,"translate"),i.k0s(),i.j41(4,"div",14),i.Z7z(5,Ui,5,4,"div",15,i.fX1),i.k0s()()),2&t){const n=i.XpG(2);i.R7$(2),i.JRh(i.bMT(3,1,"MediaRelated")),i.R7$(3),i.Dyx(n.medias_related)}}function Si(t,s){if(1&t&&(i.j41(0,"div",18)(1,"div",19)(2,"div",20)(3,"div",21)(4,"div",22),i.DNE(5,Mi,2,2)(6,xi,3,1)(7,wi,2,2)(8,ki,2,0),i.k0s()()(),i.j41(9,"div",23)(10,"div",24),i.DNE(11,Ti,5,4,"ion-button",25)(12,Oi,6,5),i.k0s(),i.j41(13,"div",26),i.DNE(14,Vi,3,5,"p")(15,Gi,3,4,"p"),i.j41(16,"p"),i.EFF(17),i.nI1(18,"translate"),i.nI1(19,"translate"),i.k0s()()()()(),i.j41(20,"div",27)(21,"div",28)(22,"div",29)(23,"div",30)(24,"div",31)(25,"ion-chip")(26,"ion-avatar",32),i.nrm(27,"img",33),i.k0s(),i.j41(28,"ion-label"),i.EFF(29),i.k0s()()(),i.j41(30,"div",34),i.DNE(31,Fi,4,2,"div",35)(32,Di,4,2)(33,$i,4,2),i.k0s()(),i.j41(34,"h2",36),i.EFF(35),i.k0s()()()(),i.DNE(36,Ni,15,3,"div",37)(37,Yi,7,3,"div",8)),2&t){let n;const e=i.XpG();i.R7$(3),i.BMQ("style","padding-bottom:"+e.viewOptions.ratio+"%",i.$dS),i.R7$(2),i.vxM(5,"img"===(n=e.viewOptions.type)?5:"canvas"===n?6:"iframe"===n?7:8),i.R7$(6),i.vxM(11,e.media.isowner?11:12),i.R7$(3),i.vxM(14,e.media.width&&e.media.height?14:-1),i.R7$(),i.vxM(15,e.media.ext?15:-1),i.R7$(2),i.Lme("",i.bMT(18,13,"Use"),": ",e.media.ispublic?"Tabca Pro":i.bMT(19,15,"Private"),""),i.R7$(10),i.Y8G("src",e.media.createdby_avatar?e.readfileuploadurl+e.media.createdby_avatar:"assets/image/user-avatar-default.png",i.B4B),i.R7$(2),i.JRh(e.media.createdby_name),i.R7$(2),i.vxM(31,e.media.topic_titles?31:e.media.category_titles?32:e.media.directory_titles?33:-1),i.R7$(4),i.JRh(e.media.media_title),i.R7$(),i.vxM(36,e.media.tags||e.media.topic_titles||e.media.category_titles||e.media.directory_titles?36:-1),i.R7$(),i.vxM(37,e.medias_related.length?37:-1)}}function Hi(t,s){if(1&t){const n=i.RV6();i.j41(0,"ion-infinite-scroll",71),i.bIt("ionInfinite",function(a){i.eBV(n);const l=i.XpG();return i.Njj(l.onIonInfinite(a))}),i.nrm(1,"ion-infinite-scroll-content"),i.k0s()}}const Ji=[{path:"",component:(()=>{var t;class s{constructor(e,a,l,c,g,f,C,k){var x,h,P=this;this.activatedRoute=e,this.titleService=a,this.metaService=l,this.router=c,this.toastController=g,this.modalController=f,this.popoverController=C,this.loadingController=k,this.APP_ROUTE=u._,this.APP_FUNC_FormatDate=_.Rv,this.v_functionlimit=A.r,this.envUI_Config=j.c.ui_config,this.appsettings=null!==(x=j.c.donvis.find(X=>X.madonvi==j.c.default_donvi))&&void 0!==x?x:{},this.siteurl=j.c.url,this.readfileuploadurl=null!==(h=this.appsettings.readfileuploadurl)&&void 0!==h?h:"",this.membership={},this.medias_related=[],this.filter={},this.paging={page:1,limit:50,active:!0},this.medias=[],this.viewOptions={ratio:66.67};let y=e.snapshot.params.id;if(!y)return void this.router.navigateByUrl(u._.LANDING_PAGE);let V=e.snapshot.queryParamMap.get("auth");"1"==V||"true"==V?(0,v.A)(function*(){yield P.loadUser(),P.media_id=y,P.loadMedia(y)})():(this.loadUser(),this.media_id=y,this.loadMedia(y,!1))}ngOnInit(){}onIonRefresher(e){this.closeSearch(),this.loadMedia(void 0,!0,()=>{e.target.complete()})}onIonInfinite(e){this.loadMore(()=>{e.target.complete()})}searchChange(e){var a;this.filter.search=null===(a=e.target.value)||void 0===a?void 0:a.replace(/[\`\~\!\@\#\$\%\^\&\*\(\)\-\_\=\+\[\{\]\}\\\|\;\:\'\,\<\.\>\/\?]+/g," ").replace(/\s+/g," ").trim(),this.refreshData()}filterChange(){this.refreshData()}refreshData(e){this.filter.search?(this.paging.page=1,this.paging.active=!0,this.loadData_Paging(e)):this.closeSearch()}loadMore(e){this.paging.page+=1,this.loadData_Paging(e)}pushData(e){return 1==this.paging.page&&(this.medias.length=0),this.medias=this.medias.concat(e),this.medias}loadData_Paging(e){var a;(0,Q.br)({loadingController:1==this.paging.page?this.loadingController:void 0,params:{userid:null===(a=this.user)||void 0===a?void 0:a.userid,getfrom:1,media_title:this.filter.search,v_mediatypes:[M.S.IMAGE,M.S.IMAGE_ANIMATION,M.S.PHET,M.S.HTML,M.S.SCORM].join(","),topic_id:this.filter.topic_id,sortfield:this.paging.sortfield,sorttype:this.paging.sorttype,page:this.paging.page,limit:this.paging.limit},callback:l=>{this.pushData(l||[]).length<this.paging.limit*this.paging.page&&(this.paging.active=!1),e&&e()}})}loadUser(){var e=this;return(0,v.A)(function*(){var a,l,c;e.appsettings=yield(0,z.AC)(),e.appsettings.madonvi&&(e.user=yield(0,p.sx)(),e.readfileuploadurl=null!==(a=e.appsettings.readfileuploadurl)&&void 0!==a?a:"",e.user.userid)&&((0,m.EW)({params:{userid:null===(l=e.user)||void 0===l?void 0:l.userid,v_functionlimit:A.r.GenAITaoHinhAnh},callback:g=>{var f;e.membership.GenAITaoHinhAnh=(0,li.j)(null==g||null===(f=g.contents)||void 0===f?void 0:f.find(C=>C.v_functionlimit==A.r.GenAITaoHinhAnh))}}),(0,m.EW)({params:{userid:null===(c=e.user)||void 0===c?void 0:c.userid,v_functionlimit:A.r.TaiVeCacHocLieuHeThongCungCap},callback:g=>{var f;e.membership.TaiVeCacHocLieuHeThongCungCap=(0,li.j)(null==g||null===(f=g.contents)||void 0===f?void 0:f.find(C=>C.v_functionlimit==A.r.TaiVeCacHocLieuHeThongCungCap))}}))})()}loadMedia(e,a,l){var c;$.ajax({async:a,cache:!0,url:`${this.appsettings.apiurl}api/Media/Detail`,method:"GET",contentType:"application/json",data:{getby:null===(c=this.user)||void 0===c?void 0:c.userid,media_id:null!=e?e:this.media_id},dataType:"json",success:g=>{var f,C,k,x,h,P,y,V,X,Z,q,ii,ei,ti,ni;g&&g.media_id?(this.media=g||{},(0,_.Kd)(this.titleService,this.metaService,{title:this.media.media_title,description:(0,w.YW)(this.media.media_description),keywords:null===(f=this.media.tags)||void 0===f?void 0:f.replace(/\;/g,", "),image:{url:`${this.appsettings.readfileuploadurl}${this.media.bigcover}`,type:"image/jpge",width:800,height:800,alt:this.media.media_title},url:`${j.c.url}/${u._.MEDIA_VIEWER_ID.replace(":id",null!==(C=null===(k=this.media.media_id)||void 0===k?void 0:k.toString())&&void 0!==C?C:"")}`,author:{name:this.media.createdby_name,email:j.c.author.email},updated:null!==(x=this.media.modifieddate)&&void 0!==x?x:this.media.createddate}),this.media.isdownload=!(this.media.v_mediatype==M.S.LINK||!this.media.filepath),null!==(h=this.media)&&void 0!==h&&null!==(h=h.filepath)&&void 0!==h&&h.match(/.lvm$/)?(0,W.Q)(`${this.appsettings.readfileuploadurl}${null===(P=this.media)||void 0===P?void 0:P.filepath}`).then(oi=>{let{ext:di,file:U}=oi;switch(di){case"gif":case"apng":this.viewOptions.type="img",this.viewOptions.file=U,this.viewOptions.url=URL.createObjectURL(U);break;case"avif":case"jpg":case"jpe":case"jpeg":case"jif":case"jfif":case"pjp":case"pjpeg":case"png":case"ico":case"cur":case"tif":case"tiff":case"bmp":case"webp":case"svg":{this.viewOptions.type="canvas",this.viewOptions.file=U;let ai=new FileReader;ai.onload=ci=>{let R=new Image;R.onload=()=>{var B;let I=R.width||1,O=R.height||1;if("svg"==di){let F=I/O;F>=1?(I=Math.max(I,800),O=I/F):(O=Math.max(O,800),I=O*F)}let G=null===(B=this.canvas)||void 0===B?void 0:B.nativeElement;if(G){G.width=I,G.height=O,G.style.maxWidth="100%",G.style.maxHeight="100%";let F=G.getContext("2d");F&&F.drawImage(R,0,0,I,O)}},R.onerror=()=>{(0,ri.c)(this.toastController,{color:"danger",message:"Kh\xf4ng t\u1ea3i \u0111\u01b0\u1ee3c th\xf4ng tin \u1ea3nh!"}).then(B=>B.present())},R.src=ci.target.result},ai.onerror=ci=>{(0,ri.c)(this.toastController,{color:"danger",message:"Kh\xf4ng t\u1ea3i \u0111\u01b0\u1ee3c t\u1eadp tin!"}).then(R=>R.present())},ai.readAsDataURL(U);break}}}):(this.viewOptions.type="iframe",this.viewOptions.url=(0,J._KM)({readfileuploadurl:this.appsettings.readfileuploadurl,type:null===(y=this.media)||void 0===y?void 0:y.v_mediatype,oss:null===(V=this.media)||void 0===V?void 0:V.v_osstype,path:null!==(X=null===(Z=this.media)||void 0===Z?void 0:Z.filepath_extract)&&void 0!==X?X:null===(q=this.media)||void 0===q?void 0:q.filepath,url:null!==(ii=null===(ei=this.media)||void 0===ei?void 0:ei.link_file)&&void 0!==ii?ii:null===(ti=this.media)||void 0===ti?void 0:ti.link_share})),this.media&&$.ajax({async:a,cache:!0,url:`${this.appsettings.apiurl}api/Media/Search`,method:"GET",contentType:"application/json",data:Object.assign({getby:null===(ni=this.user)||void 0===ni?void 0:ni.userid,getfrom:1,v_mediatypes:[M.S.IMAGE,M.S.IMAGE_ANIMATION,M.S.PHET,M.S.HTML,M.S.SCORM].join(","),sortfield:this.paging.sortfield,sorttype:this.paging.sorttype,page:1,limit:100},this.media.tags?{tags:this.media.tags}:this.media.directory_id?{directory_id:this.media.directory_id}:this.media.topic_id?{topic_id:this.media.topic_id}:this.media.category_id?{category_id:this.media.category_id}:{}),dataType:"json",success:oi=>{this.medias_related=oi||[]}}),l&&l()):this.router.navigateByUrl(u._.LANDING_PAGE)},statusCode:{206:function(){alert("page no content")},404:function(){alert("page not found")},500:function(){alert("page error")}}})}closeSearch(){this.filter={},this.medias.length=0}navigateByUrl(e){e&&this.router.navigateByUrl(e)}switchMedia(e){var a=this;return(0,v.A)(function*(){e&&a.router.navigate(["/",u._.MEDIA_VIEWER,e],{relativeTo:a.activatedRoute,queryParams:{auth:1},queryParamsHandling:"merge",replaceUrl:!0})})()}downloadMedia(){var e=this;return(0,v.A)(function*(){var a,l,c;null!==(a=e.media)&&void 0!==a&&a.isdownload&&(["img","canvas"].includes(null!==(l=e.viewOptions.type)&&void 0!==l?l:"")&&e.viewOptions.file?N()(e.viewOptions.file,e.media.media_title+"."+e.viewOptions.file.name.split(".").pop(),e.viewOptions.file.type):null!==(c=e.media)&&void 0!==c&&c.filepath&&N()(`${e.appsettings.readfileuploadurl}${e.media.filepath}`))})()}AI_recommend(e){var a=this;return(0,v.A)(function*(){(0,b.QB)(a.modalController,e)})()}loadIframe(e){this.iframe=e.target}presentModalAiImage(e){var a=this;return(0,v.A)(function*(){const l=yield a.modalController.create({component:L.K,mode:"md",cssClass:"ion-modal-lg modal-vip",backdropDismiss:!1,keyboardClose:!1});l.onDidDismiss().then(c=>{"confirm"==c.role&&a.switchMedia(c.data)}),l.present()})()}presentModalMediaShare(e){var a=this;return(0,v.A)(function*(){var l;(yield a.modalController.create({component:S.U,componentProps:{m:null===(l=a.media)||void 0===l?void 0:l.media_id},mode:"md",cssClass:"ion-modal",backdropDismiss:!0,keyboardClose:!0})).present()})()}presentPopoverTopic(e){var a=this;return(0,v.A)(function*(){const l=yield a.popoverController.create({component:H.E,componentProps:{selectedId:a.filter.topic_id,filter:{for:"media"}},event:e,dismissOnSelect:!1,animated:!1,side:"right"});l.onDidDismiss().then(c=>{var g,f,C,k,x,h,P;"confirm"==c.role&&(Object.assign(a.filter,{topic_id:null===(g=c.data)||void 0===g?void 0:g.topic_id,topic_title:null===(f=c.data)||void 0===f?void 0:f.topic_title,topic_titles:null===(C=c.data)||void 0===C?void 0:C.topic_titles}),null!==(k=c.data)&&void 0!==k&&k.category_id&&Object.assign(a.filter,{category_id:null===(x=c.data)||void 0===x?void 0:x.category_id,category_title:null===(h=c.data)||void 0===h?void 0:h.category_title,category_titles:null===(P=c.data)||void 0===P?void 0:P.category_titles}))}),l.present()})()}}return(t=s).\u0275fac=function(e){return new(e||t)(i.rXU(o.nX),i.rXU(si.hE),i.rXU(si.W8),i.rXU(o.Ix),i.rXU(d.K_),i.rXU(d.W3),i.rXU(d.IE),i.rXU(d.Xi))},t.\u0275cmp=i.VBU({type:t,selectors:[["app-media-viewer"]],viewQuery:function(e,a){if(1&e&&i.GBs(ui,5),2&e){let l;i.mGM(l=i.lsd())&&(a.canvas=l.first)}},decls:15,vars:5,consts:[["canvas",""],["slot","fixed",3,"ionRefresh"],[1,"container","pt-2","mt-4","mb-5","max-w-800"],[1,"mt-0","mb-3","fw-500","text-center"],[1,"d-flex","align-items-center","searchbox"],["name","search-outline",1,"fs-24","ml-3"],[1,"flex-grow-1"],["mode","ios","placeholder","Nh\u1eadp n\u1ed9i dung c\u1ea7n t\xecm","search-icon"," ",2,"padding","0",3,"ionChange","debounce","value"],[1,"container","mb-4","media-related"],[3,"ionInfinite",4,"ngIf"],["mode","ios","color","tabca-pro",1,"m-1","btn-ai-image",3,"title"],["mode","ios","color","tabca-pro",1,"m-1","btn-ai-image",3,"click","title"],["src","../../../assets/icon-svg/magic-ai-2.svg",1,"fs-24"],[1,"mb-2","fs-14"],[1,"d-flex","flex-wrap"],[1,"mr-2","mb-2"],["lines","none","detail","false","button","true",3,"click"],[3,"src","alt"],[1,"container"],[1,"row","align-items-stretch"],[1,"col-12","col-lg-8","mb-4","media-view"],[1,"position-relative","w-0","h-0"],[1,"position-absolute","top-0","left-0","right-0","bottom-0"],[1,"col-12","col-lg-4","mb-4","media-info"],[1,"d-flex"],["mode","ios","color","dark","fill","outline",1,"btn-share","ml-3",3,"title"],[1,"mt-4"],[1,"container","mb-4","media-introduce"],[1,"row"],[1,"col-12","col-lg-8"],[1,"d-flex","align-items-center","justify-content-between"],[1,"flex-grow-1","text-nowrap"],[1,"min-w-24"],["onerror","errorAvatar(this)",3,"src"],[1,"d-block","d-md-flex","flex-nowrap","align-items-center","text-ellipsis"],[1,"text-ellipsis","d-flex","align-items-center","ml-3",3,"title"],[1,"mt-2","mb-0","fw-400"],[1,"container","mb-4","media-tag"],["oncontextmenu","return false",1,"view-box","img-box"],[3,"src","alt",4,"ngIf"],["oncontextmenu","return false",1,"view-box","iframe-box"],["frameborder","0","allowfullscreen","","webkitallowfullscreen","","allowtransparency","true","allow","autoplay; fullscreen","oncontextmenu","return false",3,"src","load",4,"ngIf"],["frameborder","0","allowfullscreen","","webkitallowfullscreen","","allowtransparency","true","allow","autoplay; fullscreen","oncontextmenu","return false",3,"load","src"],[1,"d-flex","w-100","h-100","align-items-center","justify-content-center","line-height-0"],["color","tertiary","name","bubbles"],["mode","ios","color","linear","expand","block",1,"flex-grow-1","btn-download",3,"title"],["mode","ios","color","dark","fill","outline",1,"btn-share","ml-3",3,"click","title"],["name","share-social-outline"],["mode","ios","color","linear","expand","block",1,"flex-grow-1","btn-download",3,"click","title"],["slot","start","src","../../../assets/icon/viewer/download.svg"],["mode","ios","expand","block",1,"flex-grow-1","btn-download",3,"disabled"],["slot","start","name","download-outline"],["mode","ios","color","dark","fill","outline",1,"btn-share","ml-3",3,"title","disabled"],[1,"rounded","border","p-4"],[1,"d-flex","align-items-center"],["src","../../../assets/image/tabca-pro-2.svg",1,"fs-22","icon-tabca-pro"],[1,"fw-700","fs-16","ml-3"],[1,"my-3"],["mode","ios","color","linear","expand","block",3,"click","title"],["src","../../../assets/icon-svg/dashboard/topic.svg",1,"fs-20"],[1,"fs-12","text-ellipsis"],["src","../../../assets/icon-svg/dashboard/category.svg",1,"fs-20"],["src","../../../assets/icon-svg/dashboard/template.svg",1,"fs-20"],[1,"mt-0","mb-2"],["mode","ios","size","small","color","dark","fill","outline",1,"mt-0","ml-0","mr-2","mb-2",3,"title"],["slot","start","src","../../../assets/icon/viewer/tag.svg",1,"fs-20"],[1,"fs-14"],["slot","start","src","../../../assets/icon/viewer/topic.svg",1,"fs-20"],["slot","start","src","../../../assets/icon/viewer/category.svg",1,"fs-20"],["slot","start","src","../../../assets/icon/viewer/directory.svg",1,"fs-20"],[3,"href","title"],[3,"ionInfinite"]],template:function(e,a){1&e&&(i.nrm(0,"app-header"),i.j41(1,"ion-content")(2,"ion-refresher",1),i.bIt("ionRefresh",function(c){return a.onIonRefresher(c)}),i.nrm(3,"ion-refresher-content"),i.k0s(),i.j41(4,"div",2)(5,"h4",3),i.EFF(6,"T\xe0i nguy\xean h\u1ecdc t\u1eadp trong t\u1ea7m tay"),i.k0s(),i.j41(7,"div",4),i.nrm(8,"ion-icon",5),i.j41(9,"div",6)(10,"ion-searchbar",7),i.bIt("ionChange",function(c){return a.searchChange(c)}),i.k0s()(),i.DNE(11,vi,2,1),i.k0s()(),i.DNE(12,bi,12,2,"div",8)(13,Si,38,17)(14,Hi,2,0,"ion-infinite-scroll",9),i.k0s()),2&e&&(i.R7$(10),i.Y8G("debounce",1e3)("value",a.filter.search),i.R7$(),i.vxM(11,a.envUI_Config.is_ai_image?11:-1),i.R7$(),i.vxM(12,a.medias.length?12:a.media?13:-1),i.R7$(2),i.Y8G("ngIf",a.paging.active&&a.medias.length))},dependencies:[T.bT,d.mC,d.Jm,d.ZB,d.W9,d.iq,d.Ax,d.Hp,d.uz,d.he,d.To,d.Ki,d.S1,d.w2,d.Zx,d.Gw,mi.l,_i.m,pi.D9],styles:['.searchbox[_ngcontent-%COMP%]{overflow:hidden;border-radius:.75rem;border:1px solid #8F9BB3;background:#fff}.searchbox[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{width:100%;height:40px;--background: transparent;--box-shadow: none}.searchbox[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:2.5rem}.searchbox[_ngcontent-%COMP%]   ion-button.btn-ai-image[_ngcontent-%COMP%]{width:2.5rem;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0}.searchbox[_ngcontent-%COMP%]   ion-button.btn-search[_ngcontent-%COMP%]{width:2.5rem;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0}.media-view[_ngcontent-%COMP%]   .view-box[style][_ngcontent-%COMP%]:not([style=""]){border-radius:.75rem;background:var(--ion-background-color);box-shadow:4px 4px 12px #0101011a}.media-view[_ngcontent-%COMP%]   .view-box[style][_ngcontent-%COMP%]:not([style=""]):before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;z-index:1;opacity:.16;background-image:var(--bg-img);background-repeat:no-repeat;background-position:center center;background-size:cover}.media-view[_ngcontent-%COMP%]   .view-box[style][_ngcontent-%COMP%]:not([style=""]) > *[_ngcontent-%COMP%]{position:relative;z-index:2}.media-view[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;line-height:0;overflow:hidden;border-radius:.75rem;box-shadow:0 0 0 1px #fff;display:flex;align-items:center;justify-content:center}.media-view[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .media-view[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{border-radius:.25rem;overflow:hidden;box-shadow:0 0 12px #0101011a}.media-view[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;z-index:2147483647;background:transparent;-webkit-user-select:none;user-select:none}.media-view[_ngcontent-%COMP%]   .iframe-box[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;line-height:0;overflow:hidden;border-radius:.75rem;background:var(--ion-background-color);box-shadow:4px 4px 12px #01010133}.media-view[_ngcontent-%COMP%]   .iframe-box[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{display:block;width:100%;height:100%;padding:0;margin:0;border:0;outline:none;background-color:#fff}.media-info[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0}.media-info[_ngcontent-%COMP%]   ion-button[color=dark][_ngcontent-%COMP%]::part(native){border-color:var(--ion-color-medium-tint)}.media-info[_ngcontent-%COMP%]   .btn-download[_ngcontent-%COMP%]{min-width:3rem;height:3rem;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0}.media-info[_ngcontent-%COMP%]   .btn-share[_ngcontent-%COMP%]{min-width:3rem;width:3rem;height:3rem;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0}.media-introduce[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{margin:0;--background: transparent}.media-introduce[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0}.media-tag[_ngcontent-%COMP%]   ion-button[color=dark][_ngcontent-%COMP%]::part(native){border-color:var(--ion-color-medium-tint)}.media-related[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0;--inner-padding-top: 0;--inner-padding-bottom: 0;--inner-padding-start: 0;--inner-padding-end: 0;--border-width: 1px;--border-color: var(--ion-color-medium-tint);--border-radius: .5rem}.media-related[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{--size: 9rem;--border-radius: .375rem;margin:0}']}),s})()}];let Wi=(()=>{var t;class s{}return(t=s).\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.$C({type:t}),t.\u0275inj=i.G2t({imports:[o.iI.forChild(Ji),o.iI]}),s})();var Ki=r(3890);let zi=(()=>{var t;class s{}return(t=s).\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.$C({type:t}),t.\u0275inj=i.G2t({imports:[T.MD,D.YN,d.bv,Wi,Ki.x]}),s})()},3753:(Y,E,r)=>{r.d(E,{t:()=>Q});var T=r(467),D=r(8671),d=r(2635),o=r(4438),v=r(6637),L=r(177),S=r(31);function H(m,b){1&m&&(o.qex(0),o.j41(1,"ion-content")(2,"div",2)(3,"div",3),o.nrm(4,"ion-spinner",4),o.k0s()()(),o.bVm())}function j(m,b){if(1&m){const p=o.RV6();o.qex(0),o.j41(1,"ion-item",9),o.bIt("click",function(){const u=o.eBV(p).$implicit,w=o.XpG(3);return o.Njj(w.filterChange(u.lookup_value))}),o.j41(2,"ion-label"),o.EFF(3),o.k0s()(),o.bVm()}if(2&m){const p=b.$implicit,_=o.XpG(3);o.R7$(),o.BMQ("color",p.lookup_value==_.selectedId?"primary":""),o.R7$(2),o.JRh(p.lookup_title)}}function J(m,b){if(1&m&&(o.j41(0,"ion-list",7),o.DNE(1,j,4,2,"ng-container",8),o.k0s()),2&m){const p=o.XpG(2);o.R7$(),o.Y8G("ngForOf",p.lookups)}}function W(m,b){1&m&&(o.j41(0,"div",3)(1,"i"),o.EFF(2),o.nI1(3,"translate"),o.k0s()()),2&m&&(o.R7$(2),o.JRh(o.bMT(3,1,"DataNotFound")))}function K(m,b){if(1&m){const p=o.RV6();o.qex(0),o.j41(1,"ion-item",9),o.bIt("click",function(){const u=o.eBV(p).$implicit,w=o.XpG(3);return o.Njj(w.filterChange(u.lookup_value))}),o.j41(2,"ion-label",10),o.EFF(3),o.k0s()(),o.bVm()}if(2&m){const p=b.$implicit,_=o.XpG(3);o.R7$(),o.BMQ("color",p.lookup_value==_.selectedId?"primary":""),o.R7$(),o.Y8G("color",p.color),o.R7$(),o.JRh(p.lookup_title)}}function N(m,b){if(1&m&&(o.qex(0),o.nrm(1,"hr"),o.j41(2,"ion-list",7),o.DNE(3,K,4,3,"ng-container",8),o.k0s(),o.bVm()),2&m){const p=o.XpG(2);o.R7$(3),o.Y8G("ngForOf",p.lookups_d2)}}function z(m,b){if(1&m&&(o.qex(0),o.DNE(1,J,2,1,"ion-list",5)(2,W,4,3,"div",6)(3,N,4,1,"ng-container",1),o.bVm()),2&m){const p=o.XpG();o.R7$(),o.Y8G("ngIf",p.lookups.length),o.R7$(),o.Y8G("ngIf",!p.lookups.length),o.R7$(),o.Y8G("ngIf",p.lookups_d2.length)}}let Q=(()=>{var m;class b{constructor(_){this.popoverController=_,this.selectedId=0,this.lookup_key="",this.lookups_d2=[],this.dataInit={loading:!0},this.lookups=[]}ngOnInit(){var _=this;(0,T.A)(function*(){_.user=yield(0,d.Nk)(),_.loadLookup()})()}loadLookup(){var _;(0,D.$)({loading:u=>{this.dataInit.loading=u},params:{userid:null===(_=this.user)||void 0===_?void 0:_.userid,lookup_key:this.lookup_key},callback:u=>{this.lookups=u||[]}})}filterChange(_){var u;this.popoverController.dismiss(null!==(u=this.lookups.find(w=>w.lookup_value==_))&&void 0!==u?u:this.lookups_d2.find(w=>w.lookup_value==_),"confirm")}}return(m=b).\u0275fac=function(_){return new(_||m)(o.rXU(v.IE))},m.\u0275cmp=o.VBU({type:m,selectors:[["app-popover-lookup"]],inputs:{selectedId:"selectedId",lookup_key:"lookup_key",lookups_d2:"lookups_d2"},decls:3,vars:2,consts:[[1,"menu-lookup","overflow-auto"],[4,"ngIf"],[1,"d-flex","w-100","h-100","align-items-center","justify-content-center"],[1,"px-3","py-1"],["name","dots","color","dark",1,"align-middle"],["lines","full",4,"ngIf"],["class","px-3 py-1",4,"ngIf"],["lines","full"],[4,"ngFor","ngForOf"],["button","","detail","false",3,"click"],[3,"color"]],template:function(_,u){1&_&&(o.j41(0,"div",0),o.DNE(1,H,5,0,"ng-container",1)(2,z,4,3,"ng-container",1),o.k0s()),2&_&&(o.R7$(),o.Y8G("ngIf",u.dataInit.loading),o.R7$(),o.Y8G("ngIf",!u.dataInit.loading))},dependencies:[L.Sq,L.bT,v.W9,v.uz,v.he,v.nf,v.w2,S.D9],styles:[".menu-lookup[_ngcontent-%COMP%]{width:240px;max-height:480px;border-top:3px solid #5F6CE1}hr[_ngcontent-%COMP%]{margin:0}"]}),b})()},4668:(Y,E,r)=>{r.d(E,{z:()=>T});const T={ONLY_ME:10400,ONLY_MEMBER:10401,EVERYONE_HAS_LINK:10402}}}]);