"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5862],{5862:(Vh,sl,We)=>{We.d(sl,{A9o:()=>Mr,_5L:()=>mc,IBb:()=>Kr,arO:()=>wc,XdC:()=>$s,FLf:()=>U,r_I:()=>at,FCb:()=>de,PSO:()=>et,Q$J:()=>St,hv$:()=>C,i0Z:()=>$c,HYM:()=>tu,U9V:()=>eu,IPF:()=>Jh,uDg:()=>gh,ZFU:()=>vh,o8m:()=>kh,zc9:()=>Nh,jme:()=>Oh,woc:()=>Sh,OuQ:()=>_h,tEe:()=>Ih,NP2:()=>yh,gRD:()=>wh,R11:()=>bh,Djb:()=>xh,GwF:()=>ph,hko:()=>mh,Lz2:()=>Ch,qBK:()=>Fh,WYX:()=>Eh,iyY:()=>Th,wSf:()=>Vc,nOo:()=>Yi,dLO:()=>wr,vmR:()=>Cd,CUZ:()=>Zc,Uqb:()=>lt,_KM:()=>$i,LVk:()=>y,Dlr:()=>bt,MhA:()=>eh,gyC:()=>ih,enI:()=>Vu,Wzt:()=>nh,k5W:()=>oh,_Rs:()=>sh,yND:()=>rh,As1:()=>dh,jK7:()=>ah,okK:()=>lh,dfT:()=>th,OQD:()=>ch,Hcq:()=>uh,wMG:()=>$u,OVU:()=>Dr,zHt:()=>Ur,XWC:()=>Gr,DSO:()=>Qe,tix:()=>Jt,zOM:()=>E,JRt:()=>D,yUR:()=>Dc,tGH:()=>hh,Cfb:()=>fh,t8k:()=>ki,RYD:()=>G,qGx:()=>_u,GRx:()=>Eu,_mz:()=>Ou,yhd:()=>Nu,cZ9:()=>Su,xhT:()=>Ju,cKw:()=>Cu,qe3:()=>Fu,obU:()=>Tu,U$t:()=>Iu,dns:()=>Hu,cuZ:()=>Uu,DNi:()=>Qu,yFt:()=>Ku,RZc:()=>Gu,uJ$:()=>Du,im6:()=>Pu,Dbh:()=>Bu,qRy:()=>Lu,lcK:()=>Mu,o0:()=>zu,RL2:()=>Au,otK:()=>ju,tdO:()=>Ru,Xu9:()=>au,ZjY:()=>lu,fYU:()=>nu,JAM:()=>ru,to0:()=>iu,uiC:()=>hn,TKJ:()=>du,lFL:()=>su,TV_:()=>ou,N6o:()=>cu,I6k:()=>xu,tTI:()=>wu,yqB:()=>bu,nyA:()=>ku,$TK:()=>pu,Q6X:()=>vu,BTq:()=>yu,WpQ:()=>mu,Hr7:()=>fu,MQK:()=>uu,RdK:()=>hu,wGP:()=>gu,XTt:()=>ie,Pe_:()=>un,wTo:()=>yi,fug:()=>Sc,NxJ:()=>Oc,E$G:()=>kc,eil:()=>on,ZF9:()=>sn,SFI:()=>ic,vxI:()=>oc,smx:()=>rc,xOc:()=>Rr,kTo:()=>lc,$x6:()=>ec,T1W:()=>ac,_oT:()=>tc,rIr:()=>zr,r49:()=>nc,r7c:()=>Qh,R$j:()=>Dh,t9h:()=>Rh,PxE:()=>Bh,mJh:()=>Lh,Ptn:()=>zh,eQP:()=>jh,BiI:()=>Kh,BlC:()=>Ph,I06:()=>Mh,zgC:()=>Gh,lh0:()=>Ah,_Sz:()=>Xh,Au4:()=>Yh,I6V:()=>Zh,IBK:()=>ce,qbd:()=>qh,nGQ:()=>Wh,pHJ:()=>Uh,wjX:()=>Hh,I6f:()=>Ee,IAo:()=>Ni,AEO:()=>an,I1Q:()=>Jr,nWF:()=>Xu,YpM:()=>Yu,mmi:()=>Zu,xR4:()=>qu,dBz:()=>Wu});var Ut=We(467),re=We(119),dl=We.t(re,2);function cl(){}function Fi(i){return null==i?cl:function(){return this.querySelector(i)}}function fl(){return[]}function vn(i){return null==i?fl:function(){return this.querySelectorAll(i)}}function yn(i){return function(){return this.matches(i)}}function pn(i){return function(t){return t.matches(i)}}var yl=Array.prototype.find;function ml(){return this.firstElementChild}var bl=Array.prototype.filter;function xl(){return Array.from(this.children)}function mn(i){return new Array(i.length)}function qe(i,t){this.ownerDocument=i.ownerDocument,this.namespaceURI=i.namespaceURI,this._next=null,this._parent=i,this.__data__=t}function _l(i,t,e,n,r,l){for(var s,a=0,o=t.length,d=l.length;a<d;++a)(s=t[a])?(s.__data__=l[a],n[a]=s):e[a]=new qe(i,l[a]);for(;a<o;++a)(s=t[a])&&(r[a]=s)}function Tl(i,t,e,n,r,l,a){var s,o,f,d=new Map,c=t.length,u=l.length,h=new Array(c);for(s=0;s<c;++s)(o=t[s])&&(h[s]=f=a.call(o,o.__data__,s,t)+"",d.has(f)?r[s]=o:d.set(f,o));for(s=0;s<u;++s)f=a.call(i,l[s],s,l)+"",(o=d.get(f))?(n[s]=o,o.__data__=l[s],d.delete(f)):e[s]=new qe(i,l[s]);for(s=0;s<c;++s)(o=t[s])&&d.get(h[s])===o&&(r[s]=o)}function Fl(i){return i.__data__}function Jl(i){return"object"==typeof i&&"length"in i?i:Array.from(i)}function Bl(i,t){return i<t?-1:i>t?1:i>=t?0:NaN}qe.prototype={constructor:qe,appendChild:function(i){return this._parent.insertBefore(i,this._next)},insertBefore:function(i,t){return this._parent.insertBefore(i,t)},querySelector:function(i){return this._parent.querySelector(i)},querySelectorAll:function(i){return this._parent.querySelectorAll(i)}};var Ci="http://www.w3.org/1999/xhtml";const wn={svg:"http://www.w3.org/2000/svg",xhtml:Ci,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Xe(i){var t=i+="",e=t.indexOf(":");return e>=0&&"xmlns"!==(t=i.slice(0,e))&&(i=i.slice(e+1)),wn.hasOwnProperty(t)?{space:wn[t],local:i}:i}function Dl(i){return function(){this.removeAttribute(i)}}function Ul(i){return function(){this.removeAttributeNS(i.space,i.local)}}function Hl(i,t){return function(){this.setAttribute(i,t)}}function Wl(i,t){return function(){this.setAttributeNS(i.space,i.local,t)}}function ql(i,t){return function(){var e=t.apply(this,arguments);null==e?this.removeAttribute(i):this.setAttribute(i,e)}}function Xl(i,t){return function(){var e=t.apply(this,arguments);null==e?this.removeAttributeNS(i.space,i.local):this.setAttributeNS(i.space,i.local,e)}}function bn(i){return i.ownerDocument&&i.ownerDocument.defaultView||i.document&&i||i.defaultView}function Yl(i){return function(){this.style.removeProperty(i)}}function Vl(i,t,e){return function(){this.style.setProperty(i,t,e)}}function $l(i,t,e){return function(){var n=t.apply(this,arguments);null==n?this.style.removeProperty(i):this.style.setProperty(i,n,e)}}function ve(i,t){return i.style.getPropertyValue(t)||bn(i).getComputedStyle(i,null).getPropertyValue(t)}function ea(i){return function(){delete this[i]}}function ia(i,t){return function(){this[i]=t}}function na(i,t){return function(){var e=t.apply(this,arguments);null==e?delete this[i]:this[i]=e}}function xn(i){return i.trim().split(/^|\s+/)}function Ji(i){return i.classList||new kn(i)}function kn(i){this._node=i,this._names=xn(i.getAttribute("class")||"")}function Sn(i,t){for(var e=Ji(i),n=-1,r=t.length;++n<r;)e.add(t[n])}function On(i,t){for(var e=Ji(i),n=-1,r=t.length;++n<r;)e.remove(t[n])}function la(i){return function(){Sn(this,i)}}function aa(i){return function(){On(this,i)}}function oa(i,t){return function(){(t.apply(this,arguments)?Sn:On)(this,i)}}function da(){this.textContent=""}function ca(i){return function(){this.textContent=i}}function ua(i){return function(){var t=i.apply(this,arguments);this.textContent=null==t?"":t}}function fa(){this.innerHTML=""}function ga(i){return function(){this.innerHTML=i}}function va(i){return function(){var t=i.apply(this,arguments);this.innerHTML=null==t?"":t}}function pa(){this.nextSibling&&this.parentNode.appendChild(this)}function wa(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function xa(i){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===Ci&&t.documentElement.namespaceURI===Ci?t.createElement(i):t.createElementNS(e,i)}}function ka(i){return function(){return this.ownerDocument.createElementNS(i.space,i.local)}}function Nn(i){var t=Xe(i);return(t.local?ka:xa)(t)}function Oa(){return null}function Ea(){var i=this.parentNode;i&&i.removeChild(this)}function Ta(){var i=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(i,this.nextSibling):i}function Fa(){var i=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(i,this.nextSibling):i}function ja(i){return function(){var t=this.__on;if(t){for(var l,e=0,n=-1,r=t.length;e<r;++e)l=t[e],i.type&&l.type!==i.type||l.name!==i.name?t[++n]=l:this.removeEventListener(l.type,l.listener,l.options);++n?t.length=n:delete this.__on}}}function za(i,t,e){return function(){var r,n=this.__on,l=function Ia(i){return function(t){i.call(this,t,this.__data__)}}(t);if(n)for(var a=0,s=n.length;a<s;++a)if((r=n[a]).type===i.type&&r.name===i.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=l,r.options=e),void(r.value=t);this.addEventListener(i.type,l,e),r={type:i.type,name:i.name,value:t,listener:l,options:e},n?n.push(r):this.__on=[r]}}function En(i,t,e){var n=bn(i),r=n.CustomEvent;"function"==typeof r?r=new r(t,e):(r=n.document.createEvent("Event"),e?(r.initEvent(t,e.bubbles,e.cancelable),r.detail=e.detail):r.initEvent(t,!1,!1)),i.dispatchEvent(r)}function Ba(i,t){return function(){return En(this,i,t)}}function La(i,t){return function(){return En(this,i,t.apply(this,arguments))}}kn.prototype={add:function(i){this._names.indexOf(i)<0&&(this._names.push(i),this._node.setAttribute("class",this._names.join(" ")))},remove:function(i){var t=this._names.indexOf(i);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(i){return this._names.indexOf(i)>=0}};var Ka=[null];function Rt(i,t){this._groups=i,this._parents=t}function _n(){return new Rt([[document.documentElement]],Ka)}Rt.prototype=_n.prototype={constructor:Rt,select:function ul(i){"function"!=typeof i&&(i=Fi(i));for(var t=this._groups,e=t.length,n=new Array(e),r=0;r<e;++r)for(var o,d,l=t[r],a=l.length,s=n[r]=new Array(a),c=0;c<a;++c)(o=l[c])&&(d=i.call(o,o.__data__,c,l))&&("__data__"in o&&(d.__data__=o.__data__),s[c]=d);return new Rt(n,this._parents)},selectAll:function vl(i){i="function"==typeof i?function gl(i){return function(){return function hl(i){return null==i?[]:Array.isArray(i)?i:Array.from(i)}(i.apply(this,arguments))}}(i):vn(i);for(var t=this._groups,e=t.length,n=[],r=[],l=0;l<e;++l)for(var o,a=t[l],s=a.length,d=0;d<s;++d)(o=a[d])&&(n.push(i.call(o,o.__data__,d,a)),r.push(o));return new Rt(n,r)},selectChild:function wl(i){return this.select(null==i?ml:function pl(i){return function(){return yl.call(this.children,i)}}("function"==typeof i?i:pn(i)))},selectChildren:function Sl(i){return this.selectAll(null==i?xl:function kl(i){return function(){return bl.call(this.children,i)}}("function"==typeof i?i:pn(i)))},filter:function Ol(i){"function"!=typeof i&&(i=yn(i));for(var t=this._groups,e=t.length,n=new Array(e),r=0;r<e;++r)for(var o,l=t[r],a=l.length,s=n[r]=[],d=0;d<a;++d)(o=l[d])&&i.call(o,o.__data__,d,l)&&s.push(o);return new Rt(n,this._parents)},data:function Cl(i,t){if(!arguments.length)return Array.from(this,Fl);var e=t?Tl:_l,n=this._parents,r=this._groups;"function"!=typeof i&&(i=function El(i){return function(){return i}}(i));for(var l=r.length,a=new Array(l),s=new Array(l),o=new Array(l),d=0;d<l;++d){var c=n[d],u=r[d],h=u.length,f=Jl(i.call(c,c&&c.__data__,d,n)),g=f.length,w=s[d]=new Array(g),p=a[d]=new Array(g);e(c,u,w,p,o[d]=new Array(h),f,t);for(var m,x,k=0,b=0;k<g;++k)if(m=w[k]){for(k>=b&&(b=k+1);!(x=p[b])&&++b<g;);m._next=x||null}}return(a=new Rt(a,n))._enter=s,a._exit=o,a},enter:function Nl(){return new Rt(this._enter||this._groups.map(mn),this._parents)},exit:function Il(){return new Rt(this._exit||this._groups.map(mn),this._parents)},join:function Al(i,t,e){var n=this.enter(),r=this,l=this.exit();return"function"==typeof i?(n=i(n))&&(n=n.selection()):n=n.append(i+""),null!=t&&(r=t(r))&&(r=r.selection()),null==e?l.remove():e(l),n&&r?n.merge(r).order():r},merge:function jl(i){for(var t=i.selection?i.selection():i,e=this._groups,n=t._groups,r=e.length,a=Math.min(r,n.length),s=new Array(r),o=0;o<a;++o)for(var f,d=e[o],c=n[o],u=d.length,h=s[o]=new Array(u),g=0;g<u;++g)(f=d[g]||c[g])&&(h[g]=f);for(;o<r;++o)s[o]=e[o];return new Rt(s,this._parents)},selection:function Ga(){return this},order:function zl(){for(var i=this._groups,t=-1,e=i.length;++t<e;)for(var a,n=i[t],r=n.length-1,l=n[r];--r>=0;)(a=n[r])&&(l&&4^a.compareDocumentPosition(l)&&l.parentNode.insertBefore(a,l),l=a);return this},sort:function Rl(i){function t(u,h){return u&&h?i(u.__data__,h.__data__):!u-!h}i||(i=Bl);for(var e=this._groups,n=e.length,r=new Array(n),l=0;l<n;++l){for(var d,a=e[l],s=a.length,o=r[l]=new Array(s),c=0;c<s;++c)(d=a[c])&&(o[c]=d);o.sort(t)}return new Rt(r,this._parents).order()},call:function Ll(){var i=arguments[0];return arguments[0]=this,i.apply(null,arguments),this},nodes:function Pl(){return Array.from(this)},node:function Ml(){for(var i=this._groups,t=0,e=i.length;t<e;++t)for(var n=i[t],r=0,l=n.length;r<l;++r){var a=n[r];if(a)return a}return null},size:function Kl(){let i=0;for(const t of this)++i;return i},empty:function Gl(){return!this.node()},each:function Ql(i){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var s,r=t[e],l=0,a=r.length;l<a;++l)(s=r[l])&&i.call(s,s.__data__,l,r);return this},attr:function Zl(i,t){var e=Xe(i);if(arguments.length<2){var n=this.node();return e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}return this.each((null==t?e.local?Ul:Dl:"function"==typeof t?e.local?Xl:ql:e.local?Wl:Hl)(e,t))},style:function ta(i,t,e){return arguments.length>1?this.each((null==t?Yl:"function"==typeof t?$l:Vl)(i,t,null==e?"":e)):ve(this.node(),i)},property:function ra(i,t){return arguments.length>1?this.each((null==t?ea:"function"==typeof t?na:ia)(i,t)):this.node()[i]},classed:function sa(i,t){var e=xn(i+"");if(arguments.length<2){for(var n=Ji(this.node()),r=-1,l=e.length;++r<l;)if(!n.contains(e[r]))return!1;return!0}return this.each(("function"==typeof t?oa:t?la:aa)(e,t))},text:function ha(i){return arguments.length?this.each(null==i?da:("function"==typeof i?ua:ca)(i)):this.node().textContent},html:function ya(i){return arguments.length?this.each(null==i?fa:("function"==typeof i?va:ga)(i)):this.node().innerHTML},raise:function ma(){return this.each(pa)},lower:function ba(){return this.each(wa)},append:function Sa(i){var t="function"==typeof i?i:Nn(i);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function Na(i,t){var e="function"==typeof i?i:Nn(i),n=null==t?Oa:"function"==typeof t?t:Fi(t);return this.select(function(){return this.insertBefore(e.apply(this,arguments),n.apply(this,arguments)||null)})},remove:function _a(){return this.each(Ea)},clone:function Ca(i){return this.select(i?Fa:Ta)},datum:function Ja(i){return arguments.length?this.property("__data__",i):this.node().__data__},on:function Ra(i,t,e){var r,a,n=function Aa(i){return i.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(i+""),l=n.length;if(!(arguments.length<2)){for(s=t?za:ja,r=0;r<l;++r)this.each(s(n[r],t,e));return this}var s=this.node().__on;if(s)for(var c,o=0,d=s.length;o<d;++o)for(r=0,c=s[o];r<l;++r)if((a=n[r]).type===c.type&&a.name===c.name)return c.value},dispatch:function Pa(i,t){return this.each(("function"==typeof t?La:Ba)(i,t))},[Symbol.iterator]:function*Ma(){for(var i=this._groups,t=0,e=i.length;t<e;++t)for(var a,n=i[t],r=0,l=n.length;r<l;++r)(a=n[r])&&(yield a)}};const Fe=_n;var Qa={value:()=>{}};function Tn(){for(var n,i=0,t=arguments.length,e={};i<t;++i){if(!(n=arguments[i]+"")||n in e||/[\s.]/.test(n))throw new Error("illegal type: "+n);e[n]=[]}return new Ze(e)}function Ze(i){this._=i}function Ua(i,t){for(var r,e=0,n=i.length;e<n;++e)if((r=i[e]).name===t)return r.value}function Fn(i,t,e){for(var n=0,r=i.length;n<r;++n)if(i[n].name===t){i[n]=Qa,i=i.slice(0,n).concat(i.slice(n+1));break}return null!=e&&i.push({name:t,value:e}),i}Ze.prototype=Tn.prototype={constructor:Ze,on:function(i,t){var r,e=this._,n=function Da(i,t){return i.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}})}(i+"",e),l=-1,a=n.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++l<a;)if(r=(i=n[l]).type)e[r]=Fn(e[r],i.name,t);else if(null==t)for(r in e)e[r]=Fn(e[r],i.name,null);return this}for(;++l<a;)if((r=(i=n[l]).type)&&(r=Ua(e[r],i.name)))return r},copy:function(){var i={},t=this._;for(var e in t)i[e]=t[e].slice();return new Ze(i)},call:function(i,t){if((r=arguments.length-2)>0)for(var r,l,e=new Array(r),n=0;n<r;++n)e[n]=arguments[n+2];if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(n=0,r=(l=this._[i]).length;n<r;++n)l[n].value.apply(t,e)},apply:function(i,t,e){if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(var n=this._[i],r=0,l=n.length;r<l;++r)n[r].value.apply(t,e)}};const Ha=Tn;var Ye,Ie,ye=0,Ce=0,Je=0,Cn=1e3,Ve=0,le=0,$e=0,Ae="object"==typeof performance&&performance.now?performance:Date,Jn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(i){setTimeout(i,17)};function Ii(){return le||(Jn(Wa),le=Ae.now()+$e)}function Wa(){le=0}function ti(){this._call=this._time=this._next=null}function In(i,t,e){var n=new ti;return n.restart(i,t,e),n}function An(){le=(Ve=Ae.now())+$e,ye=Ce=0;try{!function qa(){Ii(),++ye;for(var t,i=Ye;i;)(t=le-i._time)>=0&&i._call.call(void 0,t),i=i._next;--ye}()}finally{ye=0,function Za(){for(var i,e,t=Ye,n=1/0;t;)t._call?(n>t._time&&(n=t._time),i=t,t=t._next):(e=t._next,t._next=null,t=i?i._next=e:Ye=e);Ie=i,Ai(n)}(),le=0}}function Xa(){var i=Ae.now(),t=i-Ve;t>Cn&&($e-=t,Ve=i)}function Ai(i){ye||(Ce&&(Ce=clearTimeout(Ce)),i-le>24?(i<1/0&&(Ce=setTimeout(An,i-Ae.now()-$e)),Je&&(Je=clearInterval(Je))):(Je||(Ve=Ae.now(),Je=setInterval(Xa,Cn)),ye=1,Jn(An)))}function jn(i,t,e){var n=new ti;return n.restart(r=>{n.stop(),i(r+t)},t=null==t?0:+t,e),n}ti.prototype=In.prototype={constructor:ti,restart:function(i,t,e){if("function"!=typeof i)throw new TypeError("callback is not a function");e=(null==e?Ii():+e)+(null==t?0:+t),!this._next&&Ie!==this&&(Ie?Ie._next=this:Ye=this,Ie=this),this._call=i,this._time=e,Ai()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ai())}};var Ya=Ha("start","end","cancel","interrupt"),Va=[],zn=0,ei=3;function ni(i,t,e,n,r,l){var a=i.__transition;if(a){if(e in a)return}else i.__transition={};!function $a(i,t,e){var r,n=i.__transition;function a(d){var c,u,h,f;if(1!==e.state)return o();for(c in n)if((f=n[c]).name===e.name){if(f.state===ei)return jn(a);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",i,i.__data__,f.index,f.group),delete n[c]):+c<t&&(f.state=6,f.timer.stop(),f.on.call("cancel",i,i.__data__,f.index,f.group),delete n[c])}if(jn(function(){e.state===ei&&(e.state=4,e.timer.restart(s,e.delay,e.time),s(d))}),e.state=2,e.on.call("start",i,i.__data__,e.index,e.group),2===e.state){for(e.state=ei,r=new Array(h=e.tween.length),c=0,u=-1;c<h;++c)(f=e.tween[c].value.call(i,i.__data__,e.index,e.group))&&(r[++u]=f);r.length=u+1}}function s(d){for(var c=d<e.duration?e.ease.call(null,d/e.duration):(e.timer.restart(o),e.state=5,1),u=-1,h=r.length;++u<h;)r[u].call(i,c);5===e.state&&(e.on.call("end",i,i.__data__,e.index,e.group),o())}function o(){for(var d in e.state=6,e.timer.stop(),delete n[t],n)return;delete i.__transition}n[t]=e,e.timer=In(function l(d){e.state=1,e.timer.restart(a,e.delay,e.time),e.delay<=d&&a(d-e.delay)},0,e.time)}(i,e,{name:t,index:n,group:r,on:Ya,tween:Va,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:zn})}function Ri(i,t){var e=Bt(i,t);if(e.state>zn)throw new Error("too late; already scheduled");return e}function Mt(i,t){var e=Bt(i,t);if(e.state>ei)throw new Error("too late; already running");return e}function Bt(i,t){var e=i.__transition;if(!e||!(e=e[t]))throw new Error("transition not found");return e}function Zt(i,t){return i=+i,t=+t,function(e){return i*(1-e)+t*e}}var ri,Ln=180/Math.PI,Bi={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Pn(i,t,e,n,r,l){var a,s,o;return(a=Math.sqrt(i*i+t*t))&&(i/=a,t/=a),(o=i*e+t*n)&&(e-=i*o,n-=t*o),(s=Math.sqrt(e*e+n*n))&&(e/=s,n/=s,o/=s),i*n<t*e&&(i=-i,t=-t,o=-o,a=-a),{translateX:r,translateY:l,rotate:Math.atan2(t,i)*Ln,skewX:Math.atan(o)*Ln,scaleX:a,scaleY:s}}function Mn(i,t,e,n){function r(d){return d.length?d.pop()+" ":""}return function(d,c){var u=[],h=[];return d=i(d),c=i(c),function l(d,c,u,h,f,g){if(d!==u||c!==h){var w=f.push("translate(",null,t,null,e);g.push({i:w-4,x:Zt(d,u)},{i:w-2,x:Zt(c,h)})}else(u||h)&&f.push("translate("+u+t+h+e)}(d.translateX,d.translateY,c.translateX,c.translateY,u,h),function a(d,c,u,h){d!==c?(d-c>180?c+=360:c-d>180&&(d+=360),h.push({i:u.push(r(u)+"rotate(",null,n)-2,x:Zt(d,c)})):c&&u.push(r(u)+"rotate("+c+n)}(d.rotate,c.rotate,u,h),function s(d,c,u,h){d!==c?h.push({i:u.push(r(u)+"skewX(",null,n)-2,x:Zt(d,c)}):c&&u.push(r(u)+"skewX("+c+n)}(d.skewX,c.skewX,u,h),function o(d,c,u,h,f,g){if(d!==u||c!==h){var w=f.push(r(f)+"scale(",null,",",null,")");g.push({i:w-4,x:Zt(d,u)},{i:w-2,x:Zt(c,h)})}else(1!==u||1!==h)&&f.push(r(f)+"scale("+u+","+h+")")}(d.scaleX,d.scaleY,c.scaleX,c.scaleY,u,h),d=c=null,function(f){for(var p,g=-1,w=h.length;++g<w;)u[(p=h[g]).i]=p.x(f);return u.join("")}}}var ro=Mn(function io(i){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(i+"");return t.isIdentity?Bi:Pn(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),lo=Mn(function no(i){return null!=i&&(ri||(ri=document.createElementNS("http://www.w3.org/2000/svg","g")),ri.setAttribute("transform",i),i=ri.transform.baseVal.consolidate())?Pn((i=i.matrix).a,i.b,i.c,i.d,i.e,i.f):Bi},", ",")",")");function ao(i,t){var e,n;return function(){var r=Mt(this,i),l=r.tween;if(l!==e)for(var a=0,s=(n=e=l).length;a<s;++a)if(n[a].name===t){(n=n.slice()).splice(a,1);break}r.tween=n}}function oo(i,t,e){var n,r;if("function"!=typeof e)throw new Error;return function(){var l=Mt(this,i),a=l.tween;if(a!==n){r=(n=a).slice();for(var s={name:t,value:e},o=0,d=r.length;o<d;++o)if(r[o].name===t){r[o]=s;break}o===d&&r.push(s)}l.tween=r}}function Li(i,t,e){var n=i._id;return i.each(function(){var r=Mt(this,n);(r.value||(r.value={}))[t]=e.apply(this,arguments)}),function(r){return Bt(r,n).value[t]}}function Pi(i,t,e){i.prototype=t.prototype=e,e.constructor=i}function Kn(i,t){var e=Object.create(i.prototype);for(var n in t)e[n]=t[n];return e}function je(){}var li=1/.7,pe="\\s*([+-]?\\d+)\\s*",Re="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Kt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",co=/^#([0-9a-f]{3,8})$/,uo=new RegExp(`^rgb\\(${pe},${pe},${pe}\\)$`),ho=new RegExp(`^rgb\\(${Kt},${Kt},${Kt}\\)$`),fo=new RegExp(`^rgba\\(${pe},${pe},${pe},${Re}\\)$`),go=new RegExp(`^rgba\\(${Kt},${Kt},${Kt},${Re}\\)$`),vo=new RegExp(`^hsl\\(${Re},${Kt},${Kt}\\)$`),yo=new RegExp(`^hsla\\(${Re},${Kt},${Kt},${Re}\\)$`),Gn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Qn(){return this.rgb().formatHex()}function Dn(){return this.rgb().formatRgb()}function Be(i){var t,e;return i=(i+"").trim().toLowerCase(),(t=co.exec(i))?(e=t[1].length,t=parseInt(t[1],16),6===e?Un(t):3===e?new kt(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===e?ai(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===e?ai(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=uo.exec(i))?new kt(t[1],t[2],t[3],1):(t=ho.exec(i))?new kt(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=fo.exec(i))?ai(t[1],t[2],t[3],t[4]):(t=go.exec(i))?ai(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=vo.exec(i))?qn(t[1],t[2]/100,t[3]/100,1):(t=yo.exec(i))?qn(t[1],t[2]/100,t[3]/100,t[4]):Gn.hasOwnProperty(i)?Un(Gn[i]):"transparent"===i?new kt(NaN,NaN,NaN,0):null}function Un(i){return new kt(i>>16&255,i>>8&255,255&i,1)}function ai(i,t,e,n){return n<=0&&(i=t=e=NaN),new kt(i,t,e,n)}function oi(i,t,e,n){return 1===arguments.length?function wo(i){return i instanceof je||(i=Be(i)),i?new kt((i=i.rgb()).r,i.g,i.b,i.opacity):new kt}(i):new kt(i,t,e,null==n?1:n)}function kt(i,t,e,n){this.r=+i,this.g=+t,this.b=+e,this.opacity=+n}function Hn(){return`#${oe(this.r)}${oe(this.g)}${oe(this.b)}`}function Wn(){const i=si(this.opacity);return`${1===i?"rgb(":"rgba("}${ae(this.r)}, ${ae(this.g)}, ${ae(this.b)}${1===i?")":`, ${i})`}`}function si(i){return isNaN(i)?1:Math.max(0,Math.min(1,i))}function ae(i){return Math.max(0,Math.min(255,Math.round(i)||0))}function oe(i){return((i=ae(i))<16?"0":"")+i.toString(16)}function qn(i,t,e,n){return n<=0?i=t=e=NaN:e<=0||e>=1?i=t=NaN:t<=0&&(i=NaN),new Lt(i,t,e,n)}function Xn(i){if(i instanceof Lt)return new Lt(i.h,i.s,i.l,i.opacity);if(i instanceof je||(i=Be(i)),!i)return new Lt;if(i instanceof Lt)return i;var t=(i=i.rgb()).r/255,e=i.g/255,n=i.b/255,r=Math.min(t,e,n),l=Math.max(t,e,n),a=NaN,s=l-r,o=(l+r)/2;return s?(a=t===l?(e-n)/s+6*(e<n):e===l?(n-t)/s+2:(t-e)/s+4,s/=o<.5?l+r:2-l-r,a*=60):s=o>0&&o<1?0:a,new Lt(a,s,o,i.opacity)}function Lt(i,t,e,n){this.h=+i,this.s=+t,this.l=+e,this.opacity=+n}function Zn(i){return(i=(i||0)%360)<0?i+360:i}function di(i){return Math.max(0,Math.min(1,i||0))}function Mi(i,t,e){return 255*(i<60?t+(e-t)*i/60:i<180?e:i<240?t+(e-t)*(240-i)/60:t)}function Yn(i,t,e,n,r){var l=i*i,a=l*i;return((1-3*i+3*l-a)*t+(4-6*l+3*a)*e+(1+3*i+3*l-3*a)*n+a*r)/6}Pi(je,Be,{copy(i){return Object.assign(new this.constructor,this,i)},displayable(){return this.rgb().displayable()},hex:Qn,formatHex:Qn,formatHex8:function po(){return this.rgb().formatHex8()},formatHsl:function mo(){return Xn(this).formatHsl()},formatRgb:Dn,toString:Dn}),Pi(kt,oi,Kn(je,{brighter(i){return i=null==i?li:Math.pow(li,i),new kt(this.r*i,this.g*i,this.b*i,this.opacity)},darker(i){return i=null==i?.7:Math.pow(.7,i),new kt(this.r*i,this.g*i,this.b*i,this.opacity)},rgb(){return this},clamp(){return new kt(ae(this.r),ae(this.g),ae(this.b),si(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Hn,formatHex:Hn,formatHex8:function bo(){return`#${oe(this.r)}${oe(this.g)}${oe(this.b)}${oe(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Wn,toString:Wn})),Pi(Lt,function xo(i,t,e,n){return 1===arguments.length?Xn(i):new Lt(i,t,e,null==n?1:n)},Kn(je,{brighter(i){return i=null==i?li:Math.pow(li,i),new Lt(this.h,this.s,this.l*i,this.opacity)},darker(i){return i=null==i?.7:Math.pow(.7,i),new Lt(this.h,this.s,this.l*i,this.opacity)},rgb(){var i=this.h%360+360*(this.h<0),t=isNaN(i)||isNaN(this.s)?0:this.s,e=this.l,n=e+(e<.5?e:1-e)*t,r=2*e-n;return new kt(Mi(i>=240?i-240:i+120,r,n),Mi(i,r,n),Mi(i<120?i+240:i-120,r,n),this.opacity)},clamp(){return new Lt(Zn(this.h),di(this.s),di(this.l),si(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const i=si(this.opacity);return`${1===i?"hsl(":"hsla("}${Zn(this.h)}, ${100*di(this.s)}%, ${100*di(this.l)}%${1===i?")":`, ${i})`}`}}));const Vn=i=>()=>i;function tr(i,t){var e=t-i;return e?function $n(i,t){return function(e){return i+e*t}}(i,e):Vn(isNaN(i)?t:i)}const er=function i(t){var e=function No(i){return 1==(i=+i)?tr:function(t,e){return e-t?function Oo(i,t,e){return i=Math.pow(i,e),t=Math.pow(t,e)-i,e=1/e,function(n){return Math.pow(i+n*t,e)}}(t,e,i):Vn(isNaN(t)?e:t)}}(t);function n(r,l){var a=e((r=oi(r)).r,(l=oi(l)).r),s=e(r.g,l.g),o=e(r.b,l.b),d=tr(r.opacity,l.opacity);return function(c){return r.r=a(c),r.g=s(c),r.b=o(c),r.opacity=d(c),r+""}}return n.gamma=i,n}(1);function ir(i){return function(t){var a,s,e=t.length,n=new Array(e),r=new Array(e),l=new Array(e);for(a=0;a<e;++a)s=oi(t[a]),n[a]=s.r||0,r[a]=s.g||0,l[a]=s.b||0;return n=i(n),r=i(r),l=i(l),s.opacity=1,function(o){return s.r=n(o),s.g=r(o),s.b=l(o),s+""}}}ir(function ko(i){var t=i.length-1;return function(e){var n=e<=0?e=0:e>=1?(e=1,t-1):Math.floor(e*t),r=i[n],l=i[n+1];return Yn((e-n/t)*t,n>0?i[n-1]:2*r-l,r,l,n<t-1?i[n+2]:2*l-r)}}),ir(function So(i){var t=i.length;return function(e){var n=Math.floor(((e%=1)<0?++e:e)*t);return Yn((e-n/t)*t,i[(n+t-1)%t],i[n%t],i[(n+1)%t],i[(n+2)%t])}});var Ki=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Gi=new RegExp(Ki.source,"g");function To(i,t){var n,r,l,e=Ki.lastIndex=Gi.lastIndex=0,a=-1,s=[],o=[];for(i+="",t+="";(n=Ki.exec(i))&&(r=Gi.exec(t));)(l=r.index)>e&&(l=t.slice(e,l),s[a]?s[a]+=l:s[++a]=l),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,o.push({i:a,x:Zt(n,r)})),e=Gi.lastIndex;return e<t.length&&(l=t.slice(e),s[a]?s[a]+=l:s[++a]=l),s.length<2?o[0]?function _o(i){return function(t){return i(t)+""}}(o[0].x):function Eo(i){return function(){return i}}(t):(t=o.length,function(d){for(var u,c=0;c<t;++c)s[(u=o[c]).i]=u.x(d);return s.join("")})}function nr(i,t){var e;return("number"==typeof t?Zt:t instanceof Be?er:(e=Be(t))?(t=e,er):To)(i,t)}function Fo(i){return function(){this.removeAttribute(i)}}function Co(i){return function(){this.removeAttributeNS(i.space,i.local)}}function Jo(i,t,e){var n,l,r=e+"";return function(){var a=this.getAttribute(i);return a===r?null:a===n?l:l=t(n=a,e)}}function Io(i,t,e){var n,l,r=e+"";return function(){var a=this.getAttributeNS(i.space,i.local);return a===r?null:a===n?l:l=t(n=a,e)}}function Ao(i,t,e){var n,r,l;return function(){var a,o,s=e(this);return null==s?void this.removeAttribute(i):(a=this.getAttribute(i))===(o=s+"")?null:a===n&&o===r?l:(r=o,l=t(n=a,s))}}function jo(i,t,e){var n,r,l;return function(){var a,o,s=e(this);return null==s?void this.removeAttributeNS(i.space,i.local):(a=this.getAttributeNS(i.space,i.local))===(o=s+"")?null:a===n&&o===r?l:(r=o,l=t(n=a,s))}}function Lo(i,t){var e,n;function r(){var l=t.apply(this,arguments);return l!==n&&(e=(n=l)&&function Bo(i,t){return function(e){this.setAttributeNS(i.space,i.local,t.call(this,e))}}(i,l)),e}return r._value=t,r}function Po(i,t){var e,n;function r(){var l=t.apply(this,arguments);return l!==n&&(e=(n=l)&&function Ro(i,t){return function(e){this.setAttribute(i,t.call(this,e))}}(i,l)),e}return r._value=t,r}function Ko(i,t){return function(){Ri(this,i).delay=+t.apply(this,arguments)}}function Go(i,t){return t=+t,function(){Ri(this,i).delay=t}}function Do(i,t){return function(){Mt(this,i).duration=+t.apply(this,arguments)}}function Uo(i,t){return t=+t,function(){Mt(this,i).duration=t}}var as=Fe.prototype.constructor;function rr(i){return function(){this.style.removeProperty(i)}}var Os=0;function Ht(i,t,e,n){this._groups=i,this._parents=t,this._name=e,this._id=n}function lr(){return++Os}var Wt=Fe.prototype;Ht.prototype=function Ns(i){return Fe().transition(i)}.prototype={constructor:Ht,select:function rs(i){var t=this._name,e=this._id;"function"!=typeof i&&(i=Fi(i));for(var n=this._groups,r=n.length,l=new Array(r),a=0;a<r;++a)for(var c,u,s=n[a],o=s.length,d=l[a]=new Array(o),h=0;h<o;++h)(c=s[h])&&(u=i.call(c,c.__data__,h,s))&&("__data__"in c&&(u.__data__=c.__data__),d[h]=u,ni(d[h],t,e,h,d,Bt(c,e)));return new Ht(l,this._parents,t,e)},selectAll:function ls(i){var t=this._name,e=this._id;"function"!=typeof i&&(i=vn(i));for(var n=this._groups,r=n.length,l=[],a=[],s=0;s<r;++s)for(var c,o=n[s],d=o.length,u=0;u<d;++u)if(c=o[u]){for(var f,h=i.call(c,c.__data__,u,o),g=Bt(c,e),w=0,p=h.length;w<p;++w)(f=h[w])&&ni(f,t,e,w,h,g);l.push(h),a.push(c)}return new Ht(l,a,t,e)},selectChild:Wt.selectChild,selectChildren:Wt.selectChildren,filter:function Yo(i){"function"!=typeof i&&(i=yn(i));for(var t=this._groups,e=t.length,n=new Array(e),r=0;r<e;++r)for(var o,l=t[r],a=l.length,s=n[r]=[],d=0;d<a;++d)(o=l[d])&&i.call(o,o.__data__,d,l)&&s.push(o);return new Ht(n,this._parents,this._name,this._id)},merge:function Vo(i){if(i._id!==this._id)throw new Error;for(var t=this._groups,e=i._groups,n=t.length,l=Math.min(n,e.length),a=new Array(n),s=0;s<l;++s)for(var h,o=t[s],d=e[s],c=o.length,u=a[s]=new Array(c),f=0;f<c;++f)(h=o[f]||d[f])&&(u[f]=h);for(;s<n;++s)a[s]=t[s];return new Ht(a,this._parents,this._name,this._id)},selection:function os(){return new as(this._groups,this._parents)},transition:function ks(){for(var i=this._name,t=this._id,e=lr(),n=this._groups,r=n.length,l=0;l<r;++l)for(var o,a=n[l],s=a.length,d=0;d<s;++d)if(o=a[d]){var c=Bt(o,t);ni(o,i,e,d,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Ht(n,this._parents,i,e)},call:Wt.call,nodes:Wt.nodes,node:Wt.node,size:Wt.size,empty:Wt.empty,each:Wt.each,on:function es(i,t){var e=this._id;return arguments.length<2?Bt(this.node(),e).on.on(i):this.each(function ts(i,t,e){var n,r,l=function $o(i){return(i+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(t)?Ri:Mt;return function(){var a=l(this,i),s=a.on;s!==n&&(r=(n=s).copy()).on(t,e),a.on=r}}(e,i,t))},attr:function zo(i,t){var e=Xe(i),n="transform"===e?lo:nr;return this.attrTween(i,"function"==typeof t?(e.local?jo:Ao)(e,n,Li(this,"attr."+i,t)):null==t?(e.local?Co:Fo)(e):(e.local?Io:Jo)(e,n,t))},attrTween:function Mo(i,t){var e="attr."+i;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;var n=Xe(i);return this.tween(e,(n.local?Lo:Po)(n,t))},style:function hs(i,t,e){var n="transform"==(i+="")?ro:nr;return null==t?this.styleTween(i,function ss(i,t){var e,n,r;return function(){var l=ve(this,i),a=(this.style.removeProperty(i),ve(this,i));return l===a?null:l===e&&a===n?r:r=t(e=l,n=a)}}(i,n)).on("end.style."+i,rr(i)):"function"==typeof t?this.styleTween(i,function cs(i,t,e){var n,r,l;return function(){var a=ve(this,i),s=e(this),o=s+"";return null==s&&(this.style.removeProperty(i),o=s=ve(this,i)),a===o?null:a===n&&o===r?l:(r=o,l=t(n=a,s))}}(i,n,Li(this,"style."+i,t))).each(function us(i,t){var e,n,r,s,l="style."+t,a="end."+l;return function(){var o=Mt(this,i),d=o.on,c=null==o.value[l]?s||(s=rr(t)):void 0;(d!==e||r!==c)&&(n=(e=d).copy()).on(a,r=c),o.on=n}}(this._id,i)):this.styleTween(i,function ds(i,t,e){var n,l,r=e+"";return function(){var a=ve(this,i);return a===r?null:a===n?l:l=t(n=a,e)}}(i,n,t),e).on("end.style."+i,null)},styleTween:function vs(i,t,e){var n="style."+(i+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;return this.tween(n,function gs(i,t,e){var n,r;function l(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&function fs(i,t,e){return function(n){this.style.setProperty(i,t.call(this,n),e)}}(i,a,e)),n}return l._value=t,l}(i,t,null==e?"":e))},text:function ms(i){return this.tween("text","function"==typeof i?function ps(i){return function(){var t=i(this);this.textContent=null==t?"":t}}(Li(this,"text",i)):function ys(i){return function(){this.textContent=i}}(null==i?"":i+""))},textTween:function xs(i){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==i)return this.tween(t,null);if("function"!=typeof i)throw new Error;return this.tween(t,function bs(i){var t,e;function n(){var r=i.apply(this,arguments);return r!==e&&(t=(e=r)&&function ws(i){return function(t){this.textContent=i.call(this,t)}}(r)),t}return n._value=i,n}(i))},remove:function ns(){return this.on("end.remove",function is(i){return function(){var t=this.parentNode;for(var e in this.__transition)if(+e!==i)return;t&&t.removeChild(this)}}(this._id))},tween:function so(i,t){var e=this._id;if(i+="",arguments.length<2){for(var a,n=Bt(this.node(),e).tween,r=0,l=n.length;r<l;++r)if((a=n[r]).name===i)return a.value;return null}return this.each((null==t?ao:oo)(e,i,t))},delay:function Qo(i){var t=this._id;return arguments.length?this.each(("function"==typeof i?Ko:Go)(t,i)):Bt(this.node(),t).delay},duration:function Ho(i){var t=this._id;return arguments.length?this.each(("function"==typeof i?Do:Uo)(t,i)):Bt(this.node(),t).duration},ease:function qo(i){var t=this._id;return arguments.length?this.each(function Wo(i,t){if("function"!=typeof t)throw new Error;return function(){Mt(this,i).ease=t}}(t,i)):Bt(this.node(),t).ease},easeVarying:function Zo(i){if("function"!=typeof i)throw new Error;return this.each(function Xo(i,t){return function(){var e=t.apply(this,arguments);if("function"!=typeof e)throw new Error;Mt(this,i).ease=e}}(this._id,i))},end:function Ss(){var i,t,e=this,n=e._id,r=e.size();return new Promise(function(l,a){var s={value:a},o={value:function(){0==--r&&l()}};e.each(function(){var d=Mt(this,n),c=d.on;c!==i&&((t=(i=c).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(o)),d.on=t}),0===r&&l()})},[Symbol.iterator]:Wt[Symbol.iterator]};var _s={time:null,delay:0,duration:250,ease:function Es(i){return((i*=2)<=1?i*i*i:(i-=2)*i*i+2)/2}};function Ts(i,t){for(var e;!(e=i.__transition)||!(e=e[t]);)if(!(i=i.parentNode))throw new Error(`transition ${t} not found`);return e}Fe.prototype.interrupt=function eo(i){return this.each(function(){!function to(i,t){var n,r,a,e=i.__transition,l=!0;if(e){for(a in t=null==t?null:t+"",e)(n=e[a]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",i,i.__data__,n.index,n.group),delete e[a]):l=!1;l&&delete i.__transition}}(this,i)})},Fe.prototype.transition=function Fs(i){var t,e;i instanceof Ht?(t=i._id,i=i._name):(t=lr(),(e=_s).time=Ii(),i=null==i?null:i+"");for(var n=this._groups,r=n.length,l=0;l<r;++l)for(var o,a=n[l],s=a.length,d=0;d<s;++d)(o=a[d])&&ni(o,i,t,d,a,e||Ts(o,t));return new Ht(n,this._parents,i,t)};Math;function Le(i){return{type:i}}function be(i){return function(){return i}}function ur(i){this._context=i}function Ls(i){return new ur(i)}["w","e"].map(Le),["n","s"].map(Le),["n","w","e","s","nw","ne","sw","se"].map(Le),ur.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(i,t){switch(i=+i,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(i,t):this._context.moveTo(i,t);break;case 1:this._point=2;default:this._context.lineTo(i,t)}}};const Wi=Math.PI,qi=2*Wi,se=1e-6,Ps=qi-se;function hr(i){this._+=i[0];for(let t=1,e=i.length;t<e;++t)this._+=arguments[t]+i[t]}class hi{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?hr:function Ms(i){let t=Math.floor(i);if(!(t>=0))throw new Error(`invalid digits: ${i}`);if(t>15)return hr;const e=10**t;return function(n){this._+=n[0];for(let r=1,l=n.length;r<l;++r)this._+=Math.round(arguments[r]*e)/e+n[r]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,r){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(t,e,n,r,l,a){this._append`C${+t},${+e},${+n},${+r},${this._x1=+l},${this._y1=+a}`}arcTo(t,e,n,r,l){if(t=+t,e=+e,n=+n,r=+r,(l=+l)<0)throw new Error(`negative radius: ${l}`);let a=this._x1,s=this._y1,o=n-t,d=r-e,c=a-t,u=s-e,h=c*c+u*u;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(h>se)if(Math.abs(u*o-d*c)>se&&l){let f=n-a,g=r-s,w=o*o+d*d,p=f*f+g*g,v=Math.sqrt(w),k=Math.sqrt(h),b=l*Math.tan((Wi-Math.acos((w+h-p)/(2*v*k)))/2),m=b/k,x=b/v;Math.abs(m-1)>se&&this._append`L${t+m*c},${e+m*u}`,this._append`A${l},${l},0,0,${+(u*f>c*g)},${this._x1=t+x*o},${this._y1=e+x*d}`}else this._append`L${this._x1=t},${this._y1=e}`}arc(t,e,n,r,l,a){if(t=+t,e=+e,a=!!a,(n=+n)<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(r),o=n*Math.sin(r),d=t+s,c=e+o,u=1^a,h=a?r-l:l-r;null===this._x1?this._append`M${d},${c}`:(Math.abs(this._x1-d)>se||Math.abs(this._y1-c)>se)&&this._append`L${d},${c}`,n&&(h<0&&(h=h%qi+qi),h>Ps?this._append`A${n},${n},0,1,${u},${t-s},${e-o}A${n},${n},0,1,${u},${this._x1=d},${this._y1=c}`:h>se&&this._append`A${n},${n},0,${+(h>=Wi)},${u},${this._x1=t+n*Math.cos(l)},${this._y1=e+n*Math.sin(l)}`)}rect(t,e,n,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function Qs(i){return i[0]}function Ds(i){return i[1]}function fr(i,t){var e=be(!0),n=null,r=Ls,l=null,a=function Gs(i){let t=3;return i.digits=function(e){if(!arguments.length)return t;if(null==e)t=null;else{const n=Math.floor(e);if(!(n>=0))throw new RangeError(`invalid digits: ${e}`);t=n}return i},()=>new hi(t)}(s);function s(o){var d,u,f,c=(o=function Bs(i){return"object"==typeof i&&"length"in i?i:Array.from(i)}(o)).length,h=!1;for(null==n&&(l=r(f=a())),d=0;d<=c;++d)!(d<c&&e(u=o[d],d,o))===h&&((h=!h)?l.lineStart():l.lineEnd()),h&&l.point(+i(u,d,o),+t(u,d,o));if(f)return l=null,f+""||null}return i="function"==typeof i?i:void 0===i?Qs:be(i),t="function"==typeof t?t:void 0===t?Ds:be(t),s.x=function(o){return arguments.length?(i="function"==typeof o?o:be(+o),s):i},s.y=function(o){return arguments.length?(t="function"==typeof o?o:be(+o),s):t},s.defined=function(o){return arguments.length?(e="function"==typeof o?o:be(!!o),s):e},s.curve=function(o){return arguments.length?(r=o,null!=n&&(l=r(n)),s):r},s.context=function(o){return arguments.length?(null==o?n=l=null:l=r(n=o),s):n},s}function gr(i,t,e){i._context.bezierCurveTo((2*i._x0+i._x1)/3,(2*i._y0+i._y1)/3,(i._x0+2*i._x1)/3,(i._y0+2*i._y1)/3,(i._x0+4*i._x1+t)/6,(i._y0+4*i._y1+e)/6)}function vr(i){this._context=i}function yr(i){return new vr(i)}function xe(i,t,e){this.k=i,this.x=t,this.y=e}vr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:gr(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(i,t){switch(i=+i,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(i,t):this._context.moveTo(i,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:gr(this,i,t)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=t}},xe.prototype={constructor:xe,scale:function(i){return 1===i?this:new xe(this.k*i,this.x,this.y)},translate:function(i,t){return 0===i&0===t?this:new xe(this.k,this.x+this.k*i,this.y+this.k*t)},apply:function(i){return[i[0]*this.k+this.x,i[1]*this.k+this.y]},applyX:function(i){return i*this.k+this.x},applyY:function(i){return i*this.k+this.y},invert:function(i){return[(i[0]-this.x)/this.k,(i[1]-this.y)/this.k]},invertX:function(i){return(i-this.x)/this.k},invertY:function(i){return(i-this.y)/this.k},rescaleX:function(i){return i.copy().domain(i.range().map(this.invertX,this).map(i.invert,i))},rescaleY:function(i){return i.copy().domain(i.range().map(this.invertY,this).map(i.invert,i))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new xe(1,0,0);const U={RESIZE_GROUP:"icdt-resize-g",SELECT_GROUP:"icdt-select-g",SCAN_GROUP:"icdt-scan-g",CREATE_GROUP:"icdt-create-g",INTERACTIVE_GROUP:"icdt-interactive-g",INDEX_GROUP:"icdt-index-g",BACKGROUND_GROUP:"icdt-background-g",TEST_GROUP:"icdt-test-g"},et={POINTER:0,HAND:1,PEN:2,SHAPE:3,FOREIGNOBJECT:6,IMAGE:7,TEXT:4,ERASER:5,INDEX:8},de={DRAW:1,HIGHTLIGH:2,INTERACTIVE:3},C={GROUP:0,CIRCLE:1,ELLIPSE:2,LINE:5,RECT:3,POLYGON:4,FOREIGNOBJECT:6,IMAGE:9,TEXT:7,TSPAN:10,PATH:8,POLYLINE:11},St={TRIANGLE_ISOSCELES:3,TRIANGLE_EQUILATERAL:31,RECTANGLE:4,PENTAGON:5,HEXAGON:6,BOOKMARK:101,COMMENT:102,CROSS:104,ARROW_ONEWAY:201,ARROW_TWOWAY:202,STAR_FOUR:304,STAR_FIVE:305,STAR_SIX:306},Vs=[{name:"tam gi\xe1c vu\xf4ng",type:St.TRIANGLE_ISOSCELES,ratios:[[0,0],[1,1],[0,1]]},{name:"tam gi\xe1c c\xe2n",type:St.TRIANGLE_EQUILATERAL,ratios:[[.5,0],[0,1],[1,1]]},{name:"h\xecnh ch\u1eef nh\u1eadt",type:St.RECTANGLE,ratios:[[0,0],[1,0],[1,1],[0,1]]},{name:"h\xecnh ng\u0169 gi\xe1c \u0111\u1ec1u",type:St.PENTAGON,ratios:[[.5,0],[1,.4],[.8,1],[.2,1],[0,.4]]},{name:"h\xecnh l\u1ee5c gi\xe1c \u0111\u1ec1u",type:St.HEXAGON,ratios:[[.5,0],[1,.25],[1,.75],[.5,1],[0,.75],[0,.25]]},{name:"khung \u0111\xe1nh d\u1ea5u v\u1ecb tr\xed",type:St.BOOKMARK,ratios:[[0,0],[1,0],[1,.8],[.5,1],[0,.8]]},{name:"khung \u0111\xe1nh tr\xf2 chuy\u1ec7n",type:St.COMMENT,ratios:[[0,0],[1,0],[1,.9],[.3,.9],[.2,1],[.1,.9],[0,.9]]},{name:"h\xecnh ch\u1eef th\u1eadp",type:St.CROSS,ratios:[[0,.3],[.3,.3],[.3,0],[.7,0],[.7,.3],[1,.3],[1,.7],[.7,.7],[.7,1],[.3,1],[.3,.7],[0,.7]]},{name:"h\xecnh m\u0169i t\xean 1 chi\u1ec1u",type:St.ARROW_ONEWAY,ratios:[[0,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[0,.8]]},{name:"h\xecnh m\u0169i t\xean 2 chi\u1ec1u",type:St.ARROW_TWOWAY,ratios:[[.2,0],[.2,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[.2,.8],[.2,1],[0,.5]]},{name:"h\xecnh ng\xf4i sao 4 c\xe1nh",type:St.STAR_FOUR,ratios:[[.5,0],[.65,.35],[1,.5],[.65,.65],[.5,1],[.35,.65],[0,.5],[.35,.35]]},{name:"h\xecnh ng\xf4i sao 5 c\xe1nh",type:St.STAR_FIVE,ratios:[[.5,0],[.625,.4],[1,.4],[.675,.625],[.8,1],[.5,.775],[.2,1],[.325,.625],[0,.4],[.375,.4]]},{name:"h\xecnh ng\xf4i sao 6 c\xe1nh",type:St.STAR_SIX,ratios:[[.5,0],[.667,.25],[1,.25],[.5+.334,.5],[1,.75],[.667,.75],[.5,1],[.334,.75],[0,.75],[.167,.5],[0,.25],[.334,.25]]}],$s={IMAGE:1,HTML:2,AUDIO:3,VIDEO:4},at={Digit1:49,Digit2:50,Digit3:51,Digit4:52,Digit5:53,Digit6:54,Digit7:55,Digit8:56,Digit9:57,Digit0:48,KeyA:65,KeyB:66,KeyC:67,KeyD:68,KeyE:69,KeyF:70,KeyG:71,KeyH:72,KeyI:73,KeyJ:74,KeyK:75,KeyL:76,KeyM:77,KeyN:78,KeyO:79,KeyP:80,KeyQ:81,KeyR:82,KeyS:83,KeyT:84,KeyU:85,KeyV:86,KeyW:87,KeyX:88,KeyY:89,KeyZ:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,Insert:45,Delete:46,Home:36,End:35,PageUp:33,PageDown:34,ArrowUp:38,ArrowDown:40,ArrowLeft:37,ArrowRight:39,Escape:27,Tab:9,Backspace:8,Enter:13,Space:32,BracketLeft:219,BracketRight:221,Minus:189,Equal:187},_t={stroke:"#0D99FF",strokeWidth:1,strokeLinecap:"square",strokeDasharrays:[2,5]},ce={fill:"none",stroke:"#2299F8",strokeWidth:1},Yi=i=>{var t,e,n={};let r=/Italic$/,l=/Thin$/,a=/ExtraLight|UltraLight$/i,s=/Light$/,o=/Regular|Normal$/,d=/Medium$/,c=/SemiBold|DemiBold$/i,u=/Bold$/,h=/ExtraBold|UltraBold$/i,f=/Black|Heavy$/;return(i=null!==(t=null===(e=i.split(","))||void 0===e||null===(e=e.shift())||void 0===e?void 0:e.trim().replace(/[^a-zA-Z_-\s]/g,""))&&void 0!==t?t:"").match(r)&&(n.fontStyle="italic",i=i.replace(r,"").trim()),i.match(l)?(n.fontWeight=100,i=i.replace(l,"").trim()):i.match(a)?(n.fontWeight=200,i=i.replace(a,"").trim()):i.match(s)?(n.fontWeight=300,i=i.replace(s,"").trim()):i.match(o)?(n.fontWeight=400,i=i.replace(o,"").trim()):i.match(d)?(n.fontWeight=500,i=i.replace(d,"").trim()):i.match(c)?(n.fontWeight=600,i=i.replace(c,"").trim()):i.match(u)?(n.fontWeight=700,i=i.replace(u,"").trim()):i.match(h)?(n.fontWeight=800,i=i.replace(h,"").trim()):i.match(f)&&(n.fontWeight=900,i=i.replace(f,"").trim()),n.fontFamily=i.replace(/[\-\_\s]+$/,""),n},wr=i=>{let t=[];return[/font-family\s*:\s*([^;]+);/g,/"fontFamily":"([a-zA-Z0-9\-\_\'\s]+)"/g].forEach(e=>{var n,r;t=[...t,...null!==(n=null===(r=i.replace(/&quot;/g,"'").match(e))||void 0===r?void 0:r.filter((l,a,s)=>s.indexOf(l)==a).map(l=>l.replace(e,"$1").replace(/[^a-zA-Z0-9\-\_\s\,]/g,"").trim()).filter((l,a,s)=>l&&s.indexOf(l)==a))&&void 0!==n?n:[]]}),t.filter((e,n,r)=>r.indexOf(e)==n).map(e=>Yi(e).fontFamily).filter(e=>!!e).filter((e,n,r)=>r.indexOf(e)==n)},yi=(i,t)=>{if(!i)return"";let e=i.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i),n=(e&&e[4]||"").trim(),r=e?(256|e[1]).toString(16).slice(1)+(256|e[2]).toString(16).slice(1)+(256|e[3]).toString(16).slice(1):i;if("0"==n)return"transparent";if(t){let l;l=""!==n?n:"01",l=(255*l|256).toString(16).slice(1),r+=l}return`#${r}`};var id=/^#?[a-fA-F0-9]+$/;const pi=(i,t)=>{var e;if("none"==(i=null!==(e=i)&&void 0!==e?e:""))return"none";if("transparent"==i)return"rgba(0,0,0,0)";if(i.includes("rgba("))return i;if(i.includes("rgb(")&&(i=yi(i)),!(i=i.replace(/[^0-9a-fA-F]/g,"")))return"";if(!id.test(i))return console.error(`hex2rgba -> ${i}: first argument has invalid hexadecimal characters`),"";if("#"===i[0]&&(i=i.slice(1)),3===i.length){let r=i.split("");r.splice(2,0,i[2]),r.splice(1,0,i[1]),r.splice(0,0,i[0]),i=r.join("")}if(6!==i.length)return console.error("hex2rgba: first argument has invalid hexadecimal length"),"";var n=[parseInt(i.slice(0,2),16),parseInt(i.slice(2,4),16),parseInt(i.slice(4,6),16)];return t="number"==typeof t?t:parseFloat(t),n.push(t>=0&&t<=1?t:1),"rgba("+n.join(",")+")"},$i=i=>{switch(null==i?void 0:i.type){case 901:return location.protocol.match(/^http(s)?/)?`assets/iframe/lib/mk-image-viewer/viewer.html?url=${encodeURIComponent(i.readfileuploadurl+""+i.path)}`:""+i.readfileuploadurl+i.path;case 902:return location.protocol.match(/^http(s)?/)?`assets/iframe/lib/mk-audio-player-2/player.html?url=${encodeURIComponent(i.readfileuploadurl+""+i.path)}`:""+i.readfileuploadurl+i.path;case 903:return location.protocol.match(/^http(s)?/)?`assets/iframe/lib/mk-video-player/player.html?url=${encodeURIComponent(i.readfileuploadurl+""+i.path)}`:""+i.readfileuploadurl+i.path;case 908:case 916:case 917:case 918:return location.protocol.match(/^http(s)?/)?`assets/iframe/lib/ONLYOFFICE/player.html?url=${encodeURIComponent(i.readfileuploadurl+""+i.path)}`:""+i.readfileuploadurl+i.path;case 909:return location.protocol.match(/^http(s)?/)?"assets/iframe/lib/PDFReader/web/viewer.html?file="+i.readfileuploadurl+i.path:""+i.readfileuploadurl+i.path;case 906:case 911:case 910:return""+i.readfileuploadurl+i.path;case 905:case 912:var t;return"imsmanifest.xml"==(null===(t=i.path)||void 0===t||null===(t=t.split("/"))||void 0===t?void 0:t.pop())?"assets/iframe/lib/ScormPool_Player/player.html?url="+i.readfileuploadurl+i.path:""+i.readfileuploadurl+i.path;case 907:case 900:return""+i.readfileuploadurl+i.path;case 904:switch(i.oss){case 1003:return"assets/iframe/lib/ScormPool_Player/player.html?url="+i.url;case 1002:var e;return null!==(e=ld(i.url))&&void 0!==e?e:"";case 1005:var n;return null!==(n=i.url)&&void 0!==n?n:"";default:var r;return null!==(r=i.url)&&void 0!==r?r:""}default:return""+i.readfileuploadurl+i.path}},ld=i=>{let t=ad(i);return t?"https://www.youtube.com/embed/"+t+"?"+jQuery.param({wmode:"opaque",border:0,hd:1,autoplay:!1,autohide:1,enablejsapi:1,modestbranding:1,version:3,hl:"vi_VN",rel:0,showinfo:0,iv_load_policy:3}):null},ad=i=>{let t=null==i?void 0:i.match(/(?:.+?)?(?:\/v\/|watch\/|\?v\=|\&v\=|youtu\.be\/|\/v\=|^youtu\.be\/|embed\/)([a-zA-Z0-9_-]{11})+/);return t&&t.length>=2?t[1]:null},E=(i,t)=>{var e;return t=null!==(e=t)&&void 0!==e?e:100,Math.round((i+Number.EPSILON)*t)/t},H=i=>E(i/y.screen.scale),Yt=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:y.attribute.fill,stroke:y.attribute.stroke,strokeWidth:y.attribute.strokeWidth};return{nodeId:i,element:mt(i,C.RECT,"rect",{size:n,attribute:r},e),size:n,attribute:r}},Vt=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{preserveAspectRatio:"none"},l=(null==t?void 0:t.source)||{type:"image",image:{url:"../../assets/image-svg/logo.svg",path:"assets/image-svg/logo.svg",name:"logo.svg"}};return{nodeId:i,element:mt(i,C.IMAGE,"image",{size:n,attribute:r,source:l},e),size:n,attribute:r,source:l}},$t=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:y.attribute.fill,stroke:y.attribute.stroke,strokeWidth:y.attribute.strokeWidth};return{nodeId:i,element:mt(i,C.CIRCLE,"circle",{size:n,attribute:r},e),size:n,attribute:r}},ue=(i,t,e)=>{var n;if(!t.value)return void e();let r=jQuery("#"+i).parents("g");if(!r.length)return void e();let{size:l}=t.node;r.css("transform-origin",`${l.x+l.width/2}px ${l.y+l.height/2}px`);let a="",s=null!==(n=t.iteration)&&void 0!==n?n:0,o=[];(t.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?o.push(t.value):t.value?["top-left","top","top-right","left","right","bottom-left","bottom","bottom-right"].includes(t.value)?(o.push("animation"),o.push(`animation-${t.value}`)):(o.push("animate__animated"),o.push(`animate__${t.value}`)):(o.push("animation"),o.push("animation-fadein")),s<0?(o.push("animation-iteration-infinite"),e(),e=function(){}):s>0&&o.push("animation-iteration-"+(s+1)),a=o.join(" "),function(c){let u=function(){r.data("animate-running")?r.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){r.data("animate-running",!1),setTimeout(function(){c()},100)}):c()};r.hasClass("animation")?setTimeout(function(){u()}):u()}(function(){var c;mi(i),(s>0||s<0)&&r.one("animationiteration",function(){t.slideStatus===D.slideStatus||(r.data("animate-running",!1),mi(i),t.slideStatus===D.slideStatus&&e())}),r.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(r.data("animate-running",!1),mi(i),t.finish){default:case 0:case 1:break;case 2:var u;ue(i,{node:t.node,value:null===(u=t.node.animate)||void 0===u?void 0:u.out,nodeStatus:t.nodeStatus,slideStatus:t.slideStatus},()=>{r.addClass("hide")})}t.slideStatus===D.slideStatus&&e()}),r.attr("data-class",null!==(c=r.attr("class"))&&void 0!==c?c:""),r.addClass(a),r.data("animate-running",!0)})},mi=function(i){var t,e,n=jQuery("#"+i).parents("g"),r=null===(t=n.attr("class"))||void 0===t?void 0:t.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm),l=null===(e=n.attr("class"))||void 0===e?void 0:e.match(/animate((__[a-zA-Z0-9]+)+)?(\s+||\")/gm);r&&r.forEach(function(s){jQuery(n).removeClass(s)}),l&&l.forEach(function(s){jQuery(n).removeClass(s)});let a=n.attr("data-class");a&&(n.attr("class",a),n.removeAttr("data-class")),jQuery(n).data("animation-running",!1)},br=(i,t,e)=>{var n;if(!t.value)return void e();let r=jQuery("#"+i).parents("g");if(!r.length)return void e();let{size:l}=t.node;r.css("transform-origin",`${l.x+l.width/2}px ${l.y+l.height/2}px`);let a="",s=null!==(n=t.iteration)&&void 0!==n?n:0,o=[];(t.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?o.push(t.value):(o.push("animation"),o.push(t.value?"animation-"+t.value:"animation-fadein")),s<0?(o.push("animation-iteration-infinite"),e(),e=function(){}):s>0&&o.push("animation-iteration-"+(s+1)),a=o.join(" "),function(c){let u=function(){r.data("animate-running")?r.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){r.data("animate-running",!1),setTimeout(function(){c()},100)}):c()};r.hasClass("animation")?setTimeout(function(){u()}):u()}(function(){var c;wi(i),(s>0||s<0)&&r.one("animationiteration",function(){t.slideStatus===D.slideStatus||(r.data("animate-running",!1),wi(i),t.slideStatus===D.slideStatus&&e())}),r.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(r.data("animate-running",!1),wi(i),t.finish){default:case 0:case 1:break;case 2:var u;ue(i,{node:t.node,value:null===(u=t.node.animate)||void 0===u?void 0:u.out,nodeStatus:t.nodeStatus,slideStatus:t.slideStatus},()=>{r.addClass("hide")})}t.slideStatus===D.slideStatus&&e()}),r.attr("data-class",null!==(c=r.attr("class"))&&void 0!==c?c:""),r.addClass(a),r.data("animate-running",!0)})},wi=function(i){var t,e=jQuery("#"+i).parents("g"),n=null===(t=e.attr("class"))||void 0===t?void 0:t.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm);n&&n.forEach(function(l){jQuery(e).removeClass(l)});let r=e.attr("data-class");r&&(e.attr("class",r),e.removeAttr("data-class")),jQuery(e).data("animation-running",!1)},Pe=i=>{var t;return null===(t=i.split(/(?=[MLCSQTAHVZmlcsqtahvz])/))||void 0===t?void 0:t.map(e=>{let n={type:e.substring(0,1)},r=(l=e.replace(/\s?\-?[0-9\.]+e-[0-9]+/g," 0").replace(/\,/g," ").replace(/\s?\-/g," -").replace(/(\.[0-9]+)(\.[0-9]+)/g,"$1 0$2").replace(/\-\./g,"-0.").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim())?l.split(/\s/).map(a=>E(parseFloat(a),1e6)):[];var l;return r.length&&(n.points=r),n})},Me=i=>{let t=[],e=[],n=[],r=[];return i.forEach(l=>{switch(["M","L","C","S","Q","T"].includes(l.type)&&l.points&&l.points.forEach((g,w)=>{w%2==0?t.push(g):e.push(g)}),l.type){case"A":var a;7==(null===(a=l.points)||void 0===a?void 0:a.length)&&(n.push(l.points[5]),r.push(l.points[6]));break;case"H":var s;null!==(s=l.points)&&void 0!==s&&s.length&&(t.push(l.points[0]),n.push(l.points[0]));break;case"V":var o;null!==(o=l.points)&&void 0!==o&&o.length&&(e.push(l.points[0]),r.push(l.points[0]));break;case"a":var d;if(7==(null===(d=l.points)||void 0===d?void 0:d.length)){let g=t[t.length-1];t.push(g+l.points[5]),n.push(g+l.points[5]);let w=e[e.length-1];e.push(w+l.points[6]),r.push(w+l.points[6])}break;case"h":var c;if(null!==(c=l.points)&&void 0!==c&&c.length){let g=t[t.length-1];t.push(g+l.points[0]),n.push(g+l.points[0])}break;case"v":var u;if(null!==(u=l.points)&&void 0!==u&&u.length){let g=e[e.length-1];e.push(g+l.points[0]),r.push(g+l.points[0])}break;case"M":case"L":case"C":case"S":case"Q":case"T":var h;null===(h=l.points)||void 0===h||h.forEach((g,w)=>{w%2==0?n.push(g):r.push(g)});break;case"m":case"l":case"c":case"s":case"q":case"t":var f;null===(f=l.points)||void 0===f||f.forEach((g,w)=>{if(w%2==0){let p=t[t.length-1];t.push(p+g),n.push(p+g)}else{let p=e[e.length-1];e.push(p+g),r.push(p+g)}})}}),{minX:Math.min.apply(null,n),minY:Math.min.apply(null,r),maxX:Math.max.apply(null,n),maxY:Math.max.apply(null,r)}},Ke=(i,t)=>t.map(e=>{let n=[];switch(e.type){case"a":var r;7==(null===(r=e.points)||void 0===r?void 0:r.length)&&n.push([E(e.points[0]/i.width,1e6),E(e.points[1]/i.height,1e6),e.points[2],e.points[3],e.points[4],E(e.points[5]/i.width,1e6),E(e.points[6]/i.height,1e6)]);break;case"A":var l;7==(null===(l=e.points)||void 0===l?void 0:l.length)&&n.push([E(e.points[0]/i.width,1e6),E(e.points[1]/i.height,1e6),e.points[2],e.points[3],e.points[4],E((e.points[5]-i.x)/i.width,1e6),E((e.points[6]-i.y)/i.height,1e6)]);break;case"h":var a;null!==(a=e.points)&&void 0!==a&&a.length&&n.push([E(e.points[0]/i.width,1e6)]);break;case"H":var s;null!==(s=e.points)&&void 0!==s&&s.length&&n.push([E((e.points[0]-i.x)/i.width,1e6)]);break;case"v":var o;null!==(o=e.points)&&void 0!==o&&o.length&&n.push([E(e.points[0]/i.height,1e6)]);break;case"V":var d;null!==(d=e.points)&&void 0!==d&&d.length&&n.push([E((e.points[0]-i.y)/i.height,1e6)]);break;case"z":case"Z":break;case"M":case"L":case"C":case"S":case"Q":case"T":var c;if(null!==(c=e.points)&&void 0!==c&&c.length)for(let h=0,f=e.points.length-1;h<f;h+=2)n.push([E((e.points[h]-i.x)/i.width,1e6),E((e.points[h+1]-i.y)/i.height,1e6)]);break;case"m":case"l":case"c":case"s":case"q":case"t":var u;if(null!==(u=e.points)&&void 0!==u&&u.length)for(let h=0,f=e.points.length-1;h<f;h+=2)n.push([E(e.points[h]/i.width,1e6),E(e.points[h+1]/i.height,1e6)])}return n.length?{type:e.type,ratios:n}:{type:e.type}}),sd=(i,t)=>t.map(e=>{switch(e.type){case"a":var n,r;return`${e.type}${null!==(n=null===(r=e.ratios)||void 0===r||null===(r=r.map(b=>{var m,x,T,_,I,F,O;return[E(i.width*(null!==(m=b[0])&&void 0!==m?m:0),1e6),E(i.height*(null!==(x=b[1])&&void 0!==x?x:0),1e6),null!==(T=b[2])&&void 0!==T?T:0,null!==(_=b[3])&&void 0!==_?_:0,null!==(I=b[4])&&void 0!==I?I:0,E(i.width*(null!==(F=b[5])&&void 0!==F?F:0),1e6),E(i.height*(null!==(O=b[6])&&void 0!==O?O:0),1e6)]}))||void 0===r||null===(r=r.map(b=>b.join(" ")))||void 0===r?void 0:r.join(" "))&&void 0!==n?n:""}`;case"A":var l,a;return`${e.type}${null!==(l=null===(a=e.ratios)||void 0===a||null===(a=a.map(b=>{var m,x,T,_,I,F,O;return[E(i.width*(null!==(m=b[0])&&void 0!==m?m:0),1e6),E(i.height*(null!==(x=b[1])&&void 0!==x?x:0),1e6),null!==(T=b[2])&&void 0!==T?T:0,null!==(_=b[3])&&void 0!==_?_:0,null!==(I=b[4])&&void 0!==I?I:0,E(i.x+i.width*(null!==(F=b[5])&&void 0!==F?F:0),1e6),E(i.y+i.height*(null!==(O=b[6])&&void 0!==O?O:0),1e6)]}))||void 0===a||null===(a=a.map(b=>b.join(" ")))||void 0===a?void 0:a.join(" "))&&void 0!==l?l:""}`;case"h":var s,o;return`${e.type}${null!==(s=null===(o=e.ratios)||void 0===o||null===(o=o.map(b=>{var m;return E(i.width*(null!==(m=b[0])&&void 0!==m?m:0),1e6)}))||void 0===o?void 0:o.join(" "))&&void 0!==s?s:""}`;case"H":var d,c;return`${e.type}${null!==(d=null===(c=e.ratios)||void 0===c||null===(c=c.map(b=>{var m;return E(i.x+i.width*(null!==(m=b[0])&&void 0!==m?m:0),1e6)}))||void 0===c?void 0:c.join(" "))&&void 0!==d?d:""}`;case"v":var u,h;return`${e.type}${null!==(u=null===(h=e.ratios)||void 0===h||null===(h=h.map(b=>{var m;return E(i.height*(null!==(m=b[0])&&void 0!==m?m:0),1e6)}))||void 0===h?void 0:h.join(" "))&&void 0!==u?u:""}`;case"V":var f,g;return`${e.type}${null!==(f=null===(g=e.ratios)||void 0===g||null===(g=g.map(b=>{var m;return E(i.y+i.height*(null!==(m=b[0])&&void 0!==m?m:0),1e6)}))||void 0===g?void 0:g.join(" "))&&void 0!==f?f:""}`;case"z":case"Z":return e.type;case"M":case"L":case"C":case"S":case"Q":case"T":var w,p;return`${e.type}${null!==(w=null===(p=e.ratios)||void 0===p||null===(p=p.map(b=>{var m,x;return[E(i.x+i.width*(null!==(m=b[0])&&void 0!==m?m:0),1e6),E(i.y+i.height*(null!==(x=b[1])&&void 0!==x?x:0),1e6)]}))||void 0===p||null===(p=p.map(b=>b.join(" ")))||void 0===p?void 0:p.join(" "))&&void 0!==w?w:""}`;case"m":case"l":case"c":case"s":case"q":case"t":var v,k;return`${e.type}${null!==(v=null===(k=e.ratios)||void 0===k||null===(k=k.map(b=>{var m,x;return[E(i.width*(null!==(m=b[0])&&void 0!==m?m:0),1e6),E(i.height*(null!==(x=b[1])&&void 0!==x?x:0),1e6)]}))||void 0===k||null===(k=k.map(b=>b.join(" ")))||void 0===k?void 0:k.join(" "))&&void 0!==v?v:""}`;default:return""}}).join(""),ud=(i,t)=>{let e=[];for(let n=0,r=t.length-1;n<r;n+=2)e.push([(t[n]-i.x)/i.width,(t[n+1]-i.y)/i.height]);return e},hd=(i,t)=>t.map(e=>[E(i.x+i.width*e[0],1e6),E(i.y+i.height*e[1],1e6)]).map(e=>e.join(" ")).join(" "),bi=(i,t)=>{let e=xr(t);if(e){let n=window.Snap.matrix(e.a,e.b,e.c,e.d,e.e,e.f);if(n){let{dx:r,dy:l,rotate:a,scalex:s,scaley:o}=n.split();return{x:i.x+r,y:i.y+l,dx:r,dy:l,rotate:a,scalex:s,scaley:o}}return{x:gd(i.x,i.y,e),y:vd(i.x,i.y,e)}}return i},xr=i=>{let t=i.replace(/\s?\-?[0-9\.]+e-[0-9]+/g," 0").replace(/\,/g," ").replace(/\s?\-/g," -").replace(/(\.[0-9]+)(\.[0-9]+)/g,"$1 0$2").replace(/\-\./g,"-0.").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim().split(" ").map(e=>E(parseFloat(e),1e6));if(6==t.length)return{a:t[0],b:t[1],c:t[2],d:t[3],e:t[4],f:t[5]}},gd=function(i,t,e){return E(i*e.a+t*e.c+e.e,10)},vd=function(i,t,e){return E(i*e.b+t*e.d+e.f,10)},pt=(i,t,e,n,r)=>{let l={x:Math.min(i,e),y:Math.min(t,n),width:Math.abs(e-i)||1,height:Math.abs(n-t)||1};return null!=r&&r.ratio&&(l.width<=l.height?l.height=l.width*(null==r?void 0:r.ratio):l.width=l.height/(null==r?void 0:r.ratio)),Object.assign(l,{ratios:(null==r?void 0:r.ratios)||[[(i-l.x)/(l.width||1),(t-l.y)/(l.height||1)],[(e-l.x)/(l.width||1),(n-l.y)/(l.height||1)]]}),null!=r&&r.points&&(l.points=null==r?void 0:r.points),l},W=(i,t,e)=>{var n,r=(()=>{switch(i){case C.CIRCLE:return{cx:t.x+t.width/2,cy:t.y+t.height/2,r:Math.min(t.width/2,t.height/2)};case C.ELLIPSE:return{cx:t.x+t.width/2,cy:t.y+t.height/2,rx:t.width/2,ry:t.height/2};case C.LINE:{var l;let c={};return null===(l=t.ratios)||void 0===l||l.forEach((u,h)=>{c[`x${h+1}`]=t.x+t.width*u[0],c[`y${h+1}`]=t.y+t.height*u[1]}),c}case C.RECT:case C.FOREIGNOBJECT:case C.IMAGE:return{x:t.x,y:t.y,width:t.width,height:t.height};case C.TEXT:case C.TSPAN:var a;return{x:t.x,y:t.y+(e.alignmentBaseline||e.dominantBaseline?0:null!==(a=e.fontSize)&&void 0!==a?a:16)};case C.POLYGON:case C.POLYLINE:var s;if(null!==(s=t.ratios)&&void 0!==s&&s.length)return{points:hd(t,t.ratios)};break;case C.PATH:var o,d;if(null!==(o=t.ratioMaps)&&void 0!==o&&o.length)return{d:sd(t,t.ratioMaps)};if(null!==(d=t.points)&&void 0!==d&&d.length)return{d:`M ${(c=t.points)[0][0]} ${c[0][1]} L ${(c.map(u=>[u[0],u[1]])||[]).map(u=>u.join(" ")).join(" ")}`}}var c;return{}})();return t.rotate?(r.transform=`rotate(${t.rotate})`,r.transformOrigin=`${t.x+t.width/2} ${t.y+t.height/2}`):null!==(n=e.transform)&&void 0!==n&&n.match(/^rotate/)&&(e.transform=null,e.transformOrigin=null),r},kr=(i,t,e)=>{var n;if(!t.points||!t.points.length)return void e();let r=jQuery("#"+i),a=function yd(i){let t=[];2===i.length&&i.splice(1,0,[(i[0][0]+i[1][0])/2,(i[0][1]+i[1][1])/2]);let a,s,o,e=1,n=i.length;for(;e<n;){if(a=i[e-1],s=i[e],o=i[e+1],(Math.abs(a[0]-s[0])>=15||Math.abs(a[1]-s[1])>=15)&&Math.pow(a[0]-s[0],2)+Math.pow(a[1]-s[1],2)>=Math.pow(15,2)&&o&&(Math.abs(a[0]-o[0])<=20||Math.abs(a[1]-o[1])<=20)&&Math.pow(a[0]-o[0],2)+Math.pow(a[1]-o[1],2)<=Math.pow(20,2))t.push(s);else{let c=s[0]-a[0],u=s[1]-a[1],h=Math.max(Math.abs(c),Math.abs(u));for(var d=0;d<h;d+=15)t.push([a[0]+c*d/h,a[1]+u*d/h])}e++}return n>0&&(t.splice(0,0,i[0]),t.push(i[n-1])),t}((p=>{if(1==p.length){let{size:v}=t.node;return[[v.x+v.width/2,v.y+v.height/2],...p]}return[...p]})(t.points||[])),s=null!==(n=t.iteration)&&void 0!==n?n:0;if(s<0&&(e(),e=function(){}),r.data("work-running")&&s<0)return;r.data("work-running",!0);let g,o=a.length,d=Math.max(20,1e3*(t.time||3)/o),{id:c,type:u,size:h,attribute:f}=D.findNode(i),w=function(p){if(t.slideStatus!==D.slideStatus)return r.data("work-running",!1),void(t.slideStatus===D.slideStatus&&e());if(p<o){let k=a[p];k&&(g=Object.assign({},h,{x:k[0]-h.width/2,y:k[1]-h.height/2}),Object.assign(f,W(u,g,f)),K(window.document.getElementById(c),f),setTimeout(function(){w(++p)},d))}else if(s>0)s--,w(1);else if(s<0)w(1);else switch(r.data("work-running",!1),t.slideStatus===D.slideStatus&&e(),t.finish){default:case 0:break;case 1:Object.assign(f,W(u,h,f)),K(window.document.getElementById(c),f);break;case 2:var v;ue(t.node.id,{node:t.node,value:null===(v=t.node.animate)||void 0===v?void 0:v.out,nodeStatus:t.nodeStatus,slideStatus:t.slideStatus},()=>{r.addClass("hide")})}};w(1)},Sr=(i,t,e,n,r)=>{var l,a,s,o,d,c,u;if(n.slideStatus!=D.slideStatus)return t.async&&"change-slide"!=t.async?void 0:void r();if(n.nodeStatus!=D.nodeStatus&&(!t.async||"change-node"==t.async))return void r();if(!(null!==(l=t.source)&&void 0!==l&&l.path||null!==(a=t.source)&&void 0!==a&&a.url))return console.warn(`${i} -> audio no source!`),r(),void(r=()=>{});var h=jQuery("#"+i);let f=null!==(s=t.iteration)&&void 0!==s?s:0;if(f<0&&(r(),r=function(){}),!(h.data("audio-running")&&f<0)){h.data("audio-running",!0);var g=function(p){p.pause(),p.remove(),h.data("audio-running",!1)},w=new Audio;return w.autoplay=!0,w.loop=0!=f,w.preload="auto",w.controls=!0,w.setAttributeNode(document.createAttribute("playsinline")),w.addEventListener("canplay",function(){var p=w.play();p&&p.then(function(v){var k;h.data("audio-running",!0),"time"==t.async?setTimeout(()=>{n.slideStatus===D.slideStatus&&(g(w),r(),r=()=>{})},1e3*(null!==(k=t.time)&&void 0!==k?k:1)):"non-stop"==t.async&&(r(),r=()=>{})}).catch(function(v){h.data("audio-running",!1),n.slideStatus===D.slideStatus&&(r(),r=()=>{})})}),w.addEventListener("timeupdate",function(){switch(t.async){case"time":case"change-slide":n.slideStatus!==D.slideStatus&&(g(this),r(),r=()=>{});break;case"finish-action":e.total>=2&&e.total-e.counter==1&&(g(this),r(),r=()=>{});break;default:case"change-node":n.nodeStatus!==D.nodeStatus&&(g(this),r(),r=()=>{});case"non-stop":}}),w.addEventListener("canplaythrough",function(){this.loop&&(f>0?f--:0==f&&(this.loop=!1))}),w.addEventListener("play",function(){}),w.addEventListener("pause",function(){}),w.addEventListener("ended",function(){this.remove(),h.data("audio-running",!1),n.slideStatus===D.slideStatus&&(r(),r=()=>{})}),w.onerror=function(){this.remove(),h.data("audio-running",!1),n.slideStatus===D.slideStatus&&(r(),r=()=>{})},w.src=(null!==(o=t.source)&&void 0!==o&&o.path?(null===(d=y.config)||void 0===d?void 0:d.readfileuploadurl)+(null===(c=t.source)||void 0===c?void 0:c.path):null===(u=t.source)||void 0===u?void 0:u.url)||"",w}},he=i=>{i.id?jQuery("#"+i.id).removeClass("hide"):i.ids&&i.ids.forEach(t=>{jQuery("#"+t).removeClass("hide")})},ke=i=>{i.id?(jQuery("#"+i.id).removeClass("hide"),xi(D.findNode(i.id),i.nodeStatus,i.slideStatus)):i.ids&&i.ids.forEach(t=>{jQuery("#"+t).removeClass("hide"),xi(D.findNode(t),i.nodeStatus,i.slideStatus)})},Se=i=>{if(i.id){var t;let e=D.findNode(i.id);ue(i.id,{node:e,value:null===(t=e.animate)||void 0===t?void 0:t.out,nodeStatus:i.nodeStatus,slideStatus:i.slideStatus},()=>{jQuery("#"+i.id).addClass("hide")})}else i.ids&&i.ids.forEach(e=>{var n;let r=D.findNode(e);ue(e,{node:r,value:null===(n=r.animate)||void 0===n?void 0:n.out,nodeStatus:i.nodeStatus,slideStatus:i.slideStatus},()=>{jQuery("#"+e).addClass("hide")})})},xi=(i,t,e,n)=>{var r,l,a;let s={total:0,counter:0},{triggershow:o,triggerrun:d,triggerhide:c,action:u,audio:h,slide:f,media:g}=null!==(r=null===(l=i.interactive)||void 0===l?void 0:l.click)&&void 0!==r?r:{};if(console.log(`node(${i.id}) | nodeStatus(${t}) | slideStatus(${e}) | click`),o){let{id:b,ids:m,time:x,async:T}=o;"asynctrue"==T?he({id:b,ids:m,nodeStatus:t,slideStatus:e}):"time"==T&&setTimeout(()=>{he({id:b,ids:m,nodeStatus:t,slideStatus:e})},1e3*(null!=x?x:0))}if(d){let{id:b,ids:m,time:x,async:T}=d;"asynctrue"==T?ke({id:b,ids:m,nodeStatus:t,slideStatus:e}):"time"==T&&setTimeout(()=>{ke({id:b,ids:m,nodeStatus:t,slideStatus:e})},1e3*(null!=x?x:0))}if(c){let{id:b,ids:m,time:x,async:T}=c;"asynctrue"==T?Se({id:b,ids:m,nodeStatus:t,slideStatus:e}):"time"==T&&setTimeout(()=>{Se({id:b,ids:m,nodeStatus:t,slideStatus:e})},1e3*(null!=x?x:0))}let w=()=>{setTimeout(()=>{if(s.counter>=s.total){if(n&&n(),o){let{id:b,ids:m,async:x}=o;(!x||"asyncfalse"==x)&&he({id:b,ids:m,nodeStatus:t,slideStatus:e})}if(d){let{id:b,ids:m,async:x}=d;(!x||"asyncfalse"==x)&&ke({id:b,ids:m,nodeStatus:t,slideStatus:e})}if(c){let{id:b,ids:m,async:x}=c;(!x||"asyncfalse"==x)&&Se({id:b,ids:m,nodeStatus:t,slideStatus:e})}}})};if(null!=u&&u.value){s.total+=1;let b=()=>{s.counter+=1,w()};switch(null==u?void 0:u.value){case"hide":var p;ue(i.id,{node:i,value:null===(p=i.animate)||void 0===p?void 0:p.out,nodeStatus:t,slideStatus:e},()=>{jQuery("#"+i.id).addClass("hide"),b()});break;case"points":{let{points:m,time:x,iteration:T,finish:_}=u;m&&kr(i.id,{node:i,points:m,time:x,iteration:T,finish:_,nodeStatus:t,slideStatus:e},b);break}default:{let{value:m,time:x,iteration:T,finish:_}=u;br(i.id,{node:i,value:m,time:x,iteration:T,finish:_,nodeStatus:t,slideStatus:e},b);break}}}if(null!=h&&null!==(a=h.source)&&void 0!==a&&a.path){s.total+=1;let b=()=>{s.counter+=1,w()};Sr(i.id,h,s,{nodeStatus:t,slideStatus:e},b)}if(s.total||w(),null!=f&&f.id)switch(f.id){case-1:D.runSlide(D.slideIdx-1);break;case-2:D.runSlide(D.slideIdx+1);break;default:var v;D.runSlide(void 0,f.id,null===(v=f.code)||void 0===v?void 0:v.toString())}if(null!=g&&g.type){var k;let m=`<div class="popup-media-viewer"><iframe src="${$i({readfileuploadurl:null===(k=y.config)||void 0===k?void 0:k.readfileuploadurl,type:null==g?void 0:g.type,oss:null==g?void 0:g.oss,path:null==g?void 0:g.path,url:null==g?void 0:g.url})}" frameborder="0" allowfullscreen\n        webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen"></iframe><div class="btn-close"><img src="assets/icon-svg/close-outline.svg"/></div></div>`,x=jQuery(m).appendTo(window.document.body);x.find(".btn-close").click(function(T){T.preventDefault(),x.remove()})}},Oe=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:320,height:80},r=(null==t?void 0:t.attribute)||{fill:y.attribute.stroke,fontFamily:y.attribute.fontFamily,fontSize:y.attribute.fontSize,textLength:y.attribute.textLength},l=(null==t?void 0:t.source)||{type:"text",text:{textContent:""}};return{nodeId:i,element:mt(i,C.TEXT,"text",{size:n,attribute:r,source:l},e),size:n,attribute:r,source:l}},Ge=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{};return{nodeId:i,element:mt(i,C.GROUP,"g",{size:n,attribute:r},e),size:n,attribute:r}},Or=(i,t,e)=>{var n,r,l,a;let s=1,o=new Image;o.onload=()=>{var d,c,u,h;s=E(o.naturalWidth/o.naturalHeight,100);let f=0,g=0,w=0,p=0;var v,k,b,m;s>=1?(w=Math.min(o.naturalWidth,null!==(v=null===(k=D.slide.svg)||void 0===k||null===(k=k.viewBox)||void 0===k?void 0:k.width)&&void 0!==v?v:0),p=w/s):(p=Math.min(o.naturalHeight,null!==(b=null===(m=D.slide.svg)||void 0===m||null===(m=m.viewBox)||void 0===m?void 0:m.height)&&void 0!==b?b:0),w=p/s),f=((null!==(d=null===(c=D.slide.svg)||void 0===c||null===(c=c.viewBox)||void 0===c?void 0:c.width)&&void 0!==d?d:0)-w)/2,g=((null!==(u=null===(h=D.slide.svg)||void 0===h||null===(h=h.viewBox)||void 0===h?void 0:h.height)&&void 0!==u?u:0)-p)/2,t.size={x:f,y:g,width:w,height:p},kd(t,e)},o.onerror=d=>{console.error(`ImgSrc load failed -> ${JSON.stringify(t.source)}`,d)},o.src=(null!==(n=t.source)&&void 0!==n&&n.path?(null===(r=y.config)||void 0===r?void 0:r.readfileuploadurl)+(null===(l=t.source)||void 0===l?void 0:l.path):null===(a=t.source)||void 0===a?void 0:a.url)||""},kd=(i,t)=>{if(i.slideStatus!=D.slideStatus)return void t();let{element:e}=Vt(Math.ceil(1e9*Math.random()),{size:i.size,source:{type:"image",image:null==i?void 0:i.source}});setTimeout(()=>{null==e||e.remove(),t()},3e3)},Gt=(i,t,e)=>{var n,r,l,a;let s=new Image;s.onload=()=>{Sd(i,{width:s.naturalWidth,height:s.naturalHeight},t,e)},s.onerror=o=>{console.error(`ImgSrc load failed -> ${JSON.stringify(t.source)}`,o),e()},s.src=(null!==(n=t.source)&&void 0!==n&&n.path?(null===(r=y.config)||void 0===r?void 0:r.readfileuploadurl)+(null===(l=t.source)||void 0===l?void 0:l.path):null===(a=t.source)||void 0===a?void 0:a.url)||""},Sd=(i,t,e,n)=>{if(e.slideStatus!=D.slideStatus)return void n();let r=E(t.width/t.height,100),l=0,a=0,s=0,o=0;r>=1?(s=t.width,s=Math.max(s,40),s=Math.min(s,40),o=s/r):(o=t.height,o=Math.max(o,40),o=Math.min(o,40),s=o/r);let{size:u}=i;l=u.x+u.width-s/2,a=u.y-o/2;let h=G(U.TEST_GROUP,"g",void 0,y.target);Vt(`icon-${i.id}`,{size:{x:l,y:a,width:s,height:o},source:{type:"image",image:null==e?void 0:e.source}},h),setTimeout(()=>{n()},3e3)},Nr=(i,t,e)=>{var n,r,l,a,s,o,d;if(t.slideStatus!=D.slideStatus)return void e();if(!(null!==(n=t.source)&&void 0!==n&&n.path||null!==(r=t.source)&&void 0!==r&&r.url))return console.warn(`${i.id} -> audio no source!`),void e();var c=jQuery("#"+i.id);let u=null!==(l=t.iteration)&&void 0!==l?l:0;if(u<0&&(e(),e=function(){}),!(c.data("audio-running")&&u<0)){c.data("audio-running",!0);var h=new Audio;return h.autoplay=!0,h.loop=0!=u,h.preload="auto",h.controls=!0,h.setAttributeNode(document.createAttribute("playsinline")),h.addEventListener("canplay",function(){var f=h.play();f&&f.then(function(g){c.data("audio-running",!0)}).catch(function(g){c.data("audio-running",!1),t.slideStatus===D.slideStatus&&e()})}),h.addEventListener("timeupdate",function(){var g;t.slideStatus!==D.slideStatus&&((g=this).pause(),g.remove(),c.data("audio-running",!1))}),h.addEventListener("canplaythrough",function(){this.loop&&(u>0?u--:0==u&&(this.loop=!1))}),h.addEventListener("play",function(){}),h.addEventListener("pause",function(){}),h.addEventListener("ended",function(){this.remove(),c.data("audio-running",!1),t.slideStatus===D.slideStatus&&e()}),h.onerror=function(){this.remove(),c.data("audio-running",!1),t.slideStatus===D.slideStatus&&e()},h.src=(null!==(a=t.source)&&void 0!==a&&a.path?(null===(s=y.config)||void 0===s?void 0:s.readfileuploadurl)+(null===(o=t.source)||void 0===o?void 0:o.path):null===(d=t.source)||void 0===d?void 0:d.url)||"",h}};var Od=/^#[a-fA-F0-9]+$/i,Nd=/^rgb\((\d+),(\d+),(\d+)\)$/i,Ed=/^rgba\((\d+),(\d+),(\d+),([0-9\.]+)\)$/i;const tn=i=>{let t=null,e=null;if(i)if("transparent"==i)t="#000000",e=0;else if(i.match(Od))t=i;else{let n=(i=i.replace(/\s+/g,"")).match(Ed);if(n)t="#"+(256|n[1]).toString(16).slice(1)+(256|n[2]).toString(16).slice(1)+(256|n[3]).toString(16).slice(1),e=E(parseFloat(n[4]),100);else{let r=i.match(Nd);r&&(t="#"+(256|r[1]).toString(16).slice(1)+(256|r[2]).toString(16).slice(1)+(256|r[3]).toString(16).slice(1))}}return{hex:t,alpha:e}},lt=i=>ut(null==i?void 0:i.url,null==i?void 0:i.path,null==i?void 0:i.src,null==i?void 0:i.name);var ut=(i,t,e,n)=>{var r,l;let a,s,o,d;var c,u;return i&&(a=i.replace(/\\/g,"/")),t&&(s=t.replace(/\\/g,"/")),e&&(o=e.replace(/\\/g,"/")),s&&!a&&(a=(null===(c=y.config)||void 0===c?void 0:c.readfileuploadurl)+s),!o||s||a||(s=o.replace(/^[a-zA-Z0-9\-\_\/\\\:\.]+(upload|FileUpload|files|readfileupload|filereader|readfile)\//g,""),a=(null===(u=y.config)||void 0===u?void 0:u.readfileuploadurl)+s),d=n||(null!==(r=a)&&void 0!==r?r:"").split("/").pop()||(null!==(l=s)&&void 0!==l?l:"").split("/").pop()||"",{url:a,path:s,name:d}};const Cd=i=>{let t={x:0,y:0,width:i.screen.w,height:i.screen.h},e=[];return i.data.forEach((n,r)=>{var l,a;let s={id:"number"==typeof n.id?n.id:y.data.newSlideId,code:null===(l=n.id)||void 0===l?void 0:l.toString(),name:"string"==typeof n.id?n.id:`Trang ${r+1}`,svg:{viewBox:t,nodes:[]},test:(o=n.test2,o?(o.audiotrue&&(o.audiotrue=lt({path:o.audiotrue.path})),o.audiofalse&&(o.audiofalse=lt({path:o.audiofalse.path})),o.effecttrue&&(o.effecttrue=lt({path:o.effecttrue.path})),o.effectfalse&&(o.effectfalse=lt({path:o.effectfalse.path})),o.icontrue&&(o.icontrue=lt({path:o.icontrue.path})),o.iconfalse&&(o.iconfalse=lt({path:o.iconfalse.path})),o):{})};var o;n.background&&s.svg&&(s.svg.background=function(i){return i&&(null!==i.match(/#([a-zA-Z0-9]+)/)||null!==i.match(/rgb\([0-9]+,[0-9]+,[0-9]+\)/)||null!==i.match(/rgba\([0-9]+,[0-9]+,[0-9]+,[0-9\.]+\)/))}(n.background)?{color:n.background}:function(i){return i&&null!==i.match(/data:[^;]+;base64,/)}(n.background)?{base64:n.background}:function(i){return i&&null!==i.match(/http(s)?:\/\//)}(n.background)?ut(n.background):ut(void 0,n.background)),jQuery(null!==(a=n.svg)&&void 0!==a?a:"").find(".indexs").find("polygon,path,circle,ellipse,line,rect,foreignObject").each((o,d)=>{var c,u;let h=jQuery(d).parents(".indexs"),f=(v=h.attr("data-index"))?parseInt(v):0,g=(v=>f&&v?parseInt(v):0)(h.attr("data-time")),w=null!==(c=d.getAttribute("id"))&&void 0!==c?c:(1e9*Math.random()).toFixed(),p={id:parseInt(w),code:`${d.nodeName}-${w}`,name:d.nodeName,idx:f,time:g,type:(()=>{switch(d.nodeName){case"polygon":return C.POLYGON;case"path":return C.PATH;case"circle":return C.CIRCLE;case"ellipse":return C.ELLIPSE;case"line":return C.LINE;case"rect":return C.RECT;case"foreignObject":return C.FOREIGNOBJECT}return 0})(),size:(v=>{let k={},b=0,m=0,x=0,T=0,_=null,I=null,F=parseFloat((null===(v=d.getAttribute("transform"))||void 0===v?void 0:v.replace("rotate(","").replace(")",""))||"0")||null;switch(d.nodeName){case"polygon":{var O,N;let B=[],R=[],S=999999999,A=999999999,J=0,j=0;_=JSON.parse(d.getAttribute("ratios")||"[]"),I=null!==(O=null===(N=d.getAttribute("points"))||void 0===N?void 0:N.split(",").map(function(z){return z.split(" ").map(function(L){return parseFloat(L)})}))&&void 0!==O?O:[],I.forEach(function(z){B.push(z[0]),R.push(z[1])}),S=Math.min.apply(null,B),A=Math.min.apply(null,R),J=Math.max.apply(null,B),j=Math.max.apply(null,R),b=S,m=A,x=J-b,T=j-m;break}case"path":{let B=d.getAttribute("d");if(B){let R=Pe(B),{minX:S,minY:A,maxX:J,maxY:j}=Me(R);b=S,m=A,x=J-b||1,T=j-m||1,Object.assign(k,{ratioMaps:Ke({x:b,y:m,width:x,height:T},R)})}break}case"circle":{let B=parseFloat(d.getAttribute("cx")||"0"),R=parseFloat(d.getAttribute("cy")||"0"),S=parseFloat(d.getAttribute("r")||"0");b=B-S,m=R-S,x=2*S,T=2*S;break}case"ellipse":{let B=parseFloat(d.getAttribute("cx")||"0"),R=parseFloat(d.getAttribute("cy")||"0"),S=parseFloat(d.getAttribute("rx")||"0"),A=parseFloat(d.getAttribute("ry")||"0");b=B-S,m=R-A,x=2*S,T=2*A;break}case"line":{let B=parseFloat(d.getAttribute("x1")||"0"),R=parseFloat(d.getAttribute("y1")||"0"),S=parseFloat(d.getAttribute("x2")||"0"),A=parseFloat(d.getAttribute("y2")||"0"),J=999999999,j=999999999,z=0,L=0;J=Math.min(B,S),j=Math.min(R,A),z=Math.max(B,S),L=Math.max(R,A),b=J,m=j,x=z-b,T=L-m,_=[[(B-b)/(x||1),(R-m)/(T||1)],[(S-b)/(x||1),(A-m)/(T||1)]];break}case"rect":case"foreignObject":b=parseFloat(d.getAttribute("x")||"0"),m=parseFloat(d.getAttribute("y")||"0"),x=parseFloat(d.getAttribute("width")||"0"),T=parseFloat(d.getAttribute("height")||"0")}return Object.assign(k,{x:b,y:m,width:x,height:T,ratios:_,points:I,rotate:F})})(),attribute:(()=>{let v={};switch(d.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":{var k,b,m,x,T,_,I,F;let z=null!==(k=d.getAttribute("fill"))&&void 0!==k?k:null,L=null!==(b=d.getAttribute("stroke"))&&void 0!==b?b:null,Q=null!==(m=parseFloat(null!==(x=d.getAttribute("stroke-opacity"))&&void 0!==x?x:"1"))&&void 0!==m?m:null,M=null!==(T=parseFloat(d.getAttribute("stroke-width")||"0"))&&void 0!==T?T:null,P=null!==(_=d.getAttribute("stroke-linecap"))&&void 0!==_?_:null,q=null!==(I=d.getAttribute("stroke-linejoin"))&&void 0!==I?I:null,Z=null!==(F=parseFloat(d.getAttribute("stroke-dasharray")||"0"))&&void 0!==F?F:null;Object.assign(v,{fill:z,stroke:L,strokeOpacity:Q,strokeWidth:M,strokeLinecap:P,strokeLinejoin:q,strokeDasharray:Z});break}case"path":{let z=h.get(0);if(z){var O,N,B,R,S,A,J,j;let L=null!==(O=z.getAttribute("fill"))&&void 0!==O?O:null,Q=null!==(N=z.getAttribute("stroke"))&&void 0!==N?N:null,M=null!==(B=parseFloat(null!==(R=z.getAttribute("stroke-opacity"))&&void 0!==R?R:"1"))&&void 0!==B?B:null,P=null!==(S=parseFloat(z.getAttribute("stroke-width")||"0"))&&void 0!==S?S:null,q=null!==(A=z.getAttribute("stroke-linecap"))&&void 0!==A?A:null,Z=null!==(J=z.getAttribute("stroke-linejoin"))&&void 0!==J?J:null,tt=null!==(j=parseFloat(z.getAttribute("stroke-dasharray")||"0"))&&void 0!==j?j:null;Object.assign(v,{fill:L,stroke:Q,strokeOpacity:M,strokeWidth:P,strokeLinecap:q,strokeLinejoin:Z,strokeDasharray:tt})}break}}return v})(),style:(()=>{let v={};switch(d.nodeName){case"polygon":case"path":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":{let m=jQuery(d).find(".svg-container");if(m.length){let T=parseFloat(m.css("border-width")||"0")||null,_=m.css("border-style")||null,I=m.css("border-color")||null,F=null,O=m.css("background-color")||null,N=null;(()=>{let{hex:B,alpha:R}=tn(I);I=B,F=R})(),(()=>{let{hex:B,alpha:R}=tn(O);O=B,N=R})(),Object.assign(v,{borderWidth:T,borderStyle:_,borderColor:I,borderOpacity:F,backgroundColor:O,backgroundOpacity:N})}let x=jQuery(d).find(".svg-editor-content");if(x.length){var k,b;let T=JSON.parse((x.attr("data-style")||"{}").replace(/\&quot\;/gm,'"')),{hex:_,alpha:I}=tn(T.TextColor);Object.assign(v,{fontFamily:null!==(k=T.FontFamily)&&void 0!==k?k:null,fontSize:null!==(b=T.FontSize)&&void 0!==b?b:null,color:_,opacity:I})}break}}return v})(),source:(()=>{let v={};switch(d.nodeName){case"polygon":case"path":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":if(h.hasClass("editors")){var k;let j="div,h1,h2,h3,h4,h5,h6,p,span,strong,b,i",z=M=>{null==M||M.forEach(P=>{let q=P.querySelectorAll(`:scope > ${j}`);q.length&&z(q),!P.querySelectorAll(":scope > *").length&&""==P.textContent&&P.remove()})},L=M=>{let P=null==M?void 0:M.querySelectorAll(":scope > div,h1,h2,h3,h4,h5,h6,p,strong,span");if(null!=P&&P.length){var q;let Z=P[P.length-1];if(""==(null===(q=Z.textContent)||void 0===q?void 0:q.trim())){let tt=Z.querySelectorAll(":scope > *");if(tt.length){let it=tt[tt.length-1];["br","BR"].includes(null==it?void 0:it.nodeName)&&(it.remove(),L(M))}else Z.remove(),L(M)}}};z(null===(k=jQuery(d).find(".svg-editor-content").get(0))||void 0===k?void 0:k.querySelectorAll(`:scope > ${j}`)),L(jQuery(d).find(".svg-editor-content").get(0));let Q=jQuery(d).find(".svg-editor-content");if(Q.length){var b;let M=Q.html(),P=null!==(b=(null!=M?M:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==b?b:[];Object.assign(v,{type:"html",html:{htmlContent:M,variableKeywords:P}})}}else if(h.hasClass("inputs")||h.hasClass("textareas"))Object.assign(v,{type:"input",input:{input:!!jQuery(d).find("input").length,textarea:!!jQuery(d).find("textarea").length}});else if(h.hasClass("tests")){let j=jQuery(d).find(".svg-test");if(h.hasClass("tests-truefalse")){var m,x;let z=j.find(".svg-editor-content").html(),L=null!==(m=(null!=z?z:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==m?m:[];Object.assign(v,{type:"test",test:{type:"truefalse",truefalse:{iscorrect:null===(x=n.test2.truefalse)||void 0===x?void 0:x.includes(w)}},html:{htmlContent:z,variableKeywords:L}})}else if(h.hasClass("tests-singlechoice")){var T,_;let z=j.find(".svg-editor-content").html(),L=null!==(T=(null!=z?z:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==T?T:[];Object.assign(v,{type:"test",test:{type:"singlechoice",singlechoice:{iscorrect:null===(_=n.test2.singlechoice)||void 0===_?void 0:_.includes(w)}},html:{htmlContent:z,variableKeywords:L}})}else if(h.hasClass("tests-multichoice")){var I,F;let z=j.find(".svg-editor-content").html(),L=null!==(I=(null!=z?z:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==I?I:[];Object.assign(v,{type:"test",test:{type:"multichoice",multichoice:{iscorrect:null===(F=n.test2.multichoice)||void 0===F?void 0:F.includes(w)}},html:{htmlContent:z,variableKeywords:L}})}else if(h.hasClass("tests-fill")){var O,N;let z=j.find(".svg-editor-content").html(),L=null!==(O=(null!=z?z:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==O?O:[],Q=null!==(N=(null!=z?z:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==N?N:[];Q=Q.filter((M,P,q)=>q.indexOf(M)==P),Object.assign(v,{type:"test",test:{type:"fill",fill:Q.map(M=>{var P;return{key:M,value:null===(P=n.test2.fill)||void 0===P||null===(P=P.find(q=>q.id==w))||void 0===P||null===(P=P.vals)||void 0===P?void 0:P.map(q=>q.text).filter(q=>!["",null,void 0,NaN].includes(q))}})},html:{htmlContent:z,variableKeywords:L,fillKeywords:Q}})}else if(h.hasClass("tests-matching")){if(j.hasClass("svg-test-empty"))Object.assign(v,{type:"test",test:{type:"matching-empty",matching:{key:j.attr("data-name")||null}}});else if(j.hasClass("svg-test-content")){var B;let z=j.find(".svg-editor-content").html(),L=null!==(B=(null!=z?z:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==B?B:[];Object.assign(v,{type:"test",test:{type:"matching-content",matching:{key:j.attr("data-name")||null}},html:{htmlContent:z,variableKeywords:L}})}}else if(h.hasClass("tests-speech")){var R;Object.assign(v,{type:"speech",speech:{value:null===(R=n.test2.speech)||void 0===R||null===(R=R.find(z=>z.id==w))||void 0===R||null===(R=R.vals)||void 0===R?void 0:R.map(z=>z.text).filter(z=>!["",null,void 0,NaN].includes(z))}})}else if(h.hasClass("tests-submit")){let z=jQuery(d).find(".svg-container img");Object.assign(v,{type:"test",test:{type:"submit"},image:ut(z.attr("url"),z.attr("path"),z.attr("src"))})}}else if(h.hasClass("images")){let j=jQuery(d).find(".svg-editor-content img");if(j.length)Object.assign(v,{type:"image",image:ut(j.attr("url"),j.attr("path"),j.attr("src"))});else{let z=jQuery(d).find("iframe");Object.assign(v,{type:"iframe",iframe:ut(z.attr("url"),z.attr("path"),z.attr("src"))})}}else if(h.hasClass("sounds")){let j=jQuery(d).find(".svg-editor-content img");j.length&&Object.assign(v,{type:"image",image:ut(j.attr("url"),j.attr("path"),j.attr("src"))})}else if(h.hasClass("htmls")){let j=jQuery(d).find("iframe");j.length&&Object.assign(v,{type:"iframe",iframe:ut(j.attr("url"),j.attr("path"),j.attr("src"))})}else if(h.hasClass("svgs")){let j=jQuery(d).find("svg");var S,A;j.length&&Object.assign(v,{type:"svg",svg:Object.assign(ut(j.attr("url"),j.attr("path"),j.attr("src")),{svgContent:null!==(S=null===(A=j.get(0))||void 0===A?void 0:A.outerHTML)&&void 0!==S?S:null})})}else if(h.hasClass("medias")){let j=jQuery(d).find(".media-item");if(j.length)switch(j.attr("type")){case"audio":Object.assign(v,{type:"audio",audio:ut(j.attr("url"),j.attr("path"),j.attr("src"))});break;case"video":Object.assign(v,{type:"video",video:ut(j.attr("url"),j.attr("path"),j.attr("src"))});break;case"file":Object.assign(v,{type:"file",file:ut(j.attr("url"),j.attr("path"),j.attr("src"))});break;default:var J;Object.assign(v,{type:"link",link:{url:null!==(J=j.attr("url"))&&void 0!==J?J:null}})}let z=jQuery(d).find("img");z.length&&(Object.assign(v,{image:ut(z.attr("url"),z.attr("path"),z.attr("src"))}),v.type||Object.assign(v,{type:"image"}))}}return v})(),animate:(v=>{let k={},b=null===(v=n.animates)||void 0===v?void 0:v.find(m=>m.elementId==w);return b&&Object.assign(k,{value:b.value}),k})(),interactive:(()=>{let v={},k=n.actions.show.filter(m=>m.elementId==w&&m.active);k.length&&(v.show={},k.forEach(m=>{let{source:x}=m;switch(null==x?void 0:x.type){case"work":var T,_,I,F,O;v.show.action={},Object.assign(v.show.action,{value:null!==(T=x.value)&&void 0!==T?T:null,iteration:null!==(_=x.iteration)&&void 0!==_?_:null,finish:null!==(I=x.end)&&void 0!==I?I:null,time:null!==(F=x.time)&&void 0!==F?F:null,points:null!==(O=x.points)&&void 0!==O?O:null});break;case"audio":var N,B,R;v.show.audio={},Object.assign(v.show.audio,{source:ut(null,null,x.url),iteration:null!==(N=x.iteration)&&void 0!==N?N:null,finish:null!==(B=x.end)&&void 0!==B?B:null,time:null!==(R=x.time)&&void 0!==R?R:null,async:-1==x.iteration?"change-slide":"change-node"});break;case"node":case"node2":var S,A,J,j,z,L,Q,M,P,q,Z,tt,it,V,rt;x.options.includes("show")&&(v.show.triggershow={},Object.assign(v.show.triggershow,{id:null!==(S=parseInt(null!==(A=x.id)&&void 0!==A?A:"0"))&&void 0!==S?S:null,ids:null===(J=x.ids)||void 0===J?void 0:J.map(ht=>parseInt(ht)),async:null!==(j=x.async)&&void 0!==j?j:null,time:null!==(z=x.time)&&void 0!==z?z:null})),x.options.includes("run")&&(v.show.triggerrun={},Object.assign(v.show.triggerrun,{id:null!==(L=parseInt(null!==(Q=x.id)&&void 0!==Q?Q:"0"))&&void 0!==L?L:null,ids:null===(M=x.ids)||void 0===M?void 0:M.map(ht=>parseInt(ht)),async:null!==(P=x.async)&&void 0!==P?P:null,time:null!==(q=x.time)&&void 0!==q?q:null})),x.options.includes("hide")&&(v.show.triggerhide={},Object.assign(v.show.triggerhide,{id:null!==(Z=parseInt(null!==(tt=x.id)&&void 0!==tt?tt:"0"))&&void 0!==Z?Z:null,ids:null===(it=x.ids)||void 0===it?void 0:it.map(ht=>parseInt(ht)),async:null!==(V=x.async)&&void 0!==V?V:null,time:null!==(rt=x.time)&&void 0!==rt?rt:null}))}}));let b=n.actions.click.filter(m=>m.elementId==w&&m.active);return b&&(v.click={},b.forEach(m=>{let{source:x}=m;switch(null==x?void 0:x.type){case"work":var T,_,I,F,O;v.click.action={},Object.assign(v.click.action,{value:null!==(T=x.value)&&void 0!==T?T:null,iteration:null!==(_=x.iteration)&&void 0!==_?_:null,finish:null!==(I=x.end)&&void 0!==I?I:null,time:null!==(F=x.time)&&void 0!==F?F:null,points:null!==(O=x.points)&&void 0!==O?O:null});break;case"audio":var N,B,R;v.click.audio={},Object.assign(v.click.audio,{source:ut(null,null,x.url),iteration:null!==(N=x.iteration)&&void 0!==N?N:null,finish:null!==(B=x.end)&&void 0!==B?B:null,time:null!==(R=x.time)&&void 0!==R?R:null,async:-1==x.iteration?"change-slide":"change-node"});break;case"video":{v.click.video={},Object.assign(v.click.video,{source:ut(x.url,x.path)});let{url:st,path:It,name:At}=ut(x.url,x.path);v.click.media={},Object.assign(v.click.media,{url:st,path:It,name:At,type:903});break}case"image":{v.click.image={},Object.assign(v.click.image,{source:ut(x.url,x.path)});let{url:st,path:It,name:At}=ut(x.url,x.path);v.click.media={},Object.assign(v.click.media,{url:st,path:It,name:At,type:901});break}case"link":{v.click.link={},Object.assign(v.click.link,{url:x.url,target:x.target});let{url:st,path:It,name:At}=ut(x.url,x.path);v.click.media={},Object.assign(v.click.media,{url:st,path:It,name:At,type:904});break}case"text":v.click.text={},Object.assign(v.click.text,{content:x.content});break;case"node":case"node2":var S,A,J,j,z,L,Q,M,P,q,Z,tt,it,V,rt;x.options.includes("show")&&(v.click.triggershow={},Object.assign(v.click.triggershow,{id:null!==(S=parseInt(null!==(A=x.id)&&void 0!==A?A:"0"))&&void 0!==S?S:null,ids:null===(J=x.ids)||void 0===J?void 0:J.map(st=>parseInt(st)),async:null!==(j=x.async)&&void 0!==j?j:null,time:null!==(z=x.time)&&void 0!==z?z:null})),x.options.includes("run")&&(v.click.triggerrun={},Object.assign(v.click.triggerrun,{id:null!==(L=parseInt(null!==(Q=x.id)&&void 0!==Q?Q:"0"))&&void 0!==L?L:null,ids:null===(M=x.ids)||void 0===M?void 0:M.map(st=>parseInt(st)),async:null!==(P=x.async)&&void 0!==P?P:null,time:null!==(q=x.time)&&void 0!==q?q:null})),x.options.includes("hide")&&(v.click.triggerhide={},Object.assign(v.click.triggerhide,{id:null!==(Z=parseInt(null!==(tt=x.id)&&void 0!==tt?tt:"0"))&&void 0!==Z?Z:null,ids:null===(it=x.ids)||void 0===it?void 0:it.map(st=>parseInt(st)),async:null!==(V=x.async)&&void 0!==V?V:null,time:null!==(rt=x.time)&&void 0!==rt?rt:null}));break;case"slide":var ht;v.click.slide={},Object.assign(v.click.slide,{id:parseInt(null!==(ht=x.id)&&void 0!==ht?ht:"0")||x.num||null,code:x.id})}})),v})(),variable:(v=>{let k={};var b;d.getAttribute("data-variable")&&(k.input={},Object.assign(k.input,{variable:null!==(b=d.getAttribute("data-variable"))&&void 0!==b?b:null}));let m=null===(v=n.nodes)||void 0===v||null===(v=v.find(F=>F.id==w))||void 0===v?void 0:v.variable;var x,T,_,I;return m&&(k.click={},Object.assign(k.click,{variable:null!==(x=m.variable)&&void 0!==x?x:null,operator:null!==(T=m.operator)&&void 0!==T?T:null,valuetype:null!==(_=m.valuetype)&&void 0!==_?_:null,value:null!==(I=m.value)&&void 0!==I?I:null})),k})()};var v;null===(u=s.svg)||void 0===u||u.nodes.push(p)}),e.push(s)}),{screen:{width:i.screen.w,height:i.screen.h},data:{slides:e},variable:i.variable,fonts:[]}},Er=(i,t)=>{var e;null===(e=t.test)||void 0===e||null===(e=e.answer)||void 0===e||null===(e=e.matching)||void 0===e||e.filter(n=>n.id==i.id).forEach(n=>n.value=""),jQuery(`#node-${i.id}`).remove()},Ne=(i,t,e,n,r,l)=>{var a,s,o,d,c,u,h,f;r.iscorrect?(null!==(a=t.test)&&void 0!==a&&null!==(a=a.audiotrue)&&void 0!==a&&a.path&&Nr(i,{source:lt(null===(o=t.test)||void 0===o?void 0:o.audiotrue),iteration:0,nodeStatus:e,slideStatus:n},l),null!==(s=t.test)&&void 0!==s&&null!==(s=s.effecttrue)&&void 0!==s&&s.path&&Or(0,{source:lt(null===(d=t.test)||void 0===d?void 0:d.effecttrue),iteration:0,nodeStatus:e,slideStatus:n},l)):(null!==(c=t.test)&&void 0!==c&&null!==(c=c.audiofalse)&&void 0!==c&&c.path&&Nr(i,{source:lt(null===(h=t.test)||void 0===h?void 0:h.audiofalse),iteration:0,nodeStatus:e,slideStatus:n},l),null!==(u=t.test)&&void 0!==u&&null!==(u=u.effectfalse)&&void 0!==u&&u.path&&Or(0,{source:lt(null===(f=t.test)||void 0===f?void 0:f.effectfalse),iteration:0,nodeStatus:e,slideStatus:n},l));_r(t,e,n,l)},_r=(i,t,e,n)=>{var r;switch(null===(r=i.test)||void 0===r?void 0:r.type){case"truefalse":{var l,a;let{value:m,iscorrect:x}=null!==(l=null==i||null===(a=i.test)||void 0===a||null===(a=a.answer)||void 0===a?void 0:a.truefalse)&&void 0!==l?l:{};if(m){let T=D.findNode(m);var s,o,d,c;x?null!==(s=i.test)&&void 0!==s&&null!==(s=s.icontrue)&&void 0!==s&&s.path&&Gt(T,{source:lt(null===(o=i.test)||void 0===o?void 0:o.icontrue),iteration:0,nodeStatus:t,slideStatus:e},n):null!==(d=i.test)&&void 0!==d&&null!==(d=d.iconfalse)&&void 0!==d&&d.path&&Gt(T,{source:lt(null===(c=i.test)||void 0===c?void 0:c.iconfalse),iteration:0,nodeStatus:t,slideStatus:e},n)}break}case"singlechoice":{var u,h;let{value:m,iscorrect:x}=null!==(u=null==i||null===(h=i.test)||void 0===h||null===(h=h.answer)||void 0===h?void 0:h.singlechoice)&&void 0!==u?u:{};if(m){let T=D.findNode(m);var f,g,w,p;x?null!==(f=i.test)&&void 0!==f&&null!==(f=f.icontrue)&&void 0!==f&&f.path&&Gt(T,{source:lt(null===(g=i.test)||void 0===g?void 0:g.icontrue),iteration:0,nodeStatus:t,slideStatus:e},n):null!==(w=i.test)&&void 0!==w&&null!==(w=w.iconfalse)&&void 0!==w&&w.path&&Gt(T,{source:lt(null===(p=i.test)||void 0===p?void 0:p.iconfalse),iteration:0,nodeStatus:t,slideStatus:e},n)}break}case"multichoice":var v;null==i||null===(v=i.test)||void 0===v||null===(v=v.answer)||void 0===v||null===(v=v.multichoice)||void 0===v||v.forEach(m=>{let{value:x,iscorrect:T}=m;if(x){let N=D.findNode(x);var _,I,F,O;T?null!==(_=i.test)&&void 0!==_&&null!==(_=_.icontrue)&&void 0!==_&&_.path&&Gt(N,{source:lt(null===(I=i.test)||void 0===I?void 0:I.icontrue),iteration:0,nodeStatus:t,slideStatus:e},n):null!==(F=i.test)&&void 0!==F&&null!==(F=F.iconfalse)&&void 0!==F&&F.path&&Gt(N,{source:lt(null===(O=i.test)||void 0===O?void 0:O.iconfalse),iteration:0,nodeStatus:t,slideStatus:e},n)}});break;case"fill":var k;null==i||null===(k=i.test)||void 0===k||null===(k=k.answer)||void 0===k||null===(k=k.fill)||void 0===k||k.forEach(m=>{let{id:x,value:_,iscorrect:I}=m;if(_){let R=D.findNode(x);var F,O,N,B;I?null!==(F=i.test)&&void 0!==F&&null!==(F=F.icontrue)&&void 0!==F&&F.path&&Gt(R,{source:lt(null===(O=i.test)||void 0===O?void 0:O.icontrue),iteration:0,nodeStatus:t,slideStatus:e},n):null!==(N=i.test)&&void 0!==N&&null!==(N=N.iconfalse)&&void 0!==N&&N.path&&Gt(R,{source:lt(null===(B=i.test)||void 0===B?void 0:B.iconfalse),iteration:0,nodeStatus:t,slideStatus:e},n)}});break;case"matching":var b;null==i||null===(b=i.test)||void 0===b||null===(b=b.answer)||void 0===b||null===(b=b.matching)||void 0===b||b.forEach(m=>{let{id:x,key:T,value:_}=m;if(_){let B=D.findNode(x);var I,F,O,N;T==_?null!==(I=i.test)&&void 0!==I&&null!==(I=I.icontrue)&&void 0!==I&&I.path&&Gt(B,{source:lt(null===(F=i.test)||void 0===F?void 0:F.icontrue),iteration:0,nodeStatus:t,slideStatus:e},n):null!==(O=i.test)&&void 0!==O&&null!==(O=O.iconfalse)&&void 0!==O&&O.path&&Gt(B,{source:lt(null===(N=i.test)||void 0===N?void 0:N.iconfalse),iteration:0,nodeStatus:t,slideStatus:e},n)}})}},Ld=(i,t,e,n)=>{var r,l,a,s,o,d,u,f,h;null!==(r=t.animate)&&void 0!==r&&r.value&&((i,t,e)=>{var n;let{value:l}=null!==(n=i.animate)&&void 0!==n?n:{};ue(i.id,{node:i,value:l,nodeStatus:t,slideStatus:e},()=>{})})(t,e.nodeStatus,e.slideStatus),null!==(l=t.interactive)&&void 0!==l&&l.show?(console.log(`node(${t.id}) | nodeStatus(${e.nodeStatus}) | slideStatus(${e.slideStatus}) | show`),((i,t,e,n)=>{var r,l,a;let s={total:0,counter:0},{triggershow:o,triggerrun:d,triggerhide:c,action:u,audio:h}=null!==(r=null===(l=i.interactive)||void 0===l?void 0:l.show)&&void 0!==r?r:{};if(console.log(`node(${i.id}) | nodeStatus(${t}) | slideStatus(${e}) | show`),o){let{id:g,ids:w,time:p,async:v}=o;"asynctrue"==v?setTimeout(()=>{he({id:g,ids:w,nodeStatus:t,slideStatus:e})}):"time"==v&&setTimeout(()=>{he({id:g,ids:w,nodeStatus:t,slideStatus:e})},1e3*(null!=p?p:0))}if(d){let{id:g,ids:w,time:p,async:v}=d;"asynctrue"==v?setTimeout(()=>{ke({id:g,ids:w,nodeStatus:t,slideStatus:e})}):"time"==v&&setTimeout(()=>{ke({id:g,ids:w,nodeStatus:t,slideStatus:e})},1e3*(null!=p?p:0))}if(c){let{id:g,ids:w,time:p,async:v}=c;"asynctrue"==v?setTimeout(()=>{Se({id:g,ids:w,nodeStatus:t,slideStatus:e})}):"time"==v&&setTimeout(()=>{Se({id:g,ids:w,nodeStatus:t,slideStatus:e})},1e3*(null!=p?p:0))}let f=()=>{setTimeout(()=>{if(s.counter>=s.total){if(n&&n(),o){let{id:g,ids:w,async:p}=o;(!p||"asyncfalse"==p)&&he({id:g,ids:w,nodeStatus:t,slideStatus:e})}if(d){let{id:g,ids:w,async:p}=d;(!p||"asyncfalse"==p)&&ke({id:g,ids:w,nodeStatus:t,slideStatus:e})}if(c){let{id:g,ids:w,async:p}=c;(!p||"asyncfalse"==p)&&Se({id:g,ids:w,nodeStatus:t,slideStatus:e})}}})};if(null!=u&&u.value){s.total+=1;let g=()=>{s.counter+=1,f()};switch(null==u?void 0:u.value){case"hide":jQuery("#"+i.id).addClass("hide"),g();break;case"points":{let{points:w,time:p,iteration:v,finish:k}=u;kr(i.id,{node:i,points:w,time:p,iteration:v,finish:k,nodeStatus:t,slideStatus:e},g);break}default:{let{value:w,time:p,iteration:v,finish:k}=u;br(i.id,{node:i,value:w,time:p,iteration:v,finish:k,nodeStatus:t,slideStatus:e},g);break}}}if(null!=h&&null!==(a=h.source)&&void 0!==a&&a.path){s.total+=1;let g=()=>{s.counter+=1,f()},w=Sr(i.id,h,s,{nodeStatus:t,slideStatus:e},g);-1==(null==h?void 0:h.iteration)&&jQuery("#"+i.id).click(p=>{p.preventDefault(),w&&(w.volume=w.volume>=1?0:w.volume+.25),console.log(null==w?void 0:w.volume)})}s.total||f()})(t,e.nodeStatus,e.slideStatus,n)):n&&n(),null!==(a=t.interactive)&&void 0!==a&&a.click&&(f=null===(u=t.interactive)||void 0===u?void 0:u.click,Object.keys(null!=f?f:{}).map(w=>f[w]?1:0).includes(1)&&jQuery("#"+t.id).addClass("interactive-click"),jQuery("#"+t.id).click(f=>{f.preventDefault(),e.nodeStatus=D.refreshNodeStatus(),console.log(`node(${t.id}) | nodeStatus(${e.nodeStatus}) | slideStatus(${e.slideStatus}) | click`),xi(t,e.nodeStatus,e.slideStatus)})),null!==(s=t.variable)&&void 0!==s&&s.input&&jQuery("#"+t.id).on("change","input,textarea",f=>{f.preventDefault(),((i,t,e)=>{var n,r;y.variable.setValue(null!==(n=null===(r=t.variable)||void 0===r||null===(r=r.input)||void 0===r?void 0:r.variable)&&void 0!==n?n:"",i),(i=>{var t;let e=(n,r)=>{null==n||n.forEach(l=>{switch(l.type){case C.GROUP:Ge(l.id,{},r?window.document.getElementById(r):null),e(l.nodes,l.id);break;case C.POLYGON:break;case C.TEXT:Oe(l.id,{size:l.size,attribute:l.attribute,source:l.source},r?window.document.getElementById(r):null)}})};e(null===(t=i.svg)||void 0===t?void 0:t.nodes)})(e)})(f.target.value,t,i)}),null!==(o=t.variable)&&void 0!==o&&o.click&&(null!==(h=t.variable)&&void 0!==h&&null!==(h=h.click)&&void 0!==h&&h.variable&&jQuery("#"+t.id).addClass("variable-click"),jQuery("#"+t.id).click(f=>{f.preventDefault(),((i,t)=>{var e;y.variable.setValueOperator(null===(e=i.variable)||void 0===e?void 0:e.click),(i=>{var t;let e=(n,r)=>{null==n||n.forEach(l=>{switch(l.type){case C.GROUP:Ge(l.id,{},r?window.document.getElementById(r):null),e(l.nodes,l.id);break;case C.POLYGON:break;case C.TEXT:Oe(l.id,{size:l.size,attribute:l.attribute,source:l.source},r?window.document.getElementById(r):null)}})};e(null===(t=i.svg)||void 0===t?void 0:t.nodes)})(t)})(t,i)})),"test"==(null===(d=t.source)||void 0===d?void 0:d.type)&&((i,t)=>{var e;let n=()=>{};switch(null===(e=i.source)||void 0===e||null===(e=e.test)||void 0===e?void 0:e.type){case"truefalse":{jQuery("#"+i.id).click(a=>{a.preventDefault(),((i,t,e,n,r)=>{var l,a;let s=null===(l=i.source)||void 0===l||null===(l=l.test)||void 0===l||null===(l=l.truefalse)||void 0===l?void 0:l.iscorrect;t.test?t.test.answer?t.test.answer.truefalse={value:i.id,iscorrect:s}:t.test.answer={truefalse:{value:i.id,iscorrect:s}}:t.test={answer:{truefalse:{value:i.id,iscorrect:s}}},null!==(a=t.svg)&&void 0!==a&&a.nodes.find(d=>{var c;return"submit"==(null===(c=d.source)||void 0===c||null===(c=c.test)||void 0===c?void 0:c.type)})||Ne(i,t,e,n,{iscorrect:s},r);let o=G(U.TEST_GROUP,"g",void 0,y.target);Ft(o,t,i)})(i,t,D.nodeStatus,D.slideStatus,n)});let l=G(U.TEST_GROUP,"g",void 0,y.target);Ft(l,t,i);break}case"singlechoice":{jQuery("#"+i.id).click(a=>{a.preventDefault(),((i,t,e,n,r)=>{var l,a;let s=null===(l=i.source)||void 0===l||null===(l=l.test)||void 0===l||null===(l=l.singlechoice)||void 0===l?void 0:l.iscorrect;t.test?t.test.answer?t.test.answer.singlechoice={value:i.id,iscorrect:s}:t.test.answer={singlechoice:{value:i.id,iscorrect:s}}:t.test={answer:{singlechoice:{value:i.id,iscorrect:s}}},null!==(a=t.svg)&&void 0!==a&&a.nodes.find(d=>{var c;return"submit"==(null===(c=d.source)||void 0===c||null===(c=c.test)||void 0===c?void 0:c.type)})||Ne(i,t,e,n,{iscorrect:s},r);let o=G(U.TEST_GROUP,"g",void 0,y.target);Ft(o,t,i)})(i,t,D.nodeStatus,D.slideStatus,n)});let l=G(U.TEST_GROUP,"g",void 0,y.target);Ft(l,t,i);break}case"multichoice":{jQuery("#"+i.id).click(a=>{a.preventDefault(),((i,t,e,n,r)=>{var l,a;let s=null===(l=i.source)||void 0===l||null===(l=l.test)||void 0===l||null===(l=l.multichoice)||void 0===l?void 0:l.iscorrect;t.test?t.test.answer?t.test.answer.multichoice?t.test.answer.multichoice.find(d=>d.value==i.id)?t.test.answer.multichoice=t.test.answer.multichoice.filter(d=>d.value!=i.id):t.test.answer.multichoice.push({value:i.id,iscorrect:s}):t.test.answer.multichoice=[{value:i.id,iscorrect:s}]:t.test.answer={multichoice:[{value:i.id,iscorrect:s}]}:t.test={answer:{multichoice:[{value:i.id,iscorrect:s}]}},null!==(a=t.svg)&&void 0!==a&&a.nodes.find(d=>{var c;return"submit"==(null===(c=d.source)||void 0===c||null===(c=c.test)||void 0===c?void 0:c.type)})||Ne(i,t,e,n,{iscorrect:s},r);let o=G(U.TEST_GROUP,"g",void 0,y.target);Ft(o,t,i)})(i,t,D.nodeStatus,D.slideStatus,n)});let l=G(U.TEST_GROUP,"g",void 0,y.target);Ft(l,t,i);break}case"fill":{var r;jQuery("#"+i.id).on("keyup",'input[type="text"]',a=>{var s;let o=jQuery("<div/>").css({"font-size":jQuery(a.target).css("font-size"),visibility:"hidden",float:"left"}).text(a.target.value).appendTo(window.document.body);jQuery(a.target).css({width:(null!==(s=o.width())&&void 0!==s?s:0)+30})}).on("keypress",'input[type="text"]',a=>{13===(a.keyCode||a.charCode||a.which)&&(a.preventDefault(),a.stopPropagation(),jQuery(a.target).blur())}).on("change",'input[type="text"]',a=>{var s,o;let d=null===(s=a.target)||void 0===s?void 0:s.getAttribute("data-key"),c=null===(o=a.target)||void 0===o||null===(o=o.value)||void 0===o?void 0:o.trim();jQuery("#"+i.id).find(`input[type="text"][data-key="${d}"]`).val(c),((i,t,e,n,r,l)=>{var a,s,o,d;let{value:c}=null!==(a=null===(s=i.source)||void 0===s||null===(s=s.test)||void 0===s||null===(s=s.fill)||void 0===s?void 0:s.find(f=>f.key==`[[${r.key}]]`))&&void 0!==a?a:{},u=c&&c.map(f=>null==f?void 0:f.toLocaleLowerCase()).includes(null===(o=r.value)||void 0===o?void 0:o.toLocaleLowerCase());r.iscorrect=u,t.test?t.test.answer?t.test.answer.fill?t.test.answer.fill.find(f=>f.key==r.key)?t.test.answer.fill.filter(f=>f.key==r.key).forEach(f=>{f.value=r.value,f.iscorrect=r.iscorrect}):t.test.answer.fill.push(r):t.test.answer.fill=[r]:t.test.answer={fill:[r]}:t.test={answer:{fill:[r]}};let h=G(U.TEST_GROUP,"g",void 0,y.target);Ft(h,t,i),null!==(d=t.svg)&&void 0!==d&&d.nodes.find(f=>{var g;return"submit"==(null===(g=f.source)||void 0===g||null===(g=g.test)||void 0===g?void 0:g.type)})||Ne(i,t,e,n,{iscorrect:u},l)})(i,t,D.nodeStatus,D.slideStatus,{id:i.id,key:d,value:c},n)}),null!==(r=t.test)&&void 0!==r&&r.showselection||jQuery("#"+i.id).addClass("hide-selection");let l=G(U.TEST_GROUP,"g",void 0,y.target);Ft(l,t,i);break}case"matching-empty":{jQuery("#"+i.id).on("touchmove",".ondrag-item",function(a){a.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(a){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${i.size.height/i.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${a.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(a){var s;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(s=t.test)&&void 0!==s&&s.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection"),Er(i,t)},drag:function(a){},dragend:function(a){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${i.id} .ondrop-here`).kendoDropTarget({dragenter:function(a){a.dropTarget.hasClass("actived")&&a.dropTarget.addClass("focused")},dragleave:function(a){a.dropTarget.hasClass("actived")&&a.dropTarget.removeClass("focused")},drop:function(a){if(!a.dropTarget.hasClass("actived"))return;a.dropTarget.removeClass("focused");let s=a.dropTarget,o=a.draggable.currentTarget;s.is(":empty")||s.find(".ondrag-item").appendTo($('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').first()),o.appendTo(s);let d=G(U.TEST_GROUP,"g",void 0,y.target);Ft(d,t,i),((i,t,e,n,r,l)=>{var a,s,o;let{key:d}=null!==(a=null===(s=i.source)||void 0===s||null===(s=s.test)||void 0===s?void 0:s.matching)&&void 0!==a?a:{key:"KIEN"},c=r.key==d;Er(i,t);let u={id:i.id,key:null!=d?d:"",value:r.key};t.test?t.test.answer?t.test.answer.matching?t.test.answer.matching.find(h=>h.id==u.id)?t.test.answer.matching.filter(h=>h.id==u.id).forEach(h=>{h.key=u.key,h.value=u.value}):t.test.answer.matching.push(u):t.test.answer.matching=[u]:t.test.answer={matching:[u]}:t.test={answer:{matching:[u]}},null!==(o=t.svg)&&void 0!==o&&o.nodes.find(h=>{var f;return"submit"==(null===(f=h.source)||void 0===f||null===(f=f.test)||void 0===f?void 0:f.type)})||Ne(i,t,e,n,{iscorrect:c},l)})(i,t,D.nodeStatus,D.slideStatus,{key:o.data("key")},n)}});let l=G(U.TEST_GROUP,"g",void 0,y.target);Ft(l,t,i);break}case"matching-content":{jQuery("#"+i.id).on("touchmove",".ondrag-item",function(a){a.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(a){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${i.size.height/i.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${a.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(a){var s;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(s=t.test)&&void 0!==s&&s.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(a){},dragend:function(a){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${i.id} .ondrop-here`).kendoDropTarget({dragenter:function(a){a.dropTarget.hasClass("actived")&&a.dropTarget.addClass("focused")},dragleave:function(a){a.dropTarget.hasClass("actived")&&a.dropTarget.removeClass("focused")},drop:function(a){if(!a.dropTarget.hasClass("actived"))return;a.dropTarget.removeClass("focused");let s=G(U.TEST_GROUP,"g",void 0,y.target);Ft(s,t,i),a.draggable.currentTarget.appendTo(a.dropTarget),_r(t,D.nodeStatus,D.slideStatus,n)}});let l=G(U.TEST_GROUP,"g",void 0,y.target);Ft(l,t,i);break}case"speech":break;case"submit":jQuery("#"+i.id).click(l=>{l.preventDefault(),((i,t,e,n,r)=>{var l,a,s,o,d;let c;var u;if(null!=t&&null!==(l=t.test)&&void 0!==l&&null!==(l=l.answer)&&void 0!==l&&l.truefalse)c=null==t||null===(u=t.test)||void 0===u||null===(u=u.answer)||void 0===u||null===(u=u.truefalse)||void 0===u?void 0:u.iscorrect;else if(null!=t&&null!==(a=t.test)&&void 0!==a&&null!==(a=a.answer)&&void 0!==a&&a.singlechoice){var h;c=null==t||null===(h=t.test)||void 0===h||null===(h=h.answer)||void 0===h||null===(h=h.singlechoice)||void 0===h?void 0:h.iscorrect}else if(null!=t&&null!==(s=t.test)&&void 0!==s&&null!==(s=s.answer)&&void 0!==s&&s.multichoice){var f,g,w;c=1==[null==t||null===(f=t.test)||void 0===f||null===(f=f.answer)||void 0===f||null===(f=f.multichoice)||void 0===f?void 0:f.length,null==t||null===(g=t.test)||void 0===g||null===(g=g.answer)||void 0===g||null===(g=g.multichoice)||void 0===g||null===(g=g.map(m=>m.iscorrect?1:0))||void 0===g?void 0:g.reduce((m,x)=>m+x),null==t||null===(w=t.svg)||void 0===w||null===(w=w.nodes)||void 0===w||null===(w=w.filter(m=>{var x,T;return"multichoice"==(null===(x=m.source)||void 0===x||null===(x=x.test)||void 0===x?void 0:x.type)&&(null===(T=m.source)||void 0===T||null===(T=T.test)||void 0===T||null===(T=T.multichoice)||void 0===T?void 0:T.iscorrect)}))||void 0===w?void 0:w.length].filter((m,x,T)=>T.indexOf(m)==x).length}else if(null!=t&&null!==(o=t.test)&&void 0!==o&&null!==(o=o.answer)&&void 0!==o&&o.fill){var p,v;c=(null==t||null===(p=t.test)||void 0===p||null===(p=p.answer)||void 0===p||null===(p=p.fill)||void 0===p||null===(p=p.map(m=>m.iscorrect?1:0))||void 0===p?void 0:p.reduce((m,x)=>m+x))==(null===(v=t.svg)||void 0===v||null===(v=v.nodes)||void 0===v||null===(v=v.filter(m=>{var x;return"fill"==(null===(x=m.source)||void 0===x||null===(x=x.test)||void 0===x?void 0:x.type)}))||void 0===v?void 0:v.length)}else if(null!=t&&null!==(d=t.test)&&void 0!==d&&null!==(d=d.answer)&&void 0!==d&&d.matching){var k,b;c=(null===(k=t.svg)||void 0===k||null===(k=k.nodes)||void 0===k||null===(k=k.filter(m=>{var x;return"matching-empty"==(null===(x=m.source)||void 0===x||null===(x=x.test)||void 0===x?void 0:x.type)}))||void 0===k?void 0:k.length)==((null==t||null===(b=t.test)||void 0===b||null===(b=b.answer)||void 0===b?void 0:b.matching)||[]).map(m=>m.key==m.value?1:0).reduce((m,x)=>m+x)}Ne(i,t,e,n,{iscorrect:c},r)})(i,t,D.nodeStatus,D.slideStatus,n)})}})(t,i)},en=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:y.attribute.fill,stroke:y.attribute.stroke,strokeWidth:y.attribute.strokeWidth};return{nodeId:i,element:mt(i,C.ELLIPSE,"ellipse",{size:n,attribute:r},e),size:n,attribute:r}},nn=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{stroke:y.attribute.stroke,strokeWidth:y.attribute.strokeWidth,strokeLinecap:y.attribute.strokeLinecap};return{nodeId:i,element:mt(i,C.LINE,"line",{size:n,attribute:r},e),size:n,attribute:r}},rn=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:y.attribute.fill,stroke:y.attribute.stroke,strokeWidth:y.attribute.strokeWidth};return{nodeId:i,element:mt(i,C.POLYGON,"polygon",{size:n,attribute:r},e),size:n,attribute:r}},Qt=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:320,height:80},r=(null==t?void 0:t.attribute)||{},l=(null==t?void 0:t.source)||{type:"html",html:{htmlContent:""}},a=(null==t?void 0:t.style)||{};return{nodeId:i,element:mt(i,C.FOREIGNOBJECT,"foreignObject",{size:n,attribute:r,style:a,source:l},e),size:n,attribute:r,style:a,source:l}},te=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{stroke:y.attribute.stroke,strokeWidth:y.attribute.strokeWidth};return{nodeId:i,element:mt(i,C.PATH,"path",{size:n,attribute:r},e),size:n,attribute:r}},Tr=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:y.attribute.fill,stroke:y.attribute.stroke,strokeWidth:y.attribute.strokeWidth};return{nodeId:i,element:mt(i,C.POLYLINE,"polyline",{size:n,attribute:r},e),size:n,attribute:r}},Fr=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:320,height:80},r=(null==t?void 0:t.attribute)||{fill:y.attribute.stroke,fontFamily:y.attribute.fontFamily,fontSize:y.attribute.fontSize,textLength:y.attribute.textLength},l=(null==t?void 0:t.source)||{type:"text",text:{textContent:""}};return{nodeId:i,element:mt(i,C.TSPAN,"tspan",{size:n,attribute:r,source:l},e),size:n,attribute:r,source:l}},ln=(i,t,e)=>{if(e.slideStatus!=D.slideStatus||!t.length)return;let n=t.shift(),r=i.filter(o=>{var d;return(null!==(d=o.idx)&&void 0!==d?d:0)==n});if(!r.length)return;let l=Math.max.apply(null,r.map(o=>{var d;return null!==(d=o.time)&&void 0!==d?d:0})),a=!1,s=l<.5?0:setTimeout(()=>{a||(a=!0,ln(i,t,e))},1e3*l);Cr(i,t,r,0,e,{idx:n,total:r.length,counter:0,isRecursive:a,timeoutRecursive:s,maxTimeCoundown:l,uid:Math.floor(1e9*Math.random())})},Cr=(i,t,e,n,r,l)=>{if(r.slideStatus!=D.slideStatus)return;let a=e[n];if(a){switch(a.type){case C.GROUP:break;case C.CIRCLE:$t(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case C.ELLIPSE:en(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case C.LINE:nn(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case C.RECT:Yt(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case C.POLYGON:rn(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case C.POLYLINE:Tr(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case C.FOREIGNOBJECT:Qt(a.id,{size:a.size,attribute:a.attribute,style:a.style,source:a.source},a.pid?window.document.getElementById(a.pid):null);break;case C.IMAGE:Vt(a.id,{size:a.size,attribute:a.attribute,source:a.source},a.pid?window.document.getElementById(a.pid):null);break;case C.TEXT:Oe(a.id,{size:a.size,attribute:a.attribute,source:a.source},a.pid?window.document.getElementById(a.pid):null);break;case C.TSPAN:Fr(a.id,{size:a.size,attribute:a.attribute,source:a.source},a.pid?window.document.getElementById(a.pid):null);break;case C.PATH:te(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null)}Ld(r.slide,a,r,()=>{l.counter+=1,l.maxTimeCoundown<.5&&l.counter>=l.total&&(l.total=l.counter=0,l.isRecursive||(clearTimeout(l.timeoutRecursive),l.isRecursive=!0,setTimeout(()=>{ln(i,t,r)},250)))}),Cr(i,t,e,++n,r,l)}},D=new class Md{constructor(){this._nodeStatus=0,this._slideStatus=0,this._slideIdx=0,this._fnChangeSlides=[]}set data(t){this._dataSource=t.data||{},y.variable.set=t.variable||{}}get nodeStatus(){return this._nodeStatus}refreshNodeStatus(){return this._nodeStatus=Math.floor(999999999*Math.random()),this._nodeStatus}get slideStatus(){return this._slideStatus}refreshSlideStatus(){return this._slideStatus=Math.floor(999999999*Math.random()),this._slideStatus}get slideIdx(){return this._slideIdx}get slideTotal(){var t,e;return null!==(t=null===(e=this._dataSource)||void 0===e||null===(e=e.slides)||void 0===e?void 0:e.length)&&void 0!==t?t:0}get slides(){var t;return(null===(t=this._dataSource)||void 0===t?void 0:t.slides)||[]}get slide(){var t;return((null===(t=this._dataSource)||void 0===t?void 0:t.slides)||[])[this._slideIdx]||{}}findNode(t){var e;let n=null===(e=this._dataSource)||void 0===e||null===(e=e.slides)||void 0===e?void 0:e.find((h,f)=>f==this._slideIdx),r=null==n?void 0:n.svg,l=(h,f)=>{let g=null==h?void 0:h.find(v=>v.id==t);if(g)return g;let w=0,p=h.length||0;for(;w<p&&!g&&(g=l(h[w].nodes||[],h[w].id),!g);)w++;return g},a=l((null==r?void 0:r.nodes)||[]);var s,o,d,c,u;return a?(a.style=null!==(s=a.style)&&void 0!==s?s:{},a.source=null!==(o=a.source)&&void 0!==o?o:{},a.animate=null!==(d=a.animate)&&void 0!==d?d:{},a.interactive=null!==(c=a.interactive)&&void 0!==c?c:{},a.variable=null!==(u=a.variable)&&void 0!==u?u:{},a):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}runSlide(t,e,n){var r;let l;var a,s;if(this.refreshNodeStatus(),this.refreshSlideStatus(),n)l=null===(a=this._dataSource)||void 0===a||null===(a=a.slides)||void 0===a?void 0:a.find(u=>u.code==n||u.id==n),l&&(this._slideIdx=(null===(s=this._dataSource)||void 0===s||null===(s=s.slides)||void 0===s?void 0:s.indexOf(l))||0);else if(e){var o,d;l=null===(o=this._dataSource)||void 0===o||null===(o=o.slides)||void 0===o?void 0:o.find(u=>u.id==e),l&&(this._slideIdx=(null===(d=this._dataSource)||void 0===d||null===(d=d.slides)||void 0===d?void 0:d.indexOf(l))||0)}else this._slideIdx=Math.min(Math.max(t||0,0),this.slideTotal-1),l=this.slide;if(l){var c;Jr(y.container,y.svg,l,!0),null===(c=jQuery(y.svg).find("#"+U.BACKGROUND_GROUP))||void 0===c||c.empty();let u=G(U.BACKGROUND_GROUP,"g",void 0,y.svg);Ee(u,l),(i=>{var t,e,n,r;i.test&&(i.test.answer=void 0);let l=D.nodeStatus,a=D.slideStatus;null===(t=i.svg)||void 0===t||t.nodes.forEach(o=>{o.pid=Math.ceil(1e9*Math.random()),Ge(o.pid)});let s=null===(e=i.svg)||void 0===e||null===(e=e.nodes)||void 0===e?void 0:e.map(o=>{var d;return null!==(d=o.idx)&&void 0!==d?d:0}).filter((o,d,c)=>c.indexOf(o)==d).sort((o,d)=>(null!=o?o:0)-(null!=d?d:0));ln(null!==(n=null===(r=i.svg)||void 0===r?void 0:r.nodes)&&void 0!==n?n:[],null!=s?s:[],{slide:i,nodeStatus:l,slideStatus:a})})(l)}this.changeSlide(this.slides,null===(r=this.slide)||void 0===r?void 0:r.id,this.slideIdx,this.slides.length,l)}set onChangeSlide(t){this._fnChangeSlides.push(t)}changeSlide(t,e,n,r,l){this._fnChangeSlides.forEach(a=>a(t,e,n,r,l))}},Jr=(i,t,e,n)=>{var r,l,a,s;let o=window.document.querySelector(t);var d;o||(o=document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(d=window.document.querySelector(i))||void 0===d||d.appendChild(o)),n&&(o.textContent=null);let{x:c,y:u,width:h,height:f}=null!==(r=null==e||null===(l=e.svg)||void 0===l?void 0:l.viewBox)&&void 0!==r?r:y.screen.frameSize;o.setAttributeNS(null,"viewBox",c+" "+u+" "+h+" "+f),o.setAttribute("id",t.replace("#",""));var k,b,g=null!==(a=jQuery(i).width())&&void 0!==a?a:1080,w=null!==(s=jQuery(i).height())&&void 0!==s?s:1080,v=h/f;v>=g/w?b=(k=g)/v:k=(b=w)*v,o.setAttributeNS(null,"width",k.toString()),o.setAttributeNS(null,"height",b.toString())};class Kd{constructor(t,e){let n=window.document.querySelector(e);var r;n||(n=window.document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(r=window.document.querySelector(t))||void 0===r||r.appendChild(n));let{svgViewBox:l,svgSize:a}=y.screen.init();n.setAttributeNS(null,"viewBox",`${l.x} ${l.y} ${l.width} ${l.height}`),n.setAttribute("id",e.replace("#","")),n.style.display="block",n.style.width=`${a.width}px`,n.style.height=`${a.height}px`,n.style.backgroundColor="#fafafa",n.style.cursor="default"}}const ki=i=>{jQuery(y.target).find("#"+U.BACKGROUND_GROUP).empty();let t=G(U.BACKGROUND_GROUP,"g",void 0,y.target);Ee(t,i),(()=>{let e=window.document.getElementById(null==i?void 0:i.id);jQuery(e).find("#"+U.BACKGROUND_GROUP).empty();let n=G(U.BACKGROUND_GROUP,"g",void 0,e);Ee(n,i)})()},Si=()=>{jQuery(y.target).find(">*:not(defs)").remove()},mt=(i,t,e,n,r)=>{let l;if(!e)switch(t){case C.GROUP:e="g";break;case C.CIRCLE:e="circle";break;case C.ELLIPSE:e="ellipse";break;case C.LINE:e="line";break;case C.RECT:e="rect";break;case C.POLYGON:e="polygon";break;case C.POLYLINE:e="polyline";break;case C.PATH:e="path";break;case C.FOREIGNOBJECT:e="foreignObject";break;case C.IMAGE:e="image";break;case C.TEXT:e="text";break;case C.TSPAN:e="tspan"}if(t&&null!=n&&n.size&&null!=n&&n.attribute&&Object.assign(n.attribute,W(t,n.size,n.attribute)),i)if(l=jQuery(r||y.target).find("#"+i).get(0),l){if(l.nodeName!=e){let a=window.document.createElementNS("http://www.w3.org/2000/svg",e);a.setAttribute("id",i),t==C.FOREIGNOBJECT&&a.setAttribute("xmlns:html","http://www.w3.org/1999/xhtml"),jQuery(l).replaceWith(a),l=a}}else l=window.document.createElementNS("http://www.w3.org/2000/svg",e),l.setAttribute("id",i),t==C.FOREIGNOBJECT&&l.setAttribute("xmlns:html","http://www.w3.org/1999/xhtml"),jQuery(l).appendTo(r||y.target);else l=window.document.createElementNS("http://www.w3.org/2000/svg",e),jQuery(l).appendTo(r||y.target);return null!=n&&n.attribute&&K(l,null==n?void 0:n.attribute),null!=n&&n.style&&wt(l,null==n?void 0:n.style),null!=n&&n.source&&Ot(l,t,null==n?void 0:n.source,i),l},K=(i,t)=>{return jQuery(i).attr((e=Object.assign({},t||{}),null===(n=Object.keys(e))||void 0===n||n.forEach(a=>{switch(a){case"fill":break;case"fillRule":var s;Object.assign(e,{"fill-rule":null!==(s=e.fillRule)&&void 0!==s?s:null,fillRule:null});break;case"stroke":var o;Object.assign(e,{"stroke-width":null!==(o=e.strokeWidth)&&void 0!==o?o:null,strokeWidth:null});break;case"strokeLinecap":var d;Object.assign(e,{"stroke-linecap":null!==(d=e.strokeLinecap)&&void 0!==d?d:null,strokeLinecap:null});break;case"strokeLinejoin":var c;Object.assign(e,{"stroke-linejoin":null!==(c=e.strokeLinejoin)&&void 0!==c?c:null,strokeLinejoin:null});break;case"strokeMiterlimit":var u;Object.assign(e,{"stroke-miterlimit":null!==(u=e.strokeMiterlimit)&&void 0!==u?u:null,strokeMiterlimit:null});break;case"strokeDasharray":var h;Object.assign(e,{"stroke-dasharray":null!==(h=e.strokeDasharray)&&void 0!==h?h:null,strokeDasharray:null});break;case"strokeDasharrays":var f,g;Object.assign(e,{"stroke-dasharray":null!==(f=null===(g=e.strokeDasharrays)||void 0===g?void 0:g.join(" "))&&void 0!==f?f:null,strokeDasharrays:null});break;case"fontFamily":var w;Object.assign(e,{"font-family":null!==(w=e.fontFamily)&&void 0!==w?w:null,fontFamily:null});break;case"fontWeight":var p;Object.assign(e,{"font-weight":null!==(p=e.fontWeight)&&void 0!==p?p:null,fontWeight:null});break;case"fontStyle":var v;Object.assign(e,{"font-style":null!==(v=e.fontStyle)&&void 0!==v?v:null,fontStyle:null});break;case"fontSize":var k;Object.assign(e,{"font-size":null!==(k=e.fontSize)&&void 0!==k?k:null,fontSize:null});break;case"textLength":Object.assign(e,{textLength:e.textLength?`${e.textLength}px`:null});break;case"letterSpacing":var b;Object.assign(e,{"letter-spacing":null!==(b=e.letterSpacing)&&void 0!==b?b:null,letterSpacing:null});break;case"wordSpacing":var m;Object.assign(e,{"word-spacing":null!==(m=e.wordSpacing)&&void 0!==m?m:null,wordSpacing:null});break;case"alignmentBaseline":var x;Object.assign(e,{"alignment-baseline":null!==(x=e.alignmentBaseline)&&void 0!==x?x:null,alignmentBaseline:null});break;case"dominantBaseline":var T;Object.assign(e,{"dominant-baseline":null!==(T=e.dominantBaseline)&&void 0!==T?T:null,dominantBaseline:null});break;case"textAnchor":var _;Object.assign(e,{"text-anchor":null!==(_=e.textAnchor)&&void 0!==_?_:null,textAnchor:null});break;case"textDecoration":var I;Object.assign(e,{"text-decoration":null!==(I=e.textDecoration)&&void 0!==I?I:null,textDecoration:null});break;case"transformOrigin":var F;Object.assign(e,{"transform-origin":null!==(F=e.transformOrigin)&&void 0!==F?F:null,transformOrigin:null})}}),Object.assign({},null!=e?e:{},{fill:null!=e&&e.fill?pi(e.fill,null!==(r=null==e?void 0:e.fillOpacity)&&void 0!==r?r:1):"rgba(0,0,0,0)",fillOpacity:null,stroke:null!=e&&e.stroke?pi(e.stroke,null!==(l=null==e?void 0:e.strokeOpacity)&&void 0!==l?l:1):"rgba(0,0,0,0)",strokeOpacity:null}))),i;var e,n,r,l},wt=(i,t)=>{return jQuery(i).css((e=Object.assign({},t||{}),null===(n=Object.keys(e))||void 0===n||n.forEach(r=>{switch(r){case"padding":Object.assign(e,{padding:e.padding?`${e.padding}px`:null});break;case"borderWidth":var l;Object.assign(e,e.borderWidth&&e.borderColor?{"border-width":`${e.borderWidth}px`,"border-style":e.borderStyle||"solid","border-color":pi(e.borderColor,null!==(l=e.borderOpacity)&&void 0!==l?l:1)}:{"border-width":"","border-style":"","border-color":""}),Object.assign(e,{borderWidth:null,borderStyle:null,borderColor:null,borderOpacity:null});break;case"borderRadius":Object.assign(e,{"border-radius":e.borderRadius?`${e.borderRadius}px`:null,borderRadius:null});break;case"backgroundColor":var a;Object.assign(e,e.backgroundColor?{"background-color":pi(e.backgroundColor,null!==(a=e.backgroundOpacity)&&void 0!==a?a:1)}:{"background-color":""}),Object.assign(e,{backgroundColor:null,backgroundOpacity:null})}}),e)),i;var e,n},Ot=(i,t,e,n)=>{switch(t){case C.TEXT:{var r;let Y=n==y.dataSelect.contenteditable_id,nt=(null==e||null===(r=e.text)||void 0===r?void 0:r.textContent)||"H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!";var l,a;if(!Y&&null!=e&&null!==(l=e.text)&&void 0!==l&&l.variableKeywords&&null!=e&&null!==(a=e.text)&&void 0!==a&&a.variableKeywords.length){let zt=y.variable.getKeys();e.text.variableKeywords.forEach(dt=>{var ft=dt.replace(/[^a-zA-Z0-9_]/gm,"");if(zt.indexOf(ft)>=0){var xt=y.variable.getValue(ft);nt=nt.replace(dt,xt)}})}Y?jQuery(i).attr("editable",`${Y}`).html(`<div contenteditable="${Y}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${nt}</div>`):jQuery(i).attr("editable",`${Y}`).text(nt);break}case C.TSPAN:var s,o;jQuery(i).text(null!==(s=null==e||null===(o=e.text)||void 0===o?void 0:o.textContent)&&void 0!==s?s:"");break;case C.IMAGE:var d,c,u,h,f;jQuery(i).attr("href",(null==e||null===(d=e.image)||void 0===d?void 0:d.base64)||(null!=e&&null!==(c=e.image)&&void 0!==c&&c.path?(null===(u=y.config)||void 0===u?void 0:u.readfileuploadurl)+(null==e||null===(h=e.image)||void 0===h?void 0:h.path):null==e||null===(f=e.image)||void 0===f?void 0:f.url)||"");break;case C.FOREIGNOBJECT:switch(null==e?void 0:e.type){case"text":{var g;let Y=n==y.dataSelect.contenteditable_id,nt=(null===(g=e.text)||void 0===g?void 0:g.textContent)||"H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!";var w,p;if(!Y&&null!==(w=e.text)&&void 0!==w&&w.variableKeywords&&null!==(p=e.text)&&void 0!==p&&p.variableKeywords.length){let zt=y.variable.getKeys();e.text.variableKeywords.forEach(dt=>{var ft=dt.replace(/[^a-zA-Z0-9_]/gm,"");if(zt.indexOf(ft)>=0){var xt=y.variable.getValue(ft);nt=nt.replace(dt,xt)}})}Y?jQuery(i).attr("editable",`${Y}`).html(`<div contenteditable="${Y}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${nt}</div>`):jQuery(i).attr("editable",`${Y}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${nt}</div>`);break}case"html":{var v;let Y=n==y.dataSelect.contenteditable_id,nt=(null==e||null===(v=e.html)||void 0===v?void 0:v.htmlContent)||'<span style="font-family: Roboto; font-size: 24px;">H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!</span>';var k,b;if(!Y&&null!==(k=e.html)&&void 0!==k&&k.variableKeywords&&null!==(b=e.html)&&void 0!==b&&b.variableKeywords.length){let zt=y.variable.getKeys();e.html.variableKeywords.forEach(dt=>{var ft=dt.replace(/[^a-zA-Z0-9_]/gm,"");if(zt.indexOf(ft)>=0){var xt=y.variable.getValue(ft);nt=nt.replace(dt,xt)}})}jQuery(i).attr("editable",`${Y}`).html(`<div contenteditable="${Y}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${nt}</div>`).find("img[path],video[path],iframe[path]").each((zt,dt)=>{var ft,xt;dt.setAttribute("src",(null!==(ft=null===(xt=y.config)||void 0===xt?void 0:xt.readfileuploadurl)&&void 0!==ft?ft:"")+dt.getAttribute("path")),dt.removeAttribute("path")});break}case"input":var m,x,T,_;if(null!==(m=e.input)&&void 0!==m&&m.input)jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><input type="text" placeholder="${null!==(T=null===(_=e.input)||void 0===_?void 0:_.placeholder)&&void 0!==T?T:""}" maxlength="100" /></div>`);else if(null!==(x=e.input)&&void 0!==x&&x.textarea){var I,F;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><textarea placeholder="${null!==(I=null===(F=e.input)||void 0===F?void 0:F.placeholder)&&void 0!==I?I:""}" maxlength="1000"></textarea></div>`)}break;case"image":var O,N,B,R,S;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><img src="${(null===(O=e.image)||void 0===O?void 0:O.base64)||(null!==(N=e.image)&&void 0!==N&&N.path?(null===(B=y.config)||void 0===B?void 0:B.readfileuploadurl)+(null===(R=e.image)||void 0===R?void 0:R.path):null===(S=e.image)||void 0===S?void 0:S.url)||""}" style="width:100%;height:100%;display:block;"/></div>`);break;case"iframe":var A,J,j,z;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${(null!==(A=e.iframe)&&void 0!==A&&A.path?(null===(J=y.config)||void 0===J?void 0:J.readfileuploadurl)+(null===(j=e.iframe)||void 0===j?void 0:j.path):null===(z=e.iframe)||void 0===z?void 0:z.url)||""}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break;case"embed":{var L,Q,M,P,q;let Y=$i({readfileuploadurl:null===(L=y.config)||void 0===L?void 0:L.readfileuploadurl,type:null===(Q=e.embed)||void 0===Q?void 0:Q.type,oss:null===(M=e.embed)||void 0===M?void 0:M.oss,path:null===(P=e.embed)||void 0===P?void 0:P.path,url:null===(q=e.embed)||void 0===q?void 0:q.url});jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${Y}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break}case"svg":var Z,tt;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${null!==(Z=null===(tt=e.svg)||void 0===tt?void 0:tt.svgContent)&&void 0!==Z?Z:""}</div>`);break;case"test":{var it,V;let Y=n==y.dataSelect.contenteditable_id,nt=(null==e||null===(it=e.html)||void 0===it?void 0:it.htmlContent)||"";var rt,ht;if(!Y&&null!==(rt=e.html)&&void 0!==rt&&rt.variableKeywords&&null!==(ht=e.html)&&void 0!==ht&&ht.variableKeywords.length){let zt=y.variable.getKeys();e.html.variableKeywords.forEach(dt=>{var ft=dt.replace(/[^a-zA-Z0-9_]/gm,"");if(zt.indexOf(ft)>=0){var xt=y.variable.getValue(ft);nt=nt.replace(dt,xt)}})}switch(null==e||null===(V=e.test)||void 0===V?void 0:V.type){case"truefalse":var st;Y?jQuery(i).attr("editable",`${Y}`).html(`<div contenteditable="${Y}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${nt}</div>`):jQuery(i).attr("editable",`${Y}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==e?void 0:e.test.type}" data-correct="${null!=e&&null!==(st=e.test.truefalse)&&void 0!==st&&st.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${nt}</div></div></div>`);break;case"singlechoice":var It;Y?jQuery(i).attr("editable",`${Y}`).html(`<div contenteditable="${Y}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${nt}</div>`):jQuery(i).attr("editable",`${Y}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==e?void 0:e.test.type}" data-correct="${null!=e&&null!==(It=e.test.singlechoice)&&void 0!==It&&It.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${nt}</div></div></div>`);break;case"multichoice":var At;Y?jQuery(i).attr("editable",`${Y}`).html(`<div contenteditable="${Y}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${nt}</div>`):jQuery(i).attr("editable",`${Y}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==e?void 0:e.test.type}" data-correct="${null!=e&&null!==(At=e.test.multichoice)&&void 0!==At&&At.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${nt}</div></div></div>`);break;case"matching-empty":var Pt;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-empty" data-key="${null==e||null===(Pt=e.test.matching)||void 0===Pt?void 0:Pt.key}"></div>`);break;case"matching-content":var Te,He,ne;Y?jQuery(i).attr("editable",`${Y}`).html(`<div contenteditable="${Y}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${nt}</div>`):jQuery(i).attr("editable",`${Y}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-content" data-key="${null==e||null===(Te=e.test.matching)||void 0===Te?void 0:Te.key}"><div class="ondrag-item" data-key="${null!==(He=null==e||null===(ne=e.test)||void 0===ne||null===(ne=ne.matching)||void 0===ne?void 0:ne.key)&&void 0!==He?He:"MIDDLEKIEN"}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${nt}</div></div></div></div>`);break;case"fill":var X;Y||((null===(X=e.html)||void 0===X?void 0:X.fillKeywords)||[]).forEach(zt=>{var dt=`<input type="text" maxlength="128" style="display:inline-block;width:100px;min-width:100px;max-width:100%;padding:0px 10px;margin:0px;box-sizing:border-box;outline:none;box-shadow:none;border-width:0px 0px 1px;border-top-style:initial;border-right-style:initial;border-left-style:initial;border-top-color:initial;border-right-color:initial;border-left-color:initial;border-image:initial;border-bottom-style:dashed;border-bottom-color:rgb(123,146,254);background:transparent;animation:0.3s ease-in-out 0s 1 normal none running width;text-align:inherit;" data-key="${zt.replace(/[^a-zA-Z0-9]+/gm,"")}"/>`;nt=nt.replace(new RegExp(zt.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),"g"),dt)}),Y?jQuery(i).attr("editable",`${Y}`).html(`<div contenteditable="${Y}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${nt}</div>`):jQuery(i).attr("editable",`${Y}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${nt}</div></div></div>`);break;case"speech":jQuery(i).html('<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><img src="images/svg/component/microphone4.svg" width="60" height="60"/></div></div>');break;case"submit":var ot,Xt,jt,fn,gn;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><img src="${null!==(ot=null!==(Xt=e.image)&&void 0!==Xt&&Xt.path?(null===(jt=y.config)||void 0===jt?void 0:jt.readfileuploadurl)+(null===(fn=e.image)||void 0===fn?void 0:fn.path):null===(gn=e.image)||void 0===gn?void 0:gn.url)&&void 0!==ot?ot:""}" style="width:100%;height:100%;display:block;"/></div>`)}jQuery(i).find("img[path],video[path],iframe[path]").each((zt,dt)=>{var ft,xt;dt.setAttribute("src",(null!==(ft=null===(xt=y.config)||void 0===xt?void 0:xt.readfileuploadurl)&&void 0!==ft?ft:"")+dt.getAttribute("path")),dt.removeAttribute("path")})}}}},G=(i,t,e,n)=>{let r=jQuery(n||y.target).find("#"+i).get(0);return r||(r=window.document.createElementNS("http://www.w3.org/2000/svg",t),r.setAttribute("id",i),jQuery(r).appendTo(n||y.target)),jQuery(r).attr((null==e?void 0:e.attribute)||{}),jQuery(r).css((null==e?void 0:e.style)||{}),r},ee=(i,t)=>{let e=H(2),n={fill:"transparent",stroke:"#129bff","stroke-width":H(1)};return[{element:G("icdt-temp-create-rect-center","rect",{attribute:Object.assign({x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e},n)},i),posType:"rect-center"}]},an=(i,t)=>{let e=[],{size:n}=t,r=H(1),l=H(2),a=H(3),d=(H(5),H(7),H(10)),c={stroke:_t.stroke,"stroke-width":H(_t.strokeWidth),"stroke-linecap":_t.strokeLinecap,"stroke-dasharray":_t.strokeDasharrays.map(R=>H(R)).join(" ")},u={fill:"transparent",stroke:"transparent","stroke-width":H(1)},h={fill:"#FFFFFF",stroke:"#0D99FF","stroke-width":H(1),width:H(7),height:H(7)},f={fill:"#FFFFFF",stroke:"#0D99FF","stroke-width":H(1),width:H(7),height:H(7)},g=G("icdt-temp-resize-rect-center","rect",{attribute:Object.assign({x:n.x,y:n.y,width:n.width,height:n.height},u),style:{cursor:"move"}},i);if(G("icdt-temp-resize-line-left","line",{attribute:Object.assign({x1:n.x-r,y1:n.y-r,x2:n.x-r,y2:n.y+n.height+r},c)},i),G("icdt-temp-resize-line-top","line",{attribute:Object.assign({x1:n.x-r,y1:n.y-r,x2:n.x+n.width+r,y2:n.y-r},c)},i),G("icdt-temp-resize-line-right","line",{attribute:Object.assign({x1:n.x+n.width+r,y1:n.y-r,x2:n.x+n.width+r,y2:n.y+n.height+r},c)},i),G("icdt-temp-resize-line-bottom","line",{attribute:Object.assign({x1:n.x-r,y1:n.y+n.height+r,x2:n.x+n.width+r,y2:n.y+n.height+r},c)},i),t.type==C.LINE){var b;let{size:R}=t,S=[];return null===(b=R.ratios)||void 0===b||b.forEach(function(A){S.push([R.x+R.width*A[0],R.y+R.height*A[1]])}),S.forEach((A,J)=>{e.push({posType:`point-${J}`,element:G(`icdt-temp-resize-point-${J+1}`,"circle",{attribute:Object.assign(W(C.CIRCLE,{x:A[0]-l-r,y:A[1]-l-r,width:f.width,height:f.height},{}),f)},i)})}),e.concat([{element:g,posType:"rect-center"}])}if(t.type==C.POLYGON){var m;let{size:R}=t,S=[];null===(m=R.ratios)||void 0===m||m.forEach(function(A){S.push([R.x+R.width*A[0],R.y+R.height*A[1]])}),S.forEach((A,J)=>{e.push({posType:`point-${J}`,element:G(`icdt-temp-resize-point-${J+1}`,"circle",{attribute:Object.assign(W(C.CIRCLE,{x:A[0]-l-r,y:A[1]-l-r,width:f.width,height:f.height},{}),f)},i)})})}let x=G("icdt-temp-resize-rect-top-left","rect",{attribute:Object.assign({x:n.x-d,y:n.y-d},h),style:{cursor:"nw-resize"}},i),T=G("icdt-temp-resize-rect-top-right","rect",{attribute:Object.assign({x:n.x+n.width+a,y:n.y-d},h),style:{cursor:"ne-resize"}},i),_=G("icdt-temp-resize-rect-bottom-left","rect",{attribute:Object.assign({x:n.x-d,y:n.y+n.height+a},h),style:{cursor:"sw-resize"}},i),I=G("icdt-temp-resize-rect-bottom-right","rect",{attribute:Object.assign({x:n.x+n.width+a,y:n.y+n.height+a},h),style:{cursor:"se-resize"}},i),F=G("icdt-temp-resize-rect-left","rect",{attribute:Object.assign({x:n.x-d,y:n.y+n.height/2-l-r},h),style:{cursor:"w-resize"}},i),O=G("icdt-temp-resize-rect-top","rect",{attribute:Object.assign({x:n.x+n.width/2-l-r,y:n.y-d},h),style:{cursor:"n-resize"}},i),N=G("icdt-temp-resize-rect-right","rect",{attribute:Object.assign({x:n.x+n.width+a,y:n.y+n.height/2-l-r},h),style:{cursor:"e-resize"}},i),B=G("icdt-temp-resize-rect-bottom","rect",{attribute:Object.assign({x:n.x+n.width/2-l-r,y:n.y+n.height+a},h),style:{cursor:"s-resize"}},i);return e.concat([{element:g,posType:"rect-center"},{element:x,posType:"rect-top-left"},{element:T,posType:"rect-top-right"},{element:_,posType:"rect-bottom-left"},{element:I,posType:"rect-bottom-right"},{element:F,posType:"rect-left"},{element:O,posType:"rect-top"},{element:N,posType:"rect-right"},{element:B,posType:"rect-bottom"}])},Ir=(i,t,e)=>{let n=H(1),r=H(2),l=H(5),a={stroke:_t.stroke,"stroke-width":H(_t.strokeWidth),"stroke-linecap":_t.strokeLinecap},s={fill:"transparent",stroke:"transparent","stroke-width":H(1)},o={fill:"#FFFFFF",stroke:"#0D99FF","stroke-width":H(1),width:H(7),height:H(7)},d={fill:"#0D99FF",rx:H(4)},c={fill:"#fff","alignment-baseline":"central","text-anchor":"middle","font-size":H(14)},u={fill:ce.fill,stroke:ce.stroke,"stroke-width":H(ce.strokeWidth)},p=(G("icdt-temp-resize-line-left","line",{attribute:Object.assign({x1:e.x-n,y1:e.y-n,x2:e.x-n,y2:e.y+e.height+n},a)},i),G("icdt-temp-resize-line-top","line",{attribute:Object.assign({x1:e.x-n,y1:e.y-n,x2:e.x+e.width+n,y2:e.y-n},a)},i),G("icdt-temp-resize-line-right","line",{attribute:Object.assign({x1:e.x+e.width+n,y1:e.y-n,x2:e.x+e.width+n,y2:e.y+e.height+n},a)},i),G("icdt-temp-resize-line-bottom","line",{attribute:Object.assign({x1:e.x-n,y1:e.y+e.height+n,x2:e.x+e.width+n,y2:e.y+e.height+n},a)},i),G("icdt-temp-resize-rect-center","rect",{attribute:Object.assign({x:e.x,y:e.y,width:e.width,height:e.height},s)},i)),v=`${e.width} x ${e.height}`,k=8*v.length;return G("icdt-temp-select-rect-text","rect",{attribute:Object.assign({x:e.x+e.width/2-H(k/2),y:e.y+e.height+H(10),width:H(k),height:H(20)},d)},i),G("icdt-temp-select-text","text",{attribute:Object.assign({x:e.x+e.width/2,y:e.y+e.height+H(20)},c)},i).textContent=v,t.length>1&&t.forEach(R=>{let{size:S}=R;G("icdt-temp-select-rect-node-"+R.id,"rect",{attribute:Object.assign({x:S.x,y:S.y,width:S.width,height:S.height},u)},i)}),[{element:p,posType:"rect-center"},{element:G("icdt-temp-resize-rect-top-left","rect",{attribute:Object.assign({x:e.x-l,y:e.y-l},o),style:{cursor:"nw-resize"}},i),posType:"rect-top-left"},{element:G("icdt-temp-resize-rect-top-right","rect",{attribute:Object.assign({x:e.x+e.width-r,y:e.y-l},o),style:{cursor:"ne-resize"}},i),posType:"rect-top-right"},{element:G("icdt-temp-resize-rect-bottom-left","rect",{attribute:Object.assign({x:e.x-l,y:e.y+e.height-r},o),style:{cursor:"sw-resize"}},i),posType:"rect-bottom-left"},{element:G("icdt-temp-resize-rect-bottom-right","rect",{attribute:Object.assign({x:e.x+e.width-r,y:e.y+e.height-r},o),style:{cursor:"se-resize"}},i),posType:"rect-bottom-right"},{element:G("icdt-temp-resize-rect-left","rect",{attribute:Object.assign({x:e.x-l,y:e.y+e.height/2-r-n},o),style:{cursor:"w-resize"}},i),posType:"rect-left"},{element:G("icdt-temp-resize-rect-top","rect",{attribute:Object.assign({x:e.x+e.width/2-r-n,y:e.y-l},o),style:{cursor:"n-resize"}},i),posType:"rect-top"},{element:G("icdt-temp-resize-rect-right","rect",{attribute:Object.assign({x:e.x+e.width-r,y:e.y+e.height/2-r-n},o),style:{cursor:"e-resize"}},i),posType:"rect-right"},{element:G("icdt-temp-resize-rect-bottom","rect",{attribute:Object.assign({x:e.x+e.width/2-r-n,y:e.y+e.height-r},o),style:{cursor:"s-resize"}},i),posType:"rect-bottom"}]},Oi=(i,t)=>{let e=H(1),n={stroke:_t.stroke,"stroke-width":H(_t.strokeWidth),"stroke-linecap":_t.strokeLinecap},r={fill:"transparent",stroke:"transparent","stroke-width":H(1)};return G("icdt-temp-scan-line-left","line",{attribute:Object.assign({x1:t.x-e,y1:t.y,x2:t.x-e,y2:t.y+t.height},n)},i),G("icdt-temp-scan-line-top","line",{attribute:Object.assign({x1:t.x,y1:t.y-e,x2:t.x+t.width,y2:t.y-e},n)},i),G("icdt-temp-scan-line-right","line",{attribute:Object.assign({x1:t.x+t.width+e,y1:t.y,x2:t.x+t.width+e,y2:t.y+t.height},n)},i),G("icdt-temp-scan-line-bottom","line",{attribute:Object.assign({x1:t.x,y1:t.y+t.height+e,x2:t.x+t.width,y2:t.y+t.height+e},n)},i),[{element:G("icdt-temp-scan-rect-center","rect",{attribute:Object.assign({x:t.x,y:t.y,width:t.width,height:t.height},r)},i),posType:"rect-center"}]},Ni=(i,t)=>{let e={fill:"none",stroke:"#999","stroke-width":H(1),"stroke-dasharray":H(2)};jQuery(i).empty(),t.forEach(n=>{var r,l;let{size:a}=n;if(!n.idx)return;G("icdt-temp-index-rect-node-"+n.id,"rect",{attribute:Object.assign({x:a.x-5,y:a.y-5,width:a.width+10,height:a.height+10},e)},i);let{element:s}=Qt(Math.ceil(1e9*Math.random()),{size:{x:a.x-76,y:a.y-6,width:70,height:80},attribute:{},style:{},source:{type:"html",html:{htmlContent:`<div class="position-slide" style="position:relative;width:100%;height:100%;">\n                  <div style="position:absolute;top:0;right:0;line-height:22px;">\n                    <div title="Th\u1ee9 t\u1ef1 xu\u1ea5t hi\u1ec7n">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-play" style="margin:6px 0;color:#7da7d9;font-size:12px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="idx" value="${null!==(r=n.idx)&&void 0!==r?r:0}" min="0" max="999" step="1" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="Th\u1eddi gian \u0111\u1ee3i(s), n\u1ebfu gi\xe1 tr\u1ecb = 0 s\u1ebd chuy\u1ec3n sang \u0111\u1ee3i ho\xe0n t\u1ea5t ho\u1ea1t \u0111\u1ed9ng v\xe0 \xe2m thanh" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-clock-o" style="margin:5px 0;color:#7da7d9;font-size:14px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="time" value="${null!==(l=n.time)&&void 0!==l?l:0}" min="0" max="999" step="0.5" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="H\u1ee7y thi\u1ebft l\u1eadp" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <button name="remove" style="box-sizing:border-box;width:24px;height:24px;padding:0;border:1px solid #ddd;line-height: 0;outline:none;background:#eee;background: radial-gradient(#fff, #eee);">\n                            <img src="assets/icon-png/xoa2.png" height="18">\n                          </button>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                  </div>\n              </div>`}}},i);s.classList.add("node-input"),jQuery(s).on("change",'input[name="idx"]',o=>{var d;n.idx=parseInt(null!==(d=o.target.value)&&void 0!==d?d:"0")}).on("change",'input[name="time"]',o=>{var d;n.time=parseFloat(null!==(d=o.target.value)&&void 0!==d?d:"0")}).on("click",'button[name="remove"]',o=>{n.idx=0,n.time=null,Ni(i,t)})})},Ee=(i,t)=>{var e,n,r,l,a,s;let{color:o,opacity:d,path:c,url:u,base64:h}=null!==(e=null==t||null===(n=t.svg)||void 0===n?void 0:n.background)&&void 0!==e?e:{},{x:f,y:g,width:w,height:p}=null!==(r=null==t||null===(l=t.svg)||void 0===l?void 0:l.viewBox)&&void 0!==r?r:{x:0,y:0,width:0,height:0};Oe(void 0,{size:{x:0,y:H(-10),width:100,height:20},attribute:{fill:"#999",textAnchor:"start",alignmentBaseline:"central",fontSize:H(12),class:"hide-on-viewer"},source:{type:"text",text:{textContent:null!==(a=null!==(s=null==t?void 0:t.name)&&void 0!==s?s:null==t?void 0:t.code)&&void 0!==a?a:void 0}}},i),Yt(void 0,{size:{x:f,y:g,width:w,height:p},attribute:{fill:"#fff",stroke:"#999",strokeWidth:H(1),strokeDasharray:H(10),class:"hide-on-viewer"}},i),o&&Yt(void 0,{size:{x:f,y:g,width:w,height:p},attribute:{fill:o,fillOpacity:d}},i),c&&Vt(void 0,{size:{x:f,y:g,width:w,height:p},source:{type:"image",image:{path:c,url:u,base64:h}}},i)},Ft=(i,t,e)=>{var n;switch(jQuery(i).empty(),null===(n=t.test)||void 0===n?void 0:n.type){case"truefalse":var r;if(null!==(r=t.test)&&void 0!==r&&r.showselection){var l,a,s;let F=null==t||null===(l=t.test)||void 0===l||null===(l=l.answer)||void 0===l||null===(l=l.truefalse)||void 0===l?void 0:l.value;null===(a=t.svg)||void 0===a||a.nodes.filter(O=>{var N;return"truefalse"==(null===(N=O.source)||void 0===N||null===(N=N.test)||void 0===N?void 0:N.type)&&O.id!=F}).forEach(O=>{var N;let{x:R,y:S,width:A,height:J}=null!==(N=null==O?void 0:O.size)&&void 0!==N?N:{x:0,y:0,width:0,height:0};$t(Math.ceil(1e9*Math.random()),{size:{x:R-.5,y:S-.5,width:A+1,height:J+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},i)}),null!=t&&null!==(s=t.test)&&void 0!==s&&null!==(s=s.answer)&&void 0!==s&&s.truefalse&&F&&(O=>{let N=D.findNode(F),{x:R,y:S,width:A,height:J}=null!==(O=null==N?void 0:N.size)&&void 0!==O?O:{x:0,y:0,width:0,height:0};$t(Math.ceil(1e9*Math.random()),{size:{x:R-2,y:S-2,width:A+4,height:J+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},i)})()}break;case"singlechoice":var o;if(null!==(o=t.test)&&void 0!==o&&o.showselection){var d,c,u;let F=null==t||null===(d=t.test)||void 0===d||null===(d=d.answer)||void 0===d||null===(d=d.singlechoice)||void 0===d?void 0:d.value;null===(c=t.svg)||void 0===c||c.nodes.filter(O=>{var N;return"singlechoice"==(null===(N=O.source)||void 0===N||null===(N=N.test)||void 0===N?void 0:N.type)&&O.id!=F}).forEach(O=>{var N;let{x:R,y:S,width:A,height:J}=null!==(N=null==O?void 0:O.size)&&void 0!==N?N:{x:0,y:0,width:0,height:0};$t(Math.ceil(1e9*Math.random()),{size:{x:R-.5,y:S-.5,width:A+1,height:J+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},i)}),null!=t&&null!==(u=t.test)&&void 0!==u&&null!==(u=u.answer)&&void 0!==u&&u.singlechoice&&F&&(O=>{let N=D.findNode(F),{x:R,y:S,width:A,height:J}=null!==(O=null==N?void 0:N.size)&&void 0!==O?O:{x:0,y:0,width:0,height:0};$t(Math.ceil(1e9*Math.random()),{size:{x:R-2,y:S-2,width:A+4,height:J+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},i)})()}break;case"multichoice":var h;if(null!==(h=t.test)&&void 0!==h&&h.showselection){var f,g,w,p;let F=null!==(f=null==t||null===(g=t.test)||void 0===g||null===(g=g.answer)||void 0===g||null===(g=g.multichoice)||void 0===g?void 0:g.map(O=>O.value))&&void 0!==f?f:[];var v;null===(w=t.svg)||void 0===w||w.nodes.filter(O=>{var N;return"multichoice"==(null===(N=O.source)||void 0===N||null===(N=N.test)||void 0===N?void 0:N.type)&&!F.includes(O.id)}).forEach(O=>{var N;let{x:R,y:S,width:A,height:J}=null!==(N=null==O?void 0:O.size)&&void 0!==N?N:{x:0,y:0,width:0,height:0};Yt(Math.ceil(1e9*Math.random()),{size:{x:R-.5,y:S-.5,width:A+1,height:J+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},i)}),null!=t&&null!==(p=t.test)&&void 0!==p&&null!==(p=p.answer)&&void 0!==p&&p.multichoice&&F.length&&(null==t||null===(v=t.test)||void 0===v||null===(v=v.answer)||void 0===v||v.multichoice.forEach(O=>{var N;let B=D.findNode(O.value),{x:S,y:A,width:J,height:j}=null!==(N=null==B?void 0:B.size)&&void 0!==N?N:{x:0,y:0,width:0,height:0};Yt(Math.ceil(1e9*Math.random()),{size:{x:S-2,y:A-2,width:J+4,height:j+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},i)}))}break;case"fill":var k,b;null!=t&&null!==(k=t.test)&&void 0!==k&&null!==(k=k.answer)&&void 0!==k&&k.fill&&(null==t||null===(b=t.test)||void 0===b||null===(b=b.answer)||void 0===b||b.fill.forEach(F=>{jQuery("#"+e.id).find(`input[type="text"][data-key="${F.key}"]`).val(F.value)}));break;case"matching":var m,x,T,_;if(null!=t&&null!==(m=t.test)&&void 0!==m&&null!==(m=m.answer)&&void 0!==m&&m.matching)if("matching-empty"==(null===(x=e.source)||void 0===x||null===(x=x.test)||void 0===x?void 0:x.type))null==t||null===(_=t.test)||void 0===_||null===(_=_.answer)||void 0===_||_.matching.filter(F=>{var O;return F.key==(null===(O=e.source)||void 0===O||null===(O=O.test)||void 0===O||null===(O=O.matching)||void 0===O?void 0:O.key)}).forEach(F=>{});else if("matching-content"==(null===(T=e.source)||void 0===T||null===(T=T.test)||void 0===T?void 0:T.type)){var I;null==t||null===(I=t.test)||void 0===I||null===(I=I.answer)||void 0===I||I.matching.filter(F=>{var O;return F.value==(null===(O=e.source)||void 0===O||null===(O=O.test)||void 0===O||null===(O=O.matching)||void 0===O?void 0:O.key)}).forEach(F=>{})}}};class Dd{constructor(t){this._points=[],this._options=t}start(t){this._points.length=0,this._points.push([t.x,t.y]),this._options.start(t)}move(t,e){this._points.push([t.x,t.y]),this._options.move(t,this._points,e)}end(){this._options.end(this.offsetLast,this._points)}get offsetFirst(){return this._points.length>=1?{x:(t=this._points[0])[0],y:t[1]}:{x:0,y:0};var t}get offsetLast(){return this._points.length>=1?{x:(t=this._points[this._points.length-1])[0],y:t[1]}:{x:0,y:0};var t}}const Qe=(i,t,e,n)=>(i.x-=n.x,i.y-=n.y,i.x/=t,i.y/=t,i.x-=e.x,i.y-=e.y,i.x=E(i.x),i.y=E(i.y),i),Nt=(i,t,e,n,r)=>{var l,a,s;let o=null,d=0,c=0;i.mouseEvent?(o=i.mouseEvent.target,d=i.mouseEvent.offsetX,c=i.mouseEvent.offsetY):i.touchEvent&&(o=i.touchEvent.target,i.touchEvent.touches.length&&(d=i.touchEvent.touches[0].clientX,c=i.touchEvent.touches[0].clientY));let u=null!=e?e:y.screen.scale,h=null!=n?n:y.screen.dislocation,f=null!=r?r:y.screen.offset,g=()=>{};var w=new Dd({start:null!==(l=null==t?void 0:t.start)&&void 0!==l?l:g,move:null!==(a=null==t?void 0:t.move)&&void 0!==a?a:g,end:null!==(s=null==t?void 0:t.end)&&void 0!==s?s:g});i.mouseEvent?w.start(Qe({x:d,y:c},u,h,{x:0,y:0})):i.touchEvent&&w.start(Qe({x:d,y:c},u,h,f));let p=_=>{w.move(Qe({x:_.clientX,y:_.clientY},u,h,f),{ctrlKey:_.ctrlKey,shiftKey:_.shiftKey,altKey:_.altKey})},v=_=>{w.end(),[et.SHAPE,et.FOREIGNOBJECT,et.IMAGE,et.TEXT].includes(y.pointer.pointer_type)&&(_.shiftKey||(y.pointer.pointer_type=et.POINTER))},k=_=>{_.touches.length&&p({clientX:_.touches[0].clientX,clientY:_.touches[0].clientY,ctrlKey:_.ctrlKey,shiftKey:_.shiftKey,altKey:_.altKey})},b=_=>{v({ctrlKey:_.ctrlKey,shiftKey:_.shiftKey,altKey:_.altKey}),window.removeEventListener("touchmove",k,!1),window.removeEventListener("touchend",b,!1)},m=_=>{0==_.button&&p({clientX:_.clientX,clientY:_.clientY,ctrlKey:_.ctrlKey,shiftKey:_.shiftKey,altKey:_.altKey})},x=_=>{0==_.button&&(v({shiftKey:_.shiftKey,ctrlKey:_.ctrlKey,altKey:_.altKey}),window.removeEventListener("mousemove",m,!1),window.removeEventListener("mouseup",x,!1))};if(i.mouseEvent)window.addEventListener("mousemove",m,!1),window.addEventListener("mouseup",x,!1);else if(i.touchEvent){var T;window.addEventListener("touchmove",k,!1),window.addEventListener("touchend",b,!1),null===(T=o)||void 0===T||T.addEventListener("touchmove",function(_){_.preventDefault()})}},Ar=(i,t,e,n,r)=>{let{x:l,y:a,width:s,height:o}=e;0==s&&(s=1),0==o&&(o=1);let d=n.map(p=>Object.assign({},p.size)),u=[],g=!1;Nt(i,{start:p=>{n.forEach(p=>{let{id:v,size:k,attribute:b}=p;u.push({id:v,type:"size",from:JSON.parse(JSON.stringify({id:v,size:k,attribute:b}))})})},move:(p,v,k)=>{((p,v,k,b,m)=>{let x=k-p,T=b-v;(()=>{let I,_=(s||1)/(o||1);switch(t){case"rect-center":I=null!=m&&m.shiftKey?Math.abs(k-p)>=Math.abs(b-v)?{x:l+k-p,y:a,width:s,height:o}:{x:l,y:a+b-v,width:s,height:o}:{x:l+k-p,y:a+b-v,width:s,height:o};break;case"rect-top-left":I=null!=m&&m.shiftKey&&null!=m&&m.altKey?_>=1?{x:l+(k-p),y:a+(k-p)/_,width:s-2*(k-p),height:o-2*(k-p)/_}:{x:l+(b-v)*_,y:a+(b-v),width:s-2*(b-v)*_,height:o-2*(b-v)}:null!=m&&m.shiftKey?_>=1?{x:l+(k-p),y:a+(k-p)/_,width:s-(k-p),height:o-(k-p)/_}:{x:l+(b-v)*_,y:a+(b-v),width:s-(b-v)*_,height:o-(b-v)}:null!=m&&m.altKey?{x:l+(k-p),y:a+(b-v),width:s-2*(k-p),height:o-2*(b-v)}:{x:l+(k-p),y:a+(b-v),width:s-(k-p),height:o-(b-v)};break;case"rect-top-right":I=null!=m&&m.shiftKey&&null!=m&&m.altKey?_>=1?{x:l-(k-p),y:a-(k-p)/_,width:s+2*(k-p),height:o+2*(k-p)/_}:{x:l+(b-v)*_,y:a+(b-v),width:s-2*(b-v)*_,height:o-2*(b-v)}:null!=m&&m.shiftKey?_>=1?{x:l,y:a-(k-p)/_,width:s+(k-p),height:o+(k-p)/_}:{x:l,y:a+(b-v),width:s-(b-v)*_,height:o-(b-v)}:null!=m&&m.altKey?{x:l-(k-p),y:a+(b-v),width:s+2*(k-p),height:o-2*(b-v)}:{x:l,y:a+(b-v),width:s+(k-p),height:o-(b-v)};break;case"rect-bottom-left":I=null!=m&&m.shiftKey&&null!=m&&m.altKey?_>=1?{x:l+(k-p),y:a+(k-p)/_,width:s-2*(k-p),height:o-2*(k-p)/_}:{x:l-(b-v)*_,y:a-(b-v),width:s+2*(b-v)*_,height:o+2*(b-v)}:null!=m&&m.shiftKey?_>=1?{x:l+(k-p),y:a,width:s-(k-p),height:o-(k-p)/_}:{x:l-(b-v)*_,y:a,width:s+(b-v)*_,height:o+(b-v)}:null!=m&&m.altKey?{x:l+(k-p),y:a-(b-v),width:s-2*(k-p),height:o+2*(b-v)}:{x:l+(k-p),y:a,width:s-(k-p),height:o+(b-v)};break;case"rect-bottom-right":I=null!=m&&m.shiftKey&&null!=m&&m.altKey?_>=1?{x:l-(k-p),y:a-(k-p)/_,width:s+2*(k-p),height:o+2*(k-p)/_}:{x:l-(b-v)*_,y:a-(b-v),width:s+2*(b-v)*_,height:o+2*(b-v)}:null!=m&&m.shiftKey?_>=1?{x:l,y:a,width:s+(k-p),height:o+(k-p)/_}:{x:l,y:a,width:s+(b-v)*_,height:o+(b-v)}:null!=m&&m.altKey?{x:l-(k-p),y:a-(b-v),width:s+2*(k-p),height:o+2*(b-v)}:{x:l,y:a,width:s+(k-p),height:o+(b-v)};break;case"rect-top":I=null!=m&&m.shiftKey?{x:l+T/2*_,y:a+T,width:s-T*_,height:o-T}:null!=m&&m.altKey?{x:l,y:a+T,width:s,height:o-2*T}:{x:l,y:a+T,width:s,height:o-T};break;case"rect-bottom":I=null!=m&&m.shiftKey?{x:l-T/2*_,y:a,width:s+T*_,height:o+T}:null!=m&&m.altKey?{x:l,y:a-T,width:s,height:o+2*T}:{x:l,y:a,width:s,height:o+T};break;case"rect-left":I=null!=m&&m.shiftKey?{x:l+x,y:a+x/2/_,width:s-x,height:o-x/_}:null!=m&&m.altKey?{x:l+x,y:a,width:s-2*x,height:o}:{x:l+x,y:a,width:s-x,height:o};break;case"rect-right":I=null!=m&&m.shiftKey?{x:l,y:a-x/2/_,width:s+x,height:o+x/_}:null!=m&&m.altKey?{x:l-x,y:a,width:s+2*x,height:o}:{x:l,y:a,width:s+x,height:o};break;default:I={x:l+k-p,y:a+b-v,width:s,height:o}}I.width<=0&&(I.width=1),I.height<=0&&(I.height=1),I.x=E(I.x,1),I.y=E(I.y,1),I.width=E(I.width,1),I.height=E(I.height,1),Object.assign(e,I),Ir(r,n,I),(()=>{let F=l-I.x,O=a-I.y,N=(I.width-s)/s,B=(I.height-o)/o;n.forEach((R,S)=>{let A=d[S],j=a-A.y,z={x:E(A.x-(F+(l-A.x)*N),100),y:E(A.y-(O+j*B),100),width:E(A.width+A.width*N,100),height:E(A.height+A.height*B,100)},{id:L,type:Q,size:M,attribute:P}=R;Object.assign(M,z),Object.assign(P,W(Q,M,P)),K(window.document.getElementById(L),P)})})()})()})(v[0][0],v[0][1],p.x,p.y,k),g=!0},end:(p,v)=>{g&&(n.forEach(p=>{let{id:v,size:k,attribute:b}=p,m=u.find(x=>x.id==v);m&&(m.to=JSON.parse(JSON.stringify({id:v,size:k,attribute:b})))}),y.history.push(u))}})},jr=(i,t,e,n)=>{let g,{id:r,type:l,size:a,attribute:s}=e,{x:o,y:d,width:c,height:u,ratios:h}=a,f=(c||1)/(u||1),p=null,b=!1;Nt(i,{start:x=>{p=JSON.parse(JSON.stringify({id:r,size:a,attribute:s}))},move:(x,T,_)=>{((x,T,_,I,F)=>{let O=_-x,N=I-T;switch(t){case"rect-center":g=null!=F&&F.shiftKey?Math.abs(O)>=Math.abs(N)?{x:o+O,y:d,width:c,height:u}:{x:o,y:d+N,width:c,height:u}:{x:o+O,y:d+N,width:c,height:u};break;case"rect-top-left":g=null!=F&&F.shiftKey&&null!=F&&F.altKey?f>=1?{x:o+O,y:d+O/f,width:c-2*O,height:u-2*O/f}:{x:o+N*f,y:d+N,width:c-2*N*f,height:u-2*N}:null!=F&&F.shiftKey?f>=1?{x:o+O,y:d+O/f,width:c-O,height:u-O/f}:{x:o+N*f,y:d+N,width:c-N*f,height:u-N}:null!=F&&F.altKey?{x:o+O,y:d+N,width:c-2*O,height:u-2*N}:{x:o+O,y:d+N,width:c-O,height:u-N};break;case"rect-top-right":g=null!=F&&F.shiftKey&&null!=F&&F.altKey?f>=1?{x:o-O,y:d-O/f,width:c+2*O,height:u+2*O/f}:{x:o+N*f,y:d+N,width:c-2*N*f,height:u-2*N}:null!=F&&F.shiftKey?f>=1?{x:o,y:d-O/f,width:c+O,height:u+O/f}:{x:o,y:d+N,width:c-N*f,height:u-N}:null!=F&&F.altKey?{x:o-O,y:d+N,width:c+2*O,height:u-2*N}:{x:o,y:d+N,width:c+O,height:u-N};break;case"rect-bottom-left":g=null!=F&&F.shiftKey&&null!=F&&F.altKey?f>=1?{x:o+O,y:d+O/f,width:c-2*O,height:u-2*O/f}:{x:o-N*f,y:d-N,width:c+2*N*f,height:u+2*N}:null!=F&&F.shiftKey?f>=1?{x:o+O,y:d,width:c-O,height:u-O/f}:{x:o-N*f,y:d,width:c+N*f,height:u+N}:null!=F&&F.altKey?{x:o+O,y:d-N,width:c-2*O,height:u+2*N}:{x:o+O,y:d,width:c-O,height:u+N};break;case"rect-bottom-right":g=null!=F&&F.shiftKey&&null!=F&&F.altKey?f>=1?{x:o-O,y:d-O/f,width:c+2*O,height:u+2*O/f}:{x:o-N*f,y:d-N,width:c+2*N*f,height:u+2*N}:null!=F&&F.shiftKey?f>=1?{x:o,y:d,width:c+O,height:u+O/f}:{x:o,y:d,width:c+N*f,height:u+N}:null!=F&&F.altKey?{x:o-O,y:d-N,width:c+2*O,height:u+2*N}:{x:o,y:d,width:c+O,height:u+N};break;case"rect-top":g=null!=F&&F.shiftKey?{x:o+N/2*f,y:d+N,width:c-N*f,height:u-N}:null!=F&&F.altKey?{x:o,y:d+N,width:c,height:u-2*N}:{x:o,y:d+N,width:c,height:u-N};break;case"rect-bottom":g=null!=F&&F.shiftKey?{x:o-N/2*f,y:d,width:c+N*f,height:u+N}:null!=F&&F.altKey?{x:o,y:d-N,width:c,height:u+2*N}:{x:o,y:d,width:c,height:u+N};break;case"rect-left":g=null!=F&&F.shiftKey?{x:o+O,y:d+O/2/f,width:c-O,height:u-O/f}:null!=F&&F.altKey?{x:o+O,y:d,width:c-2*O,height:u}:{x:o+O,y:d,width:c-O,height:u};break;case"rect-right":g=null!=F&&F.shiftKey?{x:o,y:d-O/2/f,width:c+O,height:u+O/f}:null!=F&&F.altKey?{x:o-O,y:d,width:c+2*O,height:u}:{x:o,y:d,width:c+O,height:u};break;default:g=t.match(/^point-(\d+)/)?{x:o,y:d,width:c,height:u}:{x:o+O,y:d+N,width:c,height:u}}g.width<=0&&(g.width=1),g.height<=0&&(g.height=1);let B=t.match(/^point-(\d+)/);if(B){let S=parseInt(B[1]);if("number"==typeof S){var R;g.ratios=null==h?void 0:h.map((z,L)=>L==S?[E(z[0]+(0==g.width?0:O/g.width),100),E(z[1]+(0==g.height?0:N/g.height),100)]:z);let A=Xd(g.x,g.y,g.width,g.height,null!==(R=g.ratios)&&void 0!==R?R:[]),J=Yd(A),j=Zd(J.x,J.y,J.width,J.height,A);g={x:J.x,y:J.y,width:J.width,height:J.height,ratios:j}}}g.x=E(g.x,1),g.y=E(g.y,1),g.width=E(g.width,1),g.height=E(g.height,1),Object.assign(a,g),Object.assign(s,W(l,a,s)),K(window.document.getElementById(r),s),an(n,e)})(T[0][0],T[0][1],x.x,x.y,_),b=!0},end:(x,T)=>{b&&p&&y.history.push([{type:"size",from:p,to:JSON.parse(JSON.stringify({id:r,size:a,attribute:s}))}])}})},Xd=(i,t,e,n,r)=>r.map(l=>[i+e*l[0],t+n*l[1]]),Zd=(i,t,e,n,r)=>r.map(l=>[0==e?0:E((l[0]-i)/e,100),0==n?0:E((l[1]-t)/n,100)]),Yd=i=>{let t=[],e=[];i.map(s=>{t.push(s[0]),e.push(s[1])});let n=Math.min.apply(null,t),r=Math.min.apply(null,e);return{x:n,y:r,width:Math.max.apply(null,t)-n||1,height:Math.max.apply(null,e)-r||1}},bt=i=>{i.length>1?(i=>{let t=999999,e=999999,n=-999999,r=-999999;i.forEach(s=>{t=Math.min(t,s.size.x),e=Math.min(e,s.size.y),n=Math.max(n,s.size.x+s.size.width),r=Math.max(r,s.size.y+s.size.height)});let l=G(U.RESIZE_GROUP,"g"),a=pt(t,e,n,r);a.x=E(a.x,100),a.y=E(a.y,100),a.width=E(a.width,100),a.height=E(a.height,100),Ir(l,i,a).forEach(s=>{((i,t,e,n,r)=>{let l=!1;null==i||i.addEventListener("touchstart",a=>{l=!0,Ar({touchEvent:a},t,e,n,r)}),null==i||i.addEventListener("mousedown",a=>{if(0==a.button){if(l)return void(l=!1);Ar({mouseEvent:a},t,e,n,r)}})})(s.element,s.posType,a,i,l)})})(i):1==i.length&&(i=>{let t=G(U.RESIZE_GROUP,"g");if(i.length>0){let e=i[0];an(t,e).forEach(n=>{((i,t,e,n)=>{let r=!1;null==i||i.addEventListener("touchstart",l=>{r=!0,jr({touchEvent:l},t,e,n)}),null==i||i.addEventListener("mousedown",l=>{if(0==l.button){if(r)return void(r=!1);jr({mouseEvent:l},t,e,n)}})})(n.element,n.posType,e,t)})}})(i)},zr=(i,t,e)=>{var n;let{id:r,type:l,source:a}=i;t=null===(n=t)||void 0===n?void 0:n.replace(/<[^>]+>/g,"");let s=JSON.parse(JSON.stringify({id:r,type:l,source:a}));var o,d;if(a)if(a.text){var h,f;a.text.textContent=t,a.text.variableKeywords=null!==(h=(null!==(f=t)&&void 0!==f?f:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==h?h:[]}else{var c,u;a.text={textContent:t,variableKeywords:null!==(c=(null!==(u=t)&&void 0!==u?u:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==c?c:[]}}else a={text:{textContent:t,variableKeywords:null!==(o=(null!==(d=t)&&void 0!==d?d:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==o?o:[]}};e||Ot(window.document.getElementById(r),l,a),y.history.push([{type:"source",from:s,to:JSON.parse(JSON.stringify({id:r,type:l,source:a}))}])},Rr=(i,t,e)=>{var n;let{id:r,type:l,source:a}=i,s=JSON.parse(JSON.stringify({id:r,type:l,source:a})),o=c=>{var u;return null!==(u=(null!=c?c:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==u?u:[]},d=c=>{var u;return(null!==(u=(null!=c?c:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==u?u:[]).filter((f,g,w)=>w.indexOf(f)==g)};a?a.html?(a.html.htmlContent=t,a.html.variableKeywords=o(t),a.html.fillKeywords=d(t)):a.html={htmlContent:t,variableKeywords:o(t),fillKeywords:d(t)}:a={html:{htmlContent:t,variableKeywords:o(t),fillKeywords:d(t)}},"fill"==(null===(n=a.test)||void 0===n?void 0:n.type)&&(a.test.fill=d(t).map(c=>{var u,h;return{key:c,value:null!==(u=null===(h=a)||void 0===h||null===(h=h.test)||void 0===h||null===(h=h.fill)||void 0===h||null===(h=h.find(f=>f.key==c))||void 0===h?void 0:h.value)&&void 0!==u?u:[]}})),e||Ot(window.document.getElementById(r),l,a),y.history.push([{type:"source",from:s,to:JSON.parse(JSON.stringify({id:r,type:l,source:a}))}])},tc=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.link?(r.link.url=t.url,r.link.title=t.title,r.link.description=t.description):r.link=t:r={link:t},Ot(window.document.getElementById(e),n,r),y.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},ec=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.image?(r.image.url=null==t?void 0:t.url,r.image.path=null==t?void 0:t.path,r.image.name=null==t?void 0:t.name,r.image.base64=void 0):r.image=t:r={image:t},Ot(window.document.getElementById(e),n,r),y.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},ic=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.audio?(r.audio.url=t.url,r.audio.path=t.path,r.audio.name=t.name):r.audio=t:r={audio:t},Ot(window.document.getElementById(e),n,r),y.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},nc=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.video?(r.video.url=t.url,r.video.path=t.path,r.video.name=t.name):r.video=t:r={video:t},Ot(window.document.getElementById(e),n,r),y.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},rc=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.file?(r.file.url=t.url,r.file.path=t.path,r.file.name=t.name):r.file=t:r={file:t},Ot(window.document.getElementById(e),n,r),y.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},lc=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.iframe?(r.iframe.url=null==t?void 0:t.url,r.iframe.path=null==t?void 0:t.path,r.iframe.name=null==t?void 0:t.name):r.iframe=t:r={iframe:t},Ot(window.document.getElementById(e),n,r),y.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},ac=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.input?r.input.placeholder=t:r.input={placeholder:t}:r={input:{placeholder:t}},Ot(window.document.getElementById(e),n,r),y.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},oc=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.embed?(r.embed.type=null==t?void 0:t.type,r.embed.oss=null==t?void 0:t.oss,r.embed.name=null==t?void 0:t.name,r.embed.path=null==t?void 0:t.path,r.embed.url=null==t?void 0:t.url):r.embed=t:r={embed:t},Ot(window.document.getElementById(e),n,r),y.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},dc=i=>{var t,e,n,r,l,a,s;let o=(null===(t=i.mouseEvent)||void 0===t?void 0:t.target)||(null===(e=i.touchEvent)||void 0===e?void 0:e.target),d=(null===(n=o)||void 0===n?void 0:n.getAttribute("id"))||"",c=null===(r=o)||void 0===r?void 0:r.nodeName;y.dataSelect.nodeName.includes(c)||(o=jQuery(o).parents("foreignObject").get(0),o&&(d=o.getAttribute("id")||"",c=o.nodeName));let u=(null===(l=o)||void 0===l||null===(l=l.parentNode)||void 0===l?void 0:l.getAttribute("id"))||"";var h,f,g;if([U.RESIZE_GROUP,U.SELECT_GROUP].includes(u))return null===(h=i.mouseEvent)||void 0===h||h.stopPropagation(),null===(f=i.mouseEvent)||void 0===f||f.preventDefault(),void("dblclick"==(null===(g=i.mouseEvent)||void 0===g?void 0:g.type)&&1==y.dataSelect.ids.length&&(i=>{var t,e,n,r,l;if(1!=i.length)return;let a=i[0];if(!(a.type==C.FOREIGNOBJECT&&["html","text"].includes(null!==(t=null===(e=a.source)||void 0===e?void 0:e.type)&&void 0!==t?t:"")||a.type==C.FOREIGNOBJECT&&"test"==(null===(n=a.source)||void 0===n?void 0:n.type)&&["truefalse","singlechoice","multichoice","matching-content","fill"].includes(null!==(r=null===(l=a.source)||void 0===l||null===(l=l.test)||void 0===l?void 0:l.type)&&void 0!==r?r:"")||a.type==C.TEXT))return;y.dataSelect.openEditable();let s=$(`#${a.id}`).find("[contenteditable]");s.on("input",()=>{var d,c,u;"html"==(null===(d=a.source)||void 0===d?void 0:d.type)||"test"==(null===(c=a.source)||void 0===c?void 0:c.type)?Rr(a,s.html(),!0):"text"==(null===(u=a.source)||void 0===u?void 0:u.type)&&zr(a,s.text(),!0)}).on("focusout",()=>{y.dataSelect.closeEditable()}).focus();let o=s.get(0);if(o){let d=document.createRange(),c=window.getSelection();c&&(d.selectNodeContents(o),c.removeAllRanges(),c.addRange(d))}})(y.dataSelect.nodes));if(null!==(a=i.mouseEvent)&&void 0!==a&&a.altKey||null!==(s=i.touchEvent)&&void 0!==s&&s.altKey||!d||d.match(/[^0-9]/)||!y.dataSelect.nodeName.includes(c)){var w;y.dataSelect.ids.length&&(y.dataSelect.ids=[]),(0==(null===(w=i.mouseEvent)||void 0===w?void 0:w.button)||i.touchEvent)&&(i=>{let l=G(U.SCAN_GROUP,"g"),a=pt(0,0,1,1);Oi(l,a),((i,t,e)=>{Nt(i,{start:l=>{},move:(l,a)=>{((l,a,s,o)=>{t=pt(l,a,s,o),Oi(e,t)})(a[0][0],a[0][1],l.x,l.y)},end:(l,a)=>{null==e||e.remove(),y.dataSelect.ids=y.data.getNodeInArea(Math.min(a[0][0],l.x),Math.min(a[0][1],l.y),Math.max(a[0][0],l.x),Math.max(a[0][1],l.y)),bt(y.dataSelect.nodes)}})})(i,a,l)})(i)}else{var p,v;let k=parseFloat(d||"0");if(k==y.dataSelect.contenteditable_id)return;y.dataSelect.ids=null!==(p=i.mouseEvent)&&void 0!==p&&p.shiftKey||null!==(v=i.touchEvent)&&void 0!==v&&v.shiftKey?[k].concat(y.dataSelect.ids).filter((b,m,x)=>x.indexOf(b)==m):[k],bt(y.dataSelect.nodes)}};class uc{constructor(){let{x:t,y:e}=y.screen.dislocation;var n=(r,l,a,s)=>{y.screen.move({x:t,y:e},{x:a-r,y:s-l})};return{start:r=>{},move:(r,l)=>{n(l[0][0],l[0][1],r.x,r.y)},end:(r,l)=>{n(l[0][0],l[0][1],r.x,r.y)}}}}class hc{constructor(){let t=G(U.CREATE_GROUP,"g"),{nodeId:e,element:n,attribute:r,size:l}=$t(Math.ceil(1e9*Math.random())),a=(s,o,d,c)=>{l=pt(s,o,d,c,{ratio:1}),l.x=E(l.x),l.y=E(l.y),l.width=E(l.width),l.height=E(l.height),Object.assign(r,W(C.CIRCLE,l,r)),K(n,r),ee(t,l)};return{start:s=>{a(s.x,s.y,s.x+l.width,s.y+l.height)},move:(s,o)=>{a(o[0][0],o[0][1],s.x,s.y)},end:(s,o)=>{(l.width<=8||l.height<=8)&&(l.width=80,l.height=80,l.x=l.x-l.width/2,l.y=l.y-l.height/2,Object.assign(r,W(C.CIRCLE,l,r)),K(n,r)),y.data.node=Object.assign({id:e,type:C.CIRCLE,name:"Circle"},{size:l,attribute:r}),null==t||t.remove()}}}}class fc{constructor(){let t=G(U.CREATE_GROUP,"g"),{nodeId:e,element:n,attribute:r,size:l}=en(Math.ceil(1e9*Math.random()));var a=(s,o,d,c)=>{l=pt(s,o,d,c),l.x=E(l.x),l.y=E(l.y),l.width=E(l.width),l.height=E(l.height),Object.assign(r,W(C.ELLIPSE,l,r)),K(n,r),ee(t,l)};return{start:s=>{a(s.x,s.y,s.x+l.width,s.y+l.height)},move:(s,o)=>{a(o[0][0],o[0][1],s.x,s.y)},end:(s,o)=>{l.width<4&&(l.width=4),l.height<4&&(l.height=4),l.width+l.height<8&&(l.width=90,l.height=60,l.x=l.x-l.width/2,l.y=l.y-l.height/2,Object.assign(r,W(C.ELLIPSE,l,r)),K(n,r)),y.data.node=Object.assign({id:e,type:C.ELLIPSE,name:"Ellipse"},{size:l,attribute:r}),null==t||t.remove()}}}}class gc{constructor(){let t=G(U.CREATE_GROUP,"g"),{nodeId:e,element:n,attribute:r,size:l}=Yt(Math.ceil(1e9*Math.random()));var a=(s,o,d,c)=>{l=pt(s,o,d,c),l.x=E(l.x),l.y=E(l.y),l.width=E(l.width),l.height=E(l.height),Object.assign(r,W(C.RECT,l,r)),K(n,r),ee(t,l)};return{start:s=>{a(s.x,s.y,s.x+l.width,s.y+l.height)},move:(s,o)=>{a(o[0][0],o[0][1],s.x,s.y)},end:(s,o)=>{l.width<1&&(l.width=1),l.height<1&&(l.height=1),l.width+l.height<8&&(l.width=80,l.height=80,l.x=l.x-l.width/2,l.y=l.y-l.height/2,Object.assign(r,W(C.RECT,l,r)),K(n,r)),y.data.node=Object.assign({id:e,type:C.RECT,name:"Rect"},{size:l,attribute:r}),null==t||t.remove()}}}}class vc{constructor(t){let e=G(U.CREATE_GROUP,"g"),n=t||[[0,0],[1,1],[0,1]],{nodeId:r,element:l,attribute:a,size:s}=rn(Math.ceil(1e9*Math.random()));s.ratios=n;var o=(d,c,u,h)=>{s=pt(d,c,u,h,{ratios:n}),s.x=E(s.x),s.y=E(s.y),s.width=E(s.width),s.height=E(s.height),Object.assign(a,W(C.POLYGON,s,a)),K(l,a),ee(e,s)};return{start:d=>{o(d.x,d.y,d.x+s.width,d.y+s.height)},move:(d,c)=>{o(c[0][0],c[0][1],d.x,d.y)},end:(d,c)=>{s.width<1&&(s.width=1),s.height<1&&(s.height=1),s.width+s.height<8&&(s.width=80,s.height=80,s.x=s.x-s.width/2,s.y=s.y-s.height/2,Object.assign(a,W(C.POLYGON,s,a)),K(l,a)),y.data.node=Object.assign({id:r,type:C.POLYGON,name:"Polygon"},{size:s,attribute:a}),null==e||e.remove()}}}}class yc{constructor(){let t=G(U.CREATE_GROUP,"g"),{nodeId:e,element:n,attribute:r,size:l}=nn(Math.ceil(1e9*Math.random()));return{start:s=>{},move:(s,o)=>{((s,o,d,c)=>{l=pt(s,o,d,c),l.x=E(l.x),l.y=E(l.y),l.width=E(l.width),l.height=E(l.height),Object.assign(r,W(C.LINE,l,r)),K(n,r),ee(t,l)})(o[0][0],o[0][1],s.x,s.y)},end:(s,o)=>{o.length>=2?(l.width<8&&(l.width=0),l.height<8&&(l.height=0),l.width+l.height<8&&(l.width=80,l.height=0,l.x=l.x-l.width/2,l.y=l.y-l.height/2,Object.assign(r,W(C.LINE,l,r)),K(n,r)),y.data.node=Object.assign({id:e,type:C.LINE,name:"Line"},{size:l,attribute:r})):null==n||n.remove(),null==t||t.remove()}}}}class Br{constructor(){let{nodeId:t,element:e,attribute:n,size:r}=te(Math.ceil(1e9*Math.random())),a="";return{start:o=>{a=`M ${o.x} ${o.y} L ${o.x} ${o.y}`},move:(o,d)=>{((o,d)=>{a+=` ${o} ${d}`,e.setAttribute("d",a)})(o.x,o.y)},end:(o,d)=>{let c=Pe(a),{minX:u,minY:h,maxX:f,maxY:g}=Me(c);r.x=u,r.y=h,r.width=f-u||1,r.height=g-h||1,r.ratioMaps=Ke(r,c),y.data.node=Object.assign({id:t,type:C.PATH,name:"Path"},{size:r,attribute:n})}}}}class Lr{constructor(){let t=G(U.CREATE_GROUP,"g"),{nodeId:e,element:n,size:r,attribute:l,style:a,source:s}=Qt(Math.ceil(1e9*Math.random()));var o=(d,c,u,h)=>{r=pt(d,c,u,h),r.x=E(r.x),r.y=E(r.y),r.width=E(r.width),r.height=E(r.height),Object.assign(l,W(C.FOREIGNOBJECT,r,l)),K(n,l),ee(t,r)};return{start:d=>{o(d.x,d.y,d.x+r.width,d.y+r.height)},move:(d,c)=>{o(c[0][0],c[0][1],d.x,d.y)},end:(d,c)=>{(r.width<=16||r.height<=16)&&(r.width=90,r.height=60,r.x=r.x-r.width/2,r.y=r.y-r.height/2,Object.assign(l,W(C.FOREIGNOBJECT,r,l)),K(n,l)),y.data.node=Object.assign({id:e,type:C.FOREIGNOBJECT,name:"ForeignObject"},{size:r,attribute:l,style:a,source:s}),null==t||t.remove()}}}}class Pr{constructor(){var t,e;let n=G(U.CREATE_GROUP,"g"),{nodeId:r,element:l,size:a,attribute:s,source:o}=Vt(Math.ceil(1e9*Math.random())),d=1;(u=>{if(!u)return;let h=new Image;h.onload=()=>{d=E(h.naturalWidth/h.naturalHeight,100)},h.onerror=f=>{console.error(`ImgSrc load failed -> ${u}`,f)},h.src=u})(null!==(t=null===(e=o.image)||void 0===e?void 0:e.url)&&void 0!==t?t:"");var c=(u,h,f,g)=>{a=pt(u,h,f,g,{ratio:d}),a.x=E(a.x),a.y=E(a.y),a.width=E(a.width),a.height=E(a.height),Object.assign(s,W(C.IMAGE,a,s)),K(l,s),ee(n,a)};return{start:u=>{c(u.x,u.y,u.x+a.width,u.y+a.height)},move:(u,h)=>{c(h[0][0],h[0][1],u.x,u.y)},end:(u,h)=>{(a.width<=16||a.height<=16)&&(a.width=80,a.height=80,a.x=a.x-a.width/2,a.y=a.y-a.height/2,Object.assign(s,W(C.IMAGE,a,s)),K(l,s)),y.data.node=Object.assign({id:r,type:C.IMAGE,name:"Image"},{size:a,attribute:s,source:o}),null==n||n.remove()}}}}re.config({driver:[re.INDEXEDDB,re.LOCALSTORAGE,re.WEBSQL],name:"_localDataDB",version:1});const Ct={create:(i=(0,Ut.A)(function*(){return dl}),function(){return i.apply(this,arguments)}),get:function(){var i=(0,Ut.A)(function*(t){return re.getItem(t)});return function(e){return i.apply(this,arguments)}}(),set:function(){var i=(0,Ut.A)(function*(t,e){return re.setItem(t,e)});return function(e,n){return i.apply(this,arguments)}}()},mc=function(){var i=(0,Ut.A)(function*(t){yield Ct.create();var e=(yield Ct.get("icdt-data"))||[];"function"==typeof t.callback&&t.callback(e)});return function(e){return i.apply(this,arguments)}}(),wc=function(){var i=(0,Ut.A)(function*(t){yield Ct.create(),t.params=t.params||{};try{yield Ct.set("icdt-data",t.params),"function"==typeof t.callback&&t.callback(t.params)}catch(e){"function"==typeof t.callback&&t.callback(null),console.error(e)}});return function(e){return i.apply(this,arguments)}}(),bc=function(){var i=(0,Ut.A)(function*(t){yield Ct.create();try{var e=(yield Ct.get("icdt-config"))||{};"function"==typeof t.callback&&t.callback(e)}catch(n){"function"==typeof t.callback&&t.callback(null),console.error(n)}});return function(e){return i.apply(this,arguments)}}(),xc=function(){var i=(0,Ut.A)(function*(t){yield Ct.create(),t.params=t.params||{};try{yield Ct.set("icdt-config",t.params),"function"==typeof t.callback&&t.callback(t.params)}catch(e){"function"==typeof t.callback&&t.callback(null),console.error(e)}});return function(e){return i.apply(this,arguments)}}(),Mr=function(){var i=(0,Ut.A)(function*(t){yield Ct.create();try{var e=(yield Ct.get("icdt-clipboard"))||{};"function"==typeof t.callback&&t.callback(e)}catch(n){"function"==typeof t.callback&&t.callback(null),console.error(n)}});return function(e){return i.apply(this,arguments)}}(),Kr=function(){var i=(0,Ut.A)(function*(t){yield Ct.create(),t.params=t.params||{};try{yield Ct.set("icdt-clipboard",t.params),"function"==typeof t.callback&&t.callback(t.params)}catch(e){"function"==typeof t.callback&&t.callback(null),console.error(e)}});return function(e){return i.apply(this,arguments)}}(),Jt=(i,t,e)=>{var n;if(t&&!(null!=e?e:window).document.getElementById(t))return;if(t){let l=(null!=e?e:window).document.getElementById(t);jQuery(l).find("#"+U.BACKGROUND_GROUP).empty();let a=G(U.BACKGROUND_GROUP,"g",void 0,l);Ee(a,i)}else{jQuery(y.target).find("#"+U.BACKGROUND_GROUP).empty();let l=G(U.BACKGROUND_GROUP,"g",void 0,y.target);Ee(l,i)}let r=(l,a)=>{a=t&&a?`${t}-${a}`:null!=t?t:a,null==l||l.forEach(s=>{let o=t?`${t}-${s.id}`:s.id;var d;if(s.isdeleted)null===(d=(null!=e?e:window).document.getElementById(o))||void 0===d||d.remove();else switch(s.type){case C.GROUP:Ge(o,{},a?(null!=e?e:window).document.getElementById(a):null),r(s.nodes,s.id);break;case C.CIRCLE:$t(o,{size:s.size,attribute:s.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case C.ELLIPSE:en(o,{size:s.size,attribute:s.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case C.LINE:nn(o,{size:s.size,attribute:s.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case C.RECT:Yt(o,{size:s.size,attribute:s.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case C.POLYGON:rn(o,{size:s.size,attribute:s.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case C.POLYLINE:Tr(o,{size:s.size,attribute:s.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case C.FOREIGNOBJECT:Qt(o,{size:s.size,attribute:s.attribute,style:s.style,source:s.source},a?(null!=e?e:window).document.getElementById(a):null);break;case C.IMAGE:Vt(o,{size:s.size,attribute:s.attribute,source:s.source},a?(null!=e?e:window).document.getElementById(a):null);break;case C.TEXT:Oe(o,{size:s.size,attribute:s.attribute,source:s.source},a?(null!=e?e:window).document.getElementById(a):null);break;case C.TSPAN:Fr(o,{size:s.size,attribute:s.attribute,source:s.source},a?(null!=e?e:window).document.getElementById(a):null);break;case C.PATH:te(o,{size:s.size,attribute:s.attribute},a?(null!=e?e:window).document.getElementById(a):null)}})};r(null==i||null===(n=i.svg)||void 0===n?void 0:n.nodes)},Ei=(i,t)=>{var e;if(t&&!window.document.getElementById(t))return;let n=(r,l)=>{l=l?`${t}-${l}`:t,null==r||r.forEach(a=>{jQuery("#"+(t?`${t}-${a.id}`:a.id)).appendTo(l?window.document.getElementById(l):y.target),a.type==C.GROUP&&n(a.nodes,a.id)})};n(null==i||null===(e=i.svg)||void 0===e?void 0:e.nodes)},on=(i,t)=>{let{id:e,type:n,size:r,attribute:l}=i,a=JSON.parse(JSON.stringify({id:e,size:r,attribute:l}));r.x=E(t||0),Object.assign(l,W(n,r,l)),K(window.document.getElementById(e),l),y.history.push([{type:"size",from:a,to:JSON.parse(JSON.stringify({id:e,size:r,attribute:l}))}])},sn=(i,t)=>{let{id:e,type:n,size:r,attribute:l}=i,a=JSON.parse(JSON.stringify({id:e,size:r,attribute:l}));r.y=E(t||0),Object.assign(l,W(n,r,l)),K(window.document.getElementById(e),l),y.history.push([{type:"size",from:a,to:JSON.parse(JSON.stringify({id:e,size:r,attribute:l}))}])},kc=(i,t,e)=>{let{id:n,type:r,size:l,attribute:a}=i;t<=0&&(t=1);let s=JSON.parse(JSON.stringify({id:n,size:l,attribute:a}));e&&(l.height=E(t*l.height/(l.width||1))),l.width=E(t),Object.assign(a,W(r,l,a)),K(window.document.getElementById(n),a),y.history.push([{type:"size",from:s,to:JSON.parse(JSON.stringify({id:n,size:l,attribute:a}))}])},Sc=(i,t,e)=>{let{id:n,type:r,size:l,attribute:a}=i;t<=0&&(t=1);let s=JSON.parse(JSON.stringify({id:n,size:l,attribute:a}));e&&(l.width=E(t*l.width/(l.height||1))),l.height=E(t),Object.assign(a,W(r,l,a)),K(window.document.getElementById(n),a),y.history.push([{type:"size",from:s,to:JSON.parse(JSON.stringify({id:n,size:l,attribute:a}))}])},Oc=(i,t)=>{let{id:e,type:n,size:r,attribute:l}=i,a=JSON.parse(JSON.stringify({id:e,size:r,attribute:l}));r.rotate="number"==typeof t?E(t,100):void 0,Object.assign(l,W(n,r,l)),K(window.document.getElementById(e),l),y.history.push([{type:"size",from:a,to:JSON.parse(JSON.stringify({id:e,size:r,attribute:l}))}])};var i;const Gr=new class Nc{constructor(){this._fnChanges=[],this.onchange={type:"keydown",key:at.Escape,fn:()=>{y.dataSelect.ids.length&&(y.dataSelect.ids=[])}},this.onchange={type:"keydown",key:at.Delete,fn:()=>{y.dataSelect.deleteNode()}},this.onchange={type:"keydown",key:at.Space,fn:()=>{y.pointer.pointer_type_temp=et.HAND}},this.onchange={type:"keyup",key:at.Space,fn:()=>{y.pointer.pointer_type_temp=et.POINTER}},this.onchange={type:"keydown",key:at.ArrowLeft,fn:()=>{y.dataSelect.ids.length||y.data.backSlide()}},this.onchange={type:"keydown",key:at.ArrowRight,fn:()=>{y.dataSelect.ids.length||y.data.nextSlide()}},this.onchange={type:"keydown",key:at.PageDown,fn:()=>{y.dataSelect.ids.length||y.data.backSlide()}},this.onchange={type:"keydown",key:at.PageUp,fn:()=>{y.dataSelect.ids.length||y.data.nextSlide()}},this.onchange={type:"keydown",key:at.ArrowLeft,fn:()=>{y.dataSelect.ids.length&&(y.dataSelect.nodes.forEach(t=>{on(t,E(t.size.x-H(1)))}),bt(y.dataSelect.nodes))}},this.onchange={type:"keydown",key:at.ArrowRight,fn:()=>{y.dataSelect.ids.length&&(y.dataSelect.nodes.forEach(t=>{on(t,E(t.size.x+H(1)))}),bt(y.dataSelect.nodes))}},this.onchange={type:"keydown",key:at.ArrowUp,fn:()=>{y.dataSelect.ids.length&&(y.dataSelect.nodes.forEach(t=>{sn(t,E(t.size.y-H(1)))}),bt(y.dataSelect.nodes))}},this.onchange={type:"keydown",key:at.ArrowDown,fn:()=>{y.dataSelect.ids.length&&(y.dataSelect.nodes.forEach(t=>{sn(t,E(t.size.y+H(1)))}),bt(y.dataSelect.nodes))}},this.onchange={type:"keydown",key:at.Digit1,fn:t=>{t.shiftKey&&(y.reloadView(),y.screen.zoomTo="fit")}},this.onchange={type:"keydown",key:at.Digit0,fn:t=>{t.ctrlKey&&(y.screen.zoomTo=100)}},this.onchange={type:"keydown",key:at.Equal,fn:t=>{t.ctrlKey&&y.screen.zoomIn()}},this.onchange={type:"keydown",key:at.Minus,fn:t=>{t.ctrlKey&&y.screen.zoomOut()}},this.onchange={type:"keydown",key:at.KeyA,fn:t=>{t.ctrlKey&&(y.dataSelect.ids=y.data.getNodeAll(),bt(y.dataSelect.nodes))}},this.onchange={type:"keydown",key:at.KeyC,fn:t=>{if(t.ctrlKey){let e=y.dataSelect.nodes;e&&Kr({params:{type:"nodes",nodes:e}})}}},this.onchange={type:"keydown",key:at.KeyV,fn:t=>{t.ctrlKey&&Mr({callback:e=>{var n,r;"nodes"==(null==e?void 0:e.type)&&null!=e&&null!==(n=e.nodes)&&void 0!==n&&n.length&&(null==e||null===(r=e.nodes)||void 0===r||r.forEach(l=>{t.shiftKey||y.data.findNode(l.id).id&&(l.size.x+=16,l.size.y+=16),l.id=Math.ceil(1e9*Math.random()),y.data.node=l}),Jt(y.data.slide))}})}},this.onchange={type:"keydown",key:at.KeyZ,fn:t=>{t.ctrlKey&&t.shiftKey?y.history.redo():t.ctrlKey&&y.history.undo()}},this.onchange={type:"keydown",key:at.BracketLeft,fn:t=>{t.ctrlKey&&t.shiftKey?y.data.sendToBack(y.dataSelect.ids):t.ctrlKey?y.data.sendToBackStep(y.dataSelect.ids,-2):y.data.sendToBackArea(y.dataSelect.ids)}},this.onchange={type:"keydown",key:at.BracketRight,fn:t=>{t.ctrlKey&&t.shiftKey?y.data.bringToFront(y.dataSelect.ids):t.ctrlKey?y.data.bringToFrontStep(y.dataSelect.ids,1):y.data.bringToFrontArea(y.dataSelect.ids)}}}set onchange(t){let e=this._fnChanges.find(n=>n.eventType==t.type&&n.eventKey==t.key);e?e.fns.push(t.fn):this._fnChanges.push({eventType:t.type,eventKey:t.key,fns:[t.fn]})}change(t,e,n){var r;y.dataSelect.contenteditable_id||null===(r=this._fnChanges.find(l=>l.eventType==t&&l.eventKey==e))||void 0===r||r.fns.forEach(l=>l(n))}},Qr=i=>{Gr.change(i.type,i.keyCode||i.which||i.charCode||0,i)};class Ec{constructor(){let t={stroke:y.attribute.stroke,strokeWidth:y.attribute.strokeWidth,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:e,element:n,attribute:r,size:l}=te(Math.ceil(1e9*Math.random()),{attribute:t});K(n,r);let a="",s="";return{start:d=>{a=`M ${d.x} ${d.y} L ${d.x} ${d.y}`},move:(d,c)=>{((d,c)=>{a+=` ${d} ${c}`,n.setAttribute("d",a)})(d.x,d.y)},end:(d,c)=>{var u;c.length>=3?(s=null!==(u=fr().x(k=>k[0]).y(k=>k[1]).curve(yr)(c))&&void 0!==u?u:"",n.setAttribute("d",s)):n.setAttribute("d",a);let h=Pe(s||a),{minX:f,minY:g,maxX:w,maxY:p}=Me(h);l.x=f,l.y=g,l.width=w-f||1,l.height=p-g||1,l.ratioMaps=Ke(l,h),y.data.node=Object.assign({id:e,type:C.PATH,name:"Path"},{size:l,attribute:r})}}}}class _c{constructor(){let t={stroke:y.attribute.stroke,strokeOpacity:.4,strokeWidth:y.attribute.strokeWidth,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:e,element:n,attribute:r,size:l}=te(Math.ceil(1e9*Math.random()),{attribute:t});K(n,r);let a="";return{start:d=>{a=`M ${d.x} ${d.y} L ${d.x} ${d.y}`},move:(d,c)=>{((d,c)=>{a+=` ${d} ${c}`,n.setAttribute("d",a)})(d.x,d.y)},end:(d,c)=>{let u=Pe(a),{minX:h,minY:f,maxX:g,maxY:w}=Me(u);l.x=h,l.y=f,l.width=g-h||1,l.height=w-f||1,l.ratioMaps=Ke(l,u),y.data.node=Object.assign({id:e,type:C.PATH,name:"Path"},{size:l,attribute:r})}}}}class Dr{constructor(t,e){var n,r;let l={stroke:"#FF0000",strokeWidth:H(2),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:H(8)},{element:a}=te(Math.ceil(1e9*Math.random()),{size:e});window.document.getElementById(U.INTERACTIVE_GROUP).querySelectorAll("path").forEach(f=>null==f?void 0:f.remove()),window.document.getElementById(U.INTERACTIVE_GROUP).querySelectorAll("circle").forEach(f=>null==f?void 0:f.remove()),null===(n=window.document.getElementById(U.INTERACTIVE_GROUP))||void 0===n||n.appendChild(a);var d=f=>{if(!f.length)return;let g=[];if(1==f.length){var w;let{size:p}=null!==(w=null!=t?t:y.dataSelect.nodes[0])&&void 0!==w?w:{};if(!p)return;g=[[p.x+p.width/2,p.y+p.height/2],f[0]]}else g=[...f];u(g),c(g[0],"start"),c(g[g.length-1],"end")},c=(f,g)=>{f&&((w=>{let{element:p}=$t(Math.ceil(1e9*Math.random()),{attribute:{fill:"start"==g?"#FF0000":"#00BA00",strokeWidth:H(1)},size:{x:f[0]-5,y:f[1]-5,width:10,height:10}});null===(w=window.document.getElementById(U.INTERACTIVE_GROUP))||void 0===w||w.prepend(p)})(),((w,p)=>{let{size:v}=null!==(w=null!=t?t:y.dataSelect.nodes[0])&&void 0!==w?w:{};if(!v)return;let k=[[f[0]-v.width/2,f[1]-v.height/2],[f[0]+v.width/2,f[1]-v.height/2],[f[0]+v.width/2,f[1]+v.height/2],[f[0]-v.width/2,f[1]+v.height/2],[f[0]-v.width/2,f[1]-v.height/2]],{element:b}=te(Math.ceil(1e9*Math.random()),{attribute:{fill:"#FFFFFF",fillOpacity:.6,stroke:"#5f6ce1",strokeWidth:H(1),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:H(8)},size:{x:0,y:0,width:10,height:10,points:k}});null===(p=window.document.getElementById(U.INTERACTIVE_GROUP))||void 0===p||p.prepend(b)})())},u=f=>{let w=fr().x(p=>p[0]).y(p=>p[1]).curve(yr)(f);a.setAttribute("d",w)};K(a,l),d(null!==(r=null==e?void 0:e.points)&&void 0!==r?r:[]);let h="";return{start:f=>{h=`M ${f.x} ${f.y} L ${f.x} ${f.y}`},move:(f,g)=>{h+=` ${f.x} ${f.y}`,a.setAttribute("d",h)},end:(f,g)=>{d(g),g.length&&(window.interactivePoints=g)}}}}const Ur=i=>{var t,e;((i,t)=>{H(-1),H(1),H(8),G("icdt-temp-interactive-rect-center","rect",{attribute:Object.assign({x:t.x,y:t.y,width:t.width,height:t.height,class:"cursor-draw"},{fill:"transparent"})},i)})(G(U.INTERACTIVE_GROUP,"g"),null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:(()=>{let{width:l,height:a}=y.screen.get;return{x:0,y:0,width:l,height:a}})()),i&&Nt(i,new Dr)};function fe(i,t,e,n){return Math.sqrt(Math.pow(e-i,2)+Math.pow(n-t,2))}function De(i,t,e,n,r){return fe(i,t,e,n)<r?1:0}function dn(i,t,e,n,r,l,a){var s=[];return s.push(De(i,t,e,n,a)),s.push(De(i,t,r,l,a)),s.push(function Jc(i,t,e,n,r,l,a){var s=[r-e,l-n],o=[i-e,t-n],d=[-s[1],s[0]],c=Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)),u=[d[0]/c,d[1]/c],h=Math.sqrt(Math.pow(s[0],2)+Math.pow(s[1],2)),f=[s[0]/h,s[1]/h],g=o[0]*f[0]+o[1]*f[1];if(g<=0||g>=h)return 0;var w=o[0]*u[0]+o[1]*u[1];return w>=a||w<=-a?0:1}(i,t,e,n,r,l,a)),s}function Hr(i,t,e,n,r){var l=[e-i,n-t],a=[-l[1],l[0]],s=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)),o=[a[0]/s,a[1]/s];return[[i+r*o[0],t+r*o[1]],[i-r*o[0],t-r*o[1]],[e-r*o[0],n-r*o[1]],[e+r*o[0],n+r*o[1]]]}function _e(i,t,e,n,r,l,a){var g,s=[r-i,l-t],o=[e-i,n-t],d=Math.sqrt(Math.pow(o[0],2)+Math.pow(o[1],2)),c=[o[0]/d,o[1]/d],u=s[0]*c[0]+s[1]*c[1],h=[i+u*c[0],t+u*c[1]],f=Math.sqrt(Math.pow(r-h[0],2)+Math.pow(l-h[1],2));g=0===f?a:Math.sqrt(Math.pow(a,2)-Math.pow(f,2));var w=[i+u*c[0]+g*c[0],t+u*c[1]+g*c[1]];return w[0]===i&&w[1]===t?null:w}function ge(i,t,e,n,r,l,a){var s=[r-i,l-t],o=[e-i,n-t],d=[-o[1],o[0]],c=Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)),u=[d[0]/c,d[1]/c],h=s[0]*u[0]+s[1]*u[1],f=jc([i,t],[e,n],[r,l]);if(qr([f[0]-r,f[1]-l])>=a)return null;var w=Math.sqrt(Math.pow(a,2)-Math.pow(h,2)),p=[r-h*u[0],l-h*u[1]],v=Math.sqrt(Math.pow(o[0],2)+Math.pow(o[1],2)),k=[o[0]/v,o[1]/v],b=[[p[0]-k[0]*w,p[1]-k[1]*w],[p[0]+k[0]*w,p[1]+k[1]*w]];return b[0][0]===i&&b[0][1]===t?null:b}function Dt(i,t,e,n,r,l,a,s){var o,d,c,u,h,f;return-(c=a-r)*(d=n-t)+(o=e-i)*(u=s-l)==0?null:(f=(c*(t-l)-u*(i-r))/(-c*d+o*u),(h=(-d*(i-r)+o*(t-l))/(-c*d+o*u))>=0&&h<=1&&f>=0&&f<=1?[i+f*o,t+f*d]:null)}function Wr(i,t,e,n,r,l,a,s,o,d){var c=Hr(l,a,s,o,d),u=[];if(e[0]&&!e[1])u.push(_e(i,t,n,r,l,a,d)),u.push(Dt(i,t,n,r,c[0][0],c[0][1],c[3][0],c[3][1])),u.push(Dt(i,t,n,r,c[1][0],c[1][1],c[2][0],c[2][1])),(h=ge(i,t,n,r,s,o,d))&&u.push(h[0],h[1]);else if(!e[0]&&e[1])u.push(_e(i,t,n,r,s,o,d)),u.push(Dt(i,t,n,r,c[0][0],c[0][1],c[3][0],c[3][1])),u.push(Dt(i,t,n,r,c[1][0],c[1][1],c[2][0],c[2][1])),(h=ge(i,t,n,r,l,a,d))&&u.push(h[0],h[1]);else if(e[0]&&e[1])u.push(_e(i,t,n,r,l,a,d)),u.push(Dt(i,t,n,r,c[0][0],c[0][1],c[3][0],c[3][1])),u.push(Dt(i,t,n,r,c[1][0],c[1][1],c[2][0],c[2][1])),u.push(_e(i,t,n,r,s,o,d));else{var h=ge(i,t,n,r,s,o,d),f=ge(i,t,n,r,l,a,d);h&&u.push(h[0],h[1]),f&&u.push(f[0],f[1]),u.push(Dt(i,t,n,r,c[0][0],c[0][1],c[3][0],c[3][1])),u.push(Dt(i,t,n,r,c[1][0],c[1][1],c[2][0],c[2][1]))}for(var g=[i,t],w=0;w<u.length;w++)u[w]&&fe(u[w][0],u[w][1],n,r)<fe(g[0],g[1],n,r)&&(g=u[w]);return g[0]===i&&g[1]===t?null:g}function Ic(i,t,e,n,r,l,a,s,o){var d=Hr(r,l,a,s,o),c=[],u=ge(i,t,e,n,r,l,o);u&&c.push(u[0],u[1]),(u=ge(i,t,e,n,a,s,o))&&c.push(u[0],u[1]),c.push(Dt(i,t,e,n,d[0][0],d[0][1],d[3][0],d[3][1])),c.push(Dt(i,t,e,n,d[1][0],d[1][1],d[2][0],d[2][1]));for(var h=[e,n],f=[i,t],g=0;g<c.length;g++)c[g]&&fe(c[g][0],c[g][1],i,t)<fe(h[0],h[1],i,t)&&(h=c[g]);for(var w=0;w<c.length;w++)c[w]&&fe(c[w][0],c[w][1],e,n)<fe(f[0],f[1],e,n)&&(f=c[w]);return h[0]===e&&h[1]===n||f[0]===i&&f[1]===t?null:[h,f]}var qr=function(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])},jc=function(i,t,e){var n=[t[0]-i[0],t[1]-i[1]],r=qr(n);if(r<1e-6)return i;var l=[e[0]-i[0],e[1]-i[1]],a=(n[0]*l[0]+n[1]*l[1])/r;return a<0?i:a>r?t:[i[0]+n[0]*a/r,i[1]+n[1]*a/r]};class zc{constructor(){let{element:n,size:l}=te(Math.ceil(1e9*Math.random()));K(n,{stroke:"#ddd",strokeWidth:10,strokeLinecap:"round",strokeLinejoin:"round"});let a="";return{start:d=>{a=`M ${d.x} ${d.y} L ${d.x} ${d.y}`},move:(d,c)=>{((d,c)=>{a+=` ${d} ${c}`,n.setAttribute("d",a)})(d.x,d.y)},end:(d,c)=>{n.remove(),(d=>{let c=9999,u=9999,h=-9999,f=-9999;d.forEach(w=>{c=Math.min(c,w[0]),u=Math.min(u,w[1]),h=Math.max(h,w[0]),f=Math.max(f,w[1])}),l=pt(c,u,h,f,{points:d}),y.data.getNodeInArea(0,0,1920,1920,C.PATH).forEach(w=>{let v=((i,t,e)=>{e=e||20;var n=[],r=function(c){var u=t[0][0],h=t[0][1],f=0,g=0;if(1!==c.length||De(c[0][0],c[0][1],u,h,e)){for(var w;f<c.length-1;){var p=c[f],v=c[f+1],k=De(p[0],p[1],u,h,e),b=De(v[0],v[1],u,h,e);if(k&&b)g=++f;else if(k&&!b)(m=_e(p[0],p[1],v[0],v[1],u,h,e))?(c[f]=m,g=f):f++;else if(!k&&b){var m;(m=_e(v[0],v[1],p[0],p[1],u,h,e))&&((w=c.slice(g,f+1)).push(m),n.push(w)),g=++f}else{var x=ge(p[0],p[1],v[0],v[1],u,h,e);x?(((w=c.slice(g,f+1))[w.length-1][0]!==x[0][0]||w[w.length-1][1]!==x[0][1])&&w.push(x[0]),w.length>1&&n.push(w),c[f]=x[1],c[f+1]&&c[f+1][0]==x[1][0]&&c[f+1][1]==x[1][1]&&f++,g=f):f++}}g!==f&&(w=c.slice(g,c.length))&&n.push(w)}else n.push(c)},l=function(c,u){var v,h=t[u],f=t[u+1],g=0,w=0;if(1!==c.length||-1!==(p=dn(c[0][0],c[0][1],h[0],h[1],f[0],f[1],e)).indexOf(1)){for(;g<c.length-1;){var k=c[g],b=c[g+1],p=dn(k[0],k[1],h[0],h[1],f[0],f[1],e),m=dn(b[0],b[1],h[0],h[1],f[0],f[1],e);if(-1!==p.indexOf(1)&&-1!==m.indexOf(1))w=++g;else if(-1!==p.indexOf(1)&&-1===m.indexOf(1))(x=Wr(k[0],k[1],p,b[0],b[1],h[0],h[1],f[0],f[1],e))?(c[g]=x,w=g):g++;else if(-1===p.indexOf(1)&&-1!==m.indexOf(1)){var x;(x=Wr(b[0],b[1],m,k[0],k[1],h[0],h[1],f[0],f[1],e))?((v=c.slice(w,g+1)).push(x),n.push(v),w=++g):g++}else{var T=Ic(k[0],k[1],b[0],b[1],h[0],h[1],f[0],f[1],e);T?(((v=c.slice(w,g+1))[v.length-1][0]!==T[0][0]||v[v.length-1][1]!==T[0][1])&&v.push(T[0]),v.length>1&&n.push(v),c[g]=T[1],c[g+1]&&c[g+1][0]==T[1][0]&&c[g+1][1]==T[1][1]&&g++,w=g):g++}}w!==g&&(v=c.slice(w,c.length))&&n.push(v)}else n.push(c)};if(t=function Cc(i){var t=[];if(1===i.length)t=i;else{for(var e=0;e<i.length-1;)(i[e][0]!==i[e+1][0]||i[e][1]!==i[e+1][1])&&t.push(i[e]),e++;0!==i.length&&0===t.length&&t.push(i[0]),(i[i.length-1][0]!==i[t.length-1][0]||i[i.length-1][1]!==i[t.length-1][1])&&t.push(i[e])}return t}(t),1===t.length){for(var a=0;a<i.length;a++)r(i[a]);i=n}else for(var s=0;s<t.length-1;s++){for(a=0;a<i.length;a++)l(i[a],s);i=n,n=[]}for(var o=0;o<i.length;o++)for(var d=0;d<i[o].length;d++)i[o][d][0]=Math.round(i[o][d][0]),i[o][d][1]=Math.round(i[o][d][1]);return i})(y.data.getNode(w).size.points,d,2);console.log(v)})})(c)}}}}class Bc{constructor(){let t=G(U.CREATE_GROUP,"g"),{nodeId:e,element:n,attribute:r,size:l,source:a}=Oe(Math.ceil(1e9*Math.random())),s=(o,d,c,u)=>{l=pt(o,d,c,u),l.x=E(l.x),l.y=E(l.y),l.width=E(l.width),l.height=E(l.height),Object.assign(r,W(C.TEXT,l,r)),K(n,r),ee(t,l)};return{start:o=>{s(o.x,o.y,o.x+l.width,o.y+l.height)},move:(o,d)=>{s(d[0][0],d[0][1],o.x,o.y)},end:(o,d)=>{l.width<100&&(l.width=100),l.height<20&&(l.height=20),l.width+l.height<8&&(l.width=100,l.height=20,l.x=l.x-l.width/2,l.y=l.y-l.height/2,Object.assign(r,W(C.TEXT,l,r)),K(n,r)),y.data.node=Object.assign({id:e,type:C.TEXT,name:"Text"},{size:l,attribute:r,source:a}),null==t||t.remove()}}}}const Qc=i=>{var t,e,n,r;let l=(null===(t=i.mouseEvent)||void 0===t?void 0:t.target)||(null===(e=i.touchEvent)||void 0===e?void 0:e.target),a=(null==l?void 0:l.getAttribute("id"))||"",s=null==l?void 0:l.nodeName,o=jQuery(l).parents("g[id]").attr("id")||"";if(![U.INDEX_GROUP].includes(o))if(null!==(n=i.mouseEvent)&&void 0!==n&&n.altKey||null!==(r=i.touchEvent)&&void 0!==r&&r.altKey||!a||a.match(/[^0-9]/)||!y.dataSelect.nodeName.includes(s)){var d;y.dataSelect.ids.length&&(y.dataSelect.ids=[]),(0==(null===(d=i.mouseEvent)||void 0===d?void 0:d.button)||i.touchEvent)&&((i,t)=>{let a=G(U.SCAN_GROUP,"g"),s=pt(0,0,1,1);Oi(a,s),((i,t,e,n)=>{Nt(i,{start:a=>{},move:(a,s)=>{((a,s,o,d)=>{t=pt(a,s,o,d),Oi(e,t)})(s[0][0],s[0][1],a.x,a.y)},end:(a,s)=>{null==e||e.remove(),y.dataSelect.ids=y.data.getNodeInArea(Math.min(s[0][0],a.x),Math.min(s[0][1],a.y),Math.max(s[0][0],a.x),Math.max(s[0][1],a.y)),n(y.dataSelect.nodes)}})})(i,s,a,t)})(i,Xr)}else{var c,u;let h=parseFloat(a||"0");y.dataSelect.ids=null!==(c=i.mouseEvent)&&void 0!==c&&c.shiftKey||null!==(u=i.touchEvent)&&void 0!==u&&u.shiftKey?[h].concat(y.dataSelect.ids).filter((g,w,p)=>p.indexOf(g)==w):[h],Xr(y.dataSelect.nodes)}},Xr=i=>{var t,e;let n=1;var r,l;if(i.length&&(n=Math.max.apply(null,null!==(r=null===(l=y.data.slide)||void 0===l||null===(l=l.svg)||void 0===l?void 0:l.nodes.map(s=>{var o;return null!==(o=s.idx)&&void 0!==o?o:0}))&&void 0!==r?r:[0])+1),1==i.length)i[0].idx||(i[0].idx=n,i[0].time=0);else if(i.length>=0){let s=i.map(d=>{var c;return null!==(c=d.idx)&&void 0!==c?c:0}).filter(d=>d>0),o=s.length?Math.min.apply(null,s):n;i.forEach(d=>{var c;d.idx=o,d.time=null!==(c=d.time)&&void 0!==c?c:0})}let a=G(U.INDEX_GROUP,"g");Ni(a,null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.nodes)&&void 0!==t?t:[])},Dc=i=>{var t,e,n;null!=i&&null!==(t=i.svg)&&void 0!==t&&t.nodes&&i.svg.nodes.forEach(l=>{l.idx=0,l.time=null});let r=G(U.INDEX_GROUP,"g");Ni(r,null!==(e=null===(n=y.data.slide)||void 0===n||null===(n=n.svg)||void 0===n?void 0:n.nodes)&&void 0!==e?e:[])};class Zr{constructor(){this._nodeName=["circle","ellipse","line","polygon","polyline","rect","text","tspan","path","image","foreignObject"],this._selected_Ids=[],this._contenteditable_Id=0,this._fnChanges=[]}get nodeName(){return this._nodeName}get ids(){return this._selected_Ids}set ids(t){this._selected_Ids=t,this.closeEditable(),this.change(this.ids)}get contenteditable_id(){return this._contenteditable_Id}get nodes(){return this._selected_Ids.map(t=>y.data.getNode(t)).filter(t=>!t.isfake)}set onchange(t){this._fnChanges.push(t)}change(t){this.cleanSelected(),this._fnChanges.forEach(e=>e(t))}deleteNode(){for(let t of this._selected_Ids){let e=y.data.deleteNode(t);y.history.push([{type:"delete",from:{id:e},to:{id:e}}])}y.dataSelect.ids=[]}groupNode(){let t=[];if(y.dataSelect.ids.length>=2){let e=y.data.getNode(y.dataSelect.ids[0]),{nodeId:n,attribute:r,size:l}=Ge(Math.ceil(1e9*Math.random()),void 0,e.pid?window.document.getElementById(e.pid):null);y.data.node=Object.assign({id:n,type:C.GROUP,name:"G"},{size:l,attribute:r});for(let a of y.dataSelect.ids)t.push(y.data.addGroup(a,n))}t.length&&(y.dataSelect.ids=t,bt(y.dataSelect.nodes))}ungroupNode(){let t=[];for(let e of y.dataSelect.ids)t.push(y.data.unGroup(e));t.length&&(y.dataSelect.ids=t,bt(y.dataSelect.nodes))}cleanSelected(){var t,e,n,r,l;null===(t=window.document.getElementById(U.RESIZE_GROUP))||void 0===t||t.remove(),null===(e=window.document.getElementById(U.SELECT_GROUP))||void 0===e||e.remove(),null===(n=window.document.getElementById(U.SCAN_GROUP))||void 0===n||n.remove(),null===(r=window.document.getElementById(U.CREATE_GROUP))||void 0===r||r.remove(),null===(l=window.document.getElementById(U.INTERACTIVE_GROUP))||void 0===l||l.remove(),jQuery('[id^="icdt-temp-"]').remove()}openEditable(){1==this._selected_Ids.length&&(this._contenteditable_Id=this._selected_Ids[0]);let t=y.data.getNode(this._contenteditable_Id);if(t.id){let{id:e,source:n,size:r,attribute:l,style:a}=t;mt(e,C.FOREIGNOBJECT,"foreignObject",{source:n,size:r,attribute:l,style:a})}this.cleanSelected()}closeEditable(){if(!this._contenteditable_Id)return;let t=y.data.getNode(this._contenteditable_Id);if(t.id){this._contenteditable_Id=0;let{id:e,type:n,source:r,size:l,attribute:a,style:s}=t;mt(e,n,void 0,{source:r,size:l,attribute:a,style:s}),this.cleanSelected(),bt(y.dataSelect.nodes)}}}class Yr{createNodeImage(t,e){var n,r,l,a;let{nodeId:o,element:d,size:c,attribute:u,source:h}=Vt(Math.ceil(1e9*Math.random()),{size:{x:(null!==(n=null==e?void 0:e.x)&&void 0!==n?n:50)-50,y:(null!==(r=null==e?void 0:e.y)&&void 0!==r?r:50)-50,width:100,height:100},source:{type:"image",image:lt(t)}});(f=>{if(!f)return;let g=new Image;g.onload=()=>{let w=E(g.naturalWidth/g.naturalHeight,100);w>=1?(c.width=Math.min(g.naturalWidth,512),c.height=E(c.width/w,100)):(c.height=Math.min(g.naturalHeight,512),c.width=E(c.height*w,100)),c.x=E(c.x+50-c.width/2,100),c.y=E(c.y+50-c.height/2,100),Object.assign(u,W(C.IMAGE,c,u)),K(d,u),y.data.node=Object.assign({id:o,type:C.IMAGE,name:"Image"},{size:c,attribute:u,source:h})},g.onerror=w=>{console.error(`ImgSrc load failed -> ${f}`,w),null==d||d.remove()},g.src=f})(null!==(l=null===(a=h.image)||void 0===a?void 0:a.url)&&void 0!==l?l:"")}createNodeIframe(t,e){var n,r;let{nodeId:a,element:s,size:o,attribute:d,style:c,source:u}=Qt(Math.ceil(1e9*Math.random()),{size:{x:(null!==(n=null==e?void 0:e.x)&&void 0!==n?n:50)-50,y:(null!==(r=null==e?void 0:e.y)&&void 0!==r?r:50)-50,width:100,height:100},style:{},source:{type:"iframe",iframe:lt(t)}});(h=>{let f=(null===(h=y.data.slide)||void 0===h||null===(h=h.svg)||void 0===h?void 0:h.viewBox)||{x:0,y:0,width:100,height:100},g=E(f.width/f.height,100);g>=1?(o.width=Math.min(f.width,512),o.height=E(o.width/g,100)):(o.height=Math.min(f.height,512),o.width=E(o.height*g,100)),o.x=E(o.x+50-o.width/2,100),o.y=E(o.y+50-o.height/2,100),Object.assign(d,W(C.IMAGE,o,d)),K(s,d),y.data.node=Object.assign({id:a,type:C.FOREIGNOBJECT,name:"ForeignObject"},{size:o,attribute:d,style:c,source:u})})()}createNodeEmbed(t,e){var n,r;let l={x:50,y:50,width:640,height:360};902==t.type&&(l.width=480,l.height=80);let{nodeId:a,element:s,size:o,attribute:d,style:c,source:u}=Qt(Math.ceil(1e9*Math.random()),{size:{x:(null!==(n=null==e?void 0:e.x)&&void 0!==n?n:l.x)-l.x,y:(null!==(r=null==e?void 0:e.y)&&void 0!==r?r:l.y)-l.y,width:l.width,height:l.height},style:{},source:{type:"embed",embed:Object.assign(t,lt(t))}});(()=>{let h=E(l.width/l.height,100);h>=1?(o.width=Math.min(o.width,l.width),o.height=E(o.width/h,1)):(o.height=Math.min(o.height,l.height),o.width=E(o.height*h,1)),o.x=E(o.x+l.x-o.width/2,1),o.y=E(o.y+l.y-o.height/2,1),Object.assign(d,W(C.FOREIGNOBJECT,o,d)),K(s,d),y.data.node=Object.assign({id:a,type:C.FOREIGNOBJECT,name:"ForeignObject"},{size:o,attribute:d,style:c,source:u})})()}createNodeMedia(t,e){var n,r,l,a;let{nodeId:o,element:d,size:c,attribute:u,source:h}=Vt(Math.ceil(1e9*Math.random()),{size:{x:(null!==(n=null==e?void 0:e.x)&&void 0!==n?n:50)-50,y:(null!==(r=null==e?void 0:e.y)&&void 0!==r?r:50)-50,width:100,height:100},source:{type:"image",image:lt(t.cover)}}),f={click:{media:t.media}};(g=>{if(!g)return;let w=new Image;w.onload=()=>{let p=E(w.naturalWidth/w.naturalHeight,100);p>=1?(c.width=Math.min(w.naturalWidth,512),c.height=E(c.width/p,100)):(c.height=Math.min(w.naturalHeight,512),c.width=E(c.height*p,100)),c.x=E(c.x+50-c.width/2,100),c.y=E(c.y+50-c.height/2,100),Object.assign(u,W(C.IMAGE,c,u)),K(d,u),y.data.node=Object.assign({id:o,type:C.IMAGE,name:"Image"},{size:c,attribute:u,source:h,interactive:f})},w.onerror=p=>{console.error(`ImgSrc load failed -> ${g}`,p),null==d||d.remove()},w.src=g})(null!==(l=null===(a=h.image)||void 0===a?void 0:a.url)&&void 0!==l?l:"")}createNodeText(t,e){var n,r;let{nodeId:a,element:s,size:o,attribute:d,style:c,source:u}=Qt(Math.ceil(1e9*Math.random()),{size:{x:(null!==(n=null==e?void 0:e.x)&&void 0!==n?n:0)-0,y:(null!==(r=null==e?void 0:e.y)&&void 0!==r?r:0)-0,width:320,height:80},style:{},source:{type:"html",html:{htmlContent:`<span style="font-family: Roboto; font-size: 24px;">${t.content}</span>`}}});(()=>{let h=E(4,100);h>=1?(o.width=Math.min(o.width,320),o.height=E(o.width/h,1)):(o.height=Math.min(o.height,80),o.width=E(o.height*h,1)),o.x=E(o.x+0-o.width/2,1),o.y=E(o.y+0-o.height/2,1),Object.assign(d,W(C.FOREIGNOBJECT,o,d)),K(s,d),y.data.node=Object.assign({id:a,type:C.FOREIGNOBJECT,name:"ForeignObject"},{size:o,attribute:d,style:c,source:u})})()}insert(t){var e;if(y.data.insertSlide(y.data.slideId,1),t.title){let{nodeId:n,size:r,attribute:l,style:a,source:s}=Qt(Math.ceil(1e9*Math.random()),{size:{x:100,y:100,width:800,height:150},source:{type:"html",html:{htmlContent:`<span style="font-size: 40px;">${t.title}</span>`}}});y.data.node=Object.assign({id:n,type:C.FOREIGNOBJECT,name:"ForeignObject"},{size:r,attribute:l,style:a,source:s})}if(t.description){let{nodeId:n,size:r,attribute:l,style:a,source:s}=Qt(Math.ceil(1e9*Math.random()),{size:{x:100,y:300,width:600,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 24px;">${t.description.replace(/\n/g,"<br/>")}</span>`}}});y.data.node=Object.assign({id:n,type:C.FOREIGNOBJECT,name:"ForeignObject"},{size:r,attribute:l,style:a,source:s})}null!==(e=t.media)&&void 0!==e&&e.prompt&&((()=>{let{nodeId:n,size:r,attribute:l}=Yt(Math.ceil(1e9*Math.random()),{size:{x:775,y:275,width:350,height:350},attribute:{fill:"#FFFFFF",stroke:"#E6E6E6",strokeWidth:1,strokeDasharray:1,rx:4}});y.data.node=Object.assign({id:n,type:C.RECT,name:"Rect"},{size:r,attribute:l})})(),(n=>{let{nodeId:r,size:l,attribute:a,style:s,source:o}=Qt(Math.ceil(1e9*Math.random()),{size:{x:800,y:300,width:300,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 18px; color: #6633cc"><i>${null===(n=t.media)||void 0===n?void 0:n.prompt}</i></span>`}}});y.data.node=Object.assign({id:r,type:C.FOREIGNOBJECT,name:"ForeignObject"},{size:l,attribute:a,style:s,source:o})})())}}class Vr{get newSlideId(){return Math.ceil(1e9*Math.random())}get _defaultSlide(){return JSON.parse(JSON.stringify({id:this.newSlideId,name:"Trang m\u1edbi",svg:{viewBox:y.screen.frameSize,nodes:[]}}))}constructor(){this._dataSource={slides:[],resources:[]},this._slideIdx=0,this._fnChangeSlides=[],this.getNodeAll=()=>{var t;let e=null===(t=this._dataSource.slides)||void 0===t?void 0:t.find((l,a)=>a==this._slideIdx),n=null==e?void 0:e.svg,r=l=>{let a=[];return l.filter(s=>!s.isdeleted).forEach(s=>{s.type==C.GROUP?a=a.concat(r(s.nodes||[])):a.push(s.id)}),a};return r((null==n?void 0:n.nodes)||[])}}get get(){var t;let e=n=>{var r,l;return null===(r=n)||void 0===r||r.filter(a=>a.type==C.GROUP).forEach(a=>{var s;a.nodes=e(null===(s=a.nodes)||void 0===s?void 0:s.filter(o=>!o.isdeleted))}),(n=null===(l=n)||void 0===l?void 0:l.filter(a=>{var s,o;return a.type!=C.GROUP||(null!==(s=null===(o=a.nodes)||void 0===o?void 0:o.length)&&void 0!==s?s:0)>0}))||[]};return null===(t=this._dataSource.slides)||void 0===t||t.forEach(n=>{var r;n.svg&&(n.svg.nodes=e(null===(r=n.svg)||void 0===r||null===(r=r.nodes)||void 0===r?void 0:r.filter(l=>!l.isdeleted)))}),this._dataSource}get getResource(){var t;let e=[];return null===(t=this._dataSource.slides)||void 0===t||t.forEach(n=>{var r,l,a,s,o,d,c,u;e.push(null===(r=n.svg)||void 0===r||null===(r=r.background)||void 0===r?void 0:r.path),null===(l=n.svg)||void 0===l||l.nodes.forEach(h=>{var f,g,w,p,v,k,b,m,x,T,_;e.push(null===(f=h.source)||void 0===f||null===(f=f.image)||void 0===f?void 0:f.path),e.push(null===(g=h.source)||void 0===g||null===(g=g.audio)||void 0===g?void 0:g.path),e.push(null===(w=h.source)||void 0===w||null===(w=w.video)||void 0===w?void 0:w.path),e.push(null===(p=h.source)||void 0===p||null===(p=p.file)||void 0===p?void 0:p.path),e.push(null===(v=h.source)||void 0===v||null===(v=v.iframe)||void 0===v?void 0:v.path),e.push(null===(k=h.source)||void 0===k||null===(k=k.embed)||void 0===k?void 0:k.path),e.push(null===(b=h.source)||void 0===b||null===(b=b.track)||void 0===b?void 0:b.path),e.push(null===(m=h.interactive)||void 0===m||null===(m=m.show)||void 0===m||null===(m=m.audio)||void 0===m||null===(m=m.source)||void 0===m?void 0:m.path),e.push(null===(x=h.interactive)||void 0===x||null===(x=x.click)||void 0===x||null===(x=x.audio)||void 0===x||null===(x=x.source)||void 0===x?void 0:x.path),e.push(null===(T=h.interactive)||void 0===T||null===(T=T.click)||void 0===T||null===(T=T.image)||void 0===T||null===(T=T.source)||void 0===T?void 0:T.path),e.push(null===(_=h.interactive)||void 0===_||null===(_=_.click)||void 0===_||null===(_=_.video)||void 0===_||null===(_=_.source)||void 0===_?void 0:_.path)}),e.push(null===(a=n.test)||void 0===a||null===(a=a.audiotrue)||void 0===a?void 0:a.path),e.push(null===(s=n.test)||void 0===s||null===(s=s.audiofalse)||void 0===s?void 0:s.path),e.push(null===(o=n.test)||void 0===o||null===(o=o.effecttrue)||void 0===o?void 0:o.path),e.push(null===(d=n.test)||void 0===d||null===(d=d.effectfalse)||void 0===d?void 0:d.path),e.push(null===(c=n.test)||void 0===c||null===(c=c.icontrue)||void 0===c?void 0:c.path),e.push(null===(u=n.test)||void 0===u||null===(u=u.iconfalse)||void 0===u?void 0:u.path)}),e.filter(n=>n).map(n=>n.replace(/(\?|\#)[^\?\#]+/g,"").toLowerCase()).filter((n,r,l)=>l.indexOf(n)==r)}get getFonts(){var t;return wr(JSON.stringify(null!==(t=this._dataSource.slides)&&void 0!==t?t:[]))}set set(t){this._dataSource=t,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),Si(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get dataSource(){var t;let e=n=>{var r,l;return null===(r=n)||void 0===r||r.filter(a=>a.type==C.GROUP).forEach(a=>{var s;a.nodes=e(null===(s=a.nodes)||void 0===s?void 0:s.filter(o=>!o.isdeleted))}),(n=null===(l=n)||void 0===l?void 0:l.filter(a=>{var s,o;return a.type!=C.GROUP||(null!==(s=null===(o=a.nodes)||void 0===o?void 0:o.length)&&void 0!==s?s:0)>0}))||[]};return null===(t=this._dataSource.slides)||void 0===t||t.forEach(n=>{var r;n.svg&&(n.svg.nodes=e(null===(r=n.svg)||void 0===r||null===(r=r.nodes)||void 0===r?void 0:r.filter(l=>!l.isdeleted)))}),this._dataSource.resources=this.getResource,this._dataSource}set dataSource(t){this._dataSource=t,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),Si(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get slideId(){var t,e;return null!==(t=null===(e=this.slide)||void 0===e?void 0:e.id)&&void 0!==t?t:0}get slideIdx(){return this._slideIdx}get slide(){var t;return null===(t=this._dataSource.slides)||void 0===t?void 0:t.find((e,n)=>n==this._slideIdx)}get slides(){return this._dataSource.slides||[]}backSlide(){this._slideIdx>0&&(this._slideIdx-=1,this.openSlide(void 0,this._slideIdx))}nextSlide(){var t,e;this._slideIdx<(null!==(t=null===(e=this._dataSource.slides)||void 0===e?void 0:e.length)&&void 0!==t?t:0)-1&&(this._slideIdx+=1,this.openSlide(void 0,this._slideIdx))}refreshSlide(){Si(),Jt(this.slide)}openSlide(t,e){var n,r,l,a,s;if(t)for(let h=0,f=null!==(o=null===(d=this._dataSource.slides)||void 0===d?void 0:d.length)&&void 0!==o?o:0;h<f;h++){var o,d,c;if((null!==(c=this._dataSource.slides)&&void 0!==c?c:[])[h].id==t){this._slideIdx=h;break}}else if(e&&e>=0&&e<(null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.length)&&void 0!==n?n:0))this._slideIdx=null!=e?e:0;else{var u;this._slideIdx=0,null!==(u=this._dataSource.slides)&&void 0!==u&&u.length||(this._dataSource.slides=[JSON.parse(JSON.stringify(this._defaultSlide))])}Si(),null!==(l=this.slide)&&void 0!==l&&null!==(l=l.svg)&&void 0!==l&&l.viewBox&&(y.screen.frameSize=this.slide.svg.viewBox),Jt(this.slide),this.changeSlide(this.slides,this.slideIdx,null!==(a=null===(s=this._dataSource.slides)||void 0===s?void 0:s.length)&&void 0!==a?a:0,this.slide)}addSlide(){var t,e,n;null===(t=this._dataSource.slides)||void 0===t||t.push(this._defaultSlide),this._slideIdx=(null!==(e=null===(n=this._dataSource.slides)||void 0===n?void 0:n.length)&&void 0!==e?e:0)-1,this.openSlide(void 0,this._slideIdx)}tryMergeSlide(t,e,n){var r,l,a;let s=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(o=>o.id==t);return s?null!==(l=s.test)&&void 0!==l&&l.type&&null!==(a=e.test)&&void 0!==a&&a.type?"boolean"!=typeof n?-1:n?this.mergeSlide(t,s,e):this.insertSlide(t,1,e):this.mergeSlide(t,s,e):this.insertSlide(t,1,e)}tryReplaceSlide(t,e){var n,r,l,a,s;let o=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find(c=>c.id==t);if(!o||null!=o&&null!==(r=o.svg)&&void 0!==r&&r.nodes.filter(c=>!c.isdeleted).length)return this.insertSlide(t,1,e);let d=null!==(l=null===(a=this._dataSource.slides)||void 0===a?void 0:a.indexOf(o))&&void 0!==l?l:0;return null===(s=this._dataSource.slides)||void 0===s||s.splice(d,1,e),this._slideIdx=d,this.openSlide(void 0,this._slideIdx),1}mergeSlide(t,e,n){var r,l,a,s;return e.test=null!==(r=n.test)&&void 0!==r?r:e.test,e.audio=null!==(l=n.audio)&&void 0!==l?l:e.audio,e.svg?e.svg.nodes=e.svg.nodes.concat(null!==(a=null===(s=n.svg)||void 0===s?void 0:s.nodes)&&void 0!==a?a:[]):e.svg=n.svg,this.openSlide(t),1}insertSlide(t,e,n){var r,l,a,s,o;let d=null!==(r=null===(l=this._dataSource.slides)||void 0===l?void 0:l.find(h=>h.id==t))&&void 0!==r?r:this._defaultSlide,c=(null!==(a=null===(s=this._dataSource.slides)||void 0===s?void 0:s.indexOf(d))&&void 0!==a?a:0)+e;var u;return n?(n.id=this.newSlideId,n.code=void 0,n.name||(n.name="Trang m\u1edbi"),null!==(u=n.svg)&&void 0!==u&&u.viewBox||n.svg&&(n.svg.viewBox=y.screen.frameSize)):n=this._defaultSlide,null===(o=this._dataSource.slides)||void 0===o||o.splice(c,0,n),this._slideIdx=c,this.openSlide(void 0,this._slideIdx),1}copySlide(t){var e,n,r,l,a,s,o;let d=null!==(e=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find(h=>h.id==t))&&void 0!==e?e:this._defaultSlide,c=(null!==(r=null===(l=this._dataSource.slides)||void 0===l?void 0:l.indexOf(d))&&void 0!==r?r:0)+1,u=Object.assign(JSON.parse(JSON.stringify(d)),{id:this.newSlideId,code:void 0,name:`${d.name} + (Copy)`});null===(a=this._dataSource.slides)||void 0===a||a.splice(c,0,u),this.changeSlide(this.slides,this.slideIdx,null!==(s=null===(o=this._dataSource.slides)||void 0===o?void 0:o.length)&&void 0!==s?s:0,this.slide)}moveSlide(t,e){var n,r,l,a,s,o;let d=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(u=>u.id==t))&&void 0!==n?n:this._defaultSlide,c=null!==(l=null===(a=this._dataSource.slides)||void 0===a?void 0:a.indexOf(d))&&void 0!==l?l:0;null===(s=this._dataSource.slides)||void 0===s||s.splice(c+e,0,null===(o=this._dataSource.slides)||void 0===o?void 0:o.splice(c,1)[0])}deleteSlide(t){var e,n,r,l,a,s;let o=null!==(e=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find(h=>h.id==t))&&void 0!==e?e:this._defaultSlide,d=null!==(r=null===(l=this._dataSource.slides)||void 0===l?void 0:l.indexOf(o))&&void 0!==r?r:0;if(null===(a=this._dataSource.slides)||void 0===a||a.splice(d,1),null!==(s=this._dataSource.slides)&&void 0!==s&&s.length)if(d<this._slideIdx){var c,u;--this._slideIdx,this.changeSlide(this.slides,this.slideIdx,null!==(c=null===(u=this._dataSource.slides)||void 0===u?void 0:u.length)&&void 0!==c?c:0,this.slide)}else d==this._slideIdx&&(--this._slideIdx,this.openSlide(void 0,this._slideIdx));else this.addSlide()}deleteSlide1(t){var e,n,r,l,a;let s=null!==(e=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find(d=>d.id==t))&&void 0!==e?e:this._defaultSlide,o=null!==(r=null===(l=this._dataSource.slides)||void 0===l?void 0:l.indexOf(s))&&void 0!==r?r:0;if(s.isdeleted=!0,null!==(a=this._dataSource.slides)&&void 0!==a&&null!==(a=a.filter(d=>!d.isdeleted))&&void 0!==a&&a.length){let d=!0;for(;s.isdeleted;)d?o++:o--,this._dataSource.slides[o]?s=this._dataSource.slides[o]:d=!d;this.openSlide(s.id)}else this.addSlide()}set onChangeSlide(t){this._fnChangeSlides.push(t)}changeSlide(t,e,n,r){this._fnChangeSlides.forEach(l=>l(t,e,n,r))}set node(t){var e,n;let r=null===(e=this._dataSource.slides)||void 0===e?void 0:e.find((l,a)=>a==this._slideIdx);null!=r&&null!==(n=r.svg)&&void 0!==n&&n.nodes&&r.svg.nodes.push(t),y.history.push([{type:"add",from:{id:t.id},to:{id:t.id}}]),Jt(r),Jt(r,null==r?void 0:r.id)}findNode(t){var e;let n=null===(e=this._dataSource.slides)||void 0===e?void 0:e.find((h,f)=>f==this._slideIdx),r=null==n?void 0:n.svg,l=(h,f)=>{let g=null==h?void 0:h.find(v=>v.id==t);if(g)return g.pid=f,g;let w=0,p=h.length||0;for(;w<p&&!g&&(g=l(h[w].nodes||[],h[w].id),!g);)w++;return g},a=l((null==r?void 0:r.nodes)||[]);var s,o,d,c,u;return a?(a.style=null!==(s=a.style)&&void 0!==s?s:{},a.source=null!==(o=a.source)&&void 0!==o?o:{},a.animate=null!==(d=a.animate)&&void 0!==d?d:{},a.interactive=null!==(c=a.interactive)&&void 0!==c?c:{},a.variable=null!==(u=a.variable)&&void 0!==u?u:{},a):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}getNode(t){var e;let n=null===(e=this._dataSource.slides)||void 0===e?void 0:e.find((s,o)=>o==this._slideIdx),r=null==n?void 0:n.svg,a=s=>{let o=(null==s?void 0:s.find(g=>g.id==t))||(s=>{let o=null,d=0,c=s.length||0;for(;d<c&&!o;){if(o=a(s[d].nodes),o){o.pid=s[d].id;break}d++}var u,h,f,g,w;return o&&(o.style=null!==(u=o.style)&&void 0!==u?u:{},o.source=null!==(h=o.source)&&void 0!==h?h:{},o.animate=null!==(f=o.animate)&&void 0!==f?f:{},o.interactive=null!==(g=o.interactive)&&void 0!==g?g:{},o.variable=null!==(w=o.variable)&&void 0!==w?w:{}),o})((null==s?void 0:s.filter(g=>g.type==C.GROUP))||[]);var d,c,u,h,f;return o&&(o.style=null!==(d=o.style)&&void 0!==d?d:{},o.source=null!==(c=o.source)&&void 0!==c?c:{},o.animate=null!==(u=o.animate)&&void 0!==u?u:{},o.interactive=null!==(h=o.interactive)&&void 0!==h?h:{},o.variable=null!==(f=o.variable)&&void 0!==f?f:{}),o};return a((null==r?void 0:r.nodes)||[])||{id:null,pid:null,type:null,element:document.createElement("div"),size:{x:0,y:0,width:0,height:0,points:[]},attribute:{},style:{},source:{},animate:{},interactive:{},variable:{},isfake:!0,isdeleted:!1,nodes:[]}}getNodeInArea(t,e,n,r,l){var a;let s=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find((c,u)=>u==this._slideIdx),o=null==s?void 0:s.svg,d=c=>{let u=[];return c.filter(h=>!h.isdeleted).forEach(h=>{h.type==C.GROUP?u=u.concat(d(h.nodes||[])):t>h.size.x||e>h.size.y||n<h.size.x+h.size.width||r<h.size.y+h.size.height||(l?h.type==l&&u.push(h.id):u.push(h.id))}),u};return d((null==o?void 0:o.nodes)||[])}getNodeOnArea(t,e,n,r,l){var a;let s=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find((c,u)=>u==this._slideIdx),o=null==s?void 0:s.svg,d=c=>{let u=[];return c.filter(h=>!h.isdeleted).forEach(h=>{h.type==C.GROUP?u=u.concat(d(h.nodes||[])):h.size.x+h.size.width<t||h.size.y+h.size.height<e||h.size.x>n||h.size.y>r||(l?h.type==l&&u.push(h.id):u.push(h.id))}),u};return d((null==o?void 0:o.nodes)||[])}deleteNode(t,e){var n;return this.getNode(t).isdeleted=null==e||e,Jt(this.slide),Jt(this.slide,null===(n=this.slide)||void 0===n?void 0:n.id),t}unGroup(t){var e,n;let r=this.getNode(t),l=Math.ceil(1e9*Math.random());return null===(e=this.slide)||void 0===e||null===(e=e.svg)||void 0===e||e.nodes.push(Object.assign(JSON.parse(JSON.stringify(r)),{id:l})),Object.assign(r,{isdeleted:!0}),Jt(this.slide),Jt(this.slide,null===(n=this.slide)||void 0===n?void 0:n.id),l}addGroup(t,e){var n;let r=this.getNode(t),l=this.getNode(e);l.nodes=l.nodes||[];let a=Math.ceil(1e9*Math.random());return l.nodes.push(Object.assign(JSON.parse(JSON.stringify(r)),{id:a})),Object.assign(r,{isdeleted:!0}),Jt(this.slide),Jt(this.slide,null===(n=this.slide)||void 0===n?void 0:n.id),a}setNodeP(t,e){var n;let r=null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n?void 0:n.nodes.find(l=>l.id==t);r&&(r.pid=e||null)}bringToFront(t){this.bringToFrontStep(t,0)}sendToBack(t){this.sendToBackStep(t,0)}bringToFrontStep(t,e){var n,r,l,a,s,o;null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((c,u)=>{c.index=u+1});let d=(null!==(r=null===(l=this.slide)||void 0===l||null===(l=l.svg)||void 0===l?void 0:l.nodes.length)&&void 0!==r?r:0)+1;t.map(c=>{var u,h;return{id:c,index:null!==(u=null===(h=this.slide)||void 0===h||null===(h=h.svg)||void 0===h||null===(h=h.nodes.find(f=>f.id==c))||void 0===h?void 0:h.index)&&void 0!==u?u:0}}).sort((c,u)=>c.index-u.index).forEach(c=>{var h,u;e?null===(h=this.slide)||void 0===h||null===(h=h.svg)||void 0===h||h.nodes.filter((f,g)=>f.id==c.id).forEach(f=>{f.index=e+c.index+c.index/1e3}):null===(u=this.slide)||void 0===u||null===(u=u.svg)||void 0===u||u.nodes.filter(f=>f.id==c.id).forEach(f=>{f.index=d+c.index})}),null===(a=this.slide)||void 0===a||null===(a=a.svg)||void 0===a||a.nodes.sort((c,u)=>{var h,f;return(null!==(h=c.index)&&void 0!==h?h:0)-(null!==(f=u.index)&&void 0!==f?f:0)}),Ei(this.slide),null===(s=window.document.getElementById(U.RESIZE_GROUP))||void 0===s||s.remove(),null===(o=window.document.getElementById(U.SELECT_GROUP))||void 0===o||o.remove(),bt(y.dataSelect.nodes)}sendToBackStep(t,e){var n,r,l,a;null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((s,o)=>{s.index=o+1}),t.map(s=>{var o,d;return{id:s,index:null!==(o=null===(d=this.slide)||void 0===d||null===(d=d.svg)||void 0===d||null===(d=d.nodes.find(c=>c.id==s))||void 0===d?void 0:d.index)&&void 0!==o?o:0}}).sort((s,o)=>s.index-o.index).forEach(s=>{var d,o;e?null===(d=this.slide)||void 0===d||null===(d=d.svg)||void 0===d||d.nodes.filter(c=>c.id==s.id).forEach(c=>{c.index=e+s.index+s.index/1e3}):null===(o=this.slide)||void 0===o||null===(o=o.svg)||void 0===o||o.nodes.filter(c=>c.id==s.id).forEach(c=>{c.index=s.index/100-1})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((s,o)=>{var d,c;return(null!==(d=s.index)&&void 0!==d?d:0)-(null!==(c=o.index)&&void 0!==c?c:0)}),Ei(this.slide),null===(l=window.document.getElementById(U.RESIZE_GROUP))||void 0===l||l.remove(),null===(a=window.document.getElementById(U.SELECT_GROUP))||void 0===a||a.remove(),bt(y.dataSelect.nodes)}bringToFrontArea(t){var e,n,r,l;let a=t.map(g=>y.data.getNode(g)).filter(g=>!g.isfake),{x1:s,y1:o,x2:d,y2:c}=$r(a),u=this.getNodeOnArea(s,o,d,c);null===(e=this.slide)||void 0===e||null===(e=e.svg)||void 0===e||e.nodes.forEach((g,w)=>{g.index=w+1});let h=u.map(g=>{var w,p;return null!==(w=null===(p=this.slide)||void 0===p||null===(p=p.svg)||void 0===p||null===(p=p.nodes.find(v=>v.id==g))||void 0===p?void 0:p.index)&&void 0!==w?w:0}),f=Math.max.apply(null,h);t.forEach((g,w)=>{var p;null===(p=this.slide)||void 0===p||null===(p=p.svg)||void 0===p||p.nodes.filter(v=>v.id==g).forEach(v=>{v.index=f+(w+1)/100})}),null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.sort((g,w)=>{var p,v;return(null!==(p=g.index)&&void 0!==p?p:0)-(null!==(v=w.index)&&void 0!==v?v:0)}),Ei(this.slide),null===(r=window.document.getElementById(U.RESIZE_GROUP))||void 0===r||r.remove(),null===(l=window.document.getElementById(U.SELECT_GROUP))||void 0===l||l.remove(),bt(y.dataSelect.nodes)}sendToBackArea(t){var e,n,r,l;let a=t.map(g=>y.data.getNode(g)).filter(g=>!g.isfake),{x1:s,y1:o,x2:d,y2:c}=$r(a),u=this.getNodeOnArea(s,o,d,c);null===(e=this.slide)||void 0===e||null===(e=e.svg)||void 0===e||e.nodes.forEach((g,w)=>{g.index=w+1});let h=u.map(g=>{var w,p;return null!==(w=null===(p=this.slide)||void 0===p||null===(p=p.svg)||void 0===p||null===(p=p.nodes.find(v=>v.id==g))||void 0===p?void 0:p.index)&&void 0!==w?w:0}),f=Math.min.apply(null,h)-1;t.forEach((g,w)=>{var p;null===(p=this.slide)||void 0===p||null===(p=p.svg)||void 0===p||p.nodes.filter(v=>v.id==g).forEach(v=>{v.index=f+(w+1)/100})}),null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.sort((g,w)=>{var p,v;return(null!==(p=g.index)&&void 0!==p?p:0)-(null!==(v=w.index)&&void 0!==v?v:0)}),Ei(this.slide),null===(r=window.document.getElementById(U.RESIZE_GROUP))||void 0===r||r.remove(),null===(l=window.document.getElementById(U.SELECT_GROUP))||void 0===l||l.remove(),bt(y.dataSelect.nodes)}}const $r=i=>{let t=999999,e=999999,n=-999999,r=-999999;return i.forEach(l=>{t=Math.min(t,l.size.x),e=Math.min(e,l.size.y),n=Math.max(n,l.size.x+l.size.width),r=Math.max(r,l.size.y+l.size.height)}),{x1:t,y1:e,x2:n,y2:r}};class tl{constructor(){this._index=-1,this._dataSource=[],this.undoExecute=t=>{t.forEach(function(e){switch(e.type){case"add":y.data.deleteNode(e.from.id);break;case"edit":break;case"delete":y.data.deleteNode(e.from.id,!1);break;case"size":{let{id:n,type:r,size:l,attribute:a}=y.data.getNode(e.from.id);Object.assign(l,e.from.size),Object.assign(a,W(r,l,a)),K(window.document.getElementById(n),a);break}case"attribute":{let{id:n,attribute:r}=y.data.getNode(e.from.id);Object.assign(r,e.from.attribute),K(window.document.getElementById(n),r);break}case"style":{let{id:n,style:r}=y.data.getNode(e.from.id);Object.assign(null!=r?r:{},e.from.style),wt(window.document.getElementById(n),r);break}case"source":{let{id:n,type:r,source:l}=y.data.getNode(e.from.id);Object.assign(null!=l?l:{},e.from.source),Ot(window.document.getElementById(n),r,null!=l?l:{});break}case"animate":{let{animate:n}=y.data.getNode(e.from.id);Object.assign(null!=n?n:{},e.from.animate);break}case"interactive":{let{interactive:n}=y.data.getNode(e.from.id);Object.assign(null!=n?n:{},e.from.interactive);break}case"variable":{let{variable:n}=y.data.getNode(e.from.id);Object.assign(null!=n?n:{},e.from.variable);break}}}),y.dataSelect.ids=[]},this.redoExecute=t=>{t.forEach(function(e){switch(e.type){case"add":y.data.deleteNode(e.to.id,!1);break;case"edit":break;case"delete":y.data.deleteNode(e.to.id,!0);break;case"size":{let{id:n,type:r,size:l,attribute:a}=y.data.getNode(e.to.id);Object.assign(l,e.to.size),Object.assign(a,W(r,l,a)),K(window.document.getElementById(n),a);break}case"attribute":{let{id:n,attribute:r}=y.data.getNode(e.to.id);Object.assign(r,e.to.attribute),K(window.document.getElementById(n),r);break}case"style":{let{id:n,style:r}=y.data.getNode(e.to.id);Object.assign(null!=r?r:{},e.to.style),wt(window.document.getElementById(n),r);break}case"source":{let{id:n,type:r,source:l}=y.data.getNode(e.to.id);Object.assign(null!=l?l:{},e.to.source),Ot(window.document.getElementById(n),r,null!=l?l:{});break}case"animate":{let{animate:n}=y.data.getNode(e.to.id);Object.assign(null!=n?n:{},e.to.animate);break}case"interactive":{let{interactive:n}=y.data.getNode(e.to.id);Object.assign(null!=n?n:{},e.to.interactive);break}case"variable":{let{variable:n}=y.data.getNode(e.to.id);Object.assign(null!=n?n:{},e.to.variable);break}}}),y.dataSelect.ids=[]},this._fnChanges=[],this._index=-1,this._dataSource=[]}get index(){return this._index}get total(){return this._dataSource.length}get dataSource(){return this._dataSource}renew(){this._index=-1,this._dataSource=[],this.change()}push(t){this._index<0?(this._index=0,this._dataSource.length=0,this._dataSource[this._index]={data:t}):(this._index<this._dataSource.length-1&&this._dataSource.splice(this._index+1,this._dataSource.length-this._index-1),this._index++,this._dataSource.push({data:t})),this.change()}undo(){this._index<0||(this.undoExecute(this._dataSource[this._index].data),this._index--,this.change())}redo(){this._index>=this._dataSource.length-1||(this._index++,this.redoExecute(this._dataSource[this._index].data),this.change())}set onchange(t){this._fnChanges.push(t)}change(){this._fnChanges.forEach(t=>t(this.index,this.total))}}class el{constructor(){this._x=0,this._y=0,this._width=0,this._height=0,this._scale=1,this._dislocation={x:0,y:0},this._offset={x:0,y:0},this._svgSize={x:0,y:0,width:0,height:0},this._svgViewBox={x:0,y:0,width:0,height:0},this._frameSize={x:0,y:0,width:1280,height:720},this._actived=!1,this._fnZoomChanges=[]}get actived(){return this._actived}set actived(t){this._actived=t}get get(){return{x:this._frameSize.x,y:this._frameSize.y,w:this._frameSize.width,h:this._frameSize.height,width:this._frameSize.width,height:this._frameSize.height}}set set(t){var e,n;this._frameSize.width=null!==(e=null==t?void 0:t.width)&&void 0!==e?e:1080,this._frameSize.height=null!==(n=null==t?void 0:t.height)&&void 0!==n?n:1080,this.zoomTo="fit"}get width(){return this._width}get height(){return this._height}get scale(){return this._scale}get dislocation(){return this._dislocation}get offset(){return this._offset}get svgSize(){return this._svgSize}get svgViewBox(){return this._svgViewBox}set svgViewBox(t){this._svgViewBox=t}get frameSize(){return this._frameSize}set frameSize(t){this._frameSize.x=t.x,this._frameSize.y=t.y,this._frameSize.width=t.width,this._frameSize.height=t.height,this.reset()}set screen(t){this._offset=t.offset,this._width=t.width,this._height=t.height,this.reset()}reset(){this.scaleTo(this._scale,void 0,!0)}scaleTo(t,e,n){var r;if(!(t<.01||t>100)){if(e=null!==(r=e)&&void 0!==r?r:{x:this._width/2,y:this._height/2},n)this._dislocation.x=this._width/t/2-e.x,this._dislocation.y=this._height/t/2-e.y,this._dislocation.x+=(this._width-this._frameSize.width)/2,this._dislocation.y+=(this._height-this._frameSize.height)/2;else{var l={x:Math.max(0,Math.min(E(e.x/this._width,1e3),1)),y:Math.max(0,Math.min(E(e.y/this._height,1e3),1))},a={x:(this._width/t-this._width/this._scale)*l.x,y:(this._height/t-this._height/this._scale)*l.y};this._dislocation.x+=a.x,this._dislocation.y+=a.y}this._scale=t,this.change(),this.zoomChange(this.scale)}}set zoomTo(t){"fit"==t?this.scaleTo(Math.min((this._width-80)/this._frameSize.width,(this._height-80)/this._frameSize.height),void 0,!0):"number"==typeof t&&this.scaleTo(t/100,void 0,!0)}zoomIn(){this.scaleTo(this._scale+.04*this._scale)}zoomOut(){this.scaleTo(this._scale-.04*this._scale)}init(){return{svgViewBox:this.svgViewBox,svgSize:this.svgSize}}move(t,e){this._dislocation.x=t.x+e.x/this._scale,this._dislocation.y=t.y+e.y/this._scale,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this.refScreen()}change(){this._svgSize.x=this._x,this._svgSize.y=this._y,this._svgSize.width=this._width,this._svgSize.height=this._height,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this._svgViewBox.width=this._width/this._scale,this._svgViewBox.height=this._height/this._scale,this.refScreen()}refScreen(){(()=>{let i=y.screen.svgViewBox,t=y.screen.svgSize;y.target&&(y.target.setAttributeNS(null,"viewBox",`${i.x} ${i.y} ${i.width} ${i.height}`),y.target.style.left=`${t.x}px`,y.target.style.top=`${t.y}px`,y.target.style.width=`${t.width}px`,y.target.style.height=`${t.height}px`)})()}set onZoomChange(t){this._fnZoomChanges.push(t)}zoomChange(t){this._fnZoomChanges.forEach(e=>e(t))}}class il{constructor(){this._fill="#D9D9D9",this._stroke="#AAAAAA",this._strokeWidth=1,this._strokeLinecap="round",this._strokeLinejoin="round",this._fontFamily=void 0,this._fontSize=20,this._textLength=void 0,this._fnChangeFills=[],this._fnChangeStrokes=[],this._fnChangeStrokeWidths=[],this.loadConfig()}loadConfig(){bc({callback:t=>{this._fill=(null==t?void 0:t.fill)||this._fill,this._stroke=(null==t?void 0:t.stroke)||this._stroke,this._strokeWidth=(null==t?void 0:t.strokeWidth)||this._strokeWidth,this._strokeLinecap=(null==t?void 0:t.strokeLinecap)||this._strokeLinecap,this._strokeLinejoin=(null==t?void 0:t.strokeLinejoin)||this._strokeLinejoin,this.changeFill(this.fill),this.changeStroke(this.stroke),this.changeStrokeWidth(this.strokeWidth)}})}saveConfig(){xc({params:{fill:this._fill,stroke:this._stroke,strokeWidth:this._strokeWidth,strokeLinecap:this._strokeLinecap,strokeLinejoin:this._strokeLinejoin}})}get fill(){return this._fill}set fill(t){this._fill=t,this.changeFill(this.fill)}get stroke(){return this._stroke}set stroke(t){this._stroke=t,this.changeStroke(this.stroke)}get strokeWidth(){return this._strokeWidth}set strokeWidth(t){this._strokeWidth=t,this.changeStrokeWidth(this.strokeWidth)}get strokeLinecap(){return this._strokeLinecap}set strokeLinecap(t){this._strokeLinecap=t}get strokeLinejoin(){return this._strokeLinejoin}set strokeLinejoin(t){this._strokeLinejoin=t}get fontFamily(){return this._fontFamily}get fontSize(){return this._fontSize}get textLength(){return this._textLength}set onchangefill(t){this._fnChangeFills.push(t)}changeFill(t){this._fnChangeFills.forEach(e=>e(t)),this.saveConfig()}set onchangestroke(t){this._fnChangeStrokes.push(t)}changeStroke(t){this._fnChangeStrokes.forEach(e=>e(t)),this.saveConfig()}set onchangestrokewidth(t){this._fnChangeStrokeWidths.push(t)}changeStrokeWidth(t){this._fnChangeStrokeWidths.forEach(e=>e(t)),this.saveConfig()}}var Et=function(i){return i&&JSON.parse(JSON.stringify(i))},Ue=[{key:"FinishedTest",type:"boolean",value:!1,note:"Ho\xe0n th\xe0nh BKT",system:!0,readonly:!1},{key:"TotalTest",type:"number",value:0,note:"T\u1ed5ng s\u1ed1 BKT",system:!0,readonly:!1},{key:"TotalTestDidNotPass",type:"number",value:0,note:"S\u1ed1 BKT kh\xf4ng v\u01b0\u1ee3t qua",system:!0,readonly:!1},{key:"TotalTestPassed",type:"number",value:0,note:"S\u1ed1 BKT \u0111\xe3 v\u01b0\u1ee3t qua",system:!0,readonly:!1}],cn=[],Wc={key:"BienSo",value:"0",type:"number",note:null,readonly:!1},qc={if:[{type:"variable",variable:"BienSo",variables:null,slide:null,node:null,condition:">",operator:null,valuetype:"value",value:5}],then:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo > 5"}],else:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo <= 5"}],id:"57623302",idx:1,variables:["BienSo"]};class nl{constructor(){this._data_variables=Et(Ue).concat(Et(cn)),this._data_conditions=[],this.GetActionExecutings=[],this.GetActionExecuteds=[],this.FuncGetExecuteds=t=>{"function"==typeof t&&this.GetActionExecuteds.push(t)},this.OnGetActionExecuted=t=>{this.GetActionExecuteds.forEach(e=>{e(t)})},this.SetActionExecutings=[],this.FuncSetExecutings=t=>{"function"==typeof t&&this.SetActionExecutings.push(t)},this.OnSetActionExecuting=t=>{this.SetActionExecutings.forEach(e=>{e(t)})},this.SetActionExecuteds=[],this.FuncSetExecuteds=t=>{"function"==typeof t&&this.SetActionExecuteds.push(t)},this.OnSetActionExecuted=t=>{for(var e of(this.SetActionExecuteds.forEach(n=>{n(t)}),this.getCondition(t.key)||[]))e.if&&e.if.length>0&&(this.checkValueConditions(e.if)?this.setValueOperators(e.then||[]):this.setValueOperators(e.else||[]))}}renew(){this._data_variables=Et(Ue).concat(Et(cn)),this._data_conditions=[]}get totalVariable(){return this._data_variables.length}get totalCondition(){return this._data_conditions.length}get get(){return{variables:this._data_variables||[],conditions:this._data_conditions||[]}}set set(t){if(!t)return;let e={};"string"==typeof t?e=JSON.parse(t):"object"==typeof t&&(e=t),this._data_variables=e.variables||[],this._data_conditions=e.conditions||(n=>(this._data_variables.map(r=>r.change||[]).forEach(r=>{n=n.concat(r)}),n))([]),Ue.forEach(n=>{var r=this._data_variables.filter(l=>l.key==n.key);r.length?r.forEach(function(l,a,s){l.type=n.type,l.readonly=n.readonly,l.system=n.system}):this._data_variables.push(n)})}getVariableTemp(){return Et(Wc)}getConditionTemp(){return Et(qc)}getKeys(){return this._data_variables.map(function(t){return t.key}).sort(function(t,e){return t.localeCompare(e)})}getVariableAll(){return this._data_variables.length?Et(function(i,t){return function(e){for(var n of i.map(function(r){return r[t]}).sort())i.filter(function(r){return r[t]==n}).forEach(function(r){e.push(r)}),i=i.filter(function(r){return r[t]!=n});return e}([])}(this._data_variables,"key")):Et(Ue).concat(Et(cn))}setVariableAll(t){t&&("string"==typeof t&&(t=JSON.parse(t)),"object"==typeof t&&(this._data_variables=t),Ue.forEach(e=>{var n=this._data_variables.filter(r=>r.key==e.key);n.length?n.forEach((r,l,a)=>{r.type=e.type,r.readonly=e.readonly,r.system=e.system}):this._data_variables.push(e)}))}getVariable(t){return t?Et(this._data_variables.filter(e=>e.key==t)[0]||{}):{}}setVariable(t,e,n){if(t){switch([null,void 0,NaN,1/0].indexOf(e)>=0&&(e=""),n||(n=(this._data_variables.filter(l=>l.key==t)[0]||{}).type||null),n){case"string":"string"!=typeof e&&(e=e.toString().trim());break;case"number":"number"!=typeof e&&(e=parseFloat(e)||0);break;case"boolean":"string"==typeof e&&(e=e.toLowerCase()),"boolean"!=typeof e&&(e="1"==e||"true"==e||"yes"==e||"dung"==e)}var r=this._data_variables.filter(l=>l.key==t);r.length?r.forEach(function(l,a,s){l.value=e,l.type=n}):this._data_variables.push({key:t,value:e,type:n})}}getValue(t,e){if(!t)return"";var n=this._data_variables.filter(function(a){return a.key==t});if(n.length){var l,r=n[0]||{};switch(this.OnGetActionExecuting(r),e||(e=r.type||null),e){case"string":l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":"string"==typeof r.value?r.value||"":r.value.toString().trim();break;case"number":l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?0:"number"==typeof r.value?r.value||0:parseFloat(r.value)||0;break;case"boolean":[null,void 0,NaN,1/0].indexOf(r.value)>=0?l=!1:"boolean"==typeof r.value?l=r.value:(l=(r.value+"").toLowerCase(),l="1"==r.value||"true"==r.value||"yes"==r.value||"dung"==r.value);break;case"audio-src":l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":r.value?`<audio controls style="width:280px;vertical-align:middle;"><source src="${r.value}"></source></audio>`:"";break;case"video-src":l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":r.value?`<video controls style="width:280px;vertical-align:middle;"><source src="${r.value}"></source></video>`:"";break;case"img-src":l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":r.value?`<img style="width:100%;vertical-align:middle;" src="${r.value}"/>`:"";break;default:l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":r.value}return this.OnGetActionExecuted(r),l}return null}setValue(t,e,n){if(t){switch([null,void 0,NaN,1/0].indexOf(e)>=0&&(e=""),n||(n=(this._data_variables.filter(function(a){return a.key==t})[0]||{}).type||null),n){case"string":"string"!=typeof e&&(e=e.toString().trim());break;case"number":"number"!=typeof e&&(e=parseFloat(e)||0);break;case"boolean":"string"==typeof e&&(e=e.toLowerCase()),"boolean"!=typeof e&&(e="1"==e||"true"==e||"yes"==e||"dung"==e)}var r=this._data_variables.filter(function(a){return a.key==t});if(r.length){var l=r[0];this.OnSetActionExecuting(l),l&&(l.value=e),this.OnSetActionExecuted(l)}}}getConditionAll(){return Et(this._data_conditions.sort(function(t,e){return t.idx-e.idx}))}setConditionAll(t){t&&("string"==typeof t&&(t=JSON.parse(t)),"object"==typeof t&&(this._data_conditions=t))}getCondition(t){return t?Et(this._data_conditions.filter(e=>e.variable==t||(e.variables||[]).indexOf(t)>=0).sort(function(e,n){return e.idx-n.idx})):{}}switchCondition(t,e,n){switch(t){case"==":return"string"==typeof n?(n=n.toLowerCase().trim(),"string"==typeof e&&(e=e.toLowerCase().trim()),n.split(";").map(function(r){return e==r.trim()?1:0}).reduce(function(r,l){return r+l})>0):e==n;case"!=":return"string"==typeof n?(n=n.toLowerCase().trim(),"string"==typeof e&&(e=e.toLowerCase().trim()),0==n.split(";").map(function(r){return e==r.trim()?1:0}).reduce(function(r,l){return r+l})):e!=n;case">=":return e>=n;case"<=":return e<=n;case">":return e>n;case"<":return e<n;case"\u2208":return n=(n+"").toLowerCase().trim(),e=(e+"").toLowerCase().trim(),n.split(";").map(function(r){return e.indexOf(r.trim())>=0?1:0}).reduce(function(r,l){return r+l})>0;case"\u2209":return n=(n+"").toLowerCase().trim(),e=(e+"").toLowerCase().trim(),0==n.split(";").map(function(r){return e.indexOf(r.trim())>=0?1:0}).reduce(function(r,l){return r+l});default:return!1}}switchOperator(t,e,n){switch(t){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"/":return e/n;case"=":return n;case"=!":return!n;case"==":return e==n;case"!=":return e!=n}}switchFormula(t,e){switch(t){case"sum":return e.reduce(function(r,l){return r+l});case"sub":return e.reduce(function(r,l){return r-l});case"pro":return e.reduce(function(r,l){return r*l});case"div":return e.reduce(function(r,l){return r/l});case"avg":var n=e.reduce(function(r,l){return r+l})/(e.length||1);return Math.round(1e4*(n+Number.EPSILON))/1e4;case"min":return Math.min.apply(null,e);case"max":return Math.max.apply(null,e);case"and":return e.reduce(function(r,l){return r&&l});case"or":return e.reduce(function(r,l){return r||l});default:return 0}}switchValueType_Condition(t){switch(t.valuetype){case"value":return this.switchCondition(t.condition,this.getValue(t.variable),t.value);case"variable":return this.switchCondition(t.condition,this.getValue(t.variable),this.getValue(t.value));default:return 0}}switchValueType_Operator(t){switch(t.valuetype){case"value":return this.switchOperator(t.operator,this.getValue(t.variable),t.value);case"variable":return this.switchOperator(t.operator,this.getValue(t.variable),this.getValue(t.value));case"variables":var e=this.switchFormula(t.valueformula,t.value.map(n=>this.getValue(n)));return this.switchOperator(t.operator,this.getValue(t.variable),e)}}checkValueCondition(t){return this.switchValueType_Condition(t)}getValueOperator(t){return this.switchValueType_Operator(t)}setValueOperator(t){null!=t&&t.variable&&this.setValue(t.variable,this.getValueOperator(t))}checkValueConditions(t){return 0==t.map(e=>{switch(e.type){case"variable":return this.switchValueType_Condition(e)?0:1;case"variables":return 0==e.variables.map(n=>this.switchValueType_Condition(Object.assign(Et(e),{variable:n}))?0:1).reduce(function(n,r){return n+r})?0:1;default:return 0}}).reduce((e,n)=>(null!=e?e:0)+(null!=n?n:0))}setValueOperators(t){for(var e of t)switch(e.type){case"variable":this.setValue(e.variable,this.getValueOperator(e));break;case"variables":for(var n of e.variables)this.setValue(n,this.getValueOperator(Object.assign(Et(e),{variable:n})));break;case"slide":D.runSlide(void 0,void 0,e.slide);break;case"node":{var r;he({id:e.node,nodeStatus:D.nodeStatus,slideStatus:D.slideStatus});let l=D.findNode(e.node);null!=l&&null!==(r=l.interactive)&&void 0!==r&&r.click&&xi(l,D.nodeStatus,D.slideStatus);break}}}FuncGetExecutings(t){"function"==typeof t&&this.GetActionExecutings.push(t)}OnGetActionExecuting(t){this.GetActionExecutings.forEach(e=>{e(t)})}}class rl{constructor(){this._fnChangePointerTypes=[],this._fnChangePointerTypeTemps=[],this._fnChangePenTypes=[],this._fnChangeShapeTypes=[],this._fnChangePolygonTypes=[],this._fnChanges=[],this._pointer_type=0,this._pointer_type_temp=0,this._pen_type=0,this._shape_type=0,this._polygon_type=0}setPointer_nochange(t,e,n){if(this._pointer_type=t,e)switch(t){case et.PEN:this._pen_type=e;break;case et.SHAPE:this._shape_type=e,n&&e===C.POLYGON&&(this._polygon_type=n)}}get pointer_type(){return this._pointer_type}set pointer_type(t){switch(this._pointer_type=t,t){case et.PEN:this._pen_type||(this._pen_type=de.DRAW);break;case et.SHAPE:this._shape_type||(this._shape_type=C.RECT)}this.changePointerType(this.pointer_type),this.change(this.pointer_type)}get pointer_type_temp(){return this._pointer_type_temp}set pointer_type_temp(t){this._pointer_type_temp=t,this.changePointerTypeTemp(this.pointer_type),this.change(this.pointer_type_temp)}get pen_type(){return this._pen_type}set pen_type(t){this._pen_type=t,this.changePenType(this.pointer_type,this.pen_type),this.change(this.pointer_type,this.pen_type)}get shape_type(){return this._shape_type}set shape_type(t){this._shape_type=t,this.changeShapeType(this.pointer_type,this.shape_type),this.change(this.pointer_type,this.shape_type)}get polygon_type(){return this._polygon_type}set polygon_type(t){this._polygon_type=t,this.changePolygonType(this.pointer_type,this.shape_type,this.polygon_type),this.change(this.pointer_type,this.shape_type,this.polygon_type)}set onchangePointerType(t){this._fnChangePointerTypes.push(t)}changePointerType(t,e,n){this._fnChangePointerTypes.forEach(r=>r(t,e,n))}set onchangePointerTypeTemp(t){this._fnChangePointerTypeTemps.push(t)}changePointerTypeTemp(t,e,n){this._fnChangePointerTypeTemps.forEach(r=>r(t,e,n))}set onchangePenType(t){this._fnChangePenTypes.push(t)}changePenType(t,e,n){this._fnChangePenTypes.forEach(r=>r(t,e,n))}set onchangeShapeType(t){this._fnChangeShapeTypes.push(t)}changeShapeType(t,e,n){this._fnChangeShapeTypes.forEach(r=>r(t,e,n))}set onchangePolygonType(t){this._fnChangePolygonTypes.push(t)}changePolygonType(t,e,n){this._fnChangePolygonTypes.forEach(r=>r(t,e,n))}set onchange(t){this._fnChanges.push(t)}change(t,e,n){this._fnChanges.forEach(r=>r(t,e,n))}}const y=new class Xc{constructor(){this._container="",this._svg="",this._screen=el.prototype,this._data=Vr.prototype,this._dataSelect=Zr.prototype,this._slide=Yr.prototype,this._history=tl.prototype,this._attribute=il.prototype,this._pointer=rl.prototype,this._variable=nl.prototype,this._data=new Vr,this._dataSelect=new Zr,this._slide=new Yr,this._history=new tl,this._attribute=new il,this._pointer=new rl,this._variable=new nl,this._pointer.onchangePointerType=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._data.onChangeSlide=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])}}get config(){return this._config}set config(t){this._config=t}get dataSource(){return{modules:"icdtV2",screen:this._screen.get,data:this._data.get,variable:this._variable.get,resources:this._data.getResource,fonts:this._data.getFonts,info:{}}}set dataSource(t){this._screen.set=t.screen||{width:1080,height:1080},this._data.set=t.data||{},this._variable.set=t.variable||{}}get container(){return this._container}set container(t){this._container=t}get svg(){return this._svg}set svg(t){this._svg=t}get target(){return window.document.querySelector(this._svg)}get screen(){return this._screen}get data(){return this._data}get dataSelect(){return this._dataSelect}get slide(){return this._slide}get history(){return this._history}get attribute(){return this._attribute}get pointer(){return this._pointer}get variable(){return this._variable}reloadView(){var t,e,n,r,l;this._screen.screen=(t=jQuery(this._container).offset(),e=jQuery(this._container).width(),n=jQuery(this._container).height(),{offset:{x:null!==(r=null==t?void 0:t.left)&&void 0!==r?r:0,y:null!==(l=null==t?void 0:t.top)&&void 0!==l?l:0},width:null!=e?e:0,height:null!=n?n:0})}init(t){this._container=t.container,this._svg=t.target,this._screen=new el,(i=>{new Kd(i.container,i.target);var t=(r,l,a,s)=>{switch(r){case et.POINTER:jQuery(i.target).css({cursor:"auto"});break;case et.HAND:s?jQuery(i.target).css({cursor:"grabbing"}):jQuery(i.target).css({cursor:"grab"});break;case et.PEN:switch(l){case de.DRAW:jQuery(i.target).css({cursor:"url(assets/images/svg/icon/viet.png) 12 32,default"});break;case de.HIGHTLIGH:jQuery(i.target).css({cursor:"url(assets/images/svg/icon/highlight1.png) 12 32,default"})}break;case et.ERASER:jQuery(i.target).css({cursor:"url(assets/images/svg/icon/gom.png) 22 22,default"});break;case et.SHAPE:jQuery(i.target).css({cursor:"url(assets/images/svg/icon/point.png) 22 22,default"});break;case et.TEXT:case et.FOREIGNOBJECT:jQuery(i.target).css({cursor:"url(assets/images/svg/icon/textmouse.png) 22 22,default"})}};y.pointer.onchange=(r,l,a)=>{t(r,l)},jQuery(i.container).off("mousedown.icdt-init-icon").on("mousedown.icdt-init-icon",r=>{t(y.pointer.pointer_type,void 0,0,!0)}).off("mouseup.icdt-init-icon").on("mouseup.icdt-init-icon",r=>{t(y.pointer.pointer_type,void 0,0,!1)}),document.addEventListener("wheel",r=>{r.ctrlKey&&r.preventDefault()},{passive:!1}),jQuery(i.container).off("wheel.icdt-init").on("wheel.icdt-init",r=>{var l;r.preventDefault();let a=null!==(l=r.originalEvent)&&void 0!==l?l:r;if(!a.deltaX&&a.deltaY!=Math.floor(a.deltaY)||a.ctrlKey){var s=y.screen.scale;y.screen.scaleTo(s-.04*s*(a.deltaY>0?1:-1),Qe({x:r.clientX,y:r.clientY},1,{x:0,y:0},y.screen.offset))}else y.screen.move(y.screen.dislocation,{x:-a.deltaX,y:-a.deltaY})}),jQuery(window).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{y.screen.actived=!!jQuery(r.target).parents(y.container).length}),jQuery(i.container).off("mouseenter.icdt-init").on("mouseenter.icdt-init",r=>{}),jQuery(i.container).off("mouseleave.icdt-init").on("mouseleave.icdt-init",r=>{y.pointer.pointer_type_temp==et.HAND&&(y.pointer.pointer_type_temp=et.POINTER)}),jQuery(i.container).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{0==r.button&&(i.container.includes("#")&&i.container.includes(r.target.getAttribute("id"))||i.container.includes(".")&&i.container.includes(r.target.getAttribute("class"))||i.container.includes(r.target.nodeName))&&(y.pointer.pointer_type_temp||y.pointer.pointer_type)===et.POINTER&&(y.dataSelect.ids=[])}),jQuery(i.container).off("touchmove.icdt-init").on("touchmove.icdt-init",r=>{r.preventDefault()});const e=r=>{switch(y.pointer.pointer_type_temp||y.pointer.pointer_type){case et.POINTER:var a,s,o;("touchstart"==(null===(a=r.touchEvent)||void 0===a?void 0:a.type)||"mousedown"==(null===(s=r.mouseEvent)||void 0===s?void 0:s.type)||"dblclick"==(null===(o=r.mouseEvent)||void 0===o?void 0:o.type))&&dc(r);break;case et.HAND:var d,c;("touchstart"==(null===(d=r.touchEvent)||void 0===d?void 0:d.type)||"mousedown"==(null===(c=r.mouseEvent)||void 0===c?void 0:c.type))&&(i=>{Nt(i,new uc,1,{x:0,y:0})})(r);break;case et.PEN:var u,h;("touchstart"==(null===(u=r.touchEvent)||void 0===u?void 0:u.type)||"mousedown"==(null===(h=r.mouseEvent)||void 0===h?void 0:h.type))&&(i=>{switch(y.pointer.pen_type){case de.DRAW:Nt(i,new Ec);break;case de.HIGHTLIGH:Nt(i,new _c);break;case de.INTERACTIVE:Ur(i)}})(r);break;case et.SHAPE:var f,g;("touchstart"==(null===(f=r.touchEvent)||void 0===f?void 0:f.type)||"mousedown"==(null===(g=r.mouseEvent)||void 0===g?void 0:g.type))&&(i=>{var t=null;switch(y.pointer.shape_type){case C.CIRCLE:t=new hc;break;case C.ELLIPSE:t=new fc;break;case C.LINE:t=new yc;break;case C.RECT:t=new gc;break;case C.POLYGON:var e;t=new vc(null===(e=Vs.find(n=>n.type==y.pointer.polygon_type))||void 0===e?void 0:e.ratios);break;case C.FOREIGNOBJECT:t=new Lr;break;case C.IMAGE:t=new Pr;break;case C.TEXT:case C.PATH:t=new Br}t&&Nt(i,t)})(r);break;case et.FOREIGNOBJECT:var w,p;("touchstart"==(null===(w=r.touchEvent)||void 0===w?void 0:w.type)||"mousedown"==(null===(p=r.mouseEvent)||void 0===p?void 0:p.type))&&(i=>{Nt(i,new Lr)})(r);break;case et.IMAGE:var v,k;("touchstart"==(null===(v=r.touchEvent)||void 0===v?void 0:v.type)||"mousedown"==(null===(k=r.mouseEvent)||void 0===k?void 0:k.type))&&(i=>{Nt(i,new Pr)})(r);break;case et.TEXT:var b,m;("touchstart"==(null===(b=r.touchEvent)||void 0===b?void 0:b.type)||"mousedown"==(null===(m=r.mouseEvent)||void 0===m?void 0:m.type))&&(i=>{Nt(i,new Bc)})(r);break;case et.ERASER:var x,T;("touchstart"==(null===(x=r.touchEvent)||void 0===x?void 0:x.type)||"mousedown"==(null===(T=r.mouseEvent)||void 0===T?void 0:T.type))&&(i=>{Nt(i,new zc)})(r);break;case et.INDEX:var _,I;("touchstart"==(null===(_=r.touchEvent)||void 0===_?void 0:_.type)||"mousedown"==(null===(I=r.mouseEvent)||void 0===I?void 0:I.type))&&Qc(r)}};let n=!1;jQuery(i.target).off("touchstart.icdt-init").on("touchstart.icdt-init",r=>{n=!0,e({touchEvent:r})}),jQuery(i.target).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{if(1!=r.button){if(n)return void(n=!1);e({mouseEvent:r})}}),jQuery(i.target).off("dblclick.icdt-init").on("dblclick.icdt-init",r=>{if(1!=r.button){if(n)return void(n=!1);e({mouseEvent:r})}}),i.iskeyboard&&(jQuery(window).off("keydown.icdt-init").on("keydown.icdt-init",r=>{y.screen.actived&&(y.dataSelect.contenteditable_id||((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),Qr(r)))}),jQuery(window).off("keyup.icdt-init").on("keyup.icdt-init",r=>{y.screen.actived&&(y.dataSelect.contenteditable_id||((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),Qr(r)))}))})({container:t.container,target:t.target,iskeyboard:t.iskeyboard})}},ie=i=>!!i.match("^#[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$"),un=i=>!!i.match(/^rgba?/),ll=i=>!!i.match(/^none|transparent$/),Zc=(i,t)=>{ol(i,null,t,i);var n=o=>{var d;"text"==o.nodeName?(o=>{var d;null!==(d=o.child)&&void 0!==d&&d.length&&(o.nodeName="g",o.child=o.child.reduce((c,u,h,f)=>{if("tspan"==u.nodeName){let p=c.find(v=>v.fill==u.fill&&v.y==u.y&&v["font-family"]==u["font-family"]&&v["font-weight"]==u["font-weight"]&&v["font-style"]==u["font-style"]&&v["font-size"]==u["font-size"]);var g,w;p?(p.x=Math.min(parseFloat(null!==(g=p.x)&&void 0!==g?g:"0"),parseFloat(null!==(w=u.x)&&void 0!==w?w:"0")),p.textContent+=u.textContent):(u.nodeName="text",c.push(u))}else c.push(u);return c},[]))})(o):null!==(d=o.child)&&void 0!==d&&d.length&&o.child.forEach(c=>n(c))},r=o=>o.reduce((d,c,u,h)=>{var f;if("g"==c.nodeName&&null!==(f=c.child)&&void 0!==f&&f.length&&(c.child=r(c.child)),"text"==c.nodeName){let p=d.find(v=>v.fill==c.fill&&v.y==c.y&&v["font-family"]==c["font-family"]&&v["font-weight"]==c["font-weight"]&&v["font-style"]==c["font-style"]&&v["font-size"]==c["font-size"]);var g,w;p?(p.x=Math.min(parseFloat(null!==(g=p.x)&&void 0!==g?g:"0"),parseFloat(null!==(w=c.x)&&void 0!==w?w:"0")),p.textContent+=c.textContent):d.push(c)}else d.push(c);return d},[]);t.forEach(o=>n(o)),t=r(t),console.log("SVG2JSON",t);let l=((o,d,c,u,h)=>{let f=null===(o=i.getAttribute("viewBox"))||void 0===o||null===(o=o.replace(/^([0-9\.]+)[\s]([0-9\.]+)[\s\,]([0-9\.]+)[\s\,]([0-9\.]+)$/g,"$1,$2,$3,$4"))||void 0===o||null===(o=o.split(","))||void 0===o?void 0:o.map(g=>E(parseFloat(g),1));return 4==(null==f?void 0:f.length)?{x:f[0],y:f[1],width:f[2],height:f[3]}:{x:null!==(d=Ti(i.getAttribute("x")))&&void 0!==d?d:0,y:null!==(c=Ti(i.getAttribute("y")))&&void 0!==c?c:0,width:null!==(u=Ti(i.getAttribute("width")))&&void 0!==u?u:0,height:null!==(h=Ti(i.getAttribute("height")))&&void 0!==h?h:0}})(),a={id:y.data.newSlideId,name:"SVG",svg:{viewBox:l,nodes:al(t)}};if(console.log(a),a.svg&&(!a.svg.viewBox.width||!a.svg.viewBox.height)){var s;let o=0,d=0,c=u=>{u.forEach(h=>{var f;let{size:g}=h;o=Math.max(o,g.width),d=Math.max(d,g.height),c(null!==(f=h.nodes)&&void 0!==f?f:[])})};c(null!==(s=a.svg.nodes)&&void 0!==s?s:[]),a.svg.viewBox.width=o,a.svg.viewBox.height=d}return a},al=(i,t)=>{let e=[];return i.forEach(n=>{let r={id:Math.ceil(1e9*Math.random()),pid:t,name:n.nodeName,type:(()=>{switch(n.nodeName){case"polygon":return C.POLYGON;case"polyline":return C.POLYLINE;case"path":return C.PATH;case"circle":return C.CIRCLE;case"ellipse":return C.ELLIPSE;case"line":return C.LINE;case"rect":return C.RECT;case"foreignObject":return C.FOREIGNOBJECT;case"image":return C.IMAGE;case"text":return C.TEXT;case"tspan":return C.TSPAN;case"g":return C.GROUP}return 0})(),size:((l,a)=>{let s={},o=0,d=0,c=0,u=0,h=null!==(l=n.rotate)&&void 0!==l?l:null;switch(n.nodeName){case"circle":{let f=parseFloat(n.cx||"0"),g=parseFloat(n.cy||"0"),w=parseFloat(n.r||"0");o=f-w,d=g-w,c=2*w,u=2*w;break}case"ellipse":{let f=parseFloat(n.cx||"0"),g=parseFloat(n.cy||"0"),w=parseFloat(n.rx||"0"),p=parseFloat(n.ry||"0");o=f-w,d=g-p,c=2*w,u=2*p;break}case"line":{let f=parseFloat(n.x1||"0"),g=parseFloat(n.y1||"0"),w=parseFloat(n.x2||"0"),p=parseFloat(n.y2||"0"),v=999999999,k=999999999,b=0,m=0;v=Math.min(f,w),k=Math.min(g,p),b=Math.max(f,w),m=Math.max(g,p),o=v,d=k,c=b-o||1,u=m-d||1,Object.assign(s,{ratios:[[(f-o)/c,(g-d)/u],[(w-o)/c,(p-d)/u]]});break}case"rect":o=parseFloat(n.x||"0"),d=parseFloat(n.y||"0"),c=parseFloat(n.width||"0"),u=parseFloat(n.height||"0"),Object.assign(s,{x:o,y:d,width:c,height:u});break;case"foreignObject":case"image":o=parseFloat(n.x||"0"),d=parseFloat(n.y||"0"),c=parseFloat(n.width||"0"),u=parseFloat(n.height||"0");break;case"text":case"tspan":s.x||s.y||(n.x&&(o=parseFloat(n.x||"0")),n.y&&(d=parseFloat(n.y||"0"))),(f=>{let g=16;var w,p,v;f&&(g=f.match(/rem/)?16*parseInt(f):parseInt(f)),u=1.2*(w=g),c=w/14*8*(null!==(p=null===(v=n.textContent)||void 0===v?void 0:v.length)&&void 0!==p?p:1),n["alignment-baseline"]||n["dominant-baseline"]||(d-=w)})(n["font-size"]||"16");break;case"polygon":case"polyline":{if(!n.points)break;let f=(i=>{return(t=i.replace(/\,/g," ").replace(/\-/g," -").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim())?t.split(/\s/).map(e=>parseFloat(e)):[];var t})(n.points),{minX:g,minY:w,maxX:p,maxY:v}=(i=>{let t=[],e=[];return i.forEach((n,r)=>{r%2==0?t.push(n):e.push(n)}),{minX:Math.min.apply(null,t),minY:Math.min.apply(null,e),maxX:Math.max.apply(null,t),maxY:Math.max.apply(null,e)}})(f);o=g,d=w,c=p-o||1,u=v-d||1,Object.assign(s,{ratios:ud({x:o,y:d,width:c,height:u},f)});break}case"path":{if(!n.d)break;let f=Pe(n.d),{minX:g,minY:w,maxX:p,maxY:v}=Me(f);o=g,d=w,c=p-o||1,u=v-d||1,Object.assign(s,{ratioMaps:Ke({x:o,y:d,width:c,height:u},f)});break}}return null!=(f=null===(a=n.transform)||void 0===a||null===(a=a.replace(/\,/," "))||void 0===a?void 0:a.replace(/\s+/g," "))&&f.match(/rotate\([^\)]+\)/)&&(k=null===(g=null!==(w=null==f?void 0:f.match(/rotate\([^\)]+\)/))&&void 0!==w?w:[])||void 0===g||null===(g=g.shift())||void 0===g?void 0:g.toString())&&(m=null==k||null===(b=k.replace(/[^0-9\-\.\,\ ]/g,""))||void 0===b||null===(b=b.replace(/\,/g," "))||void 0===b||null===(b=b.replace(/\s+/g," "))||void 0===b?void 0:b.split(" ")).length&&Object.assign(s,{rotate:parseFloat(m[0]||"0")}),null!=f&&f.match(/translate\([^\)]+\)/)&&(k=>{var b;k&&(m=>{m.length>=2&&(o+=parseFloat(m[0]||"0"),d+=parseFloat(m[1]||"0"))})(null==k||null===(b=k.replace(/[^0-9\-\.\,\ ]/g,""))||void 0===b||null===(b=b.replace(/\,/g," "))||void 0===b||null===(b=b.replace(/\s+/g," "))||void 0===b?void 0:b.split(" "))})(null===(p=null!==(v=null==f?void 0:f.match(/translate\([^\)]+\)/))&&void 0!==v?v:[])||void 0===p||null===(p=p.shift())||void 0===p?void 0:p.toString()),null!=f&&f.match(/matrix\([^\)]+\)/)&&(k=>{if(k){var b;let m=bi({x:o,y:d},k);o=m.x,d=m.y,h=null!==(b=m.rotate)&&void 0!==b?b:null}})(f),Object.assign(s,{x:o,y:d,width:c,height:u,rotate:h}),s;var f,g,w,k,b,m,p,v})(),attribute:(()=>{let l={};switch(n.fill&&(l.fill=un(m=n.fill)?yi(m):ie(m)?m:ll(m)?"rgba(0,0,0,0)":"#000000"),n["fill-opacity"]&&(l.fillOpacity=n["fill-opacity"]),n["fill-rule"]&&(l.fillRule=n["fill-rule"]),n.stroke&&(m=>{l.stroke=un(m)?yi(m):ie(m)?m:ll(m)?"rgba(0,0,0,0)":"#000000"})(n.stroke),n["stroke-opacity"]&&(l.strokeOpacity=n["stroke-opacity"]),n["stroke-width"]&&(l.strokeWidth=parseFloat(n["stroke-width"])||0),n["stroke-linecap"]&&(l.strokeLinecap=n["stroke-linecap"]),n["stroke-linejoin"]&&(l.strokeLinejoin=n["stroke-linejoin"]),n["stroke-miterlimit"]&&(l.strokeMiterlimit=parseFloat(n["stroke-miterlimit"])||0),n["stroke-dasharray"]&&(l.strokeDasharray=parseFloat(n["stroke-dasharray"])||0),n.nodeName){case"polygon":case"polyline":{var a;let m=null!==(a=n.points)&&void 0!==a?a:null;Object.assign(l,{points:m});break}case"path":{var s;let m=null!==(s=n.d)&&void 0!==s?s:null;Object.assign(l,{d:m});break}case"circle":case"ellipse":case"line":case"rect":case"foreignObject":case"image":break;case"text":case"tspan":{var o,d,c,u,h,f,g,w,p;let m=null!==(o=n["font-family"])&&void 0!==o?o:null,x=null!==(d=n["font-weight"])&&void 0!==d?d:null,T=null!==(c=n["font-style"])&&void 0!==c?c:null,_=null!==(u=n["font-size"])&&void 0!==u?u:null,I=null!==(h=n["letter-spacing"])&&void 0!==h?h:null,F=null!==(f=n["word-spacing"])&&void 0!==f?f:null,O=null!==(g=n["alignment-baseline"])&&void 0!==g?g:null,N=null!==(w=n["dominant-baseline"])&&void 0!==w?w:null,B=null!==(p=n["text-anchor"])&&void 0!==p?p:null;if(m){var v,k,b;let R=Yi(m);m=null!==(v=R.fontFamily)&&void 0!==v?v:m,x=null!==(k=R.fontWeight)&&void 0!==k?k:x,T=null!==(b=R.fontStyle)&&void 0!==b?b:T}O||N||(N="text-before-edge"),Object.assign(l,{fontFamily:m,fontWeight:x,fontStyle:T,letterSpacing:I,wordSpacing:F,alignmentBaseline:O,dominantBaseline:N,textAnchor:B}),_&&(_.match(/rem/)?Object.assign(l,{fontSize:16*parseInt(_)}):Object.assign(l,{fontSize:parseInt(_)}));break}}var m;return l})(),style:{},source:(()=>{let l={};switch(n.nodeName){case"polygon":case"polyline":case"circle":case"ellipse":case"line":case"rect":case"foreignObject":break;case"image":n.base64&&Object.assign(l,{type:"image",image:{base64:n.base64}});break;case"text":case"tspan":n.textContent&&Object.assign(l,{type:"text",text:{textContent:n.textContent}})}return l})()};if(e.push(r),n.child){let l=al(n.child,r.id);e=[...e,...l]}}),e},ol=(i,t,e,n)=>{i.querySelectorAll(":scope > *").forEach(r=>{if(["defs","script"].includes(r.nodeName))return;let l=[],a={};switch("use"===(_i(r,a),a=Object.assign({},null!=t?t:{},a),a.nodeName)&&(a.href?_i(n.querySelector(a.href),a):a["xlink:href"]&&_i(n.querySelector(a["xlink:href"]),a)),a.nodeName){case"circle":case"ellipse":var s;if(null!==(s=a.transform)&&void 0!==s&&s.match(/matrix\([^\)]+\)/)){var o,d;let N=parseFloat(null!==(o=a.x)&&void 0!==o?o:"0"),B=parseFloat(null!==(d=a.y)&&void 0!==d?d:"0");(R=>{if(R){var S;let A=bi({x:N,y:B},R);a.x=A.x,a.y=A.y,a.rotate=null!==(S=A.rotate)&&void 0!==S?S:null}})(a.transform),a.transform=null}break;case"text":{var c,u;if(null!==(c=a.transform)&&void 0!==c&&c.match(/matrix\([^\)]+\)/)){var h,f;let B=parseFloat(null!==(h=a.x)&&void 0!==h?h:"0"),R=parseFloat(null!==(f=a.y)&&void 0!==f?f:"0");(S=>{if(S){var A;let J=bi({x:B,y:R},S);a.x=J.x,a.y=J.y,a.rotate=null!==(A=J.rotate)&&void 0!==A?A:null}})(a.transform),a.transform=null}else if(null!==(u=a.transform)&&void 0!==u&&u.match(/translate\([^\)]+\)/)){var g,w,p,v,k;let B=parseFloat(null!==(g=a.x)&&void 0!==g?g:"0"),R=parseFloat(null!==(w=a.y)&&void 0!==w?w:"0");(S=null===(p=null!==(v=null===(k=a.transform)||void 0===k?void 0:k.match(/translate\([^\)]+\)/))&&void 0!==v?v:[])||void 0===p||null===(p=p.shift())||void 0===p?void 0:p.toString())&&(J=null==S||null===(A=S.replace(/[^0-9\-\.\,\ ]/g,""))||void 0===A||null===(A=A.replace(/\,/g," "))||void 0===A||null===(A=A.replace(/\s+/g," "))||void 0===A?void 0:A.split(" ")).length>=2&&(a.x=B+parseFloat(J[0]||"0"),a.y=R+parseFloat(J[1]||"0")),a.transform=null}let N=r.textContent;N&&Object.assign(a,{textContent:N}),!a.fill&&!a.stroke&&(a.fill="#000000");break}case"tspan":{var b;if(null!==(b=a.transform)&&void 0!==b&&b.match(/matrix\([^\)]+\)/)){var m,x;let B=parseFloat(null!==(m=a.x)&&void 0!==m?m:"0"),R=parseFloat(null!==(x=a.y)&&void 0!==x?x:"0");(S=>{if(S){let A=bi({x:B,y:R},S);a.x=A.x,a.y=A.y}})(a.transform),a.transform=null}else{var T,_,I,F;let B=parseFloat(null!==(T=a.x)&&void 0!==T?T:"0"),R=parseFloat(null!==(_=a.y)&&void 0!==_?_:"0");a.x=E(B+(null!==(I=null==t?void 0:t.x)&&void 0!==I?I:0),10),a.y=E(R+(null!==(F=null==t?void 0:t.y)&&void 0!==F?F:0),10)}let N=r.textContent;N&&Object.assign(a,{textContent:N}),!a.fill&&!a.stroke&&(a.fill="#000000");break}case"path":if(a.d){var O;let N=((i,t)=>{let e=xr(t);return e?window.Snap.path.map(i,window.Snap.matrix(e.a,e.b,e.c,e.d,e.e,e.f)).toString():i})(a.d,null!==(O=a.transform)&&void 0!==O&&O.match(/matrix/)?a.transform:"matrix(1 0 0 1 0 0)");Object.assign(a,{d:N}),a.transform=null}!a.fill&&!a.stroke&&(a.fill="#000000");break;case"image":{let N=a["xlink:href"]||a.href;null!=N&&N.match(/;base64,/)&&Object.assign(a,{base64:N});break}}var S,A,J;ol(r,a,l,n),l.length&&Object.assign(a,{child:l}),e.push(a)})},_i=(i,t)=>{if(i){if(["symbol"].includes(i.nodeName))return void _i((i.querySelectorAll(":scope > *")||[])[0],t);t.nodeName=i.nodeName,[["x","y","width","height"],["x1","x2","y1","y2"],["rx","ry","r"],["cx","cy"],["fill","fill-opacity","fill-rule"],["stroke","stroke-opacity","stroke-width","stroke-miterlimit","stroke-linecap","stroke-linejoin","stroke-dasharray"],["d","points"],["font-family","font-weight","font-style","font-size","letter-spacing","word-spacing","alignment-baseline","dominant-baseline","text-anchor"],["transform","transform-origin"],["href","xlink:href"]].forEach(e=>{e.forEach(n=>{Yc(i,t,n)})})}},Yc=(i,t,e)=>{let n=i.getAttribute(e);if(n){let r={};r[e]=n.trim(),Object.assign(t,r)}},Ti=i=>{return i?"string"==typeof i?i.match(/in/)?E(96*parseFloat(null!==(t=i.replace(/[^0-9\.]/g,""))&&void 0!==t?t:"0"),1):E(parseFloat(null!==(e=i.replace(/[^0-9\.]/g,""))&&void 0!==e?e:"0"),1):"number"==typeof i?i:0:0;var t,e},Vc=(i,t)=>{var e={data:{slides:[]},info:{},resources:[],screen:{w:0,h:0,width:0,height:0},variable:{conditions:[],variables:[]}};return(e=i.shift()).data=e.data||{slides:[]},e.data.slides=e.data.slides||[],e.variable=e.variable||{conditions:[],variables:[]},e.variable.conditions=e.variable.conditions||[],e.variable.variables=e.variable.variables||[],i.forEach((n,r)=>{var a=(n.data||{slides:[]}).slides||[],s=n.variable||{conditions:[],variables:[]},o=s.conditions||[],d=s.variables||[];a.forEach(function(h){if(a.find(function(w){return w.id==h.id})){var f=h.id.toString(),g=y.data.newSlideId;h.id=g,a.forEach(function(w){var p;null!==(p=w.svg)&&void 0!==p&&p.nodes&&(w.svg.nodes=JSON.parse(JSON.stringify(w.svg.nodes).replace(new RegExp(f,"g"),g.toString())))}),o=JSON.parse(JSON.stringify(o).replace(new RegExp(f,"g"),g.toString()))}});var c=e.variable.variables.map(function(h){return h.key});d=d.filter(function(h){return c.indexOf(h.key)<0});var u=e.variable.conditions.length;o.sort(function(h,f){return h.idx-f.idx}).map(function(h,f){return h.idx=f+1,h}).forEach(function(h,f){console.log(`${r}(b=${n.board_id}) -> ${h.idx} + ${u} = ${h.idx+u}`),h.idx=h.idx+u}),e.data.slides=e.data.slides.concat(a),e.variable.conditions=e.variable.conditions.concat(o),e.variable.variables=e.variable.variables.concat(d)}),e},$c=(i,t)=>{let{id:e,size:n,animate:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,animate:r}));r?r.value=t:r={value:t},y.history.push([{type:"animate",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,animate:r}))}])},tu=(i,t)=>{let{id:e,size:n,animate:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,animate:r}));r?r.in=t:r={in:t},y.history.push([{type:"animate",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,animate:r}))}])},eu=(i,t)=>{let{id:e,size:n,animate:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,animate:r}));r?r.out=t:r={out:t},y.history.push([{type:"animate",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,animate:r}))}])},iu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.action?n.show.action.value=t:n.show.action={value:t}:n.show={action:{value:t}}:n={show:{action:{value:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},nu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.action?n.show.action.points=t:n.show.action={points:t}:n.show={action:{points:t}}:n={show:{action:{points:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},ru=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.action?n.show.action.time=t:n.show.action={time:t}:n.show={action:{time:t}}:n={show:{action:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},lu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.action?n.show.action.iteration=t:n.show.action={iteration:t}:n.show={action:{iteration:t}}:n={show:{action:{iteration:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},au=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.action?n.show.action.finish=t:n.show.action={finish:t}:n.show={action:{finish:t}}:n={show:{action:{finish:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},ou=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.audio?n.show.audio.source=t:n.show.audio={source:t}:n.show={audio:{source:t}}:n={show:{audio:{source:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},su=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.audio?n.show.audio.iteration=t:n.show.audio={iteration:t}:n.show={audio:{iteration:t}}:n={show:{audio:{iteration:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}]),-1==t&&hn(i,"change-slide")},du=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.audio?n.show.audio.finish=t:n.show.audio={finish:t}:n.show={audio:{finish:t}}:n={show:{audio:{finish:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},hn=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.audio?n.show.audio.async=t:n.show.audio={async:t}:n.show={audio:{async:t}}:n={show:{audio:{async:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},cu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.audio?n.show.audio.time=t:n.show.audio={time:t}:n.show={audio:{time:t}}:n={show:{audio:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},uu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggershow?n.show.triggershow.id=t:n.show.triggershow={id:t}:n.show={triggershow:{id:t}}:n={show:{triggershow:{id:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},hu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggershow?n.show.triggershow.ids=t:n.show.triggershow={ids:t}:n.show={triggershow:{ids:t}}:n={show:{triggershow:{ids:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},fu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggershow?n.show.triggershow.async=t:n.show.triggershow={async:t}:n.show={triggershow:{async:t}}:n={show:{triggershow:{async:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},gu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggershow?n.show.triggershow.time=t:n.show.triggershow={time:t}:n.show={triggershow:{time:t}}:n={show:{triggershow:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},vu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerrun?n.show.triggerrun.id=t:n.show.triggerrun={id:t}:n.show={triggerrun:{id:t}}:n={show:{triggerrun:{id:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},yu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerrun?n.show.triggerrun.ids=t:n.show.triggerrun={ids:t}:n.show={triggerrun:{ids:t}}:n={show:{triggerrun:{ids:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},pu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerrun?n.show.triggerrun.async=t:n.show.triggerrun={async:t}:n.show={triggerrun:{async:t}}:n={show:{triggerrun:{async:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},mu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerrun?n.show.triggerrun.time=t:n.show.triggerrun={time:t}:n.show={triggerrun:{time:t}}:n={show:{triggerrun:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},wu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerhide?n.show.triggerhide.id=t:n.show.triggerhide={id:t}:n.show={triggerhide:{id:t}}:n={show:{triggerhide:{id:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},bu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerhide?n.show.triggerhide.ids=t:n.show.triggerhide={ids:t}:n.show={triggerhide:{ids:t}}:n={show:{triggerhide:{ids:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},xu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerhide?n.show.triggerhide.async=t:n.show.triggerhide={async:t}:n.show={triggerhide:{async:t}}:n={show:{triggerhide:{async:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},ku=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerhide?n.show.triggerhide.time=t:n.show.triggerhide={time:t}:n.show={triggerhide:{time:t}}:n={show:{triggerhide:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Su=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.action?n.click.action.value=t:n.click.action={value:t}:n.click={action:{value:t}}:n={click:{action:{value:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Ou=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.action?n.click.action.points=t:n.click.action={points:t}:n.click={action:{points:t}}:n={click:{action:{points:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Nu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.action?n.click.action.time=t:n.click.action={time:t}:n.click={action:{time:t}}:n={click:{action:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Eu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.action?n.click.action.iteration=t:n.click.action={iteration:t}:n.click={action:{iteration:t}}:n={click:{action:{iteration:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},_u=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.action?n.click.action.finish=t:n.click.action={finish:t}:n.click={action:{finish:t}}:n={click:{action:{finish:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Tu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.audio?n.click.audio.source=t:n.click.audio={source:t}:n.click={audio:{source:t}}:n={click:{audio:{source:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Fu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.audio?n.click.audio.iteration=t:n.click.audio={iteration:t}:n.click={audio:{iteration:t}}:n={click:{audio:{iteration:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}]),-1==t&&hn(i,"change-slide")},Cu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.audio?n.click.audio.finish=t:n.click.audio={finish:t}:n.click={audio:{finish:t}}:n={click:{audio:{finish:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Ju=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.audio?n.click.audio.async=t:n.click.audio={async:t}:n.click={audio:{async:t}}:n={click:{audio:{async:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Iu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.audio?n.click.audio.time=t:n.click.audio={time:t}:n.click={audio:{time:t}}:n={click:{audio:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Au=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggershow?n.click.triggershow.id=t:n.click.triggershow={id:t}:n.click={triggershow:{id:t}}:n={click:{triggershow:{id:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},ju=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggershow?n.click.triggershow.ids=t:n.click.triggershow={ids:t}:n.click={triggershow:{ids:t}}:n={click:{triggershow:{ids:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},zu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggershow?n.click.triggershow.async=t:n.click.triggershow={async:t}:n.click={triggershow:{async:t}}:n={click:{triggershow:{async:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Ru=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggershow?n.click.triggershow.time=t:n.click.triggershow={time:t}:n.click={triggershow:{time:t}}:n={click:{triggershow:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Bu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerrun?n.click.triggerrun.id=t:n.click.triggerrun={id:t}:n.click={triggerrun:{id:t}}:n={click:{triggerrun:{id:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Lu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerrun?n.click.triggerrun.ids=t:n.click.triggerrun={ids:t}:n.click={triggerrun:{ids:t}}:n={click:{triggerrun:{ids:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Pu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerrun?n.click.triggerrun.async=t:n.click.triggerrun={async:t}:n.click={triggerrun:{async:t}}:n={click:{triggerrun:{async:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Mu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerrun?n.click.triggerrun.time=t:n.click.triggerrun={time:t}:n.click={triggerrun:{time:t}}:n={click:{triggerrun:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Ku=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerhide?n.click.triggerhide.id=t:n.click.triggerhide={id:t}:n.click={triggerhide:{id:t}}:n={click:{triggerhide:{id:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Gu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerhide?n.click.triggerhide.ids=t:n.click.triggerhide={ids:t}:n.click={triggerhide:{ids:t}}:n={click:{triggerhide:{ids:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Qu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerhide?n.click.triggerhide.async=t:n.click.triggerhide={async:t}:n.click={triggerhide:{async:t}}:n={click:{triggerhide:{async:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Du=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerhide?n.click.triggerhide.time=t:n.click.triggerhide={time:t}:n.click={triggerhide:{time:t}}:n={click:{triggerhide:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Uu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.slide?(n.click.slide.id=null==t?void 0:t.id,n.click.slide.code=null==t?void 0:t.code):n.click.slide=t:n.click={slide:t}:n={click:{slide:t}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Hu=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.media=t:n.click={media:t}:n={click:{media:t}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Wu=(i,t)=>{let{id:e,variable:n}=i,r=JSON.parse(JSON.stringify({id:e,variable:n}));n?n.input?n.input.variable=t:n.input={variable:t}:n={input:{variable:t}},y.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:e,variable:n}))}])},qu=(i,t)=>{let{id:e,variable:n}=i,r=JSON.parse(JSON.stringify({id:e,variable:n}));n?n.click?n.click.variable=t:n.click={variable:t}:n={click:{variable:t}},y.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:e,variable:n}))}])},Xu=(i,t)=>{let{id:e,variable:n}=i,r=JSON.parse(JSON.stringify({id:e,variable:n}));n?n.click?n.click.operator=t:n.click={operator:t}:n={click:{operator:t}},y.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:e,variable:n}))}])},Zu=(i,t)=>{let{id:e,variable:n}=i,r=JSON.parse(JSON.stringify({id:e,variable:n}));n?n.click?n.click.valuetype=t:n.click={valuetype:t}:n={click:{valuetype:t}},y.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:e,variable:n}))}])},Yu=(i,t)=>{let{id:e,variable:n}=i,r=JSON.parse(JSON.stringify({id:e,variable:n}));n?n.click?n.click.value=t:n.click={value:t}:n={click:{value:t}},y.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:e,variable:n}))}])},Vu=i=>{let t=[];i.forEach((n,r)=>{let{id:l,size:a,attribute:s}=n;t.push(JSON.parse(JSON.stringify({id:l,size:a,attribute:s})))});let e=999999;for(let{size:n}of i)e=Math.min(e,n.x);for(let{id:n,type:r,size:l,attribute:a}of i)l.x=e,Object.assign(a,W(r,l,a)),K(window.document.getElementById(n),a);y.history.push(i.map((n,r)=>{let{id:l,size:a,attribute:s}=n;return{type:"size",from:t[r],to:JSON.parse(JSON.stringify({id:l,size:a,attribute:s}))}}))},$u=i=>{let t=[];i.forEach((n,r)=>{let{id:l,size:a,attribute:s}=n;t.push(JSON.parse(JSON.stringify({id:l,size:a,attribute:s})))});let e=999999;for(let{size:n}of i)e=Math.min(e,n.y);for(let{id:n,type:r,size:l,attribute:a}of i)l.y=e,Object.assign(a,W(r,l,a)),K(window.document.getElementById(n),a);y.history.push(i.map((n,r)=>{let{id:l,size:a,attribute:s}=n;return{type:"size",from:t[r],to:JSON.parse(JSON.stringify({id:l,size:a,attribute:s}))}}))},th=i=>{let t=[];i.forEach((n,r)=>{let{id:l,size:a,attribute:s}=n;t.push(JSON.parse(JSON.stringify({id:l,size:a,attribute:s})))});let e=-999999;for(let{size:n}of i)e=Math.max(e,n.x+n.width);for(let{id:n,type:r,size:l,attribute:a}of i)l.x=e-l.width,Object.assign(a,W(r,l,a)),K(window.document.getElementById(n),a);y.history.push(i.map((n,r)=>{let{id:l,size:a,attribute:s}=n;return{type:"size",from:t[r],to:JSON.parse(JSON.stringify({id:l,size:a,attribute:s}))}}))},eh=i=>{let t=[];i.forEach((n,r)=>{let{id:l,size:a,attribute:s}=n;t.push(JSON.parse(JSON.stringify({id:l,size:a,attribute:s})))});let e=-999999;for(let{size:n}of i)e=Math.max(e,n.y+n.height);for(let{id:n,type:r,size:l,attribute:a}of i)l.y=e-l.height,Object.assign(a,W(r,l,a)),K(window.document.getElementById(n),a);y.history.push(i.map((n,r)=>{let{id:l,size:a,attribute:s}=n;return{type:"size",from:t[r],to:JSON.parse(JSON.stringify({id:l,size:a,attribute:s}))}}))},ih=i=>{let t=[];i.forEach((l,a)=>{let{id:s,size:o,attribute:d}=l;t.push(JSON.parse(JSON.stringify({id:s,size:o,attribute:d})))});let e=999999,n=-999999,r=0;for(let{size:l}of i)e=Math.min(e,l.x),n=Math.max(n,l.x+l.width);r=E((e+n)/2);for(let{id:l,type:a,size:s,attribute:o}of i)s.x=E(r-s.width/2),Object.assign(o,W(a,s,o)),K(window.document.getElementById(l),o);y.history.push(i.map((l,a)=>{let{id:s,size:o,attribute:d}=l;return{type:"size",from:t[a],to:JSON.parse(JSON.stringify({id:s,size:o,attribute:d}))}}))},nh=i=>{let t=[];i.forEach((l,a)=>{let{id:s,size:o,attribute:d}=l;t.push(JSON.parse(JSON.stringify({id:s,size:o,attribute:d})))});let e=999999,n=-999999,r=0;for(let{size:l}of i)e=Math.min(e,l.y),n=Math.max(n,l.y+l.height);r=E((e+n)/2);for(let{id:l,type:a,size:s,attribute:o}of i)s.y=E(r-s.height/2),Object.assign(o,W(a,s,o)),K(window.document.getElementById(l),o);y.history.push(i.map((l,a)=>{let{id:s,size:o,attribute:d}=l;return{type:"size",from:t[a],to:JSON.parse(JSON.stringify({id:s,size:o,attribute:d}))}}))},rh=i=>{var t,e;let n=[];i.forEach((l,a)=>{let{id:s,size:o,attribute:d}=l;n.push(JSON.parse(JSON.stringify({id:s,size:o,attribute:d})))});let r=null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox.x)&&void 0!==t?t:0;for(let{id:l,type:a,size:s,attribute:o}of i)s.x=r,Object.assign(o,W(a,s,o)),K(window.document.getElementById(l),o);y.history.push(i.map((l,a)=>{let{id:s,size:o,attribute:d}=l;return{type:"size",from:n[a],to:JSON.parse(JSON.stringify({id:s,size:o,attribute:d}))}}))},lh=i=>{var t,e;let n=[];i.forEach((l,a)=>{let{id:s,size:o,attribute:d}=l;n.push(JSON.parse(JSON.stringify({id:s,size:o,attribute:d})))});let r=null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox.y)&&void 0!==t?t:0;for(let{id:l,type:a,size:s,attribute:o}of i)s.y=r,Object.assign(o,W(a,s,o)),K(window.document.getElementById(l),o);y.history.push(i.map((l,a)=>{let{id:s,size:o,attribute:d}=l;return{type:"size",from:n[a],to:JSON.parse(JSON.stringify({id:s,size:o,attribute:d}))}}))},ah=i=>{var t,e;let n=[];i.forEach((s,o)=>{let{id:d,size:c,attribute:u}=s;n.push(JSON.parse(JSON.stringify({id:d,size:c,attribute:u})))});let{x:r,width:l}=null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{x:0,width:0},a=r+l;for(let{id:s,type:o,size:d,attribute:c}of i)d.x=a-d.width,Object.assign(c,W(o,d,c)),K(window.document.getElementById(s),c);y.history.push(i.map((s,o)=>{let{id:d,size:c,attribute:u}=s;return{type:"size",from:n[o],to:JSON.parse(JSON.stringify({id:d,size:c,attribute:u}))}}))},oh=i=>{var t,e;let n=[];i.forEach((s,o)=>{let{id:d,size:c,attribute:u}=s;n.push(JSON.parse(JSON.stringify({id:d,size:c,attribute:u})))});let{y:r,height:l}=null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{y:0,height:0},a=r+l;for(let{id:s,type:o,size:d,attribute:c}of i)d.y=a-d.height,Object.assign(c,W(o,d,c)),K(window.document.getElementById(s),c);y.history.push(i.map((s,o)=>{let{id:d,size:c,attribute:u}=s;return{type:"size",from:n[o],to:JSON.parse(JSON.stringify({id:d,size:c,attribute:u}))}}))},sh=i=>{var t,e;let n=[];i.forEach((d,c)=>{let{id:u,size:h,attribute:f}=d;n.push(JSON.parse(JSON.stringify({id:u,size:h,attribute:f})))});let{x:r,width:l}=null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{x:0,width:0},o=E((r+(r+l))/2);for(let{id:d,type:c,size:u,attribute:h}of i)u.x=E(o-u.width/2),Object.assign(h,W(c,u,h)),K(window.document.getElementById(d),h);y.history.push(i.map((d,c)=>{let{id:u,size:h,attribute:f}=d;return{type:"size",from:n[c],to:JSON.parse(JSON.stringify({id:u,size:h,attribute:f}))}}))},dh=i=>{var t,e;let n=[];i.forEach((d,c)=>{let{id:u,size:h,attribute:f}=d;n.push(JSON.parse(JSON.stringify({id:u,size:h,attribute:f})))});let{y:r,height:l}=null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{y:0,height:0},o=E((r+(r+l))/2);for(let{id:d,type:c,size:u,attribute:h}of i)u.y=E(o-u.height/2),Object.assign(h,W(c,u,h)),K(window.document.getElementById(d),h);y.history.push(i.map((d,c)=>{let{id:u,size:h,attribute:f}=d;return{type:"size",from:n[c],to:JSON.parse(JSON.stringify({id:u,size:h,attribute:f}))}}))},ch=i=>{if(i.length<3)return;let t=[];i.forEach((s,o)=>{let{id:d,size:u,attribute:h}=s;t.push(JSON.parse(JSON.stringify({id:d,size:u,attribute:h})))});let e=999999,n=-999999,r=[],l=i.length;for(let s=0;s<l;s++){let{id:o,size:d}=i[s];r.push({idx:s,id:o,x:d.x+d.width/2})}r=r.sort((s,o)=>s.x-o.x),e=r[0].x,n=r[l-1].x;let a=n-e;for(let s=1,o=r.length-2;s<=o;s++){let{id:d,type:c,size:u,attribute:h}=i[r[s].idx];u.x=e+a*s/(l-1)-u.width/2,Object.assign(h,W(c,u,h)),K(window.document.getElementById(d),h)}y.history.push(i.map((s,o)=>{let{id:d,size:u,attribute:h}=s;return{type:"size",from:t[o],to:JSON.parse(JSON.stringify({id:d,size:u,attribute:h}))}}))},uh=i=>{if(i.length<3)return;let t=[];i.forEach((s,o)=>{let{id:d,size:c,attribute:u}=s;t.push(JSON.parse(JSON.stringify({id:d,size:c,attribute:u})))});let e=999999,n=-999999,r=[],l=i.length;for(let s=0;s<l;s++){let{id:o,size:d}=i[s];r.push({idx:s,id:o,y:d.y+d.height/2})}r=r.sort((s,o)=>s.y-o.y),e=r[0].y,n=r[l-1].y;let a=n-e;for(let s=1,o=r.length-2;s<=o;s++){let{id:d,type:c,size:u,attribute:h}=i[r[s].idx];u.y=e+a*s/(l-1)-u.height/2,Object.assign(h,W(c,u,h)),K(window.document.getElementById(d),h)}y.history.push(i.map((s,o)=>{let{id:d,size:c,attribute:u}=s;return{type:"size",from:t[o],to:JSON.parse(JSON.stringify({id:d,size:c,attribute:u}))}}))},hh=i=>{var t,e;let n=[];i.forEach((a,s)=>{let{id:o,size:c,attribute:u}=a;n.push(JSON.parse(JSON.stringify({id:o,size:c,attribute:u})))});let{x:r,width:l}=null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{x:0,width:0};for(let{id:a,type:s,size:o,attribute:d}of i)o.x=r,o.width=l,Object.assign(d,W(s,o,d)),K(window.document.getElementById(a),d);y.history.push(i.map((a,s)=>{let{id:o,size:c,attribute:u}=a;return{type:"size",from:n[s],to:JSON.parse(JSON.stringify({id:o,size:c,attribute:u}))}}))},fh=i=>{var t,e;let n=[];i.forEach((a,s)=>{let{id:o,size:d,attribute:c}=a;n.push(JSON.parse(JSON.stringify({id:o,size:d,attribute:c})))});let{y:r,height:l}=null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{y:0,height:0};for(let{id:a,type:s,size:o,attribute:d}of i)o.y=r,o.height=l,Object.assign(d,W(s,o,d)),K(window.document.getElementById(a),d);y.history.push(i.map((a,s)=>{let{id:o,size:d,attribute:c}=a;return{type:"size",from:n[s],to:JSON.parse(JSON.stringify({id:o,size:d,attribute:c}))}}))},gh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));t?ie(t)&&(r.fill=t):r.fill=void 0,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},vh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.fillOpacity="number"==typeof t?E(t/100,100):void 0,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},yh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));t?ie(t)&&(r.stroke=t):r.stroke=void 0,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},ph=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.strokeOpacity="number"==typeof t?E(t/100,100):void 0,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},mh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.strokeWidth="number"==typeof t?E(t,100):void 0,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},wh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.strokeDasharray="number"==typeof t?E(t,100):void 0,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},bh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.strokeLinecap=t,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},xh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.strokeLinejoin=t,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},kh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.fontFamily=t,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Sh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.fontWeight=t,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Oh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.fontStyle=t,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Nh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.fontSize="number"==typeof t?E(t,100):void 0,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Eh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.textLength="number"==typeof t?E(t,100):void 0,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},_h=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.letterSpacing="number"==typeof t?E(t,100):void 0,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Th=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.wordSpacing="number"==typeof t?E(t,100):void 0,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Fh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.textDecoration=t,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Ch=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.textAnchor=t,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Jh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.dominantBaseline=t,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Ih=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.rx="number"==typeof t?E(t,100):void 0,K(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Ah=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.padding=E(t):n={padding:E(t)},wt(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},jh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.borderWidth=t:n={borderWidth:t},wt(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},zh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.borderStyle=t:n={borderStyle:t},wt(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Rh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n})),l=a=>{n?n.borderColor=a:n={borderColor:a}};t?ie(t)&&l(t):l(),wt(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Bh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.borderOpacity="number"==typeof t?E(t/100,100):void 0:n={borderOpacity:"number"==typeof t?E(t/100,100):void 0},wt(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Lh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.borderRadius=E(t):n={borderRadius:E(t)},wt(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Ph=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.fontFamily=t:n={fontFamily:t},wt(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Mh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.fontSize=t:n={fontSize:t},wt(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Kh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n})),l=a=>{n?n.color=a:n={color:a}};t?ie(t)&&l(t):l(),wt(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Gh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.opacity="number"==typeof t?E(t/100,100):void 0:n={opacity:"number"==typeof t?E(t/100,100):void 0},wt(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Qh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n})),l=a=>{n?n.backgroundColor=a:n={backgroundColor:a}};t?ie(t)&&l(t):l(),wt(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Dh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.backgroundOpacity="number"==typeof t?E(t/100,100):void 0:n={backgroundOpacity:"number"==typeof t?E(t/100,100):void 0},wt(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Uh=(i,t)=>{i.svg?i.svg.viewBox?i.svg.viewBox.x=E(t):i.svg.viewBox={x:E(t),y:0,width:1e3,height:1e3}:i.svg={viewBox:{x:E(t),y:0,width:1e3,height:1e3}}},Hh=(i,t)=>{i.svg?i.svg.viewBox?i.svg.viewBox.y=E(t):i.svg.viewBox={x:0,y:E(t),width:1e3,height:1e3}:i.svg={viewBox:{x:0,y:E(t),width:1e3,height:1e3}}},Wh=(i,t,e)=>{i.svg?i.svg.viewBox?(e&&(i.svg.viewBox.height=E(t*i.svg.viewBox.height/i.svg.viewBox.width)),i.svg.viewBox.width=E(t)):i.svg.viewBox={x:0,y:0,width:E(t),height:E(t)}:i.svg={viewBox:{x:0,y:0,width:E(t),height:E(t)}}},qh=(i,t,e)=>{i.svg?i.svg.viewBox?(e&&(i.svg.viewBox.width=E(t*i.svg.viewBox.width/i.svg.viewBox.height)),i.svg.viewBox.height=E(t)):i.svg.viewBox={x:0,y:0,width:E(t),height:E(t)}:i.svg={viewBox:{x:0,y:0,width:E(t),height:E(t)}}},Xh=(i,t)=>{i.svg?i.svg.background?i.svg.background.color=t:i.svg.background={color:t}:i.svg={background:{color:t}},ki(i)},Zh=(i,t)=>{i.svg?i.svg.background?i.svg.background.opacity="number"==typeof t?E(t/100,100):void 0:i.svg.background={opacity:"number"==typeof t?E(t/100,100):void 0}:i.svg={background:{opacity:"number"==typeof t?E(t/100,100):void 0}},ki(i)},Yh=(i,t)=>{i.svg?i.svg.background?(i.svg.background.path=null==t?void 0:t.path,i.svg.background.url=null==t?void 0:t.url,i.svg.background.name=null==t?void 0:t.name):i.svg.background=t:i.svg={background:t},ki(i)}}}]);