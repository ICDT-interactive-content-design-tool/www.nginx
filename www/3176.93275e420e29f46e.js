"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3176],{3176:(He,Z,p)=>{p.r(Z),p.d(Z,{ViewerPageModule:()=>Le});var I=p(177),U=p(9417),c=p(6637),$=p(3658),g=p(467),N=p(5972),q=p(2635),T=p(8833),tt=p(6539),t=p(4438),dt=p(7704),st=p(9780),W=p(6081),Y=p(4975),F=p(5414),ct=p(7331),mt=p(8405),_t=p(1038),et=p(5807),pt=p(2089),ut=p(9445),J=p(31);function gt(o,l){if(1&o){const i=t.RV6();t.j41(0,"button",32),t.bIt("click",function(e){t.eBV(i);const a=t.XpG(2);return t.Njj(a.clearTopic(e))}),t.nrm(1,"ion-icon",33),t.k0s()}}function vt(o,l){if(1&o){const i=t.RV6();t.j41(0,"button",32),t.bIt("click",function(e){t.eBV(i);const a=t.XpG(2);return t.Njj(a.clearCategory(e))}),t.nrm(1,"ion-icon",33),t.k0s()}}function ht(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-content",7)(1,"div",8)(2,"div",9)(3,"div",10)(4,"div",11)(5,"div",12)(6,"div",13)(7,"b",14),t.EFF(8),t.nI1(9,"translate"),t.k0s()(),t.j41(10,"input",15),t.bIt("change",function(e){t.eBV(i);const a=t.XpG();return t.Njj(a.changeBoardTitle(e))}),t.k0s()(),t.j41(11,"div",12)(12,"div",13)(13,"b",14),t.EFF(14),t.nI1(15,"translate"),t.k0s()(),t.j41(16,"div",16),t.nrm(17,"input",17),t.j41(18,"div",18),t.DNE(19,gt,2,0,"button",19),t.j41(20,"button",20),t.bIt("click",function(e){t.eBV(i);const a=t.XpG();return t.Njj(a.presentPopoverTopic(e))}),t.nrm(21,"ion-icon",21),t.k0s()()()(),t.j41(22,"div",12)(23,"div",13)(24,"b",14),t.EFF(25),t.nI1(26,"translate"),t.k0s()(),t.j41(27,"div",16),t.nrm(28,"input",17),t.j41(29,"div",18),t.DNE(30,vt,2,0,"button",19),t.j41(31,"button",20),t.bIt("click",function(e){t.eBV(i);const a=t.XpG();return t.Njj(a.presentPopoverCategory(e))}),t.nrm(32,"ion-icon",21),t.k0s()()()(),t.j41(33,"div",22)(34,"div",13)(35,"b",14),t.EFF(36),t.nI1(37,"translate"),t.k0s()(),t.j41(38,"div",16)(39,"div",23)(40,"input",24),t.bIt("change",function(e){t.eBV(i);const a=t.XpG();return t.Njj(a.changeBoardCover(e))}),t.k0s(),t.nrm(41,"label",25),t.k0s()()()(),t.j41(42,"div",26)(43,"div",12)(44,"div",13)(45,"b",14),t.EFF(46),t.nI1(47,"translate"),t.k0s()(),t.j41(48,"div",27)(49,"div",28),t.nrm(50,"ion-img",29),t.k0s()()()()(),t.j41(51,"div",30)(52,"div",13)(53,"b",14),t.EFF(54),t.nI1(55,"translate"),t.k0s()(),t.j41(56,"ckeditor",31),t.mxI("ngModelChange",function(e){t.eBV(i);const a=t.XpG();return t.DH7(a.board.board_description,e)||(a.board.board_description=e),t.Njj(e)}),t.k0s()(),t.j41(57,"div",30)(58,"div",13)(59,"b",14),t.EFF(60),t.nI1(61,"translate"),t.k0s()(),t.j41(62,"ckeditor",31),t.mxI("ngModelChange",function(e){t.eBV(i);const a=t.XpG();return t.DH7(a.board.board_content,e)||(a.board.board_content=e),t.Njj(e)}),t.k0s()()()()()}if(2&o){let i,n;const e=t.XpG();t.R7$(8),t.JRh(t.bMT(9,18,"LectureName")),t.R7$(2),t.Y8G("ngModel",e.board.board_title),t.R7$(4),t.JRh(t.bMT(15,20,"GradeLevel")),t.R7$(3),t.Y8G("value",null==(null!==(i=e.board.topic_titles)&&void 0!==i?i:e.board.topic_title)||null==(i=(null!=i?i:e.board.topic_title).split(";"))||null==(i=i.reverse())?null:i.join(" / ")),t.R7$(2),t.Y8G("ngIf",e.board.topic_id),t.R7$(6),t.JRh(t.bMT(26,22,"Subject")),t.R7$(3),t.Y8G("value",null==(null!==(n=e.board.category_title)&&void 0!==n?n:e.board.category_title)||null==(n=(null!=n?n:e.board.category_title).split(";"))||null==(n=n.reverse())?null:n.join(" / ")),t.R7$(2),t.Y8G("ngIf",e.board.category_id),t.R7$(6),t.JRh(t.bMT(37,24,"Cover")),t.R7$(10),t.JRh(t.bMT(47,26,"Cover")),t.R7$(4),t.Y8G("src",e.fileurl||e.coverUrl||"assets/image/no-image.svg")("alt",e.board.board_title),t.R7$(4),t.JRh(t.bMT(55,28,"Knowledge")),t.R7$(2),t.Y8G("editor",e.editorDescription),t.R50("ngModel",e.board.board_description),t.R7$(4),t.JRh(t.bMT(61,30,"ContentIntroduce")),t.R7$(2),t.Y8G("editor",e.editorContent),t.R50("ngModel",e.board.board_content)}}let bt=(()=>{var o;class l{constructor(n,e,a,r){this.modalController=n,this.popoverController=e,this.toastController=a,this.loadingController=r,this.b=0,this.editorDescription=et.m,this.editorContent=et.m,this.isfullscreen=!1,this.appsettings={},this.readfileuploadurl="",this.coverUrl="",this.coverv1Url="",this.board={}}ngOnInit(){var n=this;this.isfullscreen=window.document.body.classList.contains("modal-fullscreen"),(0,g.A)(function*(){n.appsettings=yield(0,N.AC)(),n.appsettings.madonvi&&(n.user=yield(0,q.Nk)(),n.readfileuploadurl=n.appsettings.readfileuploadurl||"",n.refreshData())})()}refreshData(){var n;(0,W.qU)({params:{userid:null===(n=this.user)||void 0===n?void 0:n.userid,board_id:this.b},callback:e=>{if((null==e?void 0:e.board_id)==this.b)return this.board=e,this.board.board_title=this.board.board_title+` (${Math.floor(999*Math.random())})`,void this.coverLoad();this.modalController.dismiss()}})}toggleFullScreen(){this.isfullscreen?window.document.body.classList.remove("modal-fullscreen"):window.document.body.classList.add("modal-fullscreen"),this.isfullscreen=window.document.body.classList.contains("modal-fullscreen")}close(){return this.modalController.dismiss(null,"cancel")}save(){var n=this;return(0,g.A)(function*(){if(!n.board.board_title)return void(0,F.c)(n.toastController,{message:"Nh\u1eadp t\xean b\xe0i gi\u1ea3ng!"}).then(a=>{a.present()});let e=[];n.boardCover&&e.push(new Promise((a,r)=>{var d;(0,_t.v)({params:{file:n.boardCover,subFolder:`board-cover/${null!==(d=n.board.board_id)&&void 0!==d?d:0}`,fileType:"image"},callback:s=>{var _;0==(null==s?void 0:s.ReturnCode)?n.board.cover=s.path+"/"+(null===(_=s.file)||void 0===_?void 0:_.name):(0,F.c)(n.toastController,{},{returncode:null==s?void 0:s.ReturnCode,returnmsg:null==s?void 0:s.ReturnName}).then(m=>{m.present()}),a(!0)}})})),Promise.all(e).then(a=>{var r;(0,Y.Wb)({loadingController:n.loadingController,params:{board_id:n.board.board_id,board_title:n.board.board_title,board_description:n.board.board_description,board_content:n.board.board_content,cover:n.board.cover,topic_id:n.board.topic_id,category_id:n.board.category_id,size_width:n.board.size_width,size_height:n.board.size_height,userid:null===(r=n.user)||void 0===r?void 0:r.userid},callback:d=>{(0,F.c)(n.toastController,{},d).then(s=>{s.present()}),0==(null==d?void 0:d.returncode)&&n.modalController.dismiss({id:null==d?void 0:d.id,title:n.board.board_title},"confirm")}})})})()}presentPopoverTopic(n){var e=this;return(0,g.A)(function*(){const a=yield e.popoverController.create({component:ct.E,componentProps:{selectedId:e.board.topic_id,filter:{for:"board"}},event:n,dismissOnSelect:!1,animated:!1,side:"right"});a.onDidDismiss().then(r=>{var d,s,_,m,u,v,b;"confirm"==r.role&&(Object.assign(e.board,{topic_id:null===(d=r.data)||void 0===d?void 0:d.topic_id,topic_title:null===(s=r.data)||void 0===s?void 0:s.topic_title,topic_titles:null===(_=r.data)||void 0===_?void 0:_.topic_titles}),null!==(m=r.data)&&void 0!==m&&m.category_id&&Object.assign(e.board,{category_id:null===(u=r.data)||void 0===u?void 0:u.category_id,category_title:null===(v=r.data)||void 0===v?void 0:v.category_title,category_titles:null===(b=r.data)||void 0===b?void 0:b.category_titles}))}),a.present()})()}clearTopic(n){Object.assign(this.board,{topic_id:null,topic_title:null,topic_titles:null})}changeTopic(n){this.board.topic_id=n}presentPopoverCategory(n){var e=this;return(0,g.A)(function*(){const a=yield e.popoverController.create({component:mt.P,componentProps:{selectedId:e.board.category_id,filter:{for:"board"}},event:n,dismissOnSelect:!1,animated:!1,side:"right"});a.onDidDismiss().then(r=>{var d,s,_;"confirm"==r.role&&Object.assign(e.board,{category_id:null===(d=r.data)||void 0===d?void 0:d.category_id,category_title:null===(s=r.data)||void 0===s?void 0:s.category_title,category_titles:null===(_=r.data)||void 0===_?void 0:_.category_titles})}),a.present()})()}clearCategory(n){Object.assign(this.board,{category_id:null,category_title:null,category_titles:null})}changeCategory(n){this.board.category_id=n}presentPopoverTemplate(n){var e=this;return(0,g.A)(function*(){const a=yield e.popoverController.create({component:pt.B,componentProps:{selectedId:e.board.template_id,filter:{for:"board"}},event:n,dismissOnSelect:!1,animated:!1,side:"right"});a.onDidDismiss().then(r=>{var d,s,_;"confirm"==r.role&&Object.assign(e.board,{template_id:null===(d=r.data)||void 0===d?void 0:d.template_id,template_title:null===(s=r.data)||void 0===s?void 0:s.template_title,template_titles:null===(_=r.data)||void 0===_?void 0:_.template_titles})}),a.present()})()}clearTemplate(n){Object.assign(this.board,{template_id:null,template_title:null,template_titles:null})}changeTemplate(n){this.board.template_id=n}changeBoardTitle(n){var e;this.board.board_title=null==n||null===(e=n.target)||void 0===e?void 0:e.value}changeBoardDescription(n){var e;this.board.board_description=null==n||null===(e=n.target)||void 0===e?void 0:e.value}changeBoardContent(n){var e;this.board.board_content=null==n||null===(e=n.target)||void 0===e?void 0:e.value}changeBoardCover(n){this.boardCover=void 0,n.target.files.length&&(this.boardCover=n.target.files[0]),this.boardCover&&(this.fileurl=URL.createObjectURL(this.boardCover))}coverLoad(){var n,e,a,r,d,s,_,m,u,v,b;let C=[null!==(n=this.board)&&void 0!==n&&n.cover?`${null!==(e=this.appsettings.readfileuploadurl)&&void 0!==e?e:""}${null===(a=this.board)||void 0===a?void 0:a.cover}`:void 0,null!==(r=this.board)&&void 0!==r&&r.board_id?`${null!==(d=this.appsettings.readfileuploadurl)&&void 0!==d?d:""}${null!==(s=this.appsettings.boardpath)&&void 0!==s?s:""}${null===(_=this.board)||void 0===_?void 0:_.board_id}/cover.svg`:void 0,null!==(m=this.board)&&void 0!==m&&m.board_id?`${null!==(u=this.appsettings.readfileuploadurl)&&void 0!==u?u:""}${null!==(v=this.appsettings.boardpathv1)&&void 0!==v?v:""}${null===(b=this.board)||void 0===b?void 0:b.board_id}/cover.png`:void 0].filter(M=>!!M),R=M=>{if(!M)return;let O=new Image;O.onload=()=>{this.coverUrl=M},O.onerror=()=>{R(C.shift())},O.src=M};C.length&&R(C.shift())}}return(o=l).\u0275fac=function(n){return new(n||o)(t.rXU(c.W3),t.rXU(c.IE),t.rXU(c.K_),t.rXU(c.Xi))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-modal-board-customize-template"]],inputs:{b:"b"},decls:15,vars:8,consts:[["slot","end","mode","ios","color","tertiary",3,"click"],["slot","end"],["color","dark",1,"d-none","d-md-block",3,"click"],[3,"src"],["color","dark",3,"click"],["src","../../../assets/icon/16x16/close.svg"],["class","ion-padding",4,"ngIf"],[1,"ion-padding"],[1,"container-fluid","h-100"],[1,"d-flex","w-100","h-100","flex-column"],[1,"row"],[1,"col-lg-6"],[1,"form-group"],[1,"line-height-24"],[1,"fs-14","fw-500"],["type","text",1,"form-control",3,"change","ngModel"],[1,"input-group"],["type","text","readonly","",1,"form-control",3,"value"],[1,"input-group-append"],["type","button","class","btn btn-outline-secondary",3,"click",4,"ngIf"],["type","button",1,"btn","btn-outline-secondary","btn-popover",3,"click"],["name","chevron-down-outline"],[1,"form-group","d-none"],[1,"custom-file"],["type","file","id","inputGroupFile03",1,"custom-file-input",3,"change"],["for","inputGroupFile03",1,"custom-file-label"],[1,"col-lg-6","col-cover"],["onClick","document.getElementById('inputGroupFile03').click()",1,"embed-responsive","embed-responsive-16by9","embed-cover"],[1,"embed-responsive-item"],[3,"src","alt"],[1,"pb-3"],[1,"w-100",3,"ngModelChange","editor","ngModel"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["name","close-outline"]],template:function(n,e){1&n&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.nI1(4,"translate"),t.k0s(),t.j41(5,"ion-button",0),t.bIt("click",function(){return e.save()}),t.j41(6,"ion-label"),t.EFF(7),t.nI1(8,"translate"),t.k0s()(),t.j41(9,"ion-buttons",1)(10,"ion-button",2),t.bIt("click",function(){return e.toggleFullScreen()}),t.nrm(11,"ion-icon",3),t.k0s(),t.j41(12,"ion-button",4),t.bIt("click",function(){return e.close()}),t.nrm(13,"ion-icon",5),t.k0s()()()(),t.DNE(14,ht,63,32,"ion-content",6)),2&n&&(t.R7$(3),t.JRh(t.bMT(4,4,"CustomizeTemplate")),t.R7$(4),t.JRh(t.bMT(8,6,"UseThisTemplate")),t.R7$(4),t.Y8G("src",e.isfullscreen?"assets/icon/16x16/fullscreen-exit.svg":"assets/icon/16x16/fullscreen.svg"),t.R7$(3),t.Y8G("ngIf",e.board.board_id))},dependencies:[I.bT,U.me,U.BC,U.vS,c.Jm,c.QW,c.W9,c.eU,c.iq,c.KW,c.he,c.BC,c.ai,ut.h,J.D9],styles:[".input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{outline:none!important;box-shadow:none!important}.input-group[_ngcontent-%COMP%]   .input-group-prepend[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%]{min-width:120px}.input-group[_ngcontent-%COMP%]   .input-group-append[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{line-height:0}.input-group[_ngcontent-%COMP%]   .input-group-append[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.input-group[_ngcontent-%COMP%]   .form-control-plaintext[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem;border:1px solid #ddd;border-radius:4px}.input-group[_ngcontent-%COMP%]   .form-control-plaintext[_ngcontent-%COMP%]:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.input-group[_ngcontent-%COMP%]   .form-control-plaintext[_ngcontent-%COMP%]:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-color:#fff}.embed-cover[_ngcontent-%COMP%]{max-width:100%;border:1px dashed var(--ion-color-primary)}.embed-cover[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:contain;background-image:url(transparent-small.e8bc20e2391ee295.png);background-repeat:repeat}.col-cover[_ngcontent-%COMP%]{max-width:485px}"]}),l})();var ft=p(3181),S=p(5312),h=p(8408),nt=p(1171),K=p(1312),Ct=p(8963),it=p(4552),L=p(345);function Mt(o,l){if(1&o&&(t.j41(0,"div",34),t.nrm(1,"ion-icon",35),t.j41(2,"span",36),t.EFF(3),t.k0s()()),2&o){const i=t.XpG(3);t.Y8G("title",i.board.topic_titles),t.R7$(3),t.JRh(i.board.topic_titles.split(";").reverse().join(" / "))}}function xt(o,l){if(1&o&&(t.j41(0,"div",34),t.nrm(1,"ion-icon",37),t.j41(2,"span",36),t.EFF(3),t.k0s()()),2&o){const i=t.XpG(3);t.Y8G("title",i.board.category_titles),t.R7$(3),t.JRh(i.board.category_titles.split(";").reverse().join(" / "))}}function kt(o,l){if(1&o&&(t.j41(0,"div",34),t.nrm(1,"ion-icon",38),t.j41(2,"span",36),t.EFF(3),t.k0s()()),2&o){const i=t.XpG(3);t.Y8G("title",i.board.template_titles),t.R7$(3),t.JRh(i.board.template_titles.split(";").reverse().join(" / "))}}function wt(o,l){if(1&o&&(t.j41(0,"div",9),t.DNE(1,Mt,4,2,"div",34)(2,xt,4,2,"div",34)(3,kt,4,2,"div",34),t.k0s()),2&o){const i=t.XpG(2);t.R7$(),t.vxM(1,i.board.topic_titles?1:-1),t.R7$(),t.vxM(2,i.board.category_titles?2:-1),t.R7$(),t.vxM(3,i.board.template_titles?3:-1)}}function yt(o,l){if(1&o){const i=t.RV6();t.j41(0,"div",18)(1,"ion-button",39),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.pageBack())}),t.nrm(2,"ion-img",40),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s(),t.j41(5,"ion-button",39),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.pageNext())}),t.nrm(6,"ion-img",41),t.k0s()()}if(2&o){const i=t.XpG(2);t.R7$(),t.Y8G("disabled",i.slideIdx<1),t.R7$(3),t.Lme("",i.slideIdx+1,"/",i.slideTotal,""),t.R7$(),t.Y8G("disabled",i.slideIdx>=i.slideTotal-1)}}function Pt(o,l){if(1&o){const i=t.RV6();t.j41(0,"div")(1,"ion-button",42),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.renderSlide())}),t.nrm(2,"ion-img",43),t.k0s()()}}function Tt(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-button",42),t.bIt("click",function(){t.eBV(i);const e=t.XpG(3);return t.Njj(e.offFullScreen())}),t.nrm(1,"ion-img",45),t.k0s()}}function Rt(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-button",42),t.bIt("click",function(){t.eBV(i);const e=t.XpG(3);return t.Njj(e.onFullScreen())}),t.nrm(1,"ion-img",46),t.k0s()}}function Ot(o,l){if(1&o&&(t.j41(0,"div"),t.DNE(1,Tt,2,0,"ion-button",44)(2,Rt,2,0),t.k0s()),2&o){const i=t.XpG(2);t.R7$(),t.vxM(1,i.isfullscreen?1:2)}}function jt(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-button",47),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.navigateToEditor(e.APP_ROUTE.EDITOR+"?b="+e.board.board_id))}),t.j41(1,"ion-label"),t.EFF(2),t.nI1(3,"translate"),t.k0s()()}2&o&&(t.R7$(2),t.JRh(t.bMT(3,1,"Editor")))}function $t(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-button",47),t.bIt("click",function(e){t.eBV(i);const a=t.XpG(2);return t.Njj(a.presentModalBoardCustomizeTemplate(e,a.board.board_id))}),t.j41(1,"ion-label"),t.EFF(2),t.nI1(3,"translate"),t.k0s()()}2&o&&(t.R7$(2),t.JRh(t.bMT(3,1,"CustomizeThisTemplate")))}function Vt(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-button",48),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.navigateToEditor(e.APP_ROUTE.EDITOR+"?b="+e.board.board_id))}),t.j41(1,"ion-label"),t.EFF(2),t.nI1(3,"translate"),t.k0s()()}if(2&o){const i=t.XpG(2);t.Y8G("disabled",!i.board.chotausuabai),t.R7$(2),t.JRh(t.bMT(3,2,"Editor"))}}function It(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-button",49),t.nI1(1,"translate"),t.bIt("click",function(e){t.eBV(i);const a=t.XpG(2);return t.Njj(a.presentModalBoardShare(e))}),t.nrm(2,"ion-icon",50),t.k0s()}2&o&&t.Y8G("title",t.bMT(1,1,"Share"))}function Ft(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-chip",51),t.bIt("click",function(){const e=t.eBV(i).$implicit,a=t.XpG(2);return t.Njj(a.switchBoard(e.board_id))}),t.nrm(1,"ion-icon",52),t.j41(2,"ion-label"),t.EFF(3),t.k0s()()}if(2&o){const i=l.$implicit,n=t.XpG(2);t.HbH(n.board.board_id==i.board_id?"active":""),t.R7$(),t.Y8G("name",n.board.board_id==i.board_id?"ellipse":"ellipse-outline"),t.R7$(2),t.JRh(i.board_title)}}function Et(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-infinite-scroll",53),t.bIt("ionInfinite",function(e){t.eBV(i);const a=t.XpG(2);return t.Njj(a.onIonInfinite(e))}),t.nrm(1,"ion-infinite-scroll-content"),t.k0s()}}function Bt(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-chip",51),t.bIt("click",function(){const e=t.eBV(i).$implicit,a=t.XpG(2);return t.Njj(a.switchBoard(e.board_id))}),t.nrm(1,"ion-icon",52),t.j41(2,"ion-label"),t.EFF(3),t.k0s()()}if(2&o){const i=l.$implicit,n=t.XpG(2);t.HbH(n.board.board_id==i.board_id?"active":""),t.R7$(),t.Y8G("name",n.board.board_id==i.board_id?"ellipse":"ellipse-outline"),t.R7$(2),t.JRh(i.board_title)}}function Gt(o,l){1&o&&(t.j41(0,"div",57),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&o&&(t.R7$(),t.JRh(t.bMT(2,1,"NoData")))}function Xt(o,l){if(1&o&&(t.j41(0,"div",58),t.nrm(1,"div",59),t.k0s()),2&o){const i=t.XpG(3);t.R7$(),t.Y8G("innerHTML",i.board.board_description,t.npT)}}function Dt(o,l){if(1&o&&(t.j41(0,"div",32)(1,"h5",54),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.j41(4,"div",55)(5,"div",10),t.nrm(6,"div",56),t.DNE(7,Gt,3,3,"div",57),t.k0s(),t.DNE(8,Xt,2,1,"div",58),t.k0s()()),2&o){const i=t.XpG(2);t.R7$(2),t.JRh(t.bMT(3,4,"Introduce")),t.R7$(4),t.Y8G("innerHTML",i.board.board_content,t.npT),t.R7$(),t.vxM(7,i.board.board_content?-1:7),t.R7$(),t.vxM(8,i.board.board_description?8:-1)}}function At(o,l){if(1&o&&(t.j41(0,"div",61),t.nrm(1,"ion-icon",62),t.j41(2,"span",63),t.EFF(3),t.k0s()()),2&o){const i=l.$implicit;t.Y8G("title",i),t.R7$(3),t.JRh(i)}}function Nt(o,l){if(1&o&&(t.j41(0,"div",33)(1,"h5",54),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.j41(4,"div",55)(5,"div",10)(6,"div",60),t.Z7z(7,At,4,2,"div",61,t.fX1),t.k0s()()()()),2&o){const i=t.XpG(2);t.R7$(2),t.JRh(t.bMT(3,1,"Tag")),t.R7$(5),t.Dyx(i.board.tag_arrs)}}function St(o,l){if(1&o){const i=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),t.EFF(5),t.k0s(),t.j41(6,"div",5)(7,"div",6)(8,"ion-chip")(9,"ion-avatar",7),t.nrm(10,"img",8),t.k0s(),t.j41(11,"ion-label"),t.EFF(12),t.k0s()()(),t.DNE(13,wt,4,3,"div",9),t.k0s()(),t.j41(14,"div",10)(15,"div",11)(16,"div",12)(17,"div",13)(18,"div",14),t.qSk(),t.nrm(19,"svg",15),t.k0s()(),t.joV(),t.j41(20,"div",16)(21,"div",17),t.DNE(22,yt,7,4,"div",18)(23,Pt,3,0,"div")(24,Ot,3,1,"div"),t.k0s()()()()(),t.j41(25,"div",19)(26,"div",20)(27,"div")(28,"div",21)(29,"div",22),t.DNE(30,jt,4,3,"ion-button",23)(31,$t,4,3)(32,Vt,4,4),t.k0s(),t.j41(33,"div",24),t.DNE(34,It,3,3,"ion-button",25),t.j41(35,"ion-button",26),t.bIt("click",function(e){t.eBV(i);const a=t.XpG();return t.Njj(a.toggleLike(e))}),t.nrm(36,"ion-icon",27),t.k0s()()()(),t.j41(37,"div",28)(38,"ion-content"),t.Z7z(39,Ft,4,4,"ion-chip",29,t.fX1),t.DNE(41,Et,2,0,"ion-infinite-scroll",30),t.k0s()(),t.j41(42,"div",31),t.Z7z(43,Bt,4,4,"ion-chip",29,t.fX1),t.k0s()()()()()(),t.DNE(45,Dt,9,6,"div",32)(46,Nt,9,3,"div",33)}if(2&o){const i=t.XpG();t.R7$(5),t.JRh(i.board.board_title),t.R7$(5),t.Y8G("src",i.board.createdby_avatar?i.readfileuploadurl+i.board.createdby_avatar:"assets/image/user-avatar-default.png",t.B4B),t.R7$(2),t.JRh(i.board.createdby_name),t.R7$(),t.vxM(13,i.board.topic_titles||i.board.category_titles||i.board.template_titles?13:-1),t.R7$(2),t.BMQ("style","padding-bottom:"+i.svgRatio+"%",t.$dS),t.R7$(7),t.vxM(22,null!=i.settings.buttons&&i.settings.buttons.paging?22:-1),t.R7$(),t.vxM(23,null!=i.settings.buttons&&i.settings.buttons.refresh?23:-1),t.R7$(),t.vxM(24,null!=i.settings.buttons&&i.settings.buttons.fullscreen?24:-1),t.R7$(6),t.vxM(30,i.board.chotausuabai?30:i.board.ispublic&&i.board.istemplate?31:32),t.R7$(4),t.vxM(34,i.board.isowner?34:-1),t.R7$(2),t.Mz_("src","../../../assets/image/viewer/",i.board.isliked?"star-2.svg":"star.svg",""),t.R7$(3),t.Dyx(i.boards),t.R7$(2),t.Y8G("ngIf",i.paging.active),t.R7$(2),t.Dyx(i.boards),t.R7$(2),t.vxM(45,i.board.board_description||i.board.board_content?45:-1),t.R7$(),t.vxM(46,null!=i.board.tag_arrs&&i.board.tag_arrs.length?46:-1)}}let zt=(()=>{var o;class l{constructor(n,e,a,r,d,s,_){this.titleService=n,this.metaService=e,this.router=a,this.activatedRoute=r,this.toastController=d,this.modalController=s,this.loadingController=_,this.appsettings={},this.user={},this.APP_ROUTE=T._,this.boards=[],this.paging={page:1,limit:10,active:!0},this.filter={},this.settings={},this.slides=[],this.slideIdx=0,this.slideTotal=0,this.svgRatio=56.25,this.readfileuploadurl="",this.isfullscreen=!1,this.pageBack=()=>{this.slideIdx>0&&(this.slideIdx--,this.renderSlide())},this.pageNext=()=>{this.slideIdx<this.slideTotal-1&&(this.slideIdx++,this.renderSlide())},this.onFullScreen=()=>{var m,u;(u=null!==(m=document.getElementById("sieunhangaoo"))&&void 0!==m?m:document.body).requestFullscreen?u.requestFullscreen():u.mozRequestFullScreen?u.mozRequestFullScreen():u.webkitRequestFullscreen?u.webkitRequestFullscreen():u.msRequestFullscreen&&u.msRequestFullscreen(),setTimeout(()=>{this.isfullscreen=(u=>!!(u.fullscreen||u.fullscreenElement||u.webkitFullscreenElement||u.mozFullScreenElement||u.msFullscreenElement))(document)},600)},this.offFullScreen=()=>{var m;(m=document).exitFullscreen?m.exitFullscreen():m.mozCancelFullScreen?m.mozCancelFullScreen():m.webkitExitFullscreen?m.webkitExitFullscreen():m.msExitFullscreen&&m.msExitFullscreen(),setTimeout(()=>{this.isfullscreen=(m=>!!(m.fullscreen||m.fullscreenElement||m.webkitFullscreenElement||m.mozFullScreenElement||m.msFullscreenElement))(document)},600)}}ngOnInit(){var n;this.readfileuploadurl=null!==(n=this.appsettings.readfileuploadurl)&&void 0!==n?n:"",h.LVk.container="#mainContainer",h.LVk.svg="#mainSvg",h.LVk.config=this.appsettings,(0,Ct.j)(),this.loadBoard(()=>{var e,a,r;this.paging.page=1,this.paging.active=!0,this.filter={topic_id:null===(e=this.board)||void 0===e?void 0:e.topic_id,category_id:null===(a=this.board)||void 0===a?void 0:a.category_id,template_id:null===(r=this.board)||void 0===r?void 0:r.template_id},this.loadData_Paging()})}ngAfterViewInit(){window.addEventListener("resize",()=>{this.slide&&(0,h.I1Q)(h.LVk.container,h.LVk.svg,this.slide)})}onIonInfinite(n){this.loadMore(()=>{n.target.complete()})}loadMore(n){this.paging.page+=1,this.loadData_Paging(n)}loadData_Paging(n){var e=this;return(0,g.A)(function*(){var a;(0,W.dq)({params:{userid:null===(a=e.user)||void 0===a?void 0:a.userid,topic_id:e.filter.topic_id,category_id:e.filter.category_id,template_id:e.filter.template_id,sortfield:e.paging.sortfield,sorttype:e.paging.sorttype,page:e.paging.page,limit:e.paging.limit},callback:r=>{e.boards=e.boards.concat(null!=r?r:[]),(!(null!=r&&r.length)||(null==r?void 0:r.length)<e.paging.limit)&&(e.paging.active=!1),n&&n()}})})()}loadBoard(n){var e=this;return(0,g.A)(function*(){var a,r;(0,W.qU)({loadingController:e.loadingController,params:{userid:null===(a=e.user)||void 0===a?void 0:a.userid,board_id:e.board_id},callback:d=>{var s,_,m,u;null!=d&&d.board_id?(e.board=d,e.board.tag_arrs=null===(s=e.board.tags||null)||void 0===s?void 0:s.split(";"),n&&n(),d&&(0,K.Kd)(e.titleService,e.metaService,{title:d.board_title,description:(0,it.YW)(d.board_description),image:{url:`${e.appsettings.readfileuploadurl}${e.appsettings.boardpath}${d.board_id}/cover.svg`,type:"image/svg",width:d.size_width,height:d.size_height,alt:d.board_title},url:`${S.c.url}/${T._.VIEWER_ID.replace(":id",null!==(m=null===(u=d.board_id)||void 0===u?void 0:u.toString())&&void 0!==m?m:"")}`}),(0,Y.U5)({params:{userid:null===(_=e.user)||void 0===_?void 0:_.userid,board_id:e.board_id},callback:v=>{var b;let C;if(v&&!v.modules?C=(0,h.vmR)(v):"icdtV2"==(null==v?void 0:v.modules)&&(C=v),C)return h.JRt.data=C,h.JRt.changeSlide=(R,M,O,X,x)=>{var E,f,k,P;e.slideIdx=O,e.slideTotal=X,e.slide=x;let j=(0,h.zOM)((null!==(E=null==x||null===(f=x.svg)||void 0===f?void 0:f.viewBox.height)&&void 0!==E?E:1)/(null!==(k=null==x||null===(P=x.svg)||void 0===P?void 0:P.viewBox.width)&&void 0!==k?k:1)*100,100);e.svgRatio!=j&&(e.svgRatio=j)},e.slideTotal=h.JRt.slideTotal,e.renderSlide(),void(0,nt.U2)(C.fonts||[]);(0,Y.rH)({params:{userid:null===(b=e.user)||void 0===b?void 0:b.userid,board_id:e.board_id},callback:R=>{if(R){let M=(0,h.vmR)(R);h.JRt.data=M,h.JRt.changeSlide=(O,X,x,E,f)=>{var k,P,j,w;e.slideIdx=x,e.slideTotal=E,e.slide=f;let V=(0,h.zOM)((null!==(k=null==f||null===(P=f.svg)||void 0===P?void 0:P.viewBox.height)&&void 0!==k?k:1)/(null!==(j=null==f||null===(w=f.svg)||void 0===w?void 0:w.viewBox.width)&&void 0!==j?j:1)*100,100);e.svgRatio!=V&&(e.svgRatio=V)},e.slideTotal=h.JRt.slideTotal,e.renderSlide(),(0,nt.U2)(M.fonts||[])}}})}})):e.navigateToHome()}}),(0,Y.BS)({params:{board_id:e.board_id,userid:null===(r=e.user)||void 0===r?void 0:r.userid},callback:d=>{e.settings=d||{buttons:{paging:!0}}}})})()}switchBoard(n){var e=this;return(0,g.A)(function*(){e.board_id=null!=n?n:0,e.router.navigate([],{relativeTo:e.activatedRoute,queryParams:{b:e.board_id,n:null},queryParamsHandling:"merge",replaceUrl:!0}),e.loadBoard()})()}toggleLike(n){var e=this;return(0,g.A)(function*(){e.board&&(e.board.isliked=!e.board.isliked)})()}navigateByUrl(n){this.router.navigateByUrl(n)}navigateToHome(){var n=this;return(0,g.A)(function*(){(yield(0,tt.lJ)())?n.navigateByUrl(T._.DASHBOARD):n.navigateByUrl(T._.LANDING_PAGE)})()}navigateToEditor(n){return(0,g.A)(function*(){window.location.href=n})()}renderSlide(){h.JRt.runSlide(this.slideIdx)}presentModalBoardShare(n){var e=this;return(0,g.A)(function*(){var a;(yield e.modalController.create({component:ft.q,componentProps:{b:null===(a=e.board)||void 0===a?void 0:a.board_id},mode:"md",cssClass:"ion-modal",backdropDismiss:!0,keyboardClose:!0})).present()})()}presentModalBoardCustomizeTemplate(n,e){var a=this;return(0,g.A)(function*(){const r=yield a.modalController.create({component:bt,componentProps:{b:e},mode:"md",cssClass:"ion-modal-lg",backdropDismiss:!1,keyboardClose:!0});r.onDidDismiss().then(d=>{"confirm"==d.role&&d.data&&a.navigateToEditor(T._.EDITOR+`?b=${d.data.id}`)}),r.present()})()}}return(o=l).\u0275fac=function(n){return new(n||o)(t.rXU(L.hE),t.rXU(L.W8),t.rXU($.Ix),t.rXU($.nX),t.rXU(c.K_),t.rXU(c.W3),t.rXU(c.Xi))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-viewer-board"]],inputs:{appsettings:"appsettings",user:"user",board_id:"board_id",num:"num"},decls:1,vars:1,consts:[[1,"bg-cover","pb-5"],[1,"container","pt-3","pt-xxl-5","pb-5"],[1,"row","align-items-stretch"],[1,"col-12","col-lg-8","info"],[1,"mt-0","mb-2","mb-xxl-3"],[1,"d-flex","align-items-center","justify-content-between","mt-0","mb-2","mb-xxl-4"],[1,"flex-grow-1","mr-3","text-nowrap"],[1,"min-w-24"],["onerror","errorAvatar(this)",3,"src"],[1,"d-block","d-md-flex","flex-nowrap","align-items-center","text-ellipsis"],[1,"col-12","col-lg-8","mb-3"],[1,"position-relative","w-0","h-0","content"],["id","sieunhangaoo"],[1,"position-absolute","top-0","left-0","right-0","bottom-0"],["id","mainContainer",1,"svg-box"],["id","mainSvg","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink",1,"viewer"],[1,"position-absolute","left-0","right-0","bottom-0"],[1,"group-action"],[1,"group-action-paging"],[1,"col-12","col-lg-4","mb-3","playlist"],[1,"d-flex","flex-column","w-100","h-100"],[1,"d-flex","w-100","mb-3"],[1,"col","pl-0"],["mode","ios","expand","block"],[1,"col-auto","px-0"],["mode","ios","color","light",1,"mr-3",3,"title"],["mode","ios","color","light",3,"click"],[3,"src"],[1,"flex-grow-1","board-related-ion-content","d-none","d-lg-block"],["mode","ios",3,"class"],[3,"ionInfinite",4,"ngIf"],[1,"flex-grow-1","board-related","d-block","d-lg-none"],[1,"container","introduce","mb-4",2,"margin-top","-3rem"],[1,"container","introduce","mb-4"],[1,"text-ellipsis","d-flex","align-items-center","mr-2",3,"title"],["src","../../../assets/icon-svg/dashboard/topic.svg",1,"fs-20"],[1,"fs-12","text-ellipsis"],["src","../../../assets/icon-svg/dashboard/category.svg",1,"fs-20"],["src","../../../assets/icon-svg/dashboard/template.svg",1,"fs-20"],["fill","clear",1,"ion-no-margin","ion-no-padding",3,"click","disabled"],["src","../../../assets/icon-png/Back.png"],["src","../../../assets/icon-png/Next.png"],["fill","clear",1,"ion-no-margin","ion-no-padding",3,"click"],["src","../../../assets/images/viewer/RefreshButton_normal.png"],["fill","clear",1,"ion-no-margin","ion-no-padding"],["src","../../../assets/images/viewer/ExitFullButton_active.png"],["src","../../../assets/images/viewer/FullButton_normal.png"],["mode","ios","expand","block",3,"click"],["mode","ios","expand","block",3,"click","disabled"],["mode","ios","color","light",1,"mr-3",3,"click","title"],["name","share-social-outline"],["mode","ios",3,"click"],[3,"name"],[3,"ionInfinite"],[1,"mb-4"],[1,"row"],[3,"innerHTML"],[1,"text-muted"],[1,"col-12","col-lg-4","mb-3"],[1,"alert","mb-0",3,"innerHTML"],[1,"d-flex","flex-wrap"],[1,"text-ellipsis","d-flex","align-items-center","mr-3","mb-3",3,"title"],["src","../../../assets/icon-svg/dashboard/tag.svg",1,"fs-20"],[1,"fs-14","text-ellipsis"]],template:function(n,e){1&n&&t.DNE(0,St,47,15),2&n&&t.vxM(0,e.board?0:-1)},dependencies:[I.bT,c.mC,c.Jm,c.ZB,c.W9,c.iq,c.KW,c.Ax,c.Hp,c.he,J.D9],styles:[".bg-contain[_ngcontent-%COMP%]{background-image:url(bg.33cb60bd32718d53.svg);background-repeat:no-repeat;background-position:top center;background-size:contain}.bg-cover[_ngcontent-%COMP%]{background-image:url(bg.33cb60bd32718d53.svg);background-repeat:no-repeat;background-position:bottom center;background-size:cover}.info[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{margin:0;--background: transparent}.info[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0}.content[_ngcontent-%COMP%]{border-radius:.75rem;overflow:hidden;box-shadow:4px 4px 12px #01010133}.nav-action[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:inherit;font-size:1.25rem}.nav-action[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] + a[_ngcontent-%COMP%]{margin-left:3rem}.introduce[_ngcontent-%COMP%]   .alert[_ngcontent-%COMP%]{border-radius:.75rem;background-color:#fff3b6;color:#000}.svg-box[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;background:var(--ion-toolbar-background, var(--ion-color-step-50, #f7f7f7));display:flex;align-items:center;justify-content:center}.svg-box[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{display:block;max-width:100%;max-height:100%;margin:auto;background:#fff}.group-action[_ngcontent-%COMP%]{position:absolute;bottom:.5rem;right:1rem;line-height:0;-webkit-user-select:none;user-select:none}.group-action[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap}.group-action[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{margin-left:1rem}.group-action[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;padding:0 1rem;vertical-align:middle;font-size:18px;color:#fab11d}.group-action[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{vertical-align:middle;width:34px;height:34px}.group-action[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{height:34px}.playlist[_ngcontent-%COMP%]   .board-related-ion-content[_ngcontent-%COMP%]{min-height:250px}.playlist[_ngcontent-%COMP%]   .board-related-ion-content[_ngcontent-%COMP%]   ion-content[_ngcontent-%COMP%]{--ion-background-color: transparent}.playlist[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: .5rem;--padding-top: 0;--padding-bottom: 0;--padding-start: .75rem;--padding-end: .75rem;margin:0}.playlist[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:not([color]){--color: var(--ion-color-linear-contrast);--background: var(--ion-color-linear);--background-activated: var(--ion-color-linear-shade);--background-focused: var(--ion-color-linear-shade);--background-hover: var(--ion-color-linear-tint)}.playlist[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:.5rem;padding:.75rem 1.25rem;--background: transparent;--color: var(--ion-color-medium);-webkit-user-select:none;user-select:none}.playlist[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:.75rem;--color: var(--ion-color-medium-tint)}.playlist[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]:hover{--background: rgba(var(--ion-text-color-rgb), .1)}.playlist[_ngcontent-%COMP%]   ion-chip.active[_ngcontent-%COMP%]{--background: rgba(var(--ion-color-secondary-rgb), .4);--color: var(--ion-text-color);font-weight:500}.playlist[_ngcontent-%COMP%]   ion-chip.active[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary)}"]}),l})();var Ut=p(4569),Yt=p(1632),Jt=p(5178),Lt=p(2527),ot=p.n(Lt),Q=p(5781),at=p(7868),Ht=p(4835),rt=p(1951),z=p(1400),y=p(1607),Wt=p(2706);const Kt=["canvas"];function Qt(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-button",9),t.nI1(1,"translate"),t.bIt("click",function(e){t.eBV(i);const a=t.XpG(2);return t.Njj(a.presentModalAiImage(e))}),t.nrm(2,"ion-icon",10),t.k0s()}2&o&&t.Y8G("title",t.bMT(1,1,"CreatedWithAI"))}function Zt(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-button",9),t.nI1(1,"translate"),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.AI_recommend(e.v_functionlimit.GenAITaoHinhAnh))}),t.nrm(2,"ion-icon",10),t.k0s()}2&o&&t.Y8G("title",t.bMT(1,1,"CreatedWithAI"))}function qt(o,l){if(1&o&&t.DNE(0,Qt,3,3,"ion-button",8)(1,Zt,3,3),2&o){const i=t.XpG();t.vxM(0,i.membership.GenAITaoHinhAnh?0:1)}}function te(o,l){if(1&o){const i=t.RV6();t.j41(0,"li",13)(1,"ion-card",14),t.bIt("click",function(){const e=t.eBV(i).$implicit,a=t.XpG(2);return t.Njj(a.redirectMedia(e.media_id))}),t.nrm(2,"ion-img",15),t.j41(3,"ion-card-content")(4,"div",16),t.EFF(5),t.k0s()()(),t.j41(6,"div",17),t.EFF(7),t.k0s()()}if(2&o){let i;const n=l.$implicit,e=t.XpG(2);t.R7$(),t.Y8G("title",n.media_title),t.R7$(),t.Y8G("src",n.cover?e.readfileuploadurl+n.cover:"assets/image/media/image.svg")("alt",n.media_title)("title",n.media_title),t.R7$(2),t.Y8G("title",n.media_title),t.R7$(),t.JRh(null!==(i=null!==(i=null!==(i=n.media_title)&&void 0!==i?i:n.v_osstype_title)&&void 0!==i?i:n.v_mediatype_title)&&void 0!==i?i:""),t.R7$(2),t.JRh(n.v_mediatype_title)}}function ee(o,l){if(1&o&&(t.j41(0,"div",7)(1,"div",11),t.EFF(2,"T\xecm th\u1ea5y "),t.j41(3,"b"),t.EFF(4),t.k0s(),t.EFF(5,' m\u1ee5c v\u1edbi t\u1eeb kh\xf3a "'),t.j41(6,"b"),t.EFF(7),t.k0s(),t.EFF(8,'"'),t.k0s(),t.j41(9,"ul",12),t.Z7z(10,te,8,7,"li",13,t.fX1),t.k0s()()),2&o){let i;const n=t.XpG();t.R7$(4),t.JRh((null!==(i=n.medias[0].total)&&void 0!==i?i:0)<=99?n.medias[0].total:"99+"),t.R7$(3),t.JRh(n.filter.search),t.R7$(3),t.Dyx(n.medias)}}function ne(o,l){if(1&o&&t.nrm(0,"img",43),2&o){const i=t.XpG(3);t.Y8G("src",i.viewOptions.url,t.B4B)("alt",i.media.media_title)}}function ie(o,l){if(1&o&&(t.j41(0,"div",41),t.DNE(1,ne,1,2,"img",42),t.k0s()),2&o){const i=t.XpG(2);t.BMQ("style",i.media.bigcover?"--bg-img:url("+i.readfileuploadurl+i.media.bigcover+")":"",t.$dS),t.R7$(),t.Y8G("ngIf",i.viewOptions.url)}}function oe(o,l){if(1&o&&(t.j41(0,"div",41),t.nrm(1,"canvas",null,0),t.k0s()),2&o){const i=t.XpG(2);t.BMQ("style",i.media.bigcover?"--bg-img:url("+i.readfileuploadurl+i.media.bigcover+")":"",t.$dS)}}function ae(o,l){if(1&o){const i=t.RV6();t.j41(0,"iframe",46),t.nI1(1,"safe"),t.bIt("load",function(e){t.eBV(i);const a=t.XpG(3);return t.Njj(a.loadIframe(e))}),t.k0s()}if(2&o){const i=t.XpG(3);t.Y8G("src",t.i5U(1,1,i.viewOptions.url,"resourceUrl"),t.f$h)}}function re(o,l){if(1&o&&(t.j41(0,"div",44),t.DNE(1,ae,2,4,"iframe",45),t.k0s()),2&o){const i=t.XpG(2);t.BMQ("style",i.media.bigcover?"--bg-img:url("+i.readfileuploadurl+i.media.bigcover+")":"",t.$dS),t.R7$(),t.Y8G("ngIf",i.viewOptions.url)}}function le(o,l){1&o&&(t.j41(0,"div",47),t.nrm(1,"ion-spinner",48),t.k0s())}function de(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-button",52),t.nI1(1,"translate"),t.bIt("click",function(){t.eBV(i);const e=t.XpG(3);return t.Njj(e.downloadMedia())}),t.nrm(2,"ion-icon",53),t.j41(3,"ion-label"),t.EFF(4),t.nI1(5,"translate"),t.k0s()()}2&o&&(t.Y8G("title",t.bMT(1,2,"Download")),t.R7$(4),t.JRh(t.bMT(5,4,"Download")))}function se(o,l){1&o&&(t.j41(0,"ion-button",54),t.nrm(1,"ion-icon",55),t.j41(2,"ion-label"),t.EFF(3),t.nI1(4,"translate"),t.k0s()()),2&o&&(t.Y8G("disabled",!0),t.R7$(3),t.JRh(t.bMT(4,2,"Download")))}function ce(o,l){if(1&o){const i=t.RV6();t.DNE(0,de,6,6,"ion-button",49)(1,se,5,4),t.j41(2,"ion-button",50),t.nI1(3,"translate"),t.bIt("click",function(e){t.eBV(i);const a=t.XpG(2);return t.Njj(a.presentModalMediaShare(e))}),t.nrm(4,"ion-icon",51),t.k0s()}if(2&o){const i=t.XpG(2);t.vxM(0,i.media.isdownload?0:1),t.R7$(2),t.Y8G("title",t.bMT(3,2,"Share"))}}function me(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-button",52),t.nI1(1,"translate"),t.bIt("click",function(){t.eBV(i);const e=t.XpG(3);return t.Njj(e.downloadMedia())}),t.nrm(2,"ion-icon",53),t.j41(3,"ion-label"),t.EFF(4),t.nI1(5,"translate"),t.k0s()()}2&o&&(t.Y8G("title",t.bMT(1,2,"Download")),t.R7$(4),t.JRh(t.bMT(5,4,"Download")))}function _e(o,l){if(1&o){const i=t.RV6();t.j41(0,"div",57)(1,"div",58),t.nrm(2,"ion-icon",59),t.j41(3,"b",60),t.EFF(4,"Tabca Pro"),t.k0s()(),t.j41(5,"div",61),t.EFF(6,"N\xe2ng c\u1ea5p t\xe0i kho\u1ea3n Pro \u0111\u1ec3 t\u1ea3i v\u1ec1 v\xe0 t\u1ea1o h\xecnh \u1ea3nh b\u1eb1ng AI."),t.k0s(),t.j41(7,"ion-button",62),t.nI1(8,"translate"),t.bIt("click",function(){t.eBV(i);const e=t.XpG(3);return t.Njj(e.AI_recommend(e.v_functionlimit.TaiVeCacHocLieuHeThongCungCap))}),t.j41(9,"ion-label"),t.EFF(10),t.nI1(11,"translate"),t.k0s()()()}2&o&&(t.R7$(7),t.Y8G("title",t.bMT(8,2,"UpgradeTabcaProNow")),t.R7$(3),t.JRh(t.bMT(11,4,"Upgrade")))}function pe(o,l){1&o&&(t.j41(0,"ion-button",54),t.nrm(1,"ion-icon",55),t.j41(2,"ion-label"),t.EFF(3),t.nI1(4,"translate"),t.k0s()()),2&o&&(t.Y8G("disabled",!0),t.R7$(3),t.JRh(t.bMT(4,2,"Download")))}function ue(o,l){if(1&o&&(t.DNE(0,me,6,6,"ion-button",49)(1,_e,12,6)(2,pe,5,4),t.j41(3,"ion-button",56),t.nI1(4,"translate"),t.nrm(5,"ion-icon",51),t.k0s()),2&o){const i=t.XpG(2);t.vxM(0,i.media.isdownload&&i.media.ispublic&&i.membership.TaiVeCacHocLieuHeThongCungCap?0:i.media.isdownload&&i.media.ispublic&&!i.membership.TaiVeCacHocLieuHeThongCungCap?1:2),t.R7$(3),t.Y8G("title",t.bMT(4,3,"Share"))("disabled",!0)}}function ge(o,l){if(1&o&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&o){const i=t.XpG(2);t.R7$(),t.E5c("",t.bMT(2,3,"Size"),": ",i.media.width," x ",i.media.height," px")}}function ve(o,l){if(1&o&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&o){const i=t.XpG(2);t.R7$(),t.Lme("",t.bMT(2,2,"MediaType"),": ",i.media.ext,"")}}function he(o,l){if(1&o&&(t.j41(0,"div",37),t.nrm(1,"ion-icon",63),t.j41(2,"span",64),t.EFF(3),t.k0s()()),2&o){const i=t.XpG(2);t.Y8G("title",i.media.topic_titles),t.R7$(3),t.JRh(i.media.topic_titles.split(";").reverse().join(" / "))}}function be(o,l){if(1&o&&(t.j41(0,"div",37),t.nrm(1,"ion-icon",65),t.j41(2,"span",64),t.EFF(3),t.k0s()()),2&o){const i=t.XpG(2);t.Y8G("title",i.media.category_titles),t.R7$(3),t.JRh(i.media.category_titles.split(";").reverse().join(" / "))}}function fe(o,l){if(1&o&&(t.j41(0,"div",37),t.nrm(1,"ion-icon",66),t.j41(2,"span",64),t.EFF(3),t.k0s()()),2&o){const i=t.XpG(2);t.Y8G("title",i.media.directory_titles),t.R7$(3),t.JRh(i.media.directory_titles.split(";").reverse().join(" / "))}}function Ce(o,l){if(1&o&&(t.j41(0,"ion-button",69),t.nrm(1,"ion-icon",70),t.j41(2,"ion-label",71),t.EFF(3),t.k0s()()),2&o){const i=l.$implicit;t.Y8G("title",i),t.R7$(3),t.JRh(i)}}function Me(o,l){if(1&o&&(t.j41(0,"ion-button",69),t.nrm(1,"ion-icon",72),t.j41(2,"ion-label",71),t.EFF(3),t.k0s()()),2&o){const i=l.$implicit;t.Y8G("title",i),t.R7$(3),t.JRh(i)}}function xe(o,l){if(1&o&&(t.j41(0,"ion-button",69),t.nrm(1,"ion-icon",73),t.j41(2,"ion-label",71),t.EFF(3),t.k0s()()),2&o){const i=l.$implicit;t.Y8G("title",i),t.R7$(3),t.JRh(i)}}function ke(o,l){if(1&o&&(t.j41(0,"ion-button",69),t.nrm(1,"ion-icon",74),t.j41(2,"ion-label",71),t.EFF(3),t.k0s()()),2&o){const i=l.$implicit;t.Y8G("title",i),t.R7$(3),t.JRh(i)}}function we(o,l){if(1&o&&(t.j41(0,"div",39)(1,"h5",67),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.j41(4,"div",30)(5,"div",31)(6,"div",68),t.Z7z(7,Ce,4,2,"ion-button",69,t.fX1),t.Z7z(9,Me,4,2,"ion-button",69,t.fX1),t.Z7z(11,xe,4,2,"ion-button",69,t.fX1),t.Z7z(13,ke,4,2,"ion-button",69,t.fX1),t.k0s()()()()),2&o){let i,n,e;const a=t.XpG(2);t.R7$(2),t.JRh(t.bMT(3,1,"Tag")),t.R7$(5),t.Dyx(null==a.media.tags?null:a.media.tags.split(";")),t.R7$(2),t.Dyx(null==a.media.topic_titles||null==(i=a.media.topic_titles.split(";"))?null:i.reverse()),t.R7$(2),t.Dyx(null==a.media.category_titles||null==(n=a.media.category_titles.split(";"))?null:n.reverse()),t.R7$(2),t.Dyx(null==a.media.directory_titles||null==(e=a.media.directory_titles.split(";"))?null:e.reverse())}}function ye(o,l){if(1&o){const i=t.RV6();t.j41(0,"div",75)(1,"ion-item",76),t.bIt("click",function(){const e=t.eBV(i).$implicit,a=t.XpG(3);return t.Njj(a.switchMedia(e.media_id))}),t.j41(2,"ion-thumbnail"),t.nrm(3,"img",43),t.k0s()()()}if(2&o){const i=l.$implicit,n=t.XpG(3);t.R7$(),t.Y8G("title",i.media_title),t.R7$(2),t.Y8G("src",i.cover?n.readfileuploadurl+i.cover:"assets/image/media/image.svg",t.B4B)("alt",i.media_title)}}function Pe(o,l){if(1&o&&(t.j41(0,"div",40)(1,"h5",67),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.j41(4,"div",68),t.Z7z(5,ye,4,3,"div",75,t.fX1),t.k0s()()),2&o){const i=t.XpG(2);t.R7$(2),t.JRh(t.bMT(3,1,"MediaRelated")),t.R7$(3),t.Dyx(i.medias_related)}}function Te(o,l){if(1&o){const i=t.RV6();t.j41(0,"div",18)(1,"div",19)(2,"div",20)(3,"div",21)(4,"div",22),t.DNE(5,ie,2,2)(6,oe,3,1)(7,re,2,2)(8,le,2,0),t.k0s()()(),t.j41(9,"div",23)(10,"div",24),t.DNE(11,ce,5,4,"ion-button",25)(12,ue,6,5),t.j41(13,"ion-button",26),t.nI1(14,"translate"),t.bIt("click",function(e){t.eBV(i);const a=t.XpG();return t.Njj(a.toggleBookmark(e))}),t.nrm(15,"ion-icon",27),t.k0s()(),t.j41(16,"div",28),t.DNE(17,ge,3,5,"p")(18,ve,3,4,"p"),t.j41(19,"p"),t.EFF(20),t.nI1(21,"translate"),t.nI1(22,"translate"),t.k0s()()()()(),t.j41(23,"div",29)(24,"div",30)(25,"div",31)(26,"div",32)(27,"div",33)(28,"ion-chip")(29,"ion-avatar",34),t.nrm(30,"img",35),t.k0s(),t.j41(31,"ion-label"),t.EFF(32),t.k0s()()(),t.j41(33,"div",36),t.DNE(34,he,4,2,"div",37)(35,be,4,2)(36,fe,4,2),t.k0s()(),t.j41(37,"h2",38),t.EFF(38),t.k0s()()()(),t.DNE(39,we,15,3,"div",39)(40,Pe,7,3,"div",40)}if(2&o){let i;const n=t.XpG();t.R7$(3),t.BMQ("style","padding-bottom:"+n.viewOptions.ratio+"%",t.$dS),t.R7$(2),t.vxM(5,"img"===(i=n.viewOptions.type)?5:"canvas"===i?6:"iframe"===i?7:8),t.R7$(6),t.vxM(11,n.media.isowner?11:12),t.R7$(2),t.Y8G("color",n.media.isbookmark?"tertiary":"dark")("fill",n.media.isbookmark?"solid":"outline")("title",t.bMT(14,17,"Bookmark"))("disabled",!(null!=n.user&&n.user.userid)),t.R7$(4),t.vxM(17,n.media.width&&n.media.height?17:-1),t.R7$(),t.vxM(18,n.media.ext?18:-1),t.R7$(2),t.Lme("",t.bMT(21,19,"Use"),": ",n.media.ispublic?"Tabca Pro":t.bMT(22,21,"Private"),""),t.R7$(10),t.Y8G("src",n.media.createdby_avatar?n.readfileuploadurl+n.media.createdby_avatar:"assets/image/user-avatar-default.png",t.B4B),t.R7$(2),t.JRh(n.media.createdby_name),t.R7$(2),t.vxM(34,n.media.topic_titles?34:n.media.category_titles?35:n.media.directory_titles?36:-1),t.R7$(4),t.JRh(n.media.media_title),t.R7$(),t.vxM(39,n.media.tags||n.media.topic_titles||n.media.category_titles||n.media.directory_titles?39:-1),t.R7$(),t.vxM(40,n.medias_related.length?40:-1)}}let Re=(()=>{var o;class l{constructor(n,e,a,r,d,s,_){this.titleService=n,this.metaService=e,this.router=a,this.activatedRoute=r,this.toastController=d,this.modalController=s,this.loadingController=_,this.appsettings={},this.user={},this.APP_ROUTE=T._,this.APP_FUNC_FormatDate=K.Rv,this.v_functionlimit=z.r,this.envUI_Config=S.c.ui_config,this.siteurl=S.c.url,this.readfileuploadurl="",this.membership={},this.medias_related=[],this.filter={},this.paging={page:1,limit:50,active:!0},this.medias=[],this.viewOptions={ratio:66.67}}ngOnInit(){var n,e;this.readfileuploadurl=null!==(n=this.appsettings.readfileuploadurl)&&void 0!==n?n:"",null!==(e=this.user)&&void 0!==e&&e.userid?Promise.all([new Promise((a,r)=>{var d;(0,at.EW)({params:{userid:null===(d=this.user)||void 0===d?void 0:d.userid,v_functionlimit:z.r.GenAITaoHinhAnh},callback:s=>{var _;this.membership.GenAITaoHinhAnh=(0,rt.j)(null==s||null===(_=s.contents)||void 0===_?void 0:_.find(m=>m.v_functionlimit==z.r.GenAITaoHinhAnh)),a(s)}})}),new Promise((a,r)=>{var d;(0,at.EW)({params:{userid:null===(d=this.user)||void 0===d?void 0:d.userid,v_functionlimit:z.r.TaiVeCacHocLieuHeThongCungCap},callback:s=>{var _;this.membership.TaiVeCacHocLieuHeThongCungCap=(0,rt.j)(null==s||null===(_=s.contents)||void 0===_?void 0:_.find(m=>m.v_functionlimit==z.r.TaiVeCacHocLieuHeThongCungCap)),a(s)}})})]).then(()=>{this.loadMedia(()=>{this.loadMedia_Related()})}):this.loadMedia()}searchChange(n){var e;this.filter.search=null===(e=n.target.value)||void 0===e?void 0:e.replace(/[\`\~\!\@\#\$\%\^\&\*\(\)\-\_\=\+\[\{\]\}\\\|\;\:\'\,\<\.\>\/\?]+/g," ").replace(/\s+/g," ").trim(),this.refreshData()}filterChange(){this.refreshData()}refreshData(n){this.filter.search?(this.paging.page=1,this.paging.active=!0,this.loadData_Paging(n)):this.closeSearch()}loadMore(n){this.paging.page+=1,this.loadData_Paging(n)}pushData(n){return 1==this.paging.page&&(this.medias.length=0),this.medias=this.medias.concat(n),this.medias}loadData_Paging(n){var e;(0,Q.br)({loadingController:1==this.paging.page?this.loadingController:void 0,params:{userid:null===(e=this.user)||void 0===e?void 0:e.userid,getfrom:1,media_title:this.filter.search,v_mediatypes:[y.S.IMAGE,y.S.IMAGE_ANIMATION,y.S.PHET,y.S.HTML,y.S.SCORM].join(","),topic_id:this.filter.topic_id,sortfield:this.paging.sortfield,sorttype:this.paging.sorttype,page:this.paging.page,limit:this.paging.limit},callback:a=>{this.pushData(a||[]).length<this.paging.limit*this.paging.page&&(this.paging.active=!1),n&&n()}})}loadMedia(n){var e;(0,Q.e6)({loadingController:this.loadingController,params:{userid:null===(e=this.user)||void 0===e?void 0:e.userid,media_id:this.media_id},callback:a=>{var r,d,s,_,m,u,v,b,C,R,M,O,X,x;a&&a.media_id?(this.media=a||{},(0,K.Kd)(this.titleService,this.metaService,{title:this.media.media_title,description:(0,it.YW)(this.media.media_description),keywords:null===(r=this.media.tags)||void 0===r?void 0:r.replace(/\;/g,", "),image:{url:`${this.appsettings.readfileuploadurl}${this.media.bigcover}`,type:"image/jpge",width:800,height:800,alt:this.media.media_title},url:`${S.c.url}/${T._.MEDIA_VIEWER_ID.replace(":id",null!==(d=null===(s=this.media.media_id)||void 0===s?void 0:s.toString())&&void 0!==d?d:"")}`,author:{name:this.media.createdby_name,email:S.c.author.email},updated:null!==(_=this.media.modifieddate)&&void 0!==_?_:this.media.createddate}),this.media.isdownload=!(this.media.v_mediatype==y.S.LINK||!this.media.filepath),null!==(m=this.media)&&void 0!==m&&null!==(m=m.filepath)&&void 0!==m&&m.match(/.lvm$/)?(0,Jt.Q)(`${this.appsettings.readfileuploadurl}${null===(u=this.media)||void 0===u?void 0:u.filepath}`).then(E=>{let{ext:f,file:k}=E;switch(f){case"gif":case"apng":this.viewOptions.type="img",this.viewOptions.file=k,this.viewOptions.url=URL.createObjectURL(k);break;case"avif":case"jpg":case"jpe":case"jpeg":case"jif":case"jfif":case"pjp":case"pjpeg":case"png":case"ico":case"cur":case"tif":case"tiff":case"bmp":case"webp":case"svg":{this.viewOptions.type="canvas",this.viewOptions.file=k;let P=new FileReader;P.onload=j=>{let w=new Image;w.onload=()=>{var V;let B=w.width||1,G=w.height||1;if("svg"==f){let A=B/G;A>=1?(B=Math.max(B,800),G=B/A):(G=Math.max(G,800),B=G*A)}let D=null===(V=this.canvas)||void 0===V?void 0:V.nativeElement;if(D){D.width=B,D.height=G,D.style.maxWidth="100%",D.style.maxHeight="100%";let A=D.getContext("2d");A&&A.drawImage(w,0,0,B,G)}},w.onerror=()=>{(0,F.c)(this.toastController,{color:"danger",message:"Kh\xf4ng t\u1ea3i \u0111\u01b0\u1ee3c th\xf4ng tin \u1ea3nh!"}).then(V=>V.present())},w.src=j.target.result},P.onerror=j=>{(0,F.c)(this.toastController,{color:"danger",message:"Kh\xf4ng t\u1ea3i \u0111\u01b0\u1ee3c t\u1eadp tin!"}).then(w=>w.present())},P.readAsDataURL(k);break}}}):(this.viewOptions.type="iframe",this.viewOptions.url=(0,h._KM)({readfileuploadurl:this.appsettings.readfileuploadurl,type:null===(v=this.media)||void 0===v?void 0:v.v_mediatype,oss:null===(b=this.media)||void 0===b?void 0:b.v_osstype,path:null!==(C=null===(R=this.media)||void 0===R?void 0:R.filepath_extract)&&void 0!==C?C:null===(M=this.media)||void 0===M?void 0:M.filepath,url:null!==(O=null===(X=this.media)||void 0===X?void 0:X.link_file)&&void 0!==O?O:null===(x=this.media)||void 0===x?void 0:x.link_share})),n&&n()):this.router.navigateByUrl(T._.LANDING_PAGE)}})}loadMedia_Related(){var n,e,a,r;this.medias_related=[];let d=[];null!==(n=this.media)&&void 0!==n&&n.tags&&d.push({type:"tags",tags:this.media.tags}),null!==(e=this.media)&&void 0!==e&&e.directory_id&&d.push({type:"directory",directory_id:this.media.directory_id}),null!==(a=this.media)&&void 0!==a&&a.topic_id&&d.push({type:"topic",topic_id:this.media.topic_id}),null!==(r=this.media)&&void 0!==r&&r.category_id&&d.push({type:"category",category_id:this.media.category_id});let s=()=>{var _;let m=d.shift();m&&(0,Q.br)({params:Object.assign({userid:null===(_=this.user)||void 0===_?void 0:_.userid,getfrom:1,v_mediatypes:[y.S.IMAGE,y.S.IMAGE_ANIMATION,y.S.PHET,y.S.HTML,y.S.SCORM].join(","),sortfield:this.paging.sortfield,sorttype:this.paging.sorttype,page:1,limit:18},m),callback:u=>{this.medias_related=this.medias_related.concat(u||[]),this.medias_related.length<18&&s()}})};s()}closeSearch(){this.filter={},this.medias.length=0}toggleBookmark(n){var e=this;return(0,g.A)(function*(){e.media&&(e.media.isbookmark=!e.media.isbookmark)})()}navigateByUrl(n){n&&this.router.navigateByUrl(n)}switchMedia(n){var e=this;return(0,g.A)(function*(){n&&(e.media_id=n,e.router.navigate([],{relativeTo:e.activatedRoute,queryParams:{m:n},queryParamsHandling:"merge",replaceUrl:!0}),e.loadMedia(()=>{var a;e.closeSearch(),null===(a=e.inherits)||void 0===a||null===(a=a.parentContent)||void 0===a||a.scrollToTop(500)}))})()}redirectMedia(n){var e=this;return(0,g.A)(function*(){n&&(e.media_id=n,e.router.navigate([],{relativeTo:e.activatedRoute,queryParams:{m:n},queryParamsHandling:"merge",replaceUrl:!0}),e.loadMedia(()=>{var a;e.closeSearch(),null===(a=e.inherits)||void 0===a||null===(a=a.parentContent)||void 0===a||a.scrollToTop(500).then(()=>{e.loadMedia_Related()})}))})()}downloadMedia(){var n=this;return(0,g.A)(function*(){var e,a,r;null!==(e=n.media)&&void 0!==e&&e.isdownload&&(["img","canvas"].includes(null!==(a=n.viewOptions.type)&&void 0!==a?a:"")&&n.viewOptions.file?ot()(n.viewOptions.file,n.media.media_title+"."+n.viewOptions.file.name.split(".").pop(),n.viewOptions.file.type):null!==(r=n.media)&&void 0!==r&&r.filepath&&ot()(`${n.appsettings.readfileuploadurl}${n.media.filepath}`))})()}AI_recommend(n){var e=this;return(0,g.A)(function*(){(0,Ht.QB)(e.modalController,n)})()}loadIframe(n){this.iframe=n.target}presentModalAiImage(n){var e=this;return(0,g.A)(function*(){const a=yield e.modalController.create({component:Ut.K,mode:"md",cssClass:"ion-modal-lg modal-vip",backdropDismiss:!1,keyboardClose:!1});a.onDidDismiss().then(r=>{"confirm"==r.role&&e.switchMedia(r.data)}),a.present()})()}presentModalMediaShare(n){var e=this;return(0,g.A)(function*(){var a;(yield e.modalController.create({component:Yt.U,componentProps:{media_id:null===(a=e.media)||void 0===a?void 0:a.media_id},mode:"md",cssClass:"ion-modal",backdropDismiss:!0,keyboardClose:!0})).present()})()}}return(o=l).\u0275fac=function(n){return new(n||o)(t.rXU(L.hE),t.rXU(L.W8),t.rXU($.Ix),t.rXU($.nX),t.rXU(c.K_),t.rXU(c.W3),t.rXU(c.Xi))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-viewer-media"]],viewQuery:function(n,e){if(1&n&&t.GBs(Kt,5),2&n){let a;t.mGM(a=t.lsd())&&(e.canvas=a.first)}},inputs:{appsettings:"appsettings",user:"user",media_id:"media_id",inherits:"inherits"},decls:10,vars:4,consts:[["canvas",""],[1,"container","pt-2","mt-4","mb-5","max-w-800"],[1,"mt-0","mb-3","fw-500","text-center"],[1,"d-flex","align-items-center","searchbox"],["name","search-outline",1,"fs-24","ml-3"],[1,"flex-grow-1"],["mode","ios","placeholder","Nh\u1eadp n\u1ed9i dung c\u1ea7n t\xecm","search-icon"," ",2,"padding","0",3,"ionChange","debounce","value"],[1,"container","mb-4","list-media"],["mode","ios","color","tabca-pro",1,"m-1","btn-ai-image",3,"title"],["mode","ios","color","tabca-pro",1,"m-1","btn-ai-image",3,"click","title"],["src","../../../assets/icon-svg/magic-ai-2.svg",1,"fs-24"],[1,"mb-2","fs-14"],[1,"d-flex","flex-wrap","p-2","m-0"],[1,"position-relative","d-block","p-0","m-2"],[3,"click","title"],[3,"src","alt","title"],[1,"text-center","text-ellipsis",3,"title"],[1,"position-absolute","top-2","left-2","media-type"],[1,"container"],[1,"row","align-items-stretch"],[1,"col-12","col-lg-8","mb-4","media-view"],[1,"position-relative","w-0","h-0"],[1,"position-absolute","top-0","left-0","right-0","bottom-0"],[1,"col-12","col-lg-4","mb-4","media-info"],[1,"d-flex"],["mode","ios","color","dark","fill","outline",1,"btn-share","ml-3",3,"title"],["mode","ios",1,"btn-bookmark","ml-3",3,"click","color","fill","title","disabled"],["name","bookmark-outline"],[1,"mt-4"],[1,"container","mb-4","media-introduce"],[1,"row"],[1,"col-12","col-lg-8"],[1,"d-flex","align-items-center","justify-content-between"],[1,"flex-grow-1","text-nowrap"],[1,"min-w-24"],["onerror","errorAvatar(this)",3,"src"],[1,"d-block","d-md-flex","flex-nowrap","align-items-center","text-ellipsis"],[1,"text-ellipsis","d-flex","align-items-center","ml-3",3,"title"],[1,"mt-2","mb-0","fw-400"],[1,"container","mb-4","media-tag"],[1,"container","mb-4","media-related"],["oncontextmenu","return false",1,"view-box","img-box"],[3,"src","alt",4,"ngIf"],[3,"src","alt"],["oncontextmenu","return false",1,"view-box","iframe-box"],["frameborder","0","allowfullscreen","","webkitallowfullscreen","","allowtransparency","true","allow","autoplay; fullscreen","oncontextmenu","return false",3,"src","load",4,"ngIf"],["frameborder","0","allowfullscreen","","webkitallowfullscreen","","allowtransparency","true","allow","autoplay; fullscreen","oncontextmenu","return false",3,"load","src"],[1,"d-flex","w-100","h-100","align-items-center","justify-content-center","line-height-0"],["color","tertiary","name","bubbles"],["mode","ios","color","linear","expand","block",1,"flex-grow-1","btn-download",3,"title"],["mode","ios","color","dark","fill","outline",1,"btn-share","ml-3",3,"click","title"],["name","share-social-outline"],["mode","ios","color","linear","expand","block",1,"flex-grow-1","btn-download",3,"click","title"],["slot","start","src","../../../assets/icon/viewer/download.svg"],["mode","ios","expand","block",1,"flex-grow-1","btn-download",3,"disabled"],["slot","start","name","download-outline"],["mode","ios","color","dark","fill","outline",1,"btn-share","ml-3",3,"title","disabled"],[1,"rounded","border","p-4"],[1,"d-flex","align-items-center"],["src","../../../assets/image/tabca-pro-2.svg",1,"fs-22","icon-tabca-pro"],[1,"fw-700","fs-16","ml-3"],[1,"my-3"],["mode","ios","color","linear","expand","block",3,"click","title"],["src","../../../assets/icon-svg/dashboard/topic.svg",1,"fs-20"],[1,"fs-12","text-ellipsis"],["src","../../../assets/icon-svg/dashboard/category.svg",1,"fs-20"],["src","../../../assets/icon-svg/dashboard/template.svg",1,"fs-20"],[1,"mt-0","mb-2"],[1,"d-flex","flex-wrap"],["mode","ios","size","small","color","dark","fill","outline",1,"mt-0","ml-0","mr-2","mb-2",3,"title"],["slot","start","src","../../../assets/icon/viewer/tag.svg",1,"fs-20"],[1,"fs-14"],["slot","start","src","../../../assets/icon/viewer/topic.svg",1,"fs-20"],["slot","start","src","../../../assets/icon/viewer/category.svg",1,"fs-20"],["slot","start","src","../../../assets/icon/viewer/directory.svg",1,"fs-20"],[1,"mr-2","mb-2"],["lines","none","detail","false","button","true",3,"click","title"]],template:function(n,e){1&n&&(t.j41(0,"div",1)(1,"h4",2),t.EFF(2,"T\xe0i nguy\xean h\u1ecdc t\u1eadp trong t\u1ea7m tay"),t.k0s(),t.j41(3,"div",3),t.nrm(4,"ion-icon",4),t.j41(5,"div",5)(6,"ion-searchbar",6),t.bIt("ionChange",function(r){return e.searchChange(r)}),t.k0s()(),t.DNE(7,qt,2,1),t.k0s()(),t.DNE(8,ee,12,2,"div",7)(9,Te,41,23)),2&n&&(t.R7$(6),t.Y8G("debounce",1e3)("value",e.filter.search),t.R7$(),t.vxM(7,e.envUI_Config.is_ai_image?7:-1),t.R7$(),t.vxM(8,e.medias.length?8:e.media?9:-1))},dependencies:[I.bT,c.mC,c.Jm,c.b_,c.I9,c.ZB,c.iq,c.KW,c.uz,c.he,c.S1,c.w2,c.Zx,c.Gw,Wt.m,J.D9],styles:['.searchbox[_ngcontent-%COMP%]{overflow:hidden;border-radius:.75rem;border:1px solid #8F9BB3;background:#fff}.searchbox[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{width:100%;height:40px;--background: transparent;--box-shadow: none}.searchbox[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:2.5rem}.searchbox[_ngcontent-%COMP%]   ion-button.btn-ai-image[_ngcontent-%COMP%]{width:2.5rem;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0}.searchbox[_ngcontent-%COMP%]   ion-button.btn-search[_ngcontent-%COMP%]{width:2.5rem;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0}.media-view[_ngcontent-%COMP%]   .view-box[style][_ngcontent-%COMP%]:not([style=""]){border-radius:.75rem;background:var(--ion-background-color);box-shadow:4px 4px 12px #0101011a}.media-view[_ngcontent-%COMP%]   .view-box[style][_ngcontent-%COMP%]:not([style=""]):before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;z-index:1;opacity:.16;background-image:var(--bg-img);background-repeat:no-repeat;background-position:center center;background-size:cover}.media-view[_ngcontent-%COMP%]   .view-box[style][_ngcontent-%COMP%]:not([style=""]) > *[_ngcontent-%COMP%]{position:relative;z-index:2}.media-view[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;line-height:0;overflow:hidden;border-radius:.75rem;box-shadow:0 0 0 1px #fff;display:flex;align-items:center;justify-content:center}.media-view[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .media-view[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{border-radius:.25rem;overflow:hidden;box-shadow:0 0 12px #0101011a}.media-view[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;z-index:2147483647;background:transparent;-webkit-user-select:none;user-select:none}.media-view[_ngcontent-%COMP%]   .iframe-box[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;line-height:0;overflow:hidden;border-radius:.75rem;background:var(--ion-background-color);box-shadow:4px 4px 12px #01010133}.media-view[_ngcontent-%COMP%]   .iframe-box[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{display:block;width:100%;height:100%;padding:0;margin:0;border:0;outline:none;background-color:#fff}.media-info[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0}.media-info[_ngcontent-%COMP%]   ion-button[color=dark][_ngcontent-%COMP%]::part(native){border-color:var(--ion-color-medium-tint)}.media-info[_ngcontent-%COMP%]   .btn-download[_ngcontent-%COMP%]{min-width:3rem;height:3rem;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0}.media-info[_ngcontent-%COMP%]   .btn-share[_ngcontent-%COMP%], .media-info[_ngcontent-%COMP%]   .btn-bookmark[_ngcontent-%COMP%]{min-width:3rem;width:3rem;height:3rem;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0}.media-introduce[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{margin:0;--background: transparent}.media-introduce[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0}.media-tag[_ngcontent-%COMP%]   ion-button[color=dark][_ngcontent-%COMP%]::part(native){border-color:var(--ion-color-medium-tint)}.media-related[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0;--inner-padding-top: 0;--inner-padding-bottom: 0;--inner-padding-start: 0;--inner-padding-end: 0;--border-width: 1px;--border-color: var(--ion-color-medium-tint);--border-radius: .5rem}.media-related[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{--size: 9rem;--border-radius: .375rem;margin:0}.list-media[_ngcontent-%COMP%]{min-height:200px}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{width:156px;margin:0;box-shadow:none}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:156px;height:156px;padding:5px;border-radius:6px;object-fit:contain;overflow:hidden;border:1px solid #E7F0EF;background:#fff;cursor:pointer;transition:padding .3s ease-in-out}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-img.svgedit[_ngcontent-%COMP%]{padding:45px}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{position:relative}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-img.audio[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;width:42px;height:42px;top:50%;left:50%;transform:translate(-50%,-50%);background-image:url(video-2.54e0cad43aa51646.svg);background-repeat:no-repeat;background-position:center center;background-size:cover}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-img.video[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;width:42px;height:42px;top:50%;left:50%;transform:translate(-50%,-50%);background-image:url(video-2.54e0cad43aa51646.svg);background-repeat:no-repeat;background-position:center center;background-size:cover}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-img.animation[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;width:42px;height:42px;top:50%;left:50%;transform:translate(-50%,-50%);background-image:url(video-2.54e0cad43aa51646.svg);background-repeat:no-repeat;background-position:center center;background-size:cover}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]:hover   ion-img[_ngcontent-%COMP%]{padding:0}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:0;color:#333}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{height:24px;line-height:24px}.list-media[_ngcontent-%COMP%]   .media-type[_ngcontent-%COMP%]{display:none;padding:2px 4px;border-radius:6px;background:#33333380;color:#fff;text-align:center;font-size:13px;font-style:normal;text-transform:uppercase;font-weight:700;line-height:22px}.list-media[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style:none}.list-media[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover   .media-type[_ngcontent-%COMP%]{display:block}']}),l})();var Oe=p(7586),H=p.n(Oe);const lt=o=>({$implicit:o});function Ie(o,l){if(1&o&&t.eu8(0,12),2&o){const i=l.$implicit;t.XpG();const n=t.sdS(18);t.Y8G("ngTemplateOutlet",n)("ngTemplateOutletContext",t.eq3(2,lt,i))}}function Fe(o,l){if(1&o){const i=t.RV6();t.j41(0,"div",11)(1,"ion-button",13),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.loadMore())}),t.j41(2,"ion-label"),t.EFF(3,"T\u1ea3i th\xeam b\xecnh lu\u1eadn"),t.k0s()()()}}function Ee(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-item-options",23)(1,"ion-item-option",24),t.bIt("click",function(e){t.eBV(i);const a=t.XpG(2).$implicit,r=t.XpG();return t.Njj(r.editComment(e,a.comment_id))}),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.j41(4,"ion-item-option",25),t.bIt("click",function(e){t.eBV(i);const a=t.XpG(2).$implicit,r=t.XpG();return t.Njj(r.deleteComment(e,a.comment_id))}),t.EFF(5),t.nI1(6,"translate"),t.k0s()()}2&o&&(t.R7$(2),t.JRh(t.bMT(3,2,"Edit")),t.R7$(3),t.JRh(t.bMT(6,4,"Delete")))}function Be(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-item-sliding")(1,"ion-item")(2,"ion-thumbnail",16),t.nrm(3,"img",17),t.k0s(),t.j41(4,"ion-label")(5,"div",18),t.EFF(6),t.nI1(7,"translate"),t.j41(8,"small"),t.EFF(9),t.k0s()(),t.j41(10,"div",19),t.EFF(11),t.k0s(),t.j41(12,"div",20)(13,"small",21),t.bIt("click",function(e){t.eBV(i);const a=t.XpG().$implicit,r=t.XpG();return t.Njj(r.replyComment(e,a.comment_id))}),t.EFF(14),t.nI1(15,"translate"),t.k0s()()()(),t.DNE(16,Ee,7,6,"ion-item-options",22),t.k0s()}if(2&o){let i;const n=t.XpG().$implicit,e=t.XpG();t.R7$(3),t.Y8G("src",n.createdby_avatar?e.readfileuploadurl+n.createdby_avatar:"assets/image/user-avatar-default.png",t.B4B),t.R7$(3),t.JRh(null!==(i=n.createdby_name)&&void 0!==i?i:t.bMT(7,6,"Guest")),t.R7$(3),t.JRh(e.formatDatetime(n.createddate)),t.R7$(2),t.JRh(n.comment_content),t.R7$(3),t.JRh(t.bMT(15,8,"Reply")),t.R7$(2),t.Y8G("ngIf",(null==e.user?null:e.user.userid)==n.createdby)}}function Ge(o,l){if(1&o){const i=t.RV6();t.j41(0,"ion-item",26)(1,"ion-input",27),t.nI1(2,"translate"),t.bIt("ionChange",function(e){t.eBV(i);const a=t.XpG(2);return t.Njj(a.changeComment2(e))})("keyup",function(e){t.eBV(i);const a=t.XpG(2);return t.Njj(a.keyupComment2(e))}),t.k0s(),t.j41(3,"ion-button",28),t.bIt("click",function(e){t.eBV(i);const a=t.XpG(2);return t.Njj(a.sendComment(e,a.comment2))}),t.nrm(4,"ion-icon",7),t.k0s()()}if(2&o){let i;const n=t.XpG(2);t.R7$(),t.FS9("placeholder",t.bMT(2,3,"EnterReply")),t.Y8G("autofocus",!0)("value",null!==(i=n.comment2.comment_content)&&void 0!==i?i:"")}}function Xe(o,l){if(1&o&&t.eu8(0,12),2&o){const i=l.$implicit;t.XpG(2);const n=t.sdS(18);t.Y8G("ngTemplateOutlet",n)("ngTemplateOutletContext",t.eq3(2,lt,i))}}function De(o,l){if(1&o&&(t.j41(0,"li"),t.DNE(1,Be,17,10,"ion-item-sliding",14)(2,Ge,5,5,"ion-item",15),t.j41(3,"ul"),t.DNE(4,Xe,1,4,"ng-container",10),t.k0s()()),2&o){const i=l.$implicit,n=t.XpG();t.R7$(),t.Y8G("ngIf",n.comment2.comment_id!=i.comment_id),t.R7$(),t.Y8G("ngIf",n.comment2.comment_pid==i.comment_id),t.R7$(2),t.Y8G("ngForOf",n.filterComments(i.comment_id))}}let Ae=(()=>{var o;class l{constructor(n,e){this.toastController=n,this.loadingController=e,this.appsettings={},this.user={},this.paging={page:1,limit:10,active:!0},this.comment={},this.comment2={},this.comments=[],this.readfileuploadurl=""}ngOnInit(){var n;this.readfileuploadurl=null!==(n=this.appsettings.readfileuploadurl)&&void 0!==n?n:"",this.loadData()}loadData(n){this.paging.page=1,this.paging.active=!0,this.loadData_Paging(n)}loadMore(n){this.paging.page+=1,this.loadData_Paging(n)}loadData_Paging(n){var e,a,r;!function je(o){o.params=o.params||{},(0,N.hm)({url:"api/comment/get",params:{getby:o.params.userid||null,v_tabletype:o.params.doctype||null,table_id:o.params.docid||null},success:l=>{l=l||{},"function"==typeof o.callback&&o.callback(l.data)},error:l=>{"function"==typeof o.callback&&o.callback(),console.error(o,l)},loading:o.loading,loadingController:o.loadingController})}({loading:d=>{this.paging.loading=d},params:{userid:null===(e=this.user)||void 0===e?void 0:e.userid,doctype:null!==(a=this.doctype)&&void 0!==a?a:1105,docid:null!==(r=this.docid)&&void 0!==r?r:1,numchild:this.paging.limit,posstart:(this.paging.page-1)*this.paging.limit+1,numofrow:this.paging.limit,sortfield:234,sorttype:"desc"},callback:d=>{this.comments=this.comments.concat(d||[]),(!(null!=d&&d.length)||(null==d?void 0:d.length)<this.paging.limit)&&(this.paging.active=!1),n&&n()}})}filterComments(n){return n?this.comments.filter(e=>e.comment_pid==n).sort((e,a)=>{var r,d;return(null!==(r=a.comment_id)&&void 0!==r?r:0)-(null!==(d=e.comment_id)&&void 0!==d?d:0)}):this.comments.filter(e=>!e.comment_pid).sort((e,a)=>{var r,d;return(null!==(r=a.comment_id)&&void 0!==r?r:0)-(null!==(d=e.comment_id)&&void 0!==d?d:0)})}formatDatetime(n,e){return H()().diff(H()(n),"days")<1?H()(n).fromNow():H()(n).format(null!=e?e:"HH:mm, DD/MM/YYYY")}keyupComment(n){var e=this;return(0,g.A)(function*(){13==n.keyCode&&e.sendComment(n,e.comment)})()}changeComment(n){var e=this;return(0,g.A)(function*(){var a;e.comment.comment_content=null!==(a=n.detail.value)&&void 0!==a?a:""})()}keyupComment2(n){var e=this;return(0,g.A)(function*(){13==n.keyCode&&e.sendComment(n,e.comment2)})()}changeComment2(n){var e=this;return(0,g.A)(function*(){var a;e.comment2.comment_content=null!==(a=n.detail.value)&&void 0!==a?a:""})()}replyComment(n,e){var a=this;return(0,g.A)(function*(){a.comment2={comment_pid:e}})()}editComment(n,e){var a=this;return(0,g.A)(function*(){var r;a.comment2=null!==(r=a.comments.find(d=>d.comment_id==e))&&void 0!==r?r:{}})()}sendComment(n,e){var a=this;return(0,g.A)(function*(){var r,d,s;e.comment_content&&function $e(o){o.params=o.params||{},(0,N.Ll)({url:"api/comment/addupdate",params:{v_tabletype:o.params.doctype||null,table_id:o.params.docid||null,comment_id:o.params.comment_id||null,comment_pid:o.params.comment_pid||null,comment_content:o.params.comment_content||null,createdby:o.params.userid||null},success:l=>{"function"==typeof o.callback&&o.callback(l.data||null)},error:l=>{"function"==typeof o.callback&&o.callback(),console.error(o,l)},loading:o.loading,loadingController:o.loadingController})}({loadingController:a.loadingController,params:{userid:null===(r=a.user)||void 0===r?void 0:r.userid,doctype:null!==(d=a.doctype)&&void 0!==d?d:1105,docid:null!==(s=a.docid)&&void 0!==s?s:1,comment_id:e.comment_id,comment_pid:e.comment_pid,comment_content:e.comment_content},callback:_=>{0==(null==_?void 0:_.returncode)?(e.comment_id?a.comments.filter(m=>m.comment_id!=e.comment_id).forEach(m=>e):(e.comment_id=null==_?void 0:_.id,a.comments.push(e)),a.comment={},a.comment2={}):(0,F.c)(a.toastController,{},_).then(m=>{m.present()})}})})()}deleteComment(n,e){var a=this;return(0,g.A)(function*(){var r;!function Ve(o){o.params=o.params||{},(0,N.sj)({url:"api/comment/delete",params:{comment_id:o.params.comment_id||null,createdby:o.params.userid||null},success:l=>{"function"==typeof o.callback&&o.callback(l.data||null)},error:l=>{"function"==typeof o.callback&&o.callback(),console.error(o,l)},loading:o.loading,loadingController:o.loadingController})}({loadingController:a.loadingController,params:{userid:null===(r=a.user)||void 0===r?void 0:r.userid,comment_id:e},callback:d=>{0==(null==d?void 0:d.returncode)?a.comments=a.comments.filter(s=>s.comment_id!=e&&s.comment_pid!=e):(0,F.c)(a.toastController,{},d).then(s=>{s.present()})}})})()}}return(o=l).\u0275fac=function(n){return new(n||o)(t.rXU(c.K_),t.rXU(c.Xi))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-viewer-comment"]],inputs:{appsettings:"appsettings",user:"user",doctype:"doctype",docid:"docid"},decls:19,vars:10,consts:[["templateCommentLI",""],[1,"container","container-comment"],[1,"row","mb-4"],[1,"col-12","col-lg-8"],["lines","full","mode","ios"],[3,"ionChange","keyup","placeholder","value"],["slot","end","mode","ios","size","default","shape","clear",3,"click"],["name","paper-plane-outline"],[1,"col-12","col-lg-8","pl-0"],["lines","none"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngFor","ngForOf"],[1,"text-center","mt-3"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["size","small","color","medium","fill","outline",3,"click"],[4,"ngIf"],["lines","full",4,"ngIf"],["slot","start"],["onerror","errorAvatar(this)",3,"src"],[1,"comment-name"],[1,"comment-content"],[1,"comment-action"],[3,"click"],["side","end",4,"ngIf"],["side","end"],["color","secondary",3,"click"],["color","danger",3,"click"],["lines","full"],[3,"ionChange","keyup","placeholder","autofocus","value"],["slot","end","mode","ios","size","large","shape","clear",3,"click"]],template:function(n,e){if(1&n){const a=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"h5"),t.EFF(4),t.nI1(5,"translate"),t.k0s(),t.j41(6,"ion-item",4)(7,"ion-input",5),t.nI1(8,"translate"),t.bIt("ionChange",function(d){return t.eBV(a),t.Njj(e.changeComment(d))})("keyup",function(d){return t.eBV(a),t.Njj(e.keyupComment(d))}),t.k0s(),t.j41(9,"ion-button",6),t.bIt("click",function(d){return t.eBV(a),t.Njj(e.sendComment(d,e.comment))}),t.nrm(10,"ion-icon",7),t.k0s()()()(),t.j41(11,"div",2)(12,"div",8)(13,"ion-list",9)(14,"ul"),t.DNE(15,Ie,1,4,"ng-container",10),t.k0s()()()()(),t.DNE(16,Fe,4,0,"div",11)(17,De,5,3,"ng-template",null,0,t.C5r)}if(2&n){let a;t.R7$(4),t.Lme("",t.bMT(5,6,"Comment")," (",e.comments.length,")"),t.R7$(3),t.FS9("placeholder",t.bMT(8,8,"EnterComment")),t.Y8G("value",null!==(a=e.comment.comment_content)&&void 0!==a?a:""),t.R7$(8),t.Y8G("ngForOf",e.filterComments()),t.R7$(),t.vxM(16,e.paging.active?16:-1)}},dependencies:[I.Sq,I.bT,I.T3,c.Jm,c.iq,c.$w,c.uz,c.LU,c.CE,c.A7,c.he,c.nf,c.Zx,c.Gw,J.D9],styles:[".container-comment[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:block;padding:0;margin:1rem 0}.container-comment[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]:empty{display:none}.container-comment[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:block;margin:0 0 .5rem}.container-comment[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding-left:4rem}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{--size: 3rem;--border-radius: 50%;margin-top:0;margin-bottom:0;align-self:flex-start}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .comment-name[_ngcontent-%COMP%]{line-height:1.5rem;font-weight:500}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .comment-name[_ngcontent-%COMP%] > small[_ngcontent-%COMP%]{margin-left:.5rem;font-size:.75rem;color:var(--ion-color-medium);vertical-align:top}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .comment-content[_ngcontent-%COMP%]{line-height:1.5rem;white-space:wrap;text-align:justify}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .comment-action[_ngcontent-%COMP%]{line-height:1.5rem}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .comment-action[_ngcontent-%COMP%] > small[_ngcontent-%COMP%]{line-height:1;vertical-align:middle;font-size:.75rem;color:var(--ion-color-primary);cursor:pointer}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0;margin:0;--border-radius: .5rem;--background: var(--ion-color-secondary)}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.5rem}.container-comment[_ngcontent-%COMP%]   ion-item-option[_ngcontent-%COMP%]{text-transform:initial}"]}),l})();const Ne=o=>({parentContent:o});function Se(o,l){if(1&o&&(t.nrm(0,"app-viewer-board",1),t.j41(1,"div",2),t.nrm(2,"app-viewer-comment",3),t.k0s()),2&o){const i=t.XpG();t.Y8G("appsettings",i.appsettings)("user",i.user)("board_id",i.board_id)("num",i.num),t.R7$(2),t.Y8G("appsettings",i.appsettings)("user",i.user)("doctype",1105)("docid",i.board_id)}}function ze(o,l){if(1&o&&t.nrm(0,"app-viewer-media",4),2&o){const i=t.XpG();t.Y8G("appsettings",i.appsettings)("user",i.user)("media_id",i.media_id)("inherits",t.eq3(4,Ne,i.content))}}const Ue=[{path:"",component:(()=>{var o;class l{constructor(n,e){this.router=n,this.activatedRoute=e,this.appsettings={}}ngOnInit(){var n=this;this.IsOnInit=!0,(0,g.A)(function*(){n.appsettings=yield(0,N.AC)(),n.user=yield(0,q.Nk)(),n.loadParams()})()}ionViewDidEnter(){this.IsOnInit?this.IsOnInit=!1:this.loadParams()}onIonRefresher(n){this.loadParams(()=>{n.target.complete()})}scrollToTop(){var n;null===(n=this.content)||void 0===n||n.scrollToTop(500)}loadParams(n){var e=this;return(0,g.A)(function*(){let a=e.activatedRoute.snapshot.queryParamMap.get("b")||"";if(a)e.board_id=parseInt(a),e.num=parseInt(e.activatedRoute.snapshot.queryParamMap.get("n")||"1")-1;else{let r=e.activatedRoute.snapshot.queryParamMap.get("m")||"";r&&(e.media_id=parseInt(r))}!e.board_id||!e.media_id||e.navigateToHome(),n&&n()})()}navigateByUrl(n){this.router.navigateByUrl(n)}navigateToHome(){var n=this;return(0,g.A)(function*(){(yield(0,tt.lJ)())?n.navigateByUrl(T._.DASHBOARD):n.navigateByUrl(T._.LANDING_PAGE)})()}}return(o=l).\u0275fac=function(n){return new(n||o)(t.rXU($.Ix),t.rXU($.nX))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-viewer"]],viewQuery:function(n,e){if(1&n&&t.GBs(c.W9,5),2&n){let a;t.mGM(a=t.lsd())&&(e.content=a.first)}},decls:7,vars:1,consts:[["slot","fixed",3,"ionRefresh"],[3,"appsettings","user","board_id","num"],[1,"pb-5","mb-5"],[3,"appsettings","user","doctype","docid"],[3,"appsettings","user","media_id","inherits"]],template:function(n,e){1&n&&(t.nrm(0,"app-header"),t.j41(1,"ion-content")(2,"ion-refresher",0),t.bIt("ionRefresh",function(r){return e.onIonRefresher(r)}),t.nrm(3,"ion-refresher-content"),t.k0s(),t.DNE(4,Se,3,8)(5,ze,1,6),t.nrm(6,"app-footer"),t.k0s()),2&n&&(t.R7$(4),t.vxM(4,e.board_id?4:e.media_id?5:-1))},dependencies:[c.W9,c.To,c.Ki,dt.l,st.n,zt,Re,Ae]}),l})()}];let Ye=(()=>{var o;class l{}return(o=l).\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[$.iI.forChild(Ue),$.iI]}),l})();var Je=p(3890);let Le=(()=>{var o;class l{}return(o=l).\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[I.MD,U.YN,c.bv,Ye,Je.x]}),l})()}}]);