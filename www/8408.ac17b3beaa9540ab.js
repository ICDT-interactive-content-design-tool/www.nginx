(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8408],{8408:(Rr,Xi,xi)=>{"use strict";xi.d(Xi,{A9o:()=>Kr,_5L:()=>ja,IBb:()=>Dr,arO:()=>za,XdC:()=>Nt,FLf:()=>lt,r_I:()=>mt,FCb:()=>Mt,PSO:()=>vt,Q$J:()=>yt,hv$:()=>L,i0Z:()=>nc,HYM:()=>rc,U9V:()=>lc,IPF:()=>zh,uDg:()=>mh,ZFU:()=>wh,o8m:()=>_h,zc9:()=>Ih,jme:()=>Th,woc:()=>Eh,OuQ:()=>Ch,tEe:()=>Fh,NP2:()=>bh,gRD:()=>kh,R11:()=>Oh,Djb:()=>Nh,GwF:()=>xh,hko:()=>Sh,Lz2:()=>jh,qBK:()=>Rh,WYX:()=>Ah,iyY:()=>Jh,wSf:()=>ic,nOo:()=>et,dLO:()=>xt,vmR:()=>Xn,CUZ:()=>tc,Uqb:()=>Et,_KM:()=>oe,LVk:()=>p,Dlr:()=>$t,MhA:()=>lh,gyC:()=>ah,enI:()=>ih,Wzt:()=>oh,k5W:()=>ch,_Rs:()=>hh,yND:()=>sh,As1:()=>fh,jK7:()=>uh,okK:()=>dh,dfT:()=>rh,OQD:()=>vh,Hcq:()=>gh,wMG:()=>nh,OVU:()=>Yl,zHt:()=>Xl,XWC:()=>Gr,DSO:()=>At,tix:()=>ce,zOM:()=>A,JRt:()=>V,yUR:()=>Yu,tGH:()=>yh,Cfb:()=>ph,t8k:()=>ui,RYD:()=>N,qGx:()=>Cc,GRx:()=>Ac,_mz:()=>Tc,yhd:()=>Ic,cZ9:()=>Ec,xhT:()=>zc,cKw:()=>jc,qe3:()=>Rc,obU:()=>Jc,U$t:()=>Fc,dns:()=>qc,cuZ:()=>Xc,DNi:()=>Wc,yFt:()=>Uc,RZc:()=>Hc,uJ$:()=>Yc,im6:()=>Gc,Dbh:()=>Kc,qRy:()=>Dc,lcK:()=>Qc,o0:()=>Pc,RL2:()=>Lc,otK:()=>Bc,tdO:()=>Mc,Xu9:()=>uc,ZjY:()=>dc,fYU:()=>oc,JAM:()=>sc,to0:()=>ac,uiC:()=>Cr,TKJ:()=>fc,lFL:()=>hc,TV_:()=>cc,N6o:()=>vc,I6k:()=>Nc,tTI:()=>kc,yqB:()=>Oc,nyA:()=>_c,$TK:()=>xc,Q6X:()=>wc,BTq:()=>bc,WpQ:()=>Sc,Hr7:()=>pc,MQK:()=>gc,RdK:()=>yc,wGP:()=>mc,XTt:()=>Ge,Pe_:()=>Ar,wTo:()=>ht,fug:()=>Pa,NxJ:()=>Ma,E$G:()=>Ba,eil:()=>ar,ZF9:()=>or,SFI:()=>ma,vxI:()=>ka,smx:()=>ba,xOc:()=>Lr,kTo:()=>xa,$x6:()=>pa,T1W:()=>Sa,_oT:()=>ya,rIr:()=>ga,r49:()=>wa,r7c:()=>Wh,R$j:()=>Yh,t9h:()=>Mh,PxE:()=>Kh,mJh:()=>Dh,Ptn:()=>Ph,eQP:()=>Bh,BiI:()=>Uh,BlC:()=>Gh,I06:()=>Qh,zgC:()=>Hh,lh0:()=>Lh,_Sz:()=>$h,Au4:()=>ef,I6V:()=>tf,IBK:()=>Yt,qbd:()=>Vh,nGQ:()=>Zh,pHJ:()=>Xh,wjX:()=>qh,I6f:()=>st,IAo:()=>rt,AEO:()=>G,I1Q:()=>di,nWF:()=>$c,YpM:()=>eh,mmi:()=>th,xR4:()=>Vc,dBz:()=>Zc});const lt={RESIZE_GROUP:"icdt-resize-g",SELECT_GROUP:"icdt-select-g",SCAN_GROUP:"icdt-scan-g",CREATE_GROUP:"icdt-create-g",INTERACTIVE_GROUP:"icdt-interactive-g",INDEX_GROUP:"icdt-index-g",BACKGROUND_GROUP:"icdt-background-g",TEST_GROUP:"icdt-test-g"},vt={POINTER:0,HAND:1,PEN:2,SHAPE:3,FOREIGNOBJECT:6,IMAGE:7,TEXT:4,ERASER:5,INDEX:8},Mt={DRAW:1,HIGHTLIGH:2,INTERACTIVE:3},L={GROUP:0,CIRCLE:1,ELLIPSE:2,LINE:5,RECT:3,POLYGON:4,FOREIGNOBJECT:6,IMAGE:9,TEXT:7,TSPAN:10,PATH:8,POLYLINE:11},yt={TRIANGLE_ISOSCELES:3,TRIANGLE_EQUILATERAL:31,RECTANGLE:4,PENTAGON:5,HEXAGON:6,BOOKMARK:101,COMMENT:102,CROSS:104,ARROW_ONEWAY:201,ARROW_TWOWAY:202,STAR_FOUR:304,STAR_FIVE:305,STAR_SIX:306},Qt=[{name:"tam gi\xe1c vu\xf4ng",type:yt.TRIANGLE_ISOSCELES,ratios:[[0,0],[1,1],[0,1]]},{name:"tam gi\xe1c c\xe2n",type:yt.TRIANGLE_EQUILATERAL,ratios:[[.5,0],[0,1],[1,1]]},{name:"h\xecnh ch\u1eef nh\u1eadt",type:yt.RECTANGLE,ratios:[[0,0],[1,0],[1,1],[0,1]]},{name:"h\xecnh ng\u0169 gi\xe1c \u0111\u1ec1u",type:yt.PENTAGON,ratios:[[.5,0],[1,.4],[.8,1],[.2,1],[0,.4]]},{name:"h\xecnh l\u1ee5c gi\xe1c \u0111\u1ec1u",type:yt.HEXAGON,ratios:[[.5,0],[1,.25],[1,.75],[.5,1],[0,.75],[0,.25]]},{name:"khung \u0111\xe1nh d\u1ea5u v\u1ecb tr\xed",type:yt.BOOKMARK,ratios:[[0,0],[1,0],[1,.8],[.5,1],[0,.8]]},{name:"khung \u0111\xe1nh tr\xf2 chuy\u1ec7n",type:yt.COMMENT,ratios:[[0,0],[1,0],[1,.9],[.3,.9],[.2,1],[.1,.9],[0,.9]]},{name:"h\xecnh ch\u1eef th\u1eadp",type:yt.CROSS,ratios:[[0,.3],[.3,.3],[.3,0],[.7,0],[.7,.3],[1,.3],[1,.7],[.7,.7],[.7,1],[.3,1],[.3,.7],[0,.7]]},{name:"h\xecnh m\u0169i t\xean 1 chi\u1ec1u",type:yt.ARROW_ONEWAY,ratios:[[0,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[0,.8]]},{name:"h\xecnh m\u0169i t\xean 2 chi\u1ec1u",type:yt.ARROW_TWOWAY,ratios:[[.2,0],[.2,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[.2,.8],[.2,1],[0,.5]]},{name:"h\xecnh ng\xf4i sao 4 c\xe1nh",type:yt.STAR_FOUR,ratios:[[.5,0],[.65,.35],[1,.5],[.65,.65],[.5,1],[.35,.65],[0,.5],[.35,.35]]},{name:"h\xecnh ng\xf4i sao 5 c\xe1nh",type:yt.STAR_FIVE,ratios:[[.5,0],[.625,.4],[1,.4],[.675,.625],[.8,1],[.5,.775],[.2,1],[.325,.625],[0,.4],[.375,.4]]},{name:"h\xecnh ng\xf4i sao 6 c\xe1nh",type:yt.STAR_SIX,ratios:[[.5,0],[.667,.25],[1,.25],[.5+.334,.5],[1,.75],[.667,.75],[.5,1],[.334,.75],[0,.75],[.167,.5],[0,.25],[.334,.25]]}],Nt={IMAGE:1,HTML:2,AUDIO:3,VIDEO:4},mt={Digit1:49,Digit2:50,Digit3:51,Digit4:52,Digit5:53,Digit6:54,Digit7:55,Digit8:56,Digit9:57,Digit0:48,KeyA:65,KeyB:66,KeyC:67,KeyD:68,KeyE:69,KeyF:70,KeyG:71,KeyH:72,KeyI:73,KeyJ:74,KeyK:75,KeyL:76,KeyM:77,KeyN:78,KeyO:79,KeyP:80,KeyQ:81,KeyR:82,KeyS:83,KeyT:84,KeyU:85,KeyV:86,KeyW:87,KeyX:88,KeyY:89,KeyZ:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,Insert:45,Delete:46,Home:36,End:35,PageUp:33,PageDown:34,ArrowUp:38,ArrowDown:40,ArrowLeft:37,ArrowRight:39,Escape:27,Tab:9,Backspace:8,Enter:13,Space:32,BracketLeft:219,BracketRight:221,Minus:189,Equal:187},ot={stroke:"#0D99FF",strokeWidth:1,strokeLinecap:"square",strokeDasharrays:[2,5]},Yt={fill:"none",stroke:"#2299F8",strokeWidth:1},et=i=>{var t,e,n={};let r=/Italic$/,l=/Thin$/,a=/ExtraLight|UltraLight$/i,o=/Light$/,s=/Regular|Normal$/,d=/Medium$/,u=/SemiBold|DemiBold$/i,c=/Bold$/,h=/ExtraBold|UltraBold$/i,f=/Black|Heavy$/;return(i=null!==(t=null===(e=i.split(","))||void 0===e||null===(e=e.shift())||void 0===e?void 0:e.trim().replace(/[^a-zA-Z_-\s]/g,""))&&void 0!==t?t:"").match(r)&&(n.fontStyle="italic",i=i.replace(r,"").trim()),i.match(l)?(n.fontWeight=100,i=i.replace(l,"").trim()):i.match(a)?(n.fontWeight=200,i=i.replace(a,"").trim()):i.match(o)?(n.fontWeight=300,i=i.replace(o,"").trim()):i.match(s)?(n.fontWeight=400,i=i.replace(s,"").trim()):i.match(d)?(n.fontWeight=500,i=i.replace(d,"").trim()):i.match(u)?(n.fontWeight=600,i=i.replace(u,"").trim()):i.match(c)?(n.fontWeight=700,i=i.replace(c,"").trim()):i.match(h)?(n.fontWeight=800,i=i.replace(h,"").trim()):i.match(f)&&(n.fontWeight=900,i=i.replace(f,"").trim()),n.fontFamily=i.replace(/[\-\_\s]+$/,""),n},xt=i=>{let t=[];return[/font-family\s*:\s*([^;]+);/g,/"fontFamily":"([a-zA-Z0-9\-\_\'\s]+)"/g].forEach(e=>{var n,r;t=[...t,...null!==(n=null===(r=i.replace(/&quot;/g,"'").match(e))||void 0===r?void 0:r.filter((l,a,o)=>o.indexOf(l)==a).map(l=>l.replace(e,"$1").replace(/[^a-zA-Z0-9\-\_\s\,]/g,"").trim()).filter((l,a,o)=>l&&o.indexOf(l)==a))&&void 0!==n?n:[]]}),t.filter((e,n,r)=>r.indexOf(e)==n).map(e=>et(e).fontFamily).filter(e=>!!e).filter((e,n,r)=>r.indexOf(e)==n)},ht=(i,t)=>{if(!i)return"";let e=i.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i),n=(e&&e[4]||"").trim(),r=e?(256|e[1]).toString(16).slice(1)+(256|e[2]).toString(16).slice(1)+(256|e[3]).toString(16).slice(1):i;if("0"==n)return"transparent";if(t){let l;l=""!==n?n:"01",l=(255*l|256).toString(16).slice(1),r+=l}return`#${r}`};var Kt=/^#?[a-fA-F0-9]+$/;const Ut=(i,t)=>{var e;if("none"==(i=null!==(e=i)&&void 0!==e?e:""))return"none";if("transparent"==i)return"rgba(0,0,0,0)";if(i.includes("rgba("))return i;if(i.includes("rgb(")&&(i=ht(i)),!(i=i.replace(/[^0-9a-fA-F]/g,"")))return"";if(!Kt.test(i))return console.error(`hex2rgba -> ${i}: first argument has invalid hexadecimal characters`),"";if("#"===i[0]&&(i=i.slice(1)),3===i.length){let r=i.split("");r.splice(2,0,i[2]),r.splice(1,0,i[1]),r.splice(0,0,i[0]),i=r.join("")}if(6!==i.length)return console.error("hex2rgba: first argument has invalid hexadecimal length"),"";var n=[parseInt(i.slice(0,2),16),parseInt(i.slice(2,4),16),parseInt(i.slice(4,6),16)];return t="number"==typeof t?t:parseFloat(t),n.push(t>=0&&t<=1?t:1),"rgba("+n.join(",")+")"},oe=i=>{switch(null==i?void 0:i.type){case 901:return"assets/iframe/lib/mk-image-viewer/viewer.html?url="+i.readfileuploadurl+i.path;case 902:return"assets/iframe/lib/mk-audio-player-2/player.html?url="+i.readfileuploadurl+i.path;case 903:return"assets/iframe/lib/mk-video-player/player.html?url="+i.readfileuploadurl+i.path;case 908:return"https://view.officeapps.live.com/op/view.aspx?src="+i.readfileuploadurl+i.path;case 909:return"assets/iframe/lib/PDFReader/web/viewer.html?file="+i.readfileuploadurl+i.path;case 906:case 911:case 910:return""+i.readfileuploadurl+i.path;case 905:case 912:var t;return"imsmanifest.xml"==(null===(t=i.path)||void 0===t||null===(t=t.split("/"))||void 0===t?void 0:t.pop())?"assets/iframe/lib/ScormPool_Player/player.html?url="+i.readfileuploadurl+i.path:""+i.readfileuploadurl+i.path;case 907:case 900:return""+i.readfileuploadurl+i.path;case 904:switch(i.oss){case 1003:return"assets/iframe/lib/ScormPool_Player/player.html?url="+i.url;case 1002:var e;return null!==(e=Ue(i.url))&&void 0!==e?e:"";case 1005:var n;return null!==(n=i.url)&&void 0!==n?n:"";default:var r;return null!==(r=i.url)&&void 0!==r?r:""}default:return""+i.readfileuploadurl+i.path}},Ue=i=>{let t=ri(i);return t?"https://www.youtube.com/embed/"+t+"?"+jQuery.param({wmode:"opaque",border:0,hd:1,autoplay:!1,autohide:1,enablejsapi:1,modestbranding:1,version:3,hl:"vi_VN",rel:0,showinfo:0,iv_load_policy:3}):null},ri=i=>{let t=null==i?void 0:i.match(/(?:.+?)?(?:\/v\/|watch\/|\?v\=|\&v\=|youtu\.be\/|\/v\=|^youtu\.be\/|embed\/)([a-zA-Z0-9_-]{11})+/);return t&&t.length>=2?t[1]:null},A=(i,t)=>{var e;return t=null!==(e=t)&&void 0!==e?e:100,Math.round((i+Number.EPSILON)*t)/t},at=i=>A(i/p.screen.scale),Be=i=>{var t;return null===(t=i.split(/(?=[MLCSQTAHVZmlcsqtahvz])/))||void 0===t?void 0:t.map(e=>{let n={type:e.substring(0,1)},r=(l=e.replace(/\s?\-?[0-9\.]+e-[0-9]+/g," 0").replace(/\,/g," ").replace(/\s?\-/g," -").replace(/(\.[0-9]+)(\.[0-9]+)/g,"$1 0$2").replace(/\-\./g,"-0.").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim())?l.split(/\s/).map(a=>A(parseFloat(a),1e6)):[];var l;return r.length&&(n.points=r),n})},He=i=>{let t=[],e=[],n=[],r=[];return i.forEach(l=>{switch(["M","L","C","S","Q","T"].includes(l.type)&&l.points&&l.points.forEach((v,b)=>{b%2==0?t.push(v):e.push(v)}),l.type){case"A":var a;7==(null===(a=l.points)||void 0===a?void 0:a.length)&&(n.push(l.points[5]),r.push(l.points[6]));break;case"H":var o;null!==(o=l.points)&&void 0!==o&&o.length&&(t.push(l.points[0]),n.push(l.points[0]));break;case"V":var s;null!==(s=l.points)&&void 0!==s&&s.length&&(e.push(l.points[0]),r.push(l.points[0]));break;case"a":var d;if(7==(null===(d=l.points)||void 0===d?void 0:d.length)){let v=t[t.length-1];t.push(v+l.points[5]),n.push(v+l.points[5]);let b=e[e.length-1];e.push(b+l.points[6]),r.push(b+l.points[6])}break;case"h":var u;if(null!==(u=l.points)&&void 0!==u&&u.length){let v=t[t.length-1];t.push(v+l.points[0]),n.push(v+l.points[0])}break;case"v":var c;if(null!==(c=l.points)&&void 0!==c&&c.length){let v=e[e.length-1];e.push(v+l.points[0]),r.push(v+l.points[0])}break;case"M":case"L":case"C":case"S":case"Q":case"T":var h;null===(h=l.points)||void 0===h||h.forEach((v,b)=>{b%2==0?n.push(v):r.push(v)});break;case"m":case"l":case"c":case"s":case"q":case"t":var f;null===(f=l.points)||void 0===f||f.forEach((v,b)=>{if(b%2==0){let y=t[t.length-1];t.push(y+v),n.push(y+v)}else{let y=e[e.length-1];e.push(y+v),r.push(y+v)}})}}),{minX:Math.min.apply(null,n),minY:Math.min.apply(null,r),maxX:Math.max.apply(null,n),maxY:Math.max.apply(null,r)}},Vt=(i,t)=>t.map(e=>{let n=[];switch(e.type){case"a":var r;7==(null===(r=e.points)||void 0===r?void 0:r.length)&&n.push([A(e.points[0]/i.width,1e6),A(e.points[1]/i.height,1e6),e.points[2],e.points[3],e.points[4],A(e.points[5]/i.width,1e6),A(e.points[6]/i.height,1e6)]);break;case"A":var l;7==(null===(l=e.points)||void 0===l?void 0:l.length)&&n.push([A(e.points[0]/i.width,1e6),A(e.points[1]/i.height,1e6),e.points[2],e.points[3],e.points[4],A((e.points[5]-i.x)/i.width,1e6),A((e.points[6]-i.y)/i.height,1e6)]);break;case"h":var a;null!==(a=e.points)&&void 0!==a&&a.length&&n.push([A(e.points[0]/i.width,1e6)]);break;case"H":var o;null!==(o=e.points)&&void 0!==o&&o.length&&n.push([A((e.points[0]-i.x)/i.width,1e6)]);break;case"v":var s;null!==(s=e.points)&&void 0!==s&&s.length&&n.push([A(e.points[0]/i.height,1e6)]);break;case"V":var d;null!==(d=e.points)&&void 0!==d&&d.length&&n.push([A((e.points[0]-i.y)/i.height,1e6)]);break;case"z":case"Z":break;case"M":case"L":case"C":case"S":case"Q":case"T":var u;if(null!==(u=e.points)&&void 0!==u&&u.length)for(let h=0,f=e.points.length-1;h<f;h+=2)n.push([A((e.points[h]-i.x)/i.width,1e6),A((e.points[h+1]-i.y)/i.height,1e6)]);break;case"m":case"l":case"c":case"s":case"q":case"t":var c;if(null!==(c=e.points)&&void 0!==c&&c.length)for(let h=0,f=e.points.length-1;h<f;h+=2)n.push([A(e.points[h]/i.width,1e6),A(e.points[h+1]/i.height,1e6)])}return n.length?{type:e.type,ratios:n}:{type:e.type}}),qi=(i,t)=>t.map(e=>{switch(e.type){case"a":var n,r;return`${e.type}${null!==(n=null===(r=e.ratios)||void 0===r||null===(r=r.map(x=>{var w,S,J,j,B,z,T;return[A(i.width*(null!==(w=x[0])&&void 0!==w?w:0),1e6),A(i.height*(null!==(S=x[1])&&void 0!==S?S:0),1e6),null!==(J=x[2])&&void 0!==J?J:0,null!==(j=x[3])&&void 0!==j?j:0,null!==(B=x[4])&&void 0!==B?B:0,A(i.width*(null!==(z=x[5])&&void 0!==z?z:0),1e6),A(i.height*(null!==(T=x[6])&&void 0!==T?T:0),1e6)]}))||void 0===r||null===(r=r.map(x=>x.join(" ")))||void 0===r?void 0:r.join(" "))&&void 0!==n?n:""}`;case"A":var l,a;return`${e.type}${null!==(l=null===(a=e.ratios)||void 0===a||null===(a=a.map(x=>{var w,S,J,j,B,z,T;return[A(i.width*(null!==(w=x[0])&&void 0!==w?w:0),1e6),A(i.height*(null!==(S=x[1])&&void 0!==S?S:0),1e6),null!==(J=x[2])&&void 0!==J?J:0,null!==(j=x[3])&&void 0!==j?j:0,null!==(B=x[4])&&void 0!==B?B:0,A(i.x+i.width*(null!==(z=x[5])&&void 0!==z?z:0),1e6),A(i.y+i.height*(null!==(T=x[6])&&void 0!==T?T:0),1e6)]}))||void 0===a||null===(a=a.map(x=>x.join(" ")))||void 0===a?void 0:a.join(" "))&&void 0!==l?l:""}`;case"h":var o,s;return`${e.type}${null!==(o=null===(s=e.ratios)||void 0===s||null===(s=s.map(x=>{var w;return A(i.width*(null!==(w=x[0])&&void 0!==w?w:0),1e6)}))||void 0===s?void 0:s.join(" "))&&void 0!==o?o:""}`;case"H":var d,u;return`${e.type}${null!==(d=null===(u=e.ratios)||void 0===u||null===(u=u.map(x=>{var w;return A(i.x+i.width*(null!==(w=x[0])&&void 0!==w?w:0),1e6)}))||void 0===u?void 0:u.join(" "))&&void 0!==d?d:""}`;case"v":var c,h;return`${e.type}${null!==(c=null===(h=e.ratios)||void 0===h||null===(h=h.map(x=>{var w;return A(i.height*(null!==(w=x[0])&&void 0!==w?w:0),1e6)}))||void 0===h?void 0:h.join(" "))&&void 0!==c?c:""}`;case"V":var f,v;return`${e.type}${null!==(f=null===(v=e.ratios)||void 0===v||null===(v=v.map(x=>{var w;return A(i.y+i.height*(null!==(w=x[0])&&void 0!==w?w:0),1e6)}))||void 0===v?void 0:v.join(" "))&&void 0!==f?f:""}`;case"z":case"Z":return e.type;case"M":case"L":case"C":case"S":case"Q":case"T":var b,y;return`${e.type}${null!==(b=null===(y=e.ratios)||void 0===y||null===(y=y.map(x=>{var w,S;return[A(i.x+i.width*(null!==(w=x[0])&&void 0!==w?w:0),1e6),A(i.y+i.height*(null!==(S=x[1])&&void 0!==S?S:0),1e6)]}))||void 0===y||null===(y=y.map(x=>x.join(" ")))||void 0===y?void 0:y.join(" "))&&void 0!==b?b:""}`;case"m":case"l":case"c":case"s":case"q":case"t":var g,O;return`${e.type}${null!==(g=null===(O=e.ratios)||void 0===O||null===(O=O.map(x=>{var w,S;return[A(i.width*(null!==(w=x[0])&&void 0!==w?w:0),1e6),A(i.height*(null!==(S=x[1])&&void 0!==S?S:0),1e6)]}))||void 0===O||null===(O=O.map(x=>x.join(" ")))||void 0===O?void 0:O.join(" "))&&void 0!==g?g:""}`;default:return""}}).join(""),jn=(i,t)=>{let e=[];for(let n=0,r=t.length-1;n<r;n+=2)e.push([(t[n]-i.x)/i.width,(t[n+1]-i.y)/i.height]);return e},zn=(i,t)=>t.map(e=>[A(i.x+i.width*e[0],1e6),A(i.y+i.height*e[1],1e6)]).map(e=>e.join(" ")).join(" "),li=(i,t)=>{let e=Zi(t);if(e){let n=window.Snap.matrix(e.a,e.b,e.c,e.d,e.e,e.f);if(n){let{dx:r,dy:l,rotate:a,scalex:o,scaley:s}=n.split();return{x:i.x+r,y:i.y+l,dx:r,dy:l,rotate:a,scalex:o,scaley:s}}return{x:Ln(i.x,i.y,e),y:Bn(i.x,i.y,e)}}return i},Zi=i=>{let t=i.replace(/\s?\-?[0-9\.]+e-[0-9]+/g," 0").replace(/\,/g," ").replace(/\s?\-/g," -").replace(/(\.[0-9]+)(\.[0-9]+)/g,"$1 0$2").replace(/\-\./g,"-0.").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim().split(" ").map(e=>A(parseFloat(e),1e6));if(6==t.length)return{a:t[0],b:t[1],c:t[2],d:t[3],e:t[4],f:t[5]}},Ln=function(i,t,e){return A(i*e.a+t*e.c+e.e,10)},Bn=function(i,t,e){return A(i*e.b+t*e.d+e.f,10)},Ht=(i,t,e,n,r)=>{let l={x:Math.min(i,e),y:Math.min(t,n),width:Math.abs(e-i)||1,height:Math.abs(n-t)||1};return null!=r&&r.ratio&&(l.width<=l.height?l.height=l.width*(null==r?void 0:r.ratio):l.width=l.height/(null==r?void 0:r.ratio)),Object.assign(l,{ratios:(null==r?void 0:r.ratios)||[[(i-l.x)/(l.width||1),(t-l.y)/(l.height||1)],[(e-l.x)/(l.width||1),(n-l.y)/(l.height||1)]]}),null!=r&&r.points&&(l.points=null==r?void 0:r.points),l},nt=(i,t,e)=>{var n,r=(()=>{switch(i){case L.CIRCLE:return{cx:t.x+t.width/2,cy:t.y+t.height/2,r:Math.min(t.width/2,t.height/2)};case L.ELLIPSE:return{cx:t.x+t.width/2,cy:t.y+t.height/2,rx:t.width/2,ry:t.height/2};case L.LINE:{var l;let u={};return null===(l=t.ratios)||void 0===l||l.forEach((c,h)=>{u[`x${h+1}`]=t.x+t.width*c[0],u[`y${h+1}`]=t.y+t.height*c[1]}),u}case L.RECT:case L.FOREIGNOBJECT:case L.IMAGE:return{x:t.x,y:t.y,width:t.width,height:t.height};case L.TEXT:case L.TSPAN:var a;return{x:t.x,y:t.y+(e.alignmentBaseline||e.dominantBaseline?0:null!==(a=e.fontSize)&&void 0!==a?a:16)};case L.POLYGON:case L.POLYLINE:var o;if(null!==(o=t.ratios)&&void 0!==o&&o.length)return{points:zn(t,t.ratios)};break;case L.PATH:var s,d;if(null!==(s=t.ratioMaps)&&void 0!==s&&s.length)return{d:qi(t,t.ratioMaps)};if(null!==(d=t.points)&&void 0!==d&&d.length)return{d:`M ${(u=t.points)[0][0]} ${u[0][1]} L ${(u.map(c=>[c[0],c[1]])||[]).map(c=>c.join(" ")).join(" ")}`}}var u;return{}})();return t.rotate?(r.transform=`rotate(${t.rotate})`,r.transformOrigin=`${t.x+t.width/2} ${t.y+t.height/2}`):null!==(n=e.transform)&&void 0!==n&&n.match(/^rotate/)&&(e.transform=null,e.transformOrigin=null),r},Wt=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:p.attribute.fill,stroke:p.attribute.stroke,strokeWidth:p.attribute.strokeWidth};return Object.assign(r,nt(L.RECT,n,r)),{nodeId:i,element:re(i,L.RECT,"rect",{size:n,attribute:r},e),size:n,attribute:r}},ke=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{preserveAspectRatio:"none"};Object.assign(r,nt(L.IMAGE,n,r));let l=(null==t?void 0:t.source)||{type:"image",image:{url:"../../assets/image-svg/logo.svg",path:"assets/image-svg/logo.svg",name:"logo.svg"}};return{nodeId:i,element:re(i,L.IMAGE,"image",{size:n,attribute:r,source:l},e),size:n,attribute:r,source:l}},ge=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:p.attribute.fill,stroke:p.attribute.stroke,strokeWidth:p.attribute.strokeWidth};return Object.assign(r,nt(L.CIRCLE,n,r)),{nodeId:i,element:re(i,L.CIRCLE,"circle",{size:n,attribute:r},e),size:n,attribute:r}},ye=(i,t,e)=>{var n;if(!t.value)return void e();let r=jQuery("#"+i).parents("g");if(!r.length)return void e();let{size:l}=t.node;r.css("transform-origin",`${l.x+l.width/2}px ${l.y+l.height/2}px`);let a="",o=null!==(n=t.iteration)&&void 0!==n?n:0,s=[];(t.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?s.push(t.value):t.value?["top-left","top","top-right","left","right","bottom-left","bottom","bottom-right"].includes(t.value)?(s.push("animation"),s.push(`animation-${t.value}`)):(s.push("animate__animated"),s.push(`animate__${t.value}`)):(s.push("animation"),s.push("animation-fadein")),o<0?(s.push("animation-iteration-infinite"),e(),e=function(){}):o>0&&s.push("animation-iteration-"+(o+1)),a=s.join(" "),function(u){let c=function(){r.data("animate-running")?r.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){r.data("animate-running",!1),setTimeout(function(){u()},100)}):u()};r.hasClass("animation")?setTimeout(function(){c()}):c()}(function(){var u;Pe(i),(o>0||o<0)&&r.one("animationiteration",function(){t.slideStatus===V.slideStatus||(r.data("animate-running",!1),Pe(i),t.slideStatus===V.slideStatus&&e())}),r.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(r.data("animate-running",!1),Pe(i),t.finish){default:case 0:case 1:break;case 2:var c;ye(i,{node:t.node,value:null===(c=t.node.animate)||void 0===c?void 0:c.out,nodeStatus:t.nodeStatus,slideStatus:t.slideStatus},()=>{r.addClass("hide")})}t.slideStatus===V.slideStatus&&e()}),r.attr("data-class",null!==(u=r.attr("class"))&&void 0!==u?u:""),r.addClass(a),r.data("animate-running",!0)})},Pe=function(i){var t,e,n=jQuery("#"+i).parents("g"),r=null===(t=n.attr("class"))||void 0===t?void 0:t.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm),l=null===(e=n.attr("class"))||void 0===e?void 0:e.match(/animate((__[a-zA-Z0-9]+)+)?(\s+||\")/gm);r&&r.forEach(function(o){jQuery(n).removeClass(o)}),l&&l.forEach(function(o){jQuery(n).removeClass(o)});let a=n.attr("data-class");a&&(n.attr("class",a),n.removeAttr("data-class")),jQuery(n).data("animation-running",!1)},oi=(i,t,e)=>{var n;if(!t.value)return void e();let r=jQuery("#"+i).parents("g");if(!r.length)return void e();let{size:l}=t.node;r.css("transform-origin",`${l.x+l.width/2}px ${l.y+l.height/2}px`);let a="",o=null!==(n=t.iteration)&&void 0!==n?n:0,s=[];(t.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?s.push(t.value):(s.push("animation"),s.push(t.value?"animation-"+t.value:"animation-fadein")),o<0?(s.push("animation-iteration-infinite"),e(),e=function(){}):o>0&&s.push("animation-iteration-"+(o+1)),a=s.join(" "),function(u){let c=function(){r.data("animate-running")?r.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){r.data("animate-running",!1),setTimeout(function(){u()},100)}):u()};r.hasClass("animation")?setTimeout(function(){c()}):c()}(function(){var u;We(i),(o>0||o<0)&&r.one("animationiteration",function(){t.slideStatus===V.slideStatus||(r.data("animate-running",!1),We(i),t.slideStatus===V.slideStatus&&e())}),r.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(r.data("animate-running",!1),We(i),t.finish){default:case 0:case 1:break;case 2:var c;ye(i,{node:t.node,value:null===(c=t.node.animate)||void 0===c?void 0:c.out,nodeStatus:t.nodeStatus,slideStatus:t.slideStatus},()=>{r.addClass("hide")})}t.slideStatus===V.slideStatus&&e()}),r.attr("data-class",null!==(u=r.attr("class"))&&void 0!==u?u:""),r.addClass(a),r.data("animate-running",!0)})},We=function(i){var t,e=jQuery("#"+i).parents("g"),n=null===(t=e.attr("class"))||void 0===t?void 0:t.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm);n&&n.forEach(function(l){jQuery(e).removeClass(l)});let r=e.attr("data-class");r&&(e.attr("class",r),e.removeAttr("data-class")),jQuery(e).data("animation-running",!1)},ki=(i,t,e)=>{var n;if(!t.points||!t.points.length)return void e();let r=jQuery("#"+i),a=function Vi(i){let t=[];2===i.length&&i.splice(1,0,[(i[0][0]+i[1][0])/2,(i[0][1]+i[1][1])/2]);let a,o,s,e=1,n=i.length;for(;e<n;){if(a=i[e-1],o=i[e],s=i[e+1],(Math.abs(a[0]-o[0])>=15||Math.abs(a[1]-o[1])>=15)&&Math.pow(a[0]-o[0],2)+Math.pow(a[1]-o[1],2)>=Math.pow(15,2)&&s&&(Math.abs(a[0]-s[0])<=20||Math.abs(a[1]-s[1])<=20)&&Math.pow(a[0]-s[0],2)+Math.pow(a[1]-s[1],2)<=Math.pow(20,2))t.push(o);else{let u=o[0]-a[0],c=o[1]-a[1],h=Math.max(Math.abs(u),Math.abs(c));for(var d=0;d<h;d+=15)t.push([a[0]+u*d/h,a[1]+c*d/h])}e++}return n>0&&(t.splice(0,0,i[0]),t.push(i[n-1])),t}((y=>{if(1==y.length){let{size:g}=t.node;return[[g.x+g.width/2,g.y+g.height/2],...y]}return[...y]})(t.points||[])),o=null!==(n=t.iteration)&&void 0!==n?n:0;if(o<0&&(e(),e=function(){}),r.data("work-running")&&o<0)return;r.data("work-running",!0);let v,s=a.length,d=Math.max(20,1e3*(t.time||3)/s),{id:u,type:c,size:h,attribute:f}=V.findNode(i),b=function(y){if(t.slideStatus!==V.slideStatus)return r.data("work-running",!1),void(t.slideStatus===V.slideStatus&&e());if(y<s){let O=a[y];O&&(v=Object.assign({},h,{x:O[0]-h.width/2,y:O[1]-h.height/2}),Object.assign(f,nt(c,v,f)),m(window.document.getElementById(u),f),setTimeout(function(){b(++y)},d))}else if(o>0)o--,b(1);else if(o<0)b(1);else switch(r.data("work-running",!1),t.slideStatus===V.slideStatus&&e(),t.finish){default:case 0:break;case 1:Object.assign(f,nt(c,h,f)),m(window.document.getElementById(u),f);break;case 2:var g;ye(t.node.id,{node:t.node,value:null===(g=t.node.animate)||void 0===g?void 0:g.out,nodeStatus:t.nodeStatus,slideStatus:t.slideStatus},()=>{r.addClass("hide")})}};b(1)},Oi=(i,t,e,n,r)=>{var l,a,o,s,d,u,c;if(n.slideStatus!=V.slideStatus)return t.async&&"change-slide"!=t.async?void 0:void r();if(n.nodeStatus!=V.nodeStatus&&(!t.async||"change-node"==t.async))return void r();if(!(null!==(l=t.source)&&void 0!==l&&l.path||null!==(a=t.source)&&void 0!==a&&a.url))return console.warn(`${i} -> audio no source!`),r(),void(r=()=>{});var h=jQuery("#"+i);let f=null!==(o=t.iteration)&&void 0!==o?o:0;if(f<0&&(r(),r=function(){}),!(h.data("audio-running")&&f<0)){h.data("audio-running",!0);var v=function(y){y.pause(),y.remove(),h.data("audio-running",!1)},b=new Audio;return b.autoplay=!0,b.loop=0!=f,b.preload="auto",b.controls=!0,b.setAttributeNode(document.createAttribute("playsinline")),b.addEventListener("canplay",function(){var y=b.play();y&&y.then(function(g){var O;h.data("audio-running",!0),"time"==t.async?setTimeout(()=>{n.slideStatus===V.slideStatus&&(v(b),r(),r=()=>{})},1e3*(null!==(O=t.time)&&void 0!==O?O:1)):"non-stop"==t.async&&(r(),r=()=>{})}).catch(function(g){h.data("audio-running",!1),n.slideStatus===V.slideStatus&&(r(),r=()=>{})})}),b.addEventListener("timeupdate",function(){switch(t.async){case"time":case"change-slide":n.slideStatus!==V.slideStatus&&(v(this),r(),r=()=>{});break;case"finish-action":e.total>=2&&e.total-e.counter==1&&(v(this),r(),r=()=>{});break;default:case"change-node":n.nodeStatus!==V.nodeStatus&&(v(this),r(),r=()=>{});case"non-stop":}}),b.addEventListener("canplaythrough",function(){this.loop&&(f>0?f--:0==f&&(this.loop=!1))}),b.addEventListener("play",function(){}),b.addEventListener("pause",function(){}),b.addEventListener("ended",function(){this.remove(),h.data("audio-running",!1),n.slideStatus===V.slideStatus&&(r(),r=()=>{})}),b.onerror=function(){this.remove(),h.data("audio-running",!1),n.slideStatus===V.slideStatus&&(r(),r=()=>{})},b.src=(null!==(s=t.source)&&void 0!==s&&s.path?(null===(d=p.config)||void 0===d?void 0:d.readfileuploadurl)+(null===(u=t.source)||void 0===u?void 0:u.path):null===(c=t.source)||void 0===c?void 0:c.url)||"",b}},Oe=i=>{i.id?jQuery("#"+i.id).removeClass("hide"):i.ids&&i.ids.forEach(t=>{jQuery("#"+t).removeClass("hide")})},Ie=i=>{i.id?(jQuery("#"+i.id).removeClass("hide"),Ye(V.findNode(i.id),i.nodeStatus,i.slideStatus)):i.ids&&i.ids.forEach(t=>{jQuery("#"+t).removeClass("hide"),Ye(V.findNode(t),i.nodeStatus,i.slideStatus)})},Ae=i=>{if(i.id){var t;let e=V.findNode(i.id);ye(i.id,{node:e,value:null===(t=e.animate)||void 0===t?void 0:t.out,nodeStatus:i.nodeStatus,slideStatus:i.slideStatus},()=>{jQuery("#"+i.id).addClass("hide")})}else i.ids&&i.ids.forEach(e=>{var n;let r=V.findNode(e);ye(e,{node:r,value:null===(n=r.animate)||void 0===n?void 0:n.out,nodeStatus:i.nodeStatus,slideStatus:i.slideStatus},()=>{jQuery("#"+e).addClass("hide")})})},Ye=(i,t,e,n)=>{var r,l,a;let o={total:0,counter:0},{triggershow:s,triggerrun:d,triggerhide:u,action:c,audio:h,slide:f,media:v}=null!==(r=null===(l=i.interactive)||void 0===l?void 0:l.click)&&void 0!==r?r:{};if(console.log(`node(${i.id}) | nodeStatus(${t}) | slideStatus(${e}) | click`),s){let{id:x,ids:w,time:S,async:J}=s;"asynctrue"==J?Oe({id:x,ids:w,nodeStatus:t,slideStatus:e}):"time"==J&&setTimeout(()=>{Oe({id:x,ids:w,nodeStatus:t,slideStatus:e})},1e3*(null!=S?S:0))}if(d){let{id:x,ids:w,time:S,async:J}=d;"asynctrue"==J?Ie({id:x,ids:w,nodeStatus:t,slideStatus:e}):"time"==J&&setTimeout(()=>{Ie({id:x,ids:w,nodeStatus:t,slideStatus:e})},1e3*(null!=S?S:0))}if(u){let{id:x,ids:w,time:S,async:J}=u;"asynctrue"==J?Ae({id:x,ids:w,nodeStatus:t,slideStatus:e}):"time"==J&&setTimeout(()=>{Ae({id:x,ids:w,nodeStatus:t,slideStatus:e})},1e3*(null!=S?S:0))}let b=()=>{setTimeout(()=>{if(o.counter>=o.total){if(n&&n(),s){let{id:x,ids:w,async:S}=s;(!S||"asyncfalse"==S)&&Oe({id:x,ids:w,nodeStatus:t,slideStatus:e})}if(d){let{id:x,ids:w,async:S}=d;(!S||"asyncfalse"==S)&&Ie({id:x,ids:w,nodeStatus:t,slideStatus:e})}if(u){let{id:x,ids:w,async:S}=u;(!S||"asyncfalse"==S)&&Ae({id:x,ids:w,nodeStatus:t,slideStatus:e})}}})};if(null!=c&&c.value){o.total+=1;let x=()=>{o.counter+=1,b()};switch(null==c?void 0:c.value){case"hide":var y;ye(i.id,{node:i,value:null===(y=i.animate)||void 0===y?void 0:y.out,nodeStatus:t,slideStatus:e},()=>{jQuery("#"+i.id).addClass("hide"),x()});break;case"points":{let{points:w,time:S,iteration:J,finish:j}=c;w&&ki(i.id,{node:i,points:w,time:S,iteration:J,finish:j,nodeStatus:t,slideStatus:e},x);break}default:{let{value:w,time:S,iteration:J,finish:j}=c;oi(i.id,{node:i,value:w,time:S,iteration:J,finish:j,nodeStatus:t,slideStatus:e},x);break}}}if(null!=h&&null!==(a=h.source)&&void 0!==a&&a.path){o.total+=1;let x=()=>{o.counter+=1,b()};Oi(i.id,h,o,{nodeStatus:t,slideStatus:e},x)}if(o.total||b(),null!=f&&f.id)switch(f.id){case-1:V.runSlide(V.slideIdx-1);break;case-2:V.runSlide(V.slideIdx+1);break;default:var g;V.runSlide(void 0,f.id,null===(g=f.code)||void 0===g?void 0:g.toString())}if(null!=v&&v.type){var O;let w=`<div class="popup-media-viewer"><iframe src="${oe({readfileuploadurl:null===(O=p.config)||void 0===O?void 0:O.readfileuploadurl,type:null==v?void 0:v.type,oss:null==v?void 0:v.oss,path:null==v?void 0:v.path,url:null==v?void 0:v.url})}" frameborder="0" allowfullscreen\n        webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen"></iframe><div class="btn-close"><img src="assets/icon-svg/close-outline.svg"/></div></div>`,S=jQuery(w).appendTo(window.document.body);S.find(".btn-close").click(function(J){J.preventDefault(),S.remove()})}},Ce=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:320,height:80},r=(null==t?void 0:t.attribute)||{fill:p.attribute.stroke,fontFamily:p.attribute.fontFamily,fontSize:p.attribute.fontSize,textLength:p.attribute.textLength};Object.assign(r,nt(L.TEXT,n,r));let l=(null==t?void 0:t.source)||{type:"text",text:{textContent:""}};return{nodeId:i,element:re(i,L.TEXT,"text",{size:n,attribute:r,source:l},e),size:n,attribute:r,source:l}},Me=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{};return Object.assign(r,nt(L.GROUP,n,r)),{nodeId:i,element:re(i,L.GROUP,"g",{size:n,attribute:r},e),size:n,attribute:r}},Ei=(i,t,e)=>{var n,r,l,a;let o=1,s=new Image;s.onload=()=>{var d,u,c,h;o=A(s.naturalWidth/s.naturalHeight,100);let f=0,v=0,b=0,y=0;var g,O,x,w;o>=1?(b=Math.min(s.naturalWidth,null!==(g=null===(O=V.slide.svg)||void 0===O||null===(O=O.viewBox)||void 0===O?void 0:O.width)&&void 0!==g?g:0),y=b/o):(y=Math.min(s.naturalHeight,null!==(x=null===(w=V.slide.svg)||void 0===w||null===(w=w.viewBox)||void 0===w?void 0:w.height)&&void 0!==x?x:0),b=y/o),f=((null!==(d=null===(u=V.slide.svg)||void 0===u||null===(u=u.viewBox)||void 0===u?void 0:u.width)&&void 0!==d?d:0)-b)/2,v=((null!==(c=null===(h=V.slide.svg)||void 0===h||null===(h=h.viewBox)||void 0===h?void 0:h.height)&&void 0!==c?c:0)-y)/2,t.size={x:f,y:v,width:b,height:y},Dn(t,e)},s.onerror=d=>{console.error(`ImgSrc load failed -> ${JSON.stringify(t.source)}`,d)},s.src=(null!==(n=t.source)&&void 0!==n&&n.path?(null===(r=p.config)||void 0===r?void 0:r.readfileuploadurl)+(null===(l=t.source)||void 0===l?void 0:l.path):null===(a=t.source)||void 0===a?void 0:a.url)||""},Dn=(i,t)=>{if(i.slideStatus!=V.slideStatus)return void t();let{element:e}=ke(Math.ceil(1e9*Math.random()),{size:i.size,source:{type:"image",image:null==i?void 0:i.source}});setTimeout(()=>{null==e||e.remove(),t()},3e3)},Dt=(i,t,e)=>{var n,r,l,a;let o=new Image;o.onload=()=>{Gn(i,{width:o.naturalWidth,height:o.naturalHeight},t,e)},o.onerror=s=>{console.error(`ImgSrc load failed -> ${JSON.stringify(t.source)}`,s),e()},o.src=(null!==(n=t.source)&&void 0!==n&&n.path?(null===(r=p.config)||void 0===r?void 0:r.readfileuploadurl)+(null===(l=t.source)||void 0===l?void 0:l.path):null===(a=t.source)||void 0===a?void 0:a.url)||""},Gn=(i,t,e,n)=>{if(e.slideStatus!=V.slideStatus)return void n();let r=A(t.width/t.height,100),l=0,a=0,o=0,s=0;r>=1?(o=t.width,o=Math.max(o,40),o=Math.min(o,40),s=o/r):(s=t.height,s=Math.max(s,40),s=Math.min(s,40),o=s/r);let{size:c}=i;l=c.x+c.width-o/2,a=c.y-s/2;let h=N(lt.TEST_GROUP,"g",void 0,p.target);ke(`icon-${i.id}`,{size:{x:l,y:a,width:o,height:s},source:{type:"image",image:null==e?void 0:e.source}},h),setTimeout(()=>{n()},3e3)},tn=(i,t,e)=>{var n,r,l,a,o,s,d;if(t.slideStatus!=V.slideStatus)return void e();if(!(null!==(n=t.source)&&void 0!==n&&n.path||null!==(r=t.source)&&void 0!==r&&r.url))return console.warn(`${i.id} -> audio no source!`),void e();var u=jQuery("#"+i.id);let c=null!==(l=t.iteration)&&void 0!==l?l:0;if(c<0&&(e(),e=function(){}),!(u.data("audio-running")&&c<0)){u.data("audio-running",!0);var h=new Audio;return h.autoplay=!0,h.loop=0!=c,h.preload="auto",h.controls=!0,h.setAttributeNode(document.createAttribute("playsinline")),h.addEventListener("canplay",function(){var f=h.play();f&&f.then(function(v){u.data("audio-running",!0)}).catch(function(v){u.data("audio-running",!1),t.slideStatus===V.slideStatus&&e()})}),h.addEventListener("timeupdate",function(){var v;t.slideStatus!==V.slideStatus&&((v=this).pause(),v.remove(),u.data("audio-running",!1))}),h.addEventListener("canplaythrough",function(){this.loop&&(c>0?c--:0==c&&(this.loop=!1))}),h.addEventListener("play",function(){}),h.addEventListener("pause",function(){}),h.addEventListener("ended",function(){this.remove(),u.data("audio-running",!1),t.slideStatus===V.slideStatus&&e()}),h.onerror=function(){this.remove(),u.data("audio-running",!1),t.slideStatus===V.slideStatus&&e()},h.src=(null!==(a=t.source)&&void 0!==a&&a.path?(null===(o=p.config)||void 0===o?void 0:o.readfileuploadurl)+(null===(s=t.source)||void 0===s?void 0:s.path):null===(d=t.source)||void 0===d?void 0:d.url)||"",h}};var en=/^#[a-fA-F0-9]+$/i,Qn=/^rgb\((\d+),(\d+),(\d+)\)$/i,Un=/^rgba\((\d+),(\d+),(\d+),([0-9\.]+)\)$/i;const Ti=i=>{let t=null,e=null;if(i)if("transparent"==i)t="#000000",e=0;else if(i.match(en))t=i;else{let n=(i=i.replace(/\s+/g,"")).match(Un);if(n)t="#"+(256|n[1]).toString(16).slice(1)+(256|n[2]).toString(16).slice(1)+(256|n[3]).toString(16).slice(1),e=A(parseFloat(n[4]),100);else{let r=i.match(Qn);r&&(t="#"+(256|r[1]).toString(16).slice(1)+(256|r[2]).toString(16).slice(1)+(256|r[3]).toString(16).slice(1))}}return{hex:t,alpha:e}},Et=i=>jt(null==i?void 0:i.url,null==i?void 0:i.path,null==i?void 0:i.src,null==i?void 0:i.name);var jt=(i,t,e,n)=>{var r,l;let a,o,s,d;var u,c;return i&&(a=i.replace(/\\/g,"/")),t&&(o=t.replace(/\\/g,"/")),e&&(s=e.replace(/\\/g,"/")),o&&!a&&(a=(null===(u=p.config)||void 0===u?void 0:u.readfileuploadurl)+o),!s||o||a||(o=s.replace(/^[a-zA-Z0-9\-\_\/\\\:\.]+(upload|FileUpload|files|readfileupload|filereader|readfile)\//g,""),a=(null===(c=p.config)||void 0===c?void 0:c.readfileuploadurl)+o),d=n||(null!==(r=a)&&void 0!==r?r:"").split("/").pop()||(null!==(l=o)&&void 0!==l?l:"").split("/").pop()||"",{url:a,path:o,name:d}};const Xn=i=>{let t={x:0,y:0,width:i.screen.w,height:i.screen.h},e=[];return i.data.forEach((n,r)=>{var l,a;let o={id:"number"==typeof n.id?n.id:p.data.newSlideId,code:null===(l=n.id)||void 0===l?void 0:l.toString(),name:"string"==typeof n.id?n.id:`Trang ${r+1}`,svg:{viewBox:t,nodes:[]},test:(s=n.test2,s?(s.audiotrue&&(s.audiotrue=Et({path:s.audiotrue.path})),s.audiofalse&&(s.audiofalse=Et({path:s.audiofalse.path})),s.effecttrue&&(s.effecttrue=Et({path:s.effecttrue.path})),s.effectfalse&&(s.effectfalse=Et({path:s.effectfalse.path})),s.icontrue&&(s.icontrue=Et({path:s.icontrue.path})),s.iconfalse&&(s.iconfalse=Et({path:s.iconfalse.path})),s):{})};var s;n.background&&o.svg&&(o.svg.background=function(i){return i&&(null!==i.match(/#([a-zA-Z0-9]+)/)||null!==i.match(/rgb\([0-9]+,[0-9]+,[0-9]+\)/)||null!==i.match(/rgba\([0-9]+,[0-9]+,[0-9]+,[0-9\.]+\)/))}(n.background)?{color:n.background}:function(i){return i&&null!==i.match(/data:[^;]+;base64,/)}(n.background)?{base64:n.background}:function(i){return i&&null!==i.match(/http(s)?:\/\//)}(n.background)?jt(n.background):jt(void 0,n.background)),jQuery(null!==(a=n.svg)&&void 0!==a?a:"").find(".indexs").find("polygon,path,circle,ellipse,line,rect,foreignObject").each((s,d)=>{var u,c;let h=jQuery(d).parents(".indexs"),f=(g=h.attr("data-index"))?parseInt(g):0,v=(g=>f&&g?parseInt(g):0)(h.attr("data-time")),b=null!==(u=d.getAttribute("id"))&&void 0!==u?u:(1e9*Math.random()).toFixed(),y={id:parseInt(b),code:`${d.nodeName}-${b}`,name:d.nodeName,idx:f,time:v,type:(()=>{switch(d.nodeName){case"polygon":return L.POLYGON;case"path":return L.PATH;case"circle":return L.CIRCLE;case"ellipse":return L.ELLIPSE;case"line":return L.LINE;case"rect":return L.RECT;case"foreignObject":return L.FOREIGNOBJECT}return 0})(),size:(g=>{let O={},x=0,w=0,S=0,J=0,j=null,B=null,z=parseFloat((null===(g=d.getAttribute("transform"))||void 0===g?void 0:g.replace("rotate(","").replace(")",""))||"0")||null;switch(d.nodeName){case"polygon":{var T,C;let Q=[],D=[],E=999999999,P=999999999,F=0,M=0;j=JSON.parse(d.getAttribute("ratios")||"[]"),B=null!==(T=null===(C=d.getAttribute("points"))||void 0===C?void 0:C.split(",").map(function(K){return K.split(" ").map(function(W){return parseFloat(W)})}))&&void 0!==T?T:[],B.forEach(function(K){Q.push(K[0]),D.push(K[1])}),E=Math.min.apply(null,Q),P=Math.min.apply(null,D),F=Math.max.apply(null,Q),M=Math.max.apply(null,D),x=E,w=P,S=F-x,J=M-w;break}case"path":{let Q=d.getAttribute("d");if(Q){let D=Be(Q),{minX:E,minY:P,maxX:F,maxY:M}=He(D);x=E,w=P,S=F-x||1,J=M-w||1,Object.assign(O,{ratioMaps:Vt({x,y:w,width:S,height:J},D)})}break}case"circle":{let Q=parseFloat(d.getAttribute("cx")||"0"),D=parseFloat(d.getAttribute("cy")||"0"),E=parseFloat(d.getAttribute("r")||"0");x=Q-E,w=D-E,S=2*E,J=2*E;break}case"ellipse":{let Q=parseFloat(d.getAttribute("cx")||"0"),D=parseFloat(d.getAttribute("cy")||"0"),E=parseFloat(d.getAttribute("rx")||"0"),P=parseFloat(d.getAttribute("ry")||"0");x=Q-E,w=D-P,S=2*E,J=2*P;break}case"line":{let Q=parseFloat(d.getAttribute("x1")||"0"),D=parseFloat(d.getAttribute("y1")||"0"),E=parseFloat(d.getAttribute("x2")||"0"),P=parseFloat(d.getAttribute("y2")||"0"),F=999999999,M=999999999,K=0,W=0;F=Math.min(Q,E),M=Math.min(D,P),K=Math.max(Q,E),W=Math.max(D,P),x=F,w=M,S=K-x,J=W-w,j=[[(Q-x)/(S||1),(D-w)/(J||1)],[(E-x)/(S||1),(P-w)/(J||1)]];break}case"rect":case"foreignObject":x=parseFloat(d.getAttribute("x")||"0"),w=parseFloat(d.getAttribute("y")||"0"),S=parseFloat(d.getAttribute("width")||"0"),J=parseFloat(d.getAttribute("height")||"0")}return Object.assign(O,{x,y:w,width:S,height:J,ratios:j,points:B,rotate:z})})(),attribute:(()=>{let g={};switch(d.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":{var O,x,w,S,J,j,B,z;let K=null!==(O=d.getAttribute("fill"))&&void 0!==O?O:null,W=null!==(x=d.getAttribute("stroke"))&&void 0!==x?x:null,tt=null!==(w=parseFloat(null!==(S=d.getAttribute("stroke-opacity"))&&void 0!==S?S:"1"))&&void 0!==w?w:null,Z=null!==(J=parseFloat(d.getAttribute("stroke-width")||"0"))&&void 0!==J?J:null,X=null!==(j=d.getAttribute("stroke-linecap"))&&void 0!==j?j:null,dt=null!==(B=d.getAttribute("stroke-linejoin"))&&void 0!==B?B:null,ft=null!==(z=parseFloat(d.getAttribute("stroke-dasharray")||"0"))&&void 0!==z?z:null;Object.assign(g,{fill:K,stroke:W,strokeOpacity:tt,strokeWidth:Z,strokeLinecap:X,strokeLinejoin:dt,strokeDasharray:ft});break}case"path":{let K=h.get(0);if(K){var T,C,Q,D,E,P,F,M;let W=null!==(T=K.getAttribute("fill"))&&void 0!==T?T:null,tt=null!==(C=K.getAttribute("stroke"))&&void 0!==C?C:null,Z=null!==(Q=parseFloat(null!==(D=K.getAttribute("stroke-opacity"))&&void 0!==D?D:"1"))&&void 0!==Q?Q:null,X=null!==(E=parseFloat(K.getAttribute("stroke-width")||"0"))&&void 0!==E?E:null,dt=null!==(P=K.getAttribute("stroke-linecap"))&&void 0!==P?P:null,ft=null!==(F=K.getAttribute("stroke-linejoin"))&&void 0!==F?F:null,bt=null!==(M=parseFloat(K.getAttribute("stroke-dasharray")||"0"))&&void 0!==M?M:null;Object.assign(g,{fill:W,stroke:tt,strokeOpacity:Z,strokeWidth:X,strokeLinecap:dt,strokeLinejoin:ft,strokeDasharray:bt})}break}}return g})(),style:(()=>{let g={};switch(d.nodeName){case"polygon":case"path":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":{let w=jQuery(d).find(".svg-container");if(w.length){let J=parseFloat(w.css("border-width")||"0")||null,j=w.css("border-style")||null,B=w.css("border-color")||null,z=null,T=w.css("background-color")||null,C=null;(()=>{let{hex:Q,alpha:D}=Ti(B);B=Q,z=D})(),(()=>{let{hex:Q,alpha:D}=Ti(T);T=Q,C=D})(),Object.assign(g,{borderWidth:J,borderStyle:j,borderColor:B,borderOpacity:z,backgroundColor:T,backgroundOpacity:C})}let S=jQuery(d).find(".svg-editor-content");if(S.length){var O,x;let J=JSON.parse((S.attr("data-style")||"{}").replace(/\&quot\;/gm,'"')),{hex:j,alpha:B}=Ti(J.TextColor);Object.assign(g,{fontFamily:null!==(O=J.FontFamily)&&void 0!==O?O:null,fontSize:null!==(x=J.FontSize)&&void 0!==x?x:null,color:j,opacity:B})}break}}return g})(),source:(()=>{let g={};switch(d.nodeName){case"polygon":case"path":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":if(h.hasClass("editors")){var O;let M="div,h1,h2,h3,h4,h5,h6,p,span,strong,b,i",K=Z=>{null==Z||Z.forEach(X=>{let dt=X.querySelectorAll(`:scope > ${M}`);dt.length&&K(dt),!X.querySelectorAll(":scope > *").length&&""==X.textContent&&X.remove()})},W=Z=>{let X=null==Z?void 0:Z.querySelectorAll(":scope > div,h1,h2,h3,h4,h5,h6,p,strong,span");if(null!=X&&X.length){var dt;let ft=X[X.length-1];if(""==(null===(dt=ft.textContent)||void 0===dt?void 0:dt.trim())){let bt=ft.querySelectorAll(":scope > *");if(bt.length){let Ot=bt[bt.length-1];["br","BR"].includes(null==Ot?void 0:Ot.nodeName)&&(Ot.remove(),W(Z))}else ft.remove(),W(Z)}}};K(null===(O=jQuery(d).find(".svg-editor-content").get(0))||void 0===O?void 0:O.querySelectorAll(`:scope > ${M}`)),W(jQuery(d).find(".svg-editor-content").get(0));let tt=jQuery(d).find(".svg-editor-content");if(tt.length){var x;let Z=tt.html(),X=null!==(x=(null!=Z?Z:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==x?x:[];Object.assign(g,{type:"html",html:{htmlContent:Z,variableKeywords:X}})}}else if(h.hasClass("inputs")||h.hasClass("textareas"))Object.assign(g,{type:"input",input:{input:!!jQuery(d).find("input").length,textarea:!!jQuery(d).find("textarea").length}});else if(h.hasClass("tests")){let M=jQuery(d).find(".svg-test");if(h.hasClass("tests-truefalse")){var w,S;let K=M.find(".svg-editor-content").html(),W=null!==(w=(null!=K?K:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==w?w:[];Object.assign(g,{type:"test",test:{type:"truefalse",truefalse:{iscorrect:null===(S=n.test2.truefalse)||void 0===S?void 0:S.includes(b)}},html:{htmlContent:K,variableKeywords:W}})}else if(h.hasClass("tests-singlechoice")){var J,j;let K=M.find(".svg-editor-content").html(),W=null!==(J=(null!=K?K:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==J?J:[];Object.assign(g,{type:"test",test:{type:"singlechoice",singlechoice:{iscorrect:null===(j=n.test2.singlechoice)||void 0===j?void 0:j.includes(b)}},html:{htmlContent:K,variableKeywords:W}})}else if(h.hasClass("tests-multichoice")){var B,z;let K=M.find(".svg-editor-content").html(),W=null!==(B=(null!=K?K:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==B?B:[];Object.assign(g,{type:"test",test:{type:"multichoice",multichoice:{iscorrect:null===(z=n.test2.multichoice)||void 0===z?void 0:z.includes(b)}},html:{htmlContent:K,variableKeywords:W}})}else if(h.hasClass("tests-fill")){var T,C;let K=M.find(".svg-editor-content").html(),W=null!==(T=(null!=K?K:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==T?T:[],tt=null!==(C=(null!=K?K:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==C?C:[];tt=tt.filter((Z,X,dt)=>dt.indexOf(Z)==X),Object.assign(g,{type:"test",test:{type:"fill",fill:tt.map(Z=>{var X;return{key:Z,value:null===(X=n.test2.fill)||void 0===X||null===(X=X.find(dt=>dt.id==b))||void 0===X||null===(X=X.vals)||void 0===X?void 0:X.map(dt=>dt.text).filter(dt=>!["",null,void 0,NaN].includes(dt))}})},html:{htmlContent:K,variableKeywords:W,fillKeywords:tt}})}else if(h.hasClass("tests-matching")){if(M.hasClass("svg-test-empty"))Object.assign(g,{type:"test",test:{type:"matching-empty",matching:{key:M.attr("data-name")||null}}});else if(M.hasClass("svg-test-content")){var Q;let K=M.find(".svg-editor-content").html(),W=null!==(Q=(null!=K?K:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==Q?Q:[];Object.assign(g,{type:"test",test:{type:"matching-content",matching:{key:M.attr("data-name")||null}},html:{htmlContent:K,variableKeywords:W}})}}else if(h.hasClass("tests-speech")){var D;Object.assign(g,{type:"speech",speech:{value:null===(D=n.test2.speech)||void 0===D||null===(D=D.find(K=>K.id==b))||void 0===D||null===(D=D.vals)||void 0===D?void 0:D.map(K=>K.text).filter(K=>!["",null,void 0,NaN].includes(K))}})}else if(h.hasClass("tests-submit")){let K=jQuery(d).find(".svg-container img");Object.assign(g,{type:"test",test:{type:"submit"},image:jt(K.attr("url"),K.attr("path"),K.attr("src"))})}}else if(h.hasClass("images")){let M=jQuery(d).find(".svg-editor-content img");if(M.length)Object.assign(g,{type:"image",image:jt(M.attr("url"),M.attr("path"),M.attr("src"))});else{let K=jQuery(d).find("iframe");Object.assign(g,{type:"iframe",iframe:jt(K.attr("url"),K.attr("path"),K.attr("src"))})}}else if(h.hasClass("sounds")){let M=jQuery(d).find(".svg-editor-content img");M.length&&Object.assign(g,{type:"image",image:jt(M.attr("url"),M.attr("path"),M.attr("src"))})}else if(h.hasClass("htmls")){let M=jQuery(d).find("iframe");M.length&&Object.assign(g,{type:"iframe",iframe:jt(M.attr("url"),M.attr("path"),M.attr("src"))})}else if(h.hasClass("svgs")){let M=jQuery(d).find("svg");var E,P;M.length&&Object.assign(g,{type:"svg",svg:Object.assign(jt(M.attr("url"),M.attr("path"),M.attr("src")),{svgContent:null!==(E=null===(P=M.get(0))||void 0===P?void 0:P.outerHTML)&&void 0!==E?E:null})})}else if(h.hasClass("medias")){let M=jQuery(d).find(".media-item");if(M.length)switch(M.attr("type")){case"audio":Object.assign(g,{type:"audio",audio:jt(M.attr("url"),M.attr("path"),M.attr("src"))});break;case"video":Object.assign(g,{type:"video",video:jt(M.attr("url"),M.attr("path"),M.attr("src"))});break;case"file":Object.assign(g,{type:"file",file:jt(M.attr("url"),M.attr("path"),M.attr("src"))});break;default:var F;Object.assign(g,{type:"link",link:{url:null!==(F=M.attr("url"))&&void 0!==F?F:null}})}let K=jQuery(d).find("img");K.length&&(Object.assign(g,{image:jt(K.attr("url"),K.attr("path"),K.attr("src"))}),g.type||Object.assign(g,{type:"image"}))}}return g})(),animate:(g=>{let O={},x=null===(g=n.animates)||void 0===g?void 0:g.find(w=>w.elementId==b);return x&&Object.assign(O,{value:x.value}),O})(),interactive:(()=>{let g={},O=n.actions.show.filter(w=>w.elementId==b&&w.active);O.length&&(g.show={},O.forEach(w=>{let{source:S}=w;switch(null==S?void 0:S.type){case"work":var J,j,B,z,T;g.show.action={},Object.assign(g.show.action,{value:null!==(J=S.value)&&void 0!==J?J:null,iteration:null!==(j=S.iteration)&&void 0!==j?j:null,finish:null!==(B=S.end)&&void 0!==B?B:null,time:null!==(z=S.time)&&void 0!==z?z:null,points:null!==(T=S.points)&&void 0!==T?T:null});break;case"audio":var C,Q,D;g.show.audio={},Object.assign(g.show.audio,{source:jt(null,null,S.url),iteration:null!==(C=S.iteration)&&void 0!==C?C:null,finish:null!==(Q=S.end)&&void 0!==Q?Q:null,time:null!==(D=S.time)&&void 0!==D?D:null,async:-1==S.iteration?"change-slide":"change-node"});break;case"node":case"node2":var E,P,F,M,K,W,tt,Z,X,dt,ft,bt,Ot,gt,It;S.options.includes("show")&&(g.show.triggershow={},Object.assign(g.show.triggershow,{id:null!==(E=parseInt(null!==(P=S.id)&&void 0!==P?P:"0"))&&void 0!==E?E:null,ids:null===(F=S.ids)||void 0===F?void 0:F.map(Pt=>parseInt(Pt)),async:null!==(M=S.async)&&void 0!==M?M:null,time:null!==(K=S.time)&&void 0!==K?K:null})),S.options.includes("run")&&(g.show.triggerrun={},Object.assign(g.show.triggerrun,{id:null!==(W=parseInt(null!==(tt=S.id)&&void 0!==tt?tt:"0"))&&void 0!==W?W:null,ids:null===(Z=S.ids)||void 0===Z?void 0:Z.map(Pt=>parseInt(Pt)),async:null!==(X=S.async)&&void 0!==X?X:null,time:null!==(dt=S.time)&&void 0!==dt?dt:null})),S.options.includes("hide")&&(g.show.triggerhide={},Object.assign(g.show.triggerhide,{id:null!==(ft=parseInt(null!==(bt=S.id)&&void 0!==bt?bt:"0"))&&void 0!==ft?ft:null,ids:null===(Ot=S.ids)||void 0===Ot?void 0:Ot.map(Pt=>parseInt(Pt)),async:null!==(gt=S.async)&&void 0!==gt?gt:null,time:null!==(It=S.time)&&void 0!==It?It:null}))}}));let x=n.actions.click.filter(w=>w.elementId==b&&w.active);return x&&(g.click={},x.forEach(w=>{let{source:S}=w;switch(null==S?void 0:S.type){case"work":var J,j,B,z,T;g.click.action={},Object.assign(g.click.action,{value:null!==(J=S.value)&&void 0!==J?J:null,iteration:null!==(j=S.iteration)&&void 0!==j?j:null,finish:null!==(B=S.end)&&void 0!==B?B:null,time:null!==(z=S.time)&&void 0!==z?z:null,points:null!==(T=S.points)&&void 0!==T?T:null});break;case"audio":var C,Q,D;g.click.audio={},Object.assign(g.click.audio,{source:jt(null,null,S.url),iteration:null!==(C=S.iteration)&&void 0!==C?C:null,finish:null!==(Q=S.end)&&void 0!==Q?Q:null,time:null!==(D=S.time)&&void 0!==D?D:null,async:-1==S.iteration?"change-slide":"change-node"});break;case"video":{g.click.video={},Object.assign(g.click.video,{source:jt(S.url,S.path)});let{url:Bt,path:he,name:fe}=jt(S.url,S.path);g.click.media={},Object.assign(g.click.media,{url:Bt,path:he,name:fe,type:903});break}case"image":{g.click.image={},Object.assign(g.click.image,{source:jt(S.url,S.path)});let{url:Bt,path:he,name:fe}=jt(S.url,S.path);g.click.media={},Object.assign(g.click.media,{url:Bt,path:he,name:fe,type:901});break}case"link":{g.click.link={},Object.assign(g.click.link,{url:S.url,target:S.target});let{url:Bt,path:he,name:fe}=jt(S.url,S.path);g.click.media={},Object.assign(g.click.media,{url:Bt,path:he,name:fe,type:904});break}case"text":g.click.text={},Object.assign(g.click.text,{content:S.content});break;case"node":case"node2":var E,P,F,M,K,W,tt,Z,X,dt,ft,bt,Ot,gt,It;S.options.includes("show")&&(g.click.triggershow={},Object.assign(g.click.triggershow,{id:null!==(E=parseInt(null!==(P=S.id)&&void 0!==P?P:"0"))&&void 0!==E?E:null,ids:null===(F=S.ids)||void 0===F?void 0:F.map(Bt=>parseInt(Bt)),async:null!==(M=S.async)&&void 0!==M?M:null,time:null!==(K=S.time)&&void 0!==K?K:null})),S.options.includes("run")&&(g.click.triggerrun={},Object.assign(g.click.triggerrun,{id:null!==(W=parseInt(null!==(tt=S.id)&&void 0!==tt?tt:"0"))&&void 0!==W?W:null,ids:null===(Z=S.ids)||void 0===Z?void 0:Z.map(Bt=>parseInt(Bt)),async:null!==(X=S.async)&&void 0!==X?X:null,time:null!==(dt=S.time)&&void 0!==dt?dt:null})),S.options.includes("hide")&&(g.click.triggerhide={},Object.assign(g.click.triggerhide,{id:null!==(ft=parseInt(null!==(bt=S.id)&&void 0!==bt?bt:"0"))&&void 0!==ft?ft:null,ids:null===(Ot=S.ids)||void 0===Ot?void 0:Ot.map(Bt=>parseInt(Bt)),async:null!==(gt=S.async)&&void 0!==gt?gt:null,time:null!==(It=S.time)&&void 0!==It?It:null}));break;case"slide":var Pt;g.click.slide={},Object.assign(g.click.slide,{id:parseInt(null!==(Pt=S.id)&&void 0!==Pt?Pt:"0")||S.num||null,code:S.id})}})),g})(),variable:(g=>{let O={};var x;d.getAttribute("data-variable")&&(O.input={},Object.assign(O.input,{variable:null!==(x=d.getAttribute("data-variable"))&&void 0!==x?x:null}));let w=null===(g=n.nodes)||void 0===g||null===(g=g.find(z=>z.id==b))||void 0===g?void 0:g.variable;var S,J,j,B;return w&&(O.click={},Object.assign(O.click,{variable:null!==(S=w.variable)&&void 0!==S?S:null,operator:null!==(J=w.operator)&&void 0!==J?J:null,valuetype:null!==(j=w.valuetype)&&void 0!==j?j:null,value:null!==(B=w.value)&&void 0!==B?B:null})),O})()};var g;null===(c=o.svg)||void 0===c||c.nodes.push(y)}),e.push(o)}),{screen:{width:i.screen.w,height:i.screen.h},data:{slides:e},variable:i.variable,fonts:[]}},rn=(i,t)=>{var e;null===(e=t.test)||void 0===e||null===(e=e.answer)||void 0===e||null===(e=e.matching)||void 0===e||e.filter(n=>n.id==i.id).forEach(n=>n.value=""),jQuery(`#node-${i.id}`).remove()},Ke=(i,t,e,n,r,l)=>{var a,o,s,d,u,c,h,f;r.iscorrect?(null!==(a=t.test)&&void 0!==a&&null!==(a=a.audiotrue)&&void 0!==a&&a.path&&tn(i,{source:Et(null===(s=t.test)||void 0===s?void 0:s.audiotrue),iteration:0,nodeStatus:e,slideStatus:n},l),null!==(o=t.test)&&void 0!==o&&null!==(o=o.effecttrue)&&void 0!==o&&o.path&&Ei(0,{source:Et(null===(d=t.test)||void 0===d?void 0:d.effecttrue),iteration:0,nodeStatus:e,slideStatus:n},l)):(null!==(u=t.test)&&void 0!==u&&null!==(u=u.audiofalse)&&void 0!==u&&u.path&&tn(i,{source:Et(null===(h=t.test)||void 0===h?void 0:h.audiofalse),iteration:0,nodeStatus:e,slideStatus:n},l),null!==(c=t.test)&&void 0!==c&&null!==(c=c.effectfalse)&&void 0!==c&&c.path&&Ei(0,{source:Et(null===(f=t.test)||void 0===f?void 0:f.effectfalse),iteration:0,nodeStatus:e,slideStatus:n},l));ln(t,e,n,l)},ln=(i,t,e,n)=>{var r;switch(null===(r=i.test)||void 0===r?void 0:r.type){case"truefalse":{var l,a;let{value:w,iscorrect:S}=null!==(l=null==i||null===(a=i.test)||void 0===a||null===(a=a.answer)||void 0===a?void 0:a.truefalse)&&void 0!==l?l:{};if(w){let J=V.findNode(w);var o,s,d,u;S?null!==(o=i.test)&&void 0!==o&&null!==(o=o.icontrue)&&void 0!==o&&o.path&&Dt(J,{source:Et(null===(s=i.test)||void 0===s?void 0:s.icontrue),iteration:0,nodeStatus:t,slideStatus:e},n):null!==(d=i.test)&&void 0!==d&&null!==(d=d.iconfalse)&&void 0!==d&&d.path&&Dt(J,{source:Et(null===(u=i.test)||void 0===u?void 0:u.iconfalse),iteration:0,nodeStatus:t,slideStatus:e},n)}break}case"singlechoice":{var c,h;let{value:w,iscorrect:S}=null!==(c=null==i||null===(h=i.test)||void 0===h||null===(h=h.answer)||void 0===h?void 0:h.singlechoice)&&void 0!==c?c:{};if(w){let J=V.findNode(w);var f,v,b,y;S?null!==(f=i.test)&&void 0!==f&&null!==(f=f.icontrue)&&void 0!==f&&f.path&&Dt(J,{source:Et(null===(v=i.test)||void 0===v?void 0:v.icontrue),iteration:0,nodeStatus:t,slideStatus:e},n):null!==(b=i.test)&&void 0!==b&&null!==(b=b.iconfalse)&&void 0!==b&&b.path&&Dt(J,{source:Et(null===(y=i.test)||void 0===y?void 0:y.iconfalse),iteration:0,nodeStatus:t,slideStatus:e},n)}break}case"multichoice":var g;null==i||null===(g=i.test)||void 0===g||null===(g=g.answer)||void 0===g||null===(g=g.multichoice)||void 0===g||g.forEach(w=>{let{value:S,iscorrect:J}=w;if(S){let C=V.findNode(S);var j,B,z,T;J?null!==(j=i.test)&&void 0!==j&&null!==(j=j.icontrue)&&void 0!==j&&j.path&&Dt(C,{source:Et(null===(B=i.test)||void 0===B?void 0:B.icontrue),iteration:0,nodeStatus:t,slideStatus:e},n):null!==(z=i.test)&&void 0!==z&&null!==(z=z.iconfalse)&&void 0!==z&&z.path&&Dt(C,{source:Et(null===(T=i.test)||void 0===T?void 0:T.iconfalse),iteration:0,nodeStatus:t,slideStatus:e},n)}});break;case"fill":var O;null==i||null===(O=i.test)||void 0===O||null===(O=O.answer)||void 0===O||null===(O=O.fill)||void 0===O||O.forEach(w=>{let{id:S,value:j,iscorrect:B}=w;if(j){let D=V.findNode(S);var z,T,C,Q;B?null!==(z=i.test)&&void 0!==z&&null!==(z=z.icontrue)&&void 0!==z&&z.path&&Dt(D,{source:Et(null===(T=i.test)||void 0===T?void 0:T.icontrue),iteration:0,nodeStatus:t,slideStatus:e},n):null!==(C=i.test)&&void 0!==C&&null!==(C=C.iconfalse)&&void 0!==C&&C.path&&Dt(D,{source:Et(null===(Q=i.test)||void 0===Q?void 0:Q.iconfalse),iteration:0,nodeStatus:t,slideStatus:e},n)}});break;case"matching":var x;null==i||null===(x=i.test)||void 0===x||null===(x=x.answer)||void 0===x||null===(x=x.matching)||void 0===x||x.forEach(w=>{let{id:S,key:J,value:j}=w;if(j){let Q=V.findNode(S);var B,z,T,C;J==j?null!==(B=i.test)&&void 0!==B&&null!==(B=B.icontrue)&&void 0!==B&&B.path&&Dt(Q,{source:Et(null===(z=i.test)||void 0===z?void 0:z.icontrue),iteration:0,nodeStatus:t,slideStatus:e},n):null!==(T=i.test)&&void 0!==T&&null!==(T=T.iconfalse)&&void 0!==T&&T.path&&Dt(Q,{source:Et(null===(C=i.test)||void 0===C?void 0:C.iconfalse),iteration:0,nodeStatus:t,slideStatus:e},n)}})}},ir=(i,t,e,n)=>{var r,l,a,o,s,d,c,f,h;null!==(r=t.animate)&&void 0!==r&&r.value&&((i,t,e)=>{var n;let{value:l}=null!==(n=i.animate)&&void 0!==n?n:{};ye(i.id,{node:i,value:l,nodeStatus:t,slideStatus:e},()=>{})})(t,e.nodeStatus,e.slideStatus),null!==(l=t.interactive)&&void 0!==l&&l.show?(console.log(`node(${t.id}) | nodeStatus(${e.nodeStatus}) | slideStatus(${e.slideStatus}) | show`),((i,t,e,n)=>{var r,l,a;let o={total:0,counter:0},{triggershow:s,triggerrun:d,triggerhide:u,action:c,audio:h}=null!==(r=null===(l=i.interactive)||void 0===l?void 0:l.show)&&void 0!==r?r:{};if(console.log(`node(${i.id}) | nodeStatus(${t}) | slideStatus(${e}) | show`),s){let{id:v,ids:b,time:y,async:g}=s;"asynctrue"==g?setTimeout(()=>{Oe({id:v,ids:b,nodeStatus:t,slideStatus:e})}):"time"==g&&setTimeout(()=>{Oe({id:v,ids:b,nodeStatus:t,slideStatus:e})},1e3*(null!=y?y:0))}if(d){let{id:v,ids:b,time:y,async:g}=d;"asynctrue"==g?setTimeout(()=>{Ie({id:v,ids:b,nodeStatus:t,slideStatus:e})}):"time"==g&&setTimeout(()=>{Ie({id:v,ids:b,nodeStatus:t,slideStatus:e})},1e3*(null!=y?y:0))}if(u){let{id:v,ids:b,time:y,async:g}=u;"asynctrue"==g?setTimeout(()=>{Ae({id:v,ids:b,nodeStatus:t,slideStatus:e})}):"time"==g&&setTimeout(()=>{Ae({id:v,ids:b,nodeStatus:t,slideStatus:e})},1e3*(null!=y?y:0))}let f=()=>{setTimeout(()=>{if(o.counter>=o.total){if(n&&n(),s){let{id:v,ids:b,async:y}=s;(!y||"asyncfalse"==y)&&Oe({id:v,ids:b,nodeStatus:t,slideStatus:e})}if(d){let{id:v,ids:b,async:y}=d;(!y||"asyncfalse"==y)&&Ie({id:v,ids:b,nodeStatus:t,slideStatus:e})}if(u){let{id:v,ids:b,async:y}=u;(!y||"asyncfalse"==y)&&Ae({id:v,ids:b,nodeStatus:t,slideStatus:e})}}})};if(null!=c&&c.value){o.total+=1;let v=()=>{o.counter+=1,f()};switch(null==c?void 0:c.value){case"hide":jQuery("#"+i.id).addClass("hide"),v();break;case"points":{let{points:b,time:y,iteration:g,finish:O}=c;ki(i.id,{node:i,points:b,time:y,iteration:g,finish:O,nodeStatus:t,slideStatus:e},v);break}default:{let{value:b,time:y,iteration:g,finish:O}=c;oi(i.id,{node:i,value:b,time:y,iteration:g,finish:O,nodeStatus:t,slideStatus:e},v);break}}}if(null!=h&&null!==(a=h.source)&&void 0!==a&&a.path){o.total+=1;let v=()=>{o.counter+=1,f()},b=Oi(i.id,h,o,{nodeStatus:t,slideStatus:e},v);-1==(null==h?void 0:h.iteration)&&jQuery("#"+i.id).click(y=>{y.preventDefault(),b&&(b.volume=b.volume>=1?0:b.volume+.25),console.log(null==b?void 0:b.volume)})}o.total||f()})(t,e.nodeStatus,e.slideStatus,n)):n&&n(),null!==(a=t.interactive)&&void 0!==a&&a.click&&(f=null===(c=t.interactive)||void 0===c?void 0:c.click,Object.keys(null!=f?f:{}).map(b=>f[b]?1:0).includes(1)&&jQuery("#"+t.id).addClass("interactive-click"),jQuery("#"+t.id).click(f=>{f.preventDefault(),e.nodeStatus=V.refreshNodeStatus(),console.log(`node(${t.id}) | nodeStatus(${e.nodeStatus}) | slideStatus(${e.slideStatus}) | click`),Ye(t,e.nodeStatus,e.slideStatus)})),null!==(o=t.variable)&&void 0!==o&&o.input&&jQuery("#"+t.id).on("change","input,textarea",f=>{f.preventDefault(),((i,t,e)=>{var n,r;p.variable.setValue(null!==(n=null===(r=t.variable)||void 0===r||null===(r=r.input)||void 0===r?void 0:r.variable)&&void 0!==n?n:"",i),(i=>{var t;let e=(n,r)=>{null==n||n.forEach(l=>{switch(l.type){case L.GROUP:Me(l.id,{},r?window.document.getElementById(r):null),e(l.nodes,l.id);break;case L.POLYGON:break;case L.TEXT:Ce(l.id,{size:l.size,attribute:l.attribute,source:l.source},r?window.document.getElementById(r):null)}})};e(null===(t=i.svg)||void 0===t?void 0:t.nodes)})(e)})(f.target.value,t,i)}),null!==(s=t.variable)&&void 0!==s&&s.click&&(null!==(h=t.variable)&&void 0!==h&&null!==(h=h.click)&&void 0!==h&&h.variable&&jQuery("#"+t.id).addClass("variable-click"),jQuery("#"+t.id).click(f=>{f.preventDefault(),((i,t)=>{var e;p.variable.setValueOperator(null===(e=i.variable)||void 0===e?void 0:e.click),(i=>{var t;let e=(n,r)=>{null==n||n.forEach(l=>{switch(l.type){case L.GROUP:Me(l.id,{},r?window.document.getElementById(r):null),e(l.nodes,l.id);break;case L.POLYGON:break;case L.TEXT:Ce(l.id,{size:l.size,attribute:l.attribute,source:l.source},r?window.document.getElementById(r):null)}})};e(null===(t=i.svg)||void 0===t?void 0:t.nodes)})(t)})(t,i)})),"test"==(null===(d=t.source)||void 0===d?void 0:d.type)&&((i,t)=>{var e;let n=()=>{};switch(null===(e=i.source)||void 0===e||null===(e=e.test)||void 0===e?void 0:e.type){case"truefalse":{jQuery("#"+i.id).click(a=>{a.preventDefault(),((i,t,e,n,r)=>{var l,a;let o=null===(l=i.source)||void 0===l||null===(l=l.test)||void 0===l||null===(l=l.truefalse)||void 0===l?void 0:l.iscorrect;t.test?t.test.answer?t.test.answer.truefalse={value:i.id,iscorrect:o}:t.test.answer={truefalse:{value:i.id,iscorrect:o}}:t.test={answer:{truefalse:{value:i.id,iscorrect:o}}},null!==(a=t.svg)&&void 0!==a&&a.nodes.find(d=>{var u;return"submit"==(null===(u=d.source)||void 0===u||null===(u=u.test)||void 0===u?void 0:u.type)})||Ke(i,t,e,n,{iscorrect:o},r);let s=N(lt.TEST_GROUP,"g",void 0,p.target);ct(s,t,i)})(i,t,V.nodeStatus,V.slideStatus,n)});let l=N(lt.TEST_GROUP,"g",void 0,p.target);ct(l,t,i);break}case"singlechoice":{jQuery("#"+i.id).click(a=>{a.preventDefault(),((i,t,e,n,r)=>{var l,a;let o=null===(l=i.source)||void 0===l||null===(l=l.test)||void 0===l||null===(l=l.singlechoice)||void 0===l?void 0:l.iscorrect;t.test?t.test.answer?t.test.answer.singlechoice={value:i.id,iscorrect:o}:t.test.answer={singlechoice:{value:i.id,iscorrect:o}}:t.test={answer:{singlechoice:{value:i.id,iscorrect:o}}},null!==(a=t.svg)&&void 0!==a&&a.nodes.find(d=>{var u;return"submit"==(null===(u=d.source)||void 0===u||null===(u=u.test)||void 0===u?void 0:u.type)})||Ke(i,t,e,n,{iscorrect:o},r);let s=N(lt.TEST_GROUP,"g",void 0,p.target);ct(s,t,i)})(i,t,V.nodeStatus,V.slideStatus,n)});let l=N(lt.TEST_GROUP,"g",void 0,p.target);ct(l,t,i);break}case"multichoice":{jQuery("#"+i.id).click(a=>{a.preventDefault(),((i,t,e,n,r)=>{var l,a;let o=null===(l=i.source)||void 0===l||null===(l=l.test)||void 0===l||null===(l=l.multichoice)||void 0===l?void 0:l.iscorrect;t.test?t.test.answer?t.test.answer.multichoice?t.test.answer.multichoice.find(d=>d.value==i.id)?t.test.answer.multichoice=t.test.answer.multichoice.filter(d=>d.value!=i.id):t.test.answer.multichoice.push({value:i.id,iscorrect:o}):t.test.answer.multichoice=[{value:i.id,iscorrect:o}]:t.test.answer={multichoice:[{value:i.id,iscorrect:o}]}:t.test={answer:{multichoice:[{value:i.id,iscorrect:o}]}},null!==(a=t.svg)&&void 0!==a&&a.nodes.find(d=>{var u;return"submit"==(null===(u=d.source)||void 0===u||null===(u=u.test)||void 0===u?void 0:u.type)})||Ke(i,t,e,n,{iscorrect:o},r);let s=N(lt.TEST_GROUP,"g",void 0,p.target);ct(s,t,i)})(i,t,V.nodeStatus,V.slideStatus,n)});let l=N(lt.TEST_GROUP,"g",void 0,p.target);ct(l,t,i);break}case"fill":{var r;jQuery("#"+i.id).on("keyup",'input[type="text"]',a=>{var o;let s=jQuery("<div/>").css({"font-size":jQuery(a.target).css("font-size"),visibility:"hidden",float:"left"}).text(a.target.value).appendTo(window.document.body);jQuery(a.target).css({width:(null!==(o=s.width())&&void 0!==o?o:0)+30})}).on("keypress",'input[type="text"]',a=>{13===(a.keyCode||a.charCode||a.which)&&(a.preventDefault(),a.stopPropagation(),jQuery(a.target).blur())}).on("change",'input[type="text"]',a=>{var o,s;let d=null===(o=a.target)||void 0===o?void 0:o.getAttribute("data-key"),u=null===(s=a.target)||void 0===s||null===(s=s.value)||void 0===s?void 0:s.trim();jQuery("#"+i.id).find(`input[type="text"][data-key="${d}"]`).val(u),((i,t,e,n,r,l)=>{var a,o,s,d;let{value:u}=null!==(a=null===(o=i.source)||void 0===o||null===(o=o.test)||void 0===o||null===(o=o.fill)||void 0===o?void 0:o.find(f=>f.key==`[[${r.key}]]`))&&void 0!==a?a:{},c=u&&u.map(f=>null==f?void 0:f.toLocaleLowerCase()).includes(null===(s=r.value)||void 0===s?void 0:s.toLocaleLowerCase());r.iscorrect=c,t.test?t.test.answer?t.test.answer.fill?t.test.answer.fill.find(f=>f.key==r.key)?t.test.answer.fill.filter(f=>f.key==r.key).forEach(f=>{f.value=r.value,f.iscorrect=r.iscorrect}):t.test.answer.fill.push(r):t.test.answer.fill=[r]:t.test.answer={fill:[r]}:t.test={answer:{fill:[r]}};let h=N(lt.TEST_GROUP,"g",void 0,p.target);ct(h,t,i),null!==(d=t.svg)&&void 0!==d&&d.nodes.find(f=>{var v;return"submit"==(null===(v=f.source)||void 0===v||null===(v=v.test)||void 0===v?void 0:v.type)})||Ke(i,t,e,n,{iscorrect:c},l)})(i,t,V.nodeStatus,V.slideStatus,{id:i.id,key:d,value:u},n)}),null!==(r=t.test)&&void 0!==r&&r.showselection||jQuery("#"+i.id).addClass("hide-selection");let l=N(lt.TEST_GROUP,"g",void 0,p.target);ct(l,t,i);break}case"matching-empty":{jQuery("#"+i.id).on("touchmove",".ondrag-item",function(a){a.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(a){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${i.size.height/i.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${a.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(a){var o;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(o=t.test)&&void 0!==o&&o.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection"),rn(i,t)},drag:function(a){},dragend:function(a){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${i.id} .ondrop-here`).kendoDropTarget({dragenter:function(a){a.dropTarget.hasClass("actived")&&a.dropTarget.addClass("focused")},dragleave:function(a){a.dropTarget.hasClass("actived")&&a.dropTarget.removeClass("focused")},drop:function(a){if(!a.dropTarget.hasClass("actived"))return;a.dropTarget.removeClass("focused");let o=a.dropTarget,s=a.draggable.currentTarget;o.is(":empty")||o.find(".ondrag-item").appendTo($('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').first()),s.appendTo(o);let d=N(lt.TEST_GROUP,"g",void 0,p.target);ct(d,t,i),((i,t,e,n,r,l)=>{var a,o,s;let{key:d}=null!==(a=null===(o=i.source)||void 0===o||null===(o=o.test)||void 0===o?void 0:o.matching)&&void 0!==a?a:{key:"KIEN"},u=r.key==d;rn(i,t);let c={id:i.id,key:null!=d?d:"",value:r.key};t.test?t.test.answer?t.test.answer.matching?t.test.answer.matching.find(h=>h.id==c.id)?t.test.answer.matching.filter(h=>h.id==c.id).forEach(h=>{h.key=c.key,h.value=c.value}):t.test.answer.matching.push(c):t.test.answer.matching=[c]:t.test.answer={matching:[c]}:t.test={answer:{matching:[c]}},null!==(s=t.svg)&&void 0!==s&&s.nodes.find(h=>{var f;return"submit"==(null===(f=h.source)||void 0===f||null===(f=f.test)||void 0===f?void 0:f.type)})||Ke(i,t,e,n,{iscorrect:u},l)})(i,t,V.nodeStatus,V.slideStatus,{key:s.data("key")},n)}});let l=N(lt.TEST_GROUP,"g",void 0,p.target);ct(l,t,i);break}case"matching-content":{jQuery("#"+i.id).on("touchmove",".ondrag-item",function(a){a.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(a){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${i.size.height/i.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${a.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(a){var o;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(o=t.test)&&void 0!==o&&o.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(a){},dragend:function(a){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${i.id} .ondrop-here`).kendoDropTarget({dragenter:function(a){a.dropTarget.hasClass("actived")&&a.dropTarget.addClass("focused")},dragleave:function(a){a.dropTarget.hasClass("actived")&&a.dropTarget.removeClass("focused")},drop:function(a){if(!a.dropTarget.hasClass("actived"))return;a.dropTarget.removeClass("focused");let o=N(lt.TEST_GROUP,"g",void 0,p.target);ct(o,t,i),a.draggable.currentTarget.appendTo(a.dropTarget),ln(t,V.nodeStatus,V.slideStatus,n)}});let l=N(lt.TEST_GROUP,"g",void 0,p.target);ct(l,t,i);break}case"speech":break;case"submit":jQuery("#"+i.id).click(l=>{l.preventDefault(),((i,t,e,n,r)=>{var l,a,o,s,d;let u;var c;if(null!=t&&null!==(l=t.test)&&void 0!==l&&null!==(l=l.answer)&&void 0!==l&&l.truefalse)u=null==t||null===(c=t.test)||void 0===c||null===(c=c.answer)||void 0===c||null===(c=c.truefalse)||void 0===c?void 0:c.iscorrect;else if(null!=t&&null!==(a=t.test)&&void 0!==a&&null!==(a=a.answer)&&void 0!==a&&a.singlechoice){var h;u=null==t||null===(h=t.test)||void 0===h||null===(h=h.answer)||void 0===h||null===(h=h.singlechoice)||void 0===h?void 0:h.iscorrect}else if(null!=t&&null!==(o=t.test)&&void 0!==o&&null!==(o=o.answer)&&void 0!==o&&o.multichoice){var f,v,b;u=1==[null==t||null===(f=t.test)||void 0===f||null===(f=f.answer)||void 0===f||null===(f=f.multichoice)||void 0===f?void 0:f.length,null==t||null===(v=t.test)||void 0===v||null===(v=v.answer)||void 0===v||null===(v=v.multichoice)||void 0===v||null===(v=v.map(w=>w.iscorrect?1:0))||void 0===v?void 0:v.reduce((w,S)=>w+S),null==t||null===(b=t.svg)||void 0===b||null===(b=b.nodes)||void 0===b||null===(b=b.filter(w=>{var S,J;return"multichoice"==(null===(S=w.source)||void 0===S||null===(S=S.test)||void 0===S?void 0:S.type)&&(null===(J=w.source)||void 0===J||null===(J=J.test)||void 0===J||null===(J=J.multichoice)||void 0===J?void 0:J.iscorrect)}))||void 0===b?void 0:b.length].filter((w,S,J)=>J.indexOf(w)==S).length}else if(null!=t&&null!==(s=t.test)&&void 0!==s&&null!==(s=s.answer)&&void 0!==s&&s.fill){var y,g;u=(null==t||null===(y=t.test)||void 0===y||null===(y=y.answer)||void 0===y||null===(y=y.fill)||void 0===y||null===(y=y.map(w=>w.iscorrect?1:0))||void 0===y?void 0:y.reduce((w,S)=>w+S))==(null===(g=t.svg)||void 0===g||null===(g=g.nodes)||void 0===g||null===(g=g.filter(w=>{var S;return"fill"==(null===(S=w.source)||void 0===S||null===(S=S.test)||void 0===S?void 0:S.type)}))||void 0===g?void 0:g.length)}else if(null!=t&&null!==(d=t.test)&&void 0!==d&&null!==(d=d.answer)&&void 0!==d&&d.matching){var O,x;u=(null===(O=t.svg)||void 0===O||null===(O=O.nodes)||void 0===O||null===(O=O.filter(w=>{var S;return"matching-empty"==(null===(S=w.source)||void 0===S||null===(S=S.test)||void 0===S?void 0:S.type)}))||void 0===O?void 0:O.length)==((null==t||null===(x=t.test)||void 0===x||null===(x=x.answer)||void 0===x?void 0:x.matching)||[]).map(w=>w.key==w.value?1:0).reduce((w,S)=>w+S)}Ke(i,t,e,n,{iscorrect:u},r)})(i,t,V.nodeStatus,V.slideStatus,n)})}})(t,i)},Ii=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:p.attribute.fill,stroke:p.attribute.stroke,strokeWidth:p.attribute.strokeWidth};return Object.assign(r,nt(L.ELLIPSE,n,r)),{nodeId:i,element:re(i,L.ELLIPSE,"ellipse",{size:n,attribute:r},e),size:n,attribute:r}},Ai=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{stroke:p.attribute.stroke,strokeWidth:p.attribute.strokeWidth,strokeLinecap:p.attribute.strokeLinecap};return Object.assign(r,nt(L.LINE,n,r)),{nodeId:i,element:re(i,L.LINE,"line",{size:n,attribute:r},e),size:n,attribute:r}},Ci=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:p.attribute.fill,stroke:p.attribute.stroke,strokeWidth:p.attribute.strokeWidth};return Object.assign(r,nt(L.POLYGON,n,r)),{nodeId:i,element:re(i,L.POLYGON,"polygon",{size:n,attribute:r},e),size:n,attribute:r}},de=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:320,height:80},r=(null==t?void 0:t.attribute)||{};Object.assign(r,nt(L.FOREIGNOBJECT,n,r));let l=(null==t?void 0:t.source)||{type:"html",html:{htmlContent:""}},a=(null==t?void 0:t.style)||{};return{nodeId:i,element:re(i,L.FOREIGNOBJECT,"foreignObject",{size:n,attribute:r,style:a,source:l},e),size:n,attribute:r,style:a,source:l}},Ne=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{stroke:p.attribute.stroke,strokeWidth:p.attribute.strokeWidth};return Object.assign(r,nt(L.PATH,n,r)),{nodeId:i,element:re(i,L.PATH,"path",{size:n,attribute:r},e),size:n,attribute:r}},an=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:p.attribute.fill,stroke:p.attribute.stroke,strokeWidth:p.attribute.strokeWidth};return Object.assign(r,nt(L.POLYLINE,n,r)),{nodeId:i,element:re(i,L.POLYLINE,"polyline",{size:n,attribute:r},e),size:n,attribute:r}},Ji=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:320,height:80},r=(null==t?void 0:t.attribute)||{fill:p.attribute.stroke,fontFamily:p.attribute.fontFamily,fontSize:p.attribute.fontSize,textLength:p.attribute.textLength};Object.assign(r,nt(L.TSPAN,n,r));let l=(null==t?void 0:t.source)||{type:"text",text:{textContent:""}};return{nodeId:i,element:re(i,L.TSPAN,"tspan",{size:n,attribute:r,source:l},e),size:n,attribute:r,source:l}},si=(i,t,e)=>{if(e.slideStatus!=V.slideStatus||!t.length)return;let n=t.shift(),r=i.filter(s=>{var d;return(null!==(d=s.idx)&&void 0!==d?d:0)==n});if(!r.length)return;let l=Math.max.apply(null,r.map(s=>{var d;return null!==(d=s.time)&&void 0!==d?d:0})),a=!1,o=l<.5?0:setTimeout(()=>{a||(a=!0,si(i,t,e))},1e3*l);Je(i,t,r,0,e,{idx:n,total:r.length,counter:0,isRecursive:a,timeoutRecursive:o,maxTimeCoundown:l,uid:Math.floor(1e9*Math.random())})},Je=(i,t,e,n,r,l)=>{if(r.slideStatus!=V.slideStatus)return;let a=e[n];if(a){switch(a.type){case L.GROUP:break;case L.CIRCLE:ge(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case L.ELLIPSE:Ii(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case L.LINE:Ai(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case L.RECT:Wt(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case L.POLYGON:Ci(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case L.POLYLINE:an(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case L.FOREIGNOBJECT:de(a.id,{size:a.size,attribute:a.attribute,style:a.style,source:a.source},a.pid?window.document.getElementById(a.pid):null);break;case L.IMAGE:ke(a.id,{size:a.size,attribute:a.attribute,source:a.source},a.pid?window.document.getElementById(a.pid):null);break;case L.TEXT:Ce(a.id,{size:a.size,attribute:a.attribute,source:a.source},a.pid?window.document.getElementById(a.pid):null);break;case L.TSPAN:Ji(a.id,{size:a.size,attribute:a.attribute,source:a.source},a.pid?window.document.getElementById(a.pid):null);break;case L.PATH:Ne(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null)}ir(r.slide,a,r,()=>{l.counter+=1,l.maxTimeCoundown<.5&&l.counter>=l.total&&(l.total=l.counter=0,l.isRecursive||(clearTimeout(l.timeoutRecursive),l.isRecursive=!0,setTimeout(()=>{si(i,t,r)},250)))}),Je(i,t,e,++n,r,l)}},V=new class nr{constructor(){this._nodeStatus=0,this._slideStatus=0,this._slideIdx=0,this._fnChangeSlides=[]}set data(t){this._dataSource=t.data||{},p.variable.set=t.variable||{}}get nodeStatus(){return this._nodeStatus}refreshNodeStatus(){return this._nodeStatus=Math.floor(999999999*Math.random()),this._nodeStatus}get slideStatus(){return this._slideStatus}refreshSlideStatus(){return this._slideStatus=Math.floor(999999999*Math.random()),this._slideStatus}get slideIdx(){return this._slideIdx}get slideTotal(){var t,e;return null!==(t=null===(e=this._dataSource)||void 0===e||null===(e=e.slides)||void 0===e?void 0:e.length)&&void 0!==t?t:0}get slides(){var t;return(null===(t=this._dataSource)||void 0===t?void 0:t.slides)||[]}get slide(){var t;return((null===(t=this._dataSource)||void 0===t?void 0:t.slides)||[])[this._slideIdx]||{}}findNode(t){var e;let n=null===(e=this._dataSource)||void 0===e||null===(e=e.slides)||void 0===e?void 0:e.find((h,f)=>f==this._slideIdx),r=null==n?void 0:n.svg,l=(h,f)=>{let v=null==h?void 0:h.find(g=>g.id==t);if(v)return v;let b=0,y=h.length||0;for(;b<y&&!v&&(v=l(h[b].nodes||[],h[b].id),!v);)b++;return v},a=l((null==r?void 0:r.nodes)||[]);var o,s,d,u,c;return a?(a.style=null!==(o=a.style)&&void 0!==o?o:{},a.source=null!==(s=a.source)&&void 0!==s?s:{},a.animate=null!==(d=a.animate)&&void 0!==d?d:{},a.interactive=null!==(u=a.interactive)&&void 0!==u?u:{},a.variable=null!==(c=a.variable)&&void 0!==c?c:{},a):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}runSlide(t,e,n){var r;let l;var a,o;if(this.refreshNodeStatus(),this.refreshSlideStatus(),n)l=null===(a=this._dataSource)||void 0===a||null===(a=a.slides)||void 0===a?void 0:a.find(c=>c.code==n||c.id==n),l&&(this._slideIdx=(null===(o=this._dataSource)||void 0===o||null===(o=o.slides)||void 0===o?void 0:o.indexOf(l))||0);else if(e){var s,d;l=null===(s=this._dataSource)||void 0===s||null===(s=s.slides)||void 0===s?void 0:s.find(c=>c.id==e),l&&(this._slideIdx=(null===(d=this._dataSource)||void 0===d||null===(d=d.slides)||void 0===d?void 0:d.indexOf(l))||0)}else this._slideIdx=Math.min(Math.max(t||0,0),this.slideTotal-1),l=this.slide;if(l){var u;di(p.container,p.svg,l,!0),null===(u=jQuery(p.svg).find("#"+lt.BACKGROUND_GROUP))||void 0===u||u.empty();let c=N(lt.BACKGROUND_GROUP,"g",void 0,p.svg);st(c,l),(i=>{var t,e,n,r;i.test&&(i.test.answer=void 0);let l=V.nodeStatus,a=V.slideStatus;null===(t=i.svg)||void 0===t||t.nodes.forEach(s=>{s.pid=Math.ceil(1e9*Math.random()),Me(s.pid)});let o=null===(e=i.svg)||void 0===e||null===(e=e.nodes)||void 0===e?void 0:e.map(s=>{var d;return null!==(d=s.idx)&&void 0!==d?d:0}).filter((s,d,u)=>u.indexOf(s)==d).sort((s,d)=>(null!=s?s:0)-(null!=d?d:0));si(null!==(n=null===(r=i.svg)||void 0===r?void 0:r.nodes)&&void 0!==n?n:[],null!=o?o:[],{slide:i,nodeStatus:l,slideStatus:a})})(l)}this.changeSlide(this.slides,null===(r=this.slide)||void 0===r?void 0:r.id,this.slideIdx,this.slides.length,l)}set onChangeSlide(t){this._fnChangeSlides.push(t)}changeSlide(t,e,n,r,l){this._fnChangeSlides.forEach(a=>a(t,e,n,r,l))}},di=(i,t,e,n)=>{var r,l,a,o;let s=window.document.querySelector(t);var d;s||(s=document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(d=window.document.querySelector(i))||void 0===d||d.appendChild(s)),n&&(s.textContent=null);let{x:u,y:c,width:h,height:f}=null!==(r=null==e||null===(l=e.svg)||void 0===l?void 0:l.viewBox)&&void 0!==r?r:p.screen.frameSize;s.setAttributeNS(null,"viewBox",u+" "+c+" "+h+" "+f),s.setAttribute("id",t.replace("#",""));var O,x,v=null!==(a=jQuery(i).width())&&void 0!==a?a:1080,b=null!==(o=jQuery(i).height())&&void 0!==o?o:1080,g=h/f;g>=v/b?x=(O=v)/g:O=(x=b)*g,s.setAttributeNS(null,"width",O.toString()),s.setAttributeNS(null,"height",x.toString())};class rr{constructor(t,e){let n=window.document.querySelector(e);var r;n||(n=window.document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(r=window.document.querySelector(t))||void 0===r||r.appendChild(n));let{svgViewBox:l,svgSize:a}=p.screen.init();n.setAttributeNS(null,"viewBox",`${l.x} ${l.y} ${l.width} ${l.height}`),n.setAttribute("id",e.replace("#","")),n.style.display="block",n.style.width=`${a.width}px`,n.style.height=`${a.height}px`,n.style.backgroundColor="#fafafa",n.style.cursor="default"}}const ui=i=>{jQuery(p.target).find("#"+lt.BACKGROUND_GROUP).empty();let t=N(lt.BACKGROUND_GROUP,"g",void 0,p.target);st(t,i),(()=>{let e=window.document.getElementById(null==i?void 0:i.id);jQuery(e).find("#"+lt.BACKGROUND_GROUP).empty();let n=N(lt.BACKGROUND_GROUP,"g",void 0,e);st(n,i)})()},ci=()=>{jQuery(p.target).find(">*:not(defs)").remove()},re=(i,t,e,n,r)=>{let l;return i?(l=jQuery(r||p.target).find("#"+i).get(0),l||(l=window.document.createElementNS("http://www.w3.org/2000/svg",e),l.setAttribute("id",i),t==L.FOREIGNOBJECT&&l.setAttribute("xmlns:html","http://www.w3.org/1999/xhtml"),jQuery(l).appendTo(r||p.target))):(l=window.document.createElementNS("http://www.w3.org/2000/svg",e),jQuery(l).appendTo(r||p.target)),null!=n&&n.attribute&&m(l,null==n?void 0:n.attribute),null!=n&&n.style&&_(l,null==n?void 0:n.style),null!=n&&n.source&&k(l,t,null==n?void 0:n.source,i),l},m=(i,t)=>{return jQuery(i).attr((e=Object.assign({},t||{}),null===(n=Object.keys(e))||void 0===n||n.forEach(a=>{switch(a){case"fill":break;case"fillRule":var o;Object.assign(e,{"fill-rule":null!==(o=e.fillRule)&&void 0!==o?o:null,fillRule:null});break;case"stroke":var s;Object.assign(e,{"stroke-width":null!==(s=e.strokeWidth)&&void 0!==s?s:null,strokeWidth:null});break;case"strokeLinecap":var d;Object.assign(e,{"stroke-linecap":null!==(d=e.strokeLinecap)&&void 0!==d?d:null,strokeLinecap:null});break;case"strokeLinejoin":var u;Object.assign(e,{"stroke-linejoin":null!==(u=e.strokeLinejoin)&&void 0!==u?u:null,strokeLinejoin:null});break;case"strokeMiterlimit":var c;Object.assign(e,{"stroke-miterlimit":null!==(c=e.strokeMiterlimit)&&void 0!==c?c:null,strokeMiterlimit:null});break;case"strokeDasharray":var h;Object.assign(e,{"stroke-dasharray":null!==(h=e.strokeDasharray)&&void 0!==h?h:null,strokeDasharray:null});break;case"strokeDasharrays":var f,v;Object.assign(e,{"stroke-dasharray":null!==(f=null===(v=e.strokeDasharrays)||void 0===v?void 0:v.join(" "))&&void 0!==f?f:null,strokeDasharrays:null});break;case"fontFamily":var b;Object.assign(e,{"font-family":null!==(b=e.fontFamily)&&void 0!==b?b:null,fontFamily:null});break;case"fontWeight":var y;Object.assign(e,{"font-weight":null!==(y=e.fontWeight)&&void 0!==y?y:null,fontWeight:null});break;case"fontStyle":var g;Object.assign(e,{"font-style":null!==(g=e.fontStyle)&&void 0!==g?g:null,fontStyle:null});break;case"fontSize":var O;Object.assign(e,{"font-size":null!==(O=e.fontSize)&&void 0!==O?O:null,fontSize:null});break;case"textLength":Object.assign(e,{textLength:e.textLength?`${e.textLength}px`:null});break;case"letterSpacing":var x;Object.assign(e,{"letter-spacing":null!==(x=e.letterSpacing)&&void 0!==x?x:null,letterSpacing:null});break;case"wordSpacing":var w;Object.assign(e,{"word-spacing":null!==(w=e.wordSpacing)&&void 0!==w?w:null,wordSpacing:null});break;case"alignmentBaseline":var S;Object.assign(e,{"alignment-baseline":null!==(S=e.alignmentBaseline)&&void 0!==S?S:null,alignmentBaseline:null});break;case"dominantBaseline":var J;Object.assign(e,{"dominant-baseline":null!==(J=e.dominantBaseline)&&void 0!==J?J:null,dominantBaseline:null});break;case"textAnchor":var j;Object.assign(e,{"text-anchor":null!==(j=e.textAnchor)&&void 0!==j?j:null,textAnchor:null});break;case"textDecoration":var B;Object.assign(e,{"text-decoration":null!==(B=e.textDecoration)&&void 0!==B?B:null,textDecoration:null});break;case"transformOrigin":var z;Object.assign(e,{"transform-origin":null!==(z=e.transformOrigin)&&void 0!==z?z:null,transformOrigin:null})}}),Object.assign({},null!=e?e:{},{fill:null!=e&&e.fill?Ut(e.fill,null!==(r=null==e?void 0:e.fillOpacity)&&void 0!==r?r:1):"rgba(0,0,0,0)",fillOpacity:null,stroke:null!=e&&e.stroke?Ut(e.stroke,null!==(l=null==e?void 0:e.strokeOpacity)&&void 0!==l?l:1):"rgba(0,0,0,0)",strokeOpacity:null}))),i;var e,n,r,l},_=(i,t)=>{return jQuery(i).css((e=Object.assign({},t||{}),null===(n=Object.keys(e))||void 0===n||n.forEach(r=>{switch(r){case"padding":Object.assign(e,{padding:e.padding?`${e.padding}px`:null});break;case"borderWidth":var l;Object.assign(e,e.borderWidth&&e.borderColor?{"border-width":`${e.borderWidth}px`,"border-style":e.borderStyle||"solid","border-color":Ut(e.borderColor,null!==(l=e.borderOpacity)&&void 0!==l?l:1)}:{"border-width":"","border-style":"","border-color":""}),Object.assign(e,{borderWidth:null,borderStyle:null,borderColor:null,borderOpacity:null});break;case"borderRadius":Object.assign(e,{"border-radius":e.borderRadius?`${e.borderRadius}px`:null,borderRadius:null});break;case"backgroundColor":var a;Object.assign(e,e.backgroundColor?{"background-color":Ut(e.backgroundColor,null!==(a=e.backgroundOpacity)&&void 0!==a?a:1)}:{"background-color":""}),Object.assign(e,{backgroundColor:null,backgroundOpacity:null})}}),e)),i;var e,n},k=(i,t,e,n)=>{switch(t){case L.TEXT:var r,l;jQuery(i).text(null!==(r=null==e||null===(l=e.text)||void 0===l?void 0:l.textContent)&&void 0!==r?r:"");break;case L.TSPAN:var a,o;jQuery(i).text(null!==(a=null==e||null===(o=e.text)||void 0===o?void 0:o.textContent)&&void 0!==a?a:"");break;case L.IMAGE:var s,d,u,c,h;jQuery(i).attr("href",(null==e||null===(s=e.image)||void 0===s?void 0:s.base64)||(null!=e&&null!==(d=e.image)&&void 0!==d&&d.path?(null===(u=p.config)||void 0===u?void 0:u.readfileuploadurl)+(null==e||null===(c=e.image)||void 0===c?void 0:c.path):null==e||null===(h=e.image)||void 0===h?void 0:h.url)||"");break;case L.FOREIGNOBJECT:switch(null==e?void 0:e.type){case"text":{var f,v,b;let Ft=(null===(f=e.text)||void 0===f?void 0:f.textContent)||"H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!";if(null!==(v=e.text)&&void 0!==v&&v.variableKeywords&&null!==(b=e.text)&&void 0!==b&&b.variableKeywords.length){let te=p.variable.getKeys();e.text.variableKeywords.forEach(xe=>{var Gt=xe.replace(/[^a-zA-Z0-9_]/gm,"");if(te.indexOf(Gt)>=0){var ee=p.variable.getValue(Gt);Ft=Ft.replace(xe,ee)}})}jQuery(i).text(Ft);break}case"html":{var y;let Ft=n==p.dataSelect.contenteditable_id,te=(null==e||null===(y=e.html)||void 0===y?void 0:y.htmlContent)||'<span style="font-family: Roboto; font-size: 24px;">H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!</span>';var g,O;if(!Ft&&null!==(g=e.html)&&void 0!==g&&g.variableKeywords&&null!==(O=e.html)&&void 0!==O&&O.variableKeywords.length){let xe=p.variable.getKeys();e.html.variableKeywords.forEach(Gt=>{var ee=Gt.replace(/[^a-zA-Z0-9_]/gm,"");if(xe.indexOf(ee)>=0){var Se=p.variable.getValue(ee);te=te.replace(Gt,Se)}})}jQuery(i).attr("editable",`${Ft}`).html(`<div contenteditable="${Ft}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${te}</div>`).find("img[path],video[path],iframe[path]").each((xe,Gt)=>{var ee,Se;Gt.setAttribute("src",(null!==(ee=null===(Se=p.config)||void 0===Se?void 0:Se.readfileuploadurl)&&void 0!==ee?ee:"")+Gt.getAttribute("path")),Gt.removeAttribute("path")});break}case"input":var x,w,S,J;if(null!==(x=e.input)&&void 0!==x&&x.input)jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><input type="text" placeholder="${null!==(S=null===(J=e.input)||void 0===J?void 0:J.placeholder)&&void 0!==S?S:""}" maxlength="100" /></div>`);else if(null!==(w=e.input)&&void 0!==w&&w.textarea){var j,B;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><textarea placeholder="${null!==(j=null===(B=e.input)||void 0===B?void 0:B.placeholder)&&void 0!==j?j:""}" maxlength="1000"></textarea></div>`)}break;case"image":var z,T,C,Q,D;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><img src="${(null===(z=e.image)||void 0===z?void 0:z.base64)||(null!==(T=e.image)&&void 0!==T&&T.path?(null===(C=p.config)||void 0===C?void 0:C.readfileuploadurl)+(null===(Q=e.image)||void 0===Q?void 0:Q.path):null===(D=e.image)||void 0===D?void 0:D.url)||""}" style="width:100%;height:100%;display:block;"/></div>`);break;case"iframe":var E,P,F,M;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${(null!==(E=e.iframe)&&void 0!==E&&E.path?(null===(P=p.config)||void 0===P?void 0:P.readfileuploadurl)+(null===(F=e.iframe)||void 0===F?void 0:F.path):null===(M=e.iframe)||void 0===M?void 0:M.url)||""}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break;case"embed":{var K,W,tt,Z,X;let Ft=oe({readfileuploadurl:null===(K=p.config)||void 0===K?void 0:K.readfileuploadurl,type:null===(W=e.embed)||void 0===W?void 0:W.type,oss:null===(tt=e.embed)||void 0===tt?void 0:tt.oss,path:null===(Z=e.embed)||void 0===Z?void 0:Z.path,url:null===(X=e.embed)||void 0===X?void 0:X.url});jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${Ft}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break}case"svg":var dt,ft;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${null!==(dt=null===(ft=e.svg)||void 0===ft?void 0:ft.svgContent)&&void 0!==dt?dt:""}</div>`);break;case"test":{var bt,Ot;let Ft=n==p.dataSelect.contenteditable_id,te=(null==e||null===(bt=e.html)||void 0===bt?void 0:bt.htmlContent)||"";var gt,It;if(!Ft&&null!==(gt=e.html)&&void 0!==gt&&gt.variableKeywords&&null!==(It=e.html)&&void 0!==It&&It.variableKeywords.length){let xe=p.variable.getKeys();e.html.variableKeywords.forEach(Gt=>{var ee=Gt.replace(/[^a-zA-Z0-9_]/gm,"");if(xe.indexOf(ee)>=0){var Se=p.variable.getValue(ee);te=te.replace(Gt,Se)}})}switch(null==e||null===(Ot=e.test)||void 0===Ot?void 0:Ot.type){case"truefalse":var Pt;jQuery(i).attr("editable",`${Ft}`).html(`<div contenteditable="${Ft}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;" data-node="test" data-type="${null==e?void 0:e.test.type}" data-correct="${null!=e&&null!==(Pt=e.test.truefalse)&&void 0!==Pt&&Pt.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${te}</div></div></div>`);break;case"singlechoice":var Bt;jQuery(i).attr("editable",`${Ft}`).html(`<div contenteditable="${Ft}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;" data-node="test" data-type="${null==e?void 0:e.test.type}" data-correct="${null!=e&&null!==(Bt=e.test.singlechoice)&&void 0!==Bt&&Bt.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${te}</div></div></div>`);break;case"multichoice":var he;jQuery(i).attr("editable",`${Ft}`).html(`<div contenteditable="${Ft}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;" data-node="test" data-type="${null==e?void 0:e.test.type}" data-correct="${null!=e&&null!==(he=e.test.multichoice)&&void 0!==he&&he.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${te}</div></div></div>`);break;case"matching-empty":var fe;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-empty" data-key="${null==e||null===(fe=e.test.matching)||void 0===fe?void 0:fe.key}"></div>`);break;case"matching-content":var be,bi,Qe;jQuery(i).attr("editable",`${Ft}`).html(`<div contenteditable="${Ft}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-content" data-key="${null==e||null===(be=e.test.matching)||void 0===be?void 0:be.key}"><div class="ondrag-item" data-key="${null!==(bi=null==e||null===(Qe=e.test)||void 0===Qe||null===(Qe=Qe.matching)||void 0===Qe?void 0:Qe.key)&&void 0!==bi?bi:"KIEN"}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${te}</div></div></div></div>`);break;case"fill":var Yi;Ft||((null===(Yi=e.html)||void 0===Yi?void 0:Yi.fillKeywords)||[]).forEach(xe=>{var Gt=`<input type="text" maxlength="128" style="display:inline-block;width:100px;min-width:100px;max-width:100%;padding:0px 10px;margin:0px;box-sizing:border-box;outline:none;box-shadow:none;border-width:0px 0px 1px;border-top-style:initial;border-right-style:initial;border-left-style:initial;border-top-color:initial;border-right-color:initial;border-left-color:initial;border-image:initial;border-bottom-style:dashed;border-bottom-color:rgb(123,146,254);background:transparent;animation:0.3s ease-in-out 0s 1 normal none running width;text-align:inherit;" data-key="${xe.replace(/[^a-zA-Z0-9]+/gm,"")}"/>`;te=te.replace(new RegExp(xe.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),"g"),Gt)}),jQuery(i).attr("editable",`${Ft}`).html(`<div contenteditable="${Ft}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${te}</div></div></div>`);break;case"speech":jQuery(i).html('<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><img src="images/svg/component/microphone4.svg" width="60" height="60"/></div></div>');break;case"submit":var ut,Jt,Le,ve,Jr;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><img src="${null!==(ut=null!==(Jt=e.image)&&void 0!==Jt&&Jt.path?(null===(Le=p.config)||void 0===Le?void 0:Le.readfileuploadurl)+(null===(ve=e.image)||void 0===ve?void 0:ve.path):null===(Jr=e.image)||void 0===Jr?void 0:Jr.url)&&void 0!==ut?ut:""}" style="width:100%;height:100%;display:block;"/></div>`)}jQuery(i).find("img[path],video[path],iframe[path]").each((xe,Gt)=>{var ee,Se;Gt.setAttribute("src",(null!==(ee=null===(Se=p.config)||void 0===Se?void 0:Se.readfileuploadurl)&&void 0!==ee?ee:"")+Gt.getAttribute("path")),Gt.removeAttribute("path")})}}}},N=(i,t,e,n)=>{let r=jQuery(n||p.target).find("#"+i).get(0);return r||(r=window.document.createElementNS("http://www.w3.org/2000/svg",t),r.setAttribute("id",i),jQuery(r).appendTo(n||p.target)),jQuery(r).attr((null==e?void 0:e.attribute)||{}),jQuery(r).css((null==e?void 0:e.style)||{}),r},I=(i,t)=>{let e=at(2),n={fill:"transparent",stroke:"#129bff","stroke-width":at(1)};return[{element:N("icdt-temp-create-rect-center","rect",{attribute:Object.assign({x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e},n)},i),posType:"rect-center"}]},G=(i,t)=>{let e=[],{size:n}=t,r=at(1),l=at(2),a=at(3),d=(at(5),at(7),at(10)),u={stroke:ot.stroke,"stroke-width":at(ot.strokeWidth),"stroke-linecap":ot.strokeLinecap,"stroke-dasharray":ot.strokeDasharrays.map(D=>at(D)).join(" ")},c={fill:"transparent",stroke:"transparent","stroke-width":at(1)},h={fill:"#FFFFFF",stroke:"#0D99FF","stroke-width":at(1),width:at(7),height:at(7)},f={fill:"#FFFFFF",stroke:"#0D99FF","stroke-width":at(1),width:at(7),height:at(7)},v=N("icdt-temp-resize-rect-center","rect",{attribute:Object.assign({x:n.x,y:n.y,width:n.width,height:n.height},c),style:{cursor:"move"}},i);if(N("icdt-temp-resize-line-left","line",{attribute:Object.assign({x1:n.x-r,y1:n.y-r,x2:n.x-r,y2:n.y+n.height+r},u)},i),N("icdt-temp-resize-line-top","line",{attribute:Object.assign({x1:n.x-r,y1:n.y-r,x2:n.x+n.width+r,y2:n.y-r},u)},i),N("icdt-temp-resize-line-right","line",{attribute:Object.assign({x1:n.x+n.width+r,y1:n.y-r,x2:n.x+n.width+r,y2:n.y+n.height+r},u)},i),N("icdt-temp-resize-line-bottom","line",{attribute:Object.assign({x1:n.x-r,y1:n.y+n.height+r,x2:n.x+n.width+r,y2:n.y+n.height+r},u)},i),t.type==L.LINE){var x;let{size:D}=t,E=[];return null===(x=D.ratios)||void 0===x||x.forEach(function(P){E.push([D.x+D.width*P[0],D.y+D.height*P[1]])}),E.forEach((P,F)=>{e.push({posType:`point-${F}`,element:N(`icdt-temp-resize-point-${F+1}`,"circle",{attribute:Object.assign(nt(L.CIRCLE,{x:P[0]-l-r,y:P[1]-l-r,width:f.width,height:f.height},{}),f)},i)})}),e.concat([{element:v,posType:"rect-center"}])}if(t.type==L.POLYGON){var w;let{size:D}=t,E=[];null===(w=D.ratios)||void 0===w||w.forEach(function(P){E.push([D.x+D.width*P[0],D.y+D.height*P[1]])}),E.forEach((P,F)=>{e.push({posType:`point-${F}`,element:N(`icdt-temp-resize-point-${F+1}`,"circle",{attribute:Object.assign(nt(L.CIRCLE,{x:P[0]-l-r,y:P[1]-l-r,width:f.width,height:f.height},{}),f)},i)})})}let S=N("icdt-temp-resize-rect-top-left","rect",{attribute:Object.assign({x:n.x-d,y:n.y-d},h),style:{cursor:"nw-resize"}},i),J=N("icdt-temp-resize-rect-top-right","rect",{attribute:Object.assign({x:n.x+n.width+a,y:n.y-d},h),style:{cursor:"ne-resize"}},i),j=N("icdt-temp-resize-rect-bottom-left","rect",{attribute:Object.assign({x:n.x-d,y:n.y+n.height+a},h),style:{cursor:"sw-resize"}},i),B=N("icdt-temp-resize-rect-bottom-right","rect",{attribute:Object.assign({x:n.x+n.width+a,y:n.y+n.height+a},h),style:{cursor:"se-resize"}},i),z=N("icdt-temp-resize-rect-left","rect",{attribute:Object.assign({x:n.x-d,y:n.y+n.height/2-l-r},h),style:{cursor:"w-resize"}},i),T=N("icdt-temp-resize-rect-top","rect",{attribute:Object.assign({x:n.x+n.width/2-l-r,y:n.y-d},h),style:{cursor:"n-resize"}},i),C=N("icdt-temp-resize-rect-right","rect",{attribute:Object.assign({x:n.x+n.width+a,y:n.y+n.height/2-l-r},h),style:{cursor:"e-resize"}},i),Q=N("icdt-temp-resize-rect-bottom","rect",{attribute:Object.assign({x:n.x+n.width/2-l-r,y:n.y+n.height+a},h),style:{cursor:"s-resize"}},i);return e.concat([{element:v,posType:"rect-center"},{element:S,posType:"rect-top-left"},{element:J,posType:"rect-top-right"},{element:j,posType:"rect-bottom-left"},{element:B,posType:"rect-bottom-right"},{element:z,posType:"rect-left"},{element:T,posType:"rect-top"},{element:C,posType:"rect-right"},{element:Q,posType:"rect-bottom"}])},U=(i,t,e)=>{let n=at(1),r=at(2),l=at(5),a={stroke:ot.stroke,"stroke-width":at(ot.strokeWidth),"stroke-linecap":ot.strokeLinecap},o={fill:"transparent",stroke:"transparent","stroke-width":at(1)},s={fill:"#FFFFFF",stroke:"#0D99FF","stroke-width":at(1),width:at(7),height:at(7)},d={fill:"#0D99FF",rx:at(4)},u={fill:"#fff","alignment-baseline":"central","text-anchor":"middle","font-size":at(14)},c={fill:Yt.fill,stroke:Yt.stroke,"stroke-width":at(Yt.strokeWidth)},y=(N("icdt-temp-resize-line-left","line",{attribute:Object.assign({x1:e.x-n,y1:e.y-n,x2:e.x-n,y2:e.y+e.height+n},a)},i),N("icdt-temp-resize-line-top","line",{attribute:Object.assign({x1:e.x-n,y1:e.y-n,x2:e.x+e.width+n,y2:e.y-n},a)},i),N("icdt-temp-resize-line-right","line",{attribute:Object.assign({x1:e.x+e.width+n,y1:e.y-n,x2:e.x+e.width+n,y2:e.y+e.height+n},a)},i),N("icdt-temp-resize-line-bottom","line",{attribute:Object.assign({x1:e.x-n,y1:e.y+e.height+n,x2:e.x+e.width+n,y2:e.y+e.height+n},a)},i),N("icdt-temp-resize-rect-center","rect",{attribute:Object.assign({x:e.x,y:e.y,width:e.width,height:e.height},o)},i)),g=`${e.width} x ${e.height}`,O=8*g.length;return N("icdt-temp-select-rect-text","rect",{attribute:Object.assign({x:e.x+e.width/2-at(O/2),y:e.y+e.height+at(10),width:at(O),height:at(20)},d)},i),N("icdt-temp-select-text","text",{attribute:Object.assign({x:e.x+e.width/2,y:e.y+e.height+at(20)},u)},i).textContent=g,t.length>1&&t.forEach(D=>{let{size:E}=D;N("icdt-temp-select-rect-node-"+D.id,"rect",{attribute:Object.assign({x:E.x,y:E.y,width:E.width,height:E.height},c)},i)}),[{element:y,posType:"rect-center"},{element:N("icdt-temp-resize-rect-top-left","rect",{attribute:Object.assign({x:e.x-l,y:e.y-l},s),style:{cursor:"nw-resize"}},i),posType:"rect-top-left"},{element:N("icdt-temp-resize-rect-top-right","rect",{attribute:Object.assign({x:e.x+e.width-r,y:e.y-l},s),style:{cursor:"ne-resize"}},i),posType:"rect-top-right"},{element:N("icdt-temp-resize-rect-bottom-left","rect",{attribute:Object.assign({x:e.x-l,y:e.y+e.height-r},s),style:{cursor:"sw-resize"}},i),posType:"rect-bottom-left"},{element:N("icdt-temp-resize-rect-bottom-right","rect",{attribute:Object.assign({x:e.x+e.width-r,y:e.y+e.height-r},s),style:{cursor:"se-resize"}},i),posType:"rect-bottom-right"},{element:N("icdt-temp-resize-rect-left","rect",{attribute:Object.assign({x:e.x-l,y:e.y+e.height/2-r-n},s),style:{cursor:"w-resize"}},i),posType:"rect-left"},{element:N("icdt-temp-resize-rect-top","rect",{attribute:Object.assign({x:e.x+e.width/2-r-n,y:e.y-l},s),style:{cursor:"n-resize"}},i),posType:"rect-top"},{element:N("icdt-temp-resize-rect-right","rect",{attribute:Object.assign({x:e.x+e.width-r,y:e.y+e.height/2-r-n},s),style:{cursor:"e-resize"}},i),posType:"rect-right"},{element:N("icdt-temp-resize-rect-bottom","rect",{attribute:Object.assign({x:e.x+e.width/2-r-n,y:e.y+e.height-r},s),style:{cursor:"s-resize"}},i),posType:"rect-bottom"}]},H=(i,t)=>{let e=at(1),n={stroke:ot.stroke,"stroke-width":at(ot.strokeWidth),"stroke-linecap":ot.strokeLinecap},r={fill:"transparent",stroke:"transparent","stroke-width":at(1)};return N("icdt-temp-scan-line-left","line",{attribute:Object.assign({x1:t.x-e,y1:t.y,x2:t.x-e,y2:t.y+t.height},n)},i),N("icdt-temp-scan-line-top","line",{attribute:Object.assign({x1:t.x,y1:t.y-e,x2:t.x+t.width,y2:t.y-e},n)},i),N("icdt-temp-scan-line-right","line",{attribute:Object.assign({x1:t.x+t.width+e,y1:t.y,x2:t.x+t.width+e,y2:t.y+t.height},n)},i),N("icdt-temp-scan-line-bottom","line",{attribute:Object.assign({x1:t.x,y1:t.y+t.height+e,x2:t.x+t.width,y2:t.y+t.height+e},n)},i),[{element:N("icdt-temp-scan-rect-center","rect",{attribute:Object.assign({x:t.x,y:t.y,width:t.width,height:t.height},r)},i),posType:"rect-center"}]},rt=(i,t)=>{let e={fill:"none",stroke:"#999","stroke-width":at(1),"stroke-dasharray":at(2)};jQuery(i).empty(),t.forEach(n=>{var r,l;let{size:a}=n;if(!n.idx)return;N("icdt-temp-index-rect-node-"+n.id,"rect",{attribute:Object.assign({x:a.x-5,y:a.y-5,width:a.width+10,height:a.height+10},e)},i);let{element:o}=de(Math.ceil(1e9*Math.random()),{size:{x:a.x-76,y:a.y-6,width:70,height:80},attribute:{},style:{},source:{type:"html",html:{htmlContent:`<div class="position-slide" style="position:relative;width:100%;height:100%;">\n                  <div style="position:absolute;top:0;right:0;line-height:22px;">\n                    <div title="Th\u1ee9 t\u1ef1 xu\u1ea5t hi\u1ec7n">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-play" style="margin:6px 0;color:#7da7d9;font-size:12px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="idx" value="${null!==(r=n.idx)&&void 0!==r?r:0}" min="0" max="999" step="1" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="Th\u1eddi gian \u0111\u1ee3i(s), n\u1ebfu gi\xe1 tr\u1ecb = 0 s\u1ebd chuy\u1ec3n sang \u0111\u1ee3i ho\xe0n t\u1ea5t ho\u1ea1t \u0111\u1ed9ng v\xe0 \xe2m thanh" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-clock-o" style="margin:5px 0;color:#7da7d9;font-size:14px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="time" value="${null!==(l=n.time)&&void 0!==l?l:0}" min="0" max="999" step="0.5" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="H\u1ee7y thi\u1ebft l\u1eadp" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <button name="remove" style="box-sizing:border-box;width:24px;height:24px;padding:0;border:1px solid #ddd;line-height: 0;outline:none;background:#eee;background: radial-gradient(#fff, #eee);">\n                            <img src="assets/icon-png/xoa2.png" height="18">\n                          </button>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                  </div>\n              </div>`}}},i);o.classList.add("node-input"),jQuery(o).on("change",'input[name="idx"]',s=>{var d;n.idx=parseInt(null!==(d=s.target.value)&&void 0!==d?d:"0")}).on("change",'input[name="time"]',s=>{var d;n.time=parseFloat(null!==(d=s.target.value)&&void 0!==d?d:"0")}).on("click",'button[name="remove"]',s=>{n.idx=0,n.time=null,rt(i,t)})})},st=(i,t)=>{var e,n,r,l,a,o;let{color:s,opacity:d,path:u,url:c,base64:h}=null!==(e=null==t||null===(n=t.svg)||void 0===n?void 0:n.background)&&void 0!==e?e:{},{x:f,y:v,width:b,height:y}=null!==(r=null==t||null===(l=t.svg)||void 0===l?void 0:l.viewBox)&&void 0!==r?r:{x:0,y:0,width:0,height:0};Ce(void 0,{size:{x:0,y:at(-10),width:100,height:20},attribute:{fill:"#999",textAnchor:"start",alignmentBaseline:"central",fontSize:at(12),class:"hide-on-viewer"},source:{type:"text",text:{textContent:null!==(a=null!==(o=null==t?void 0:t.name)&&void 0!==o?o:null==t?void 0:t.code)&&void 0!==a?a:void 0}}},i),Wt(void 0,{size:{x:f,y:v,width:b,height:y},attribute:{fill:"#fff",stroke:"#999",strokeWidth:at(1),strokeDasharray:at(10),class:"hide-on-viewer"}},i),s&&Wt(void 0,{size:{x:f,y:v,width:b,height:y},attribute:{fill:s,fillOpacity:d}},i),u&&ke(void 0,{size:{x:f,y:v,width:b,height:y},source:{type:"image",image:{path:u,url:c,base64:h}}},i)},ct=(i,t,e)=>{var n;switch(jQuery(i).empty(),null===(n=t.test)||void 0===n?void 0:n.type){case"truefalse":var r;if(null!==(r=t.test)&&void 0!==r&&r.showselection){var l,a,o;let z=null==t||null===(l=t.test)||void 0===l||null===(l=l.answer)||void 0===l||null===(l=l.truefalse)||void 0===l?void 0:l.value;null===(a=t.svg)||void 0===a||a.nodes.filter(T=>{var C;return"truefalse"==(null===(C=T.source)||void 0===C||null===(C=C.test)||void 0===C?void 0:C.type)&&T.id!=z}).forEach(T=>{var C;let{x:D,y:E,width:P,height:F}=null!==(C=null==T?void 0:T.size)&&void 0!==C?C:{x:0,y:0,width:0,height:0};ge(Math.ceil(1e9*Math.random()),{size:{x:D-.5,y:E-.5,width:P+1,height:F+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},i)}),null!=t&&null!==(o=t.test)&&void 0!==o&&null!==(o=o.answer)&&void 0!==o&&o.truefalse&&z&&(T=>{let C=V.findNode(z),{x:D,y:E,width:P,height:F}=null!==(T=null==C?void 0:C.size)&&void 0!==T?T:{x:0,y:0,width:0,height:0};ge(Math.ceil(1e9*Math.random()),{size:{x:D-2,y:E-2,width:P+4,height:F+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},i)})()}break;case"singlechoice":var s;if(null!==(s=t.test)&&void 0!==s&&s.showselection){var d,u,c;let z=null==t||null===(d=t.test)||void 0===d||null===(d=d.answer)||void 0===d||null===(d=d.singlechoice)||void 0===d?void 0:d.value;null===(u=t.svg)||void 0===u||u.nodes.filter(T=>{var C;return"singlechoice"==(null===(C=T.source)||void 0===C||null===(C=C.test)||void 0===C?void 0:C.type)&&T.id!=z}).forEach(T=>{var C;let{x:D,y:E,width:P,height:F}=null!==(C=null==T?void 0:T.size)&&void 0!==C?C:{x:0,y:0,width:0,height:0};ge(Math.ceil(1e9*Math.random()),{size:{x:D-.5,y:E-.5,width:P+1,height:F+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},i)}),null!=t&&null!==(c=t.test)&&void 0!==c&&null!==(c=c.answer)&&void 0!==c&&c.singlechoice&&z&&(T=>{let C=V.findNode(z),{x:D,y:E,width:P,height:F}=null!==(T=null==C?void 0:C.size)&&void 0!==T?T:{x:0,y:0,width:0,height:0};ge(Math.ceil(1e9*Math.random()),{size:{x:D-2,y:E-2,width:P+4,height:F+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},i)})()}break;case"multichoice":var h;if(null!==(h=t.test)&&void 0!==h&&h.showselection){var f,v,b,y;let z=null!==(f=null==t||null===(v=t.test)||void 0===v||null===(v=v.answer)||void 0===v||null===(v=v.multichoice)||void 0===v?void 0:v.map(T=>T.value))&&void 0!==f?f:[];var g;null===(b=t.svg)||void 0===b||b.nodes.filter(T=>{var C;return"multichoice"==(null===(C=T.source)||void 0===C||null===(C=C.test)||void 0===C?void 0:C.type)&&!z.includes(T.id)}).forEach(T=>{var C;let{x:D,y:E,width:P,height:F}=null!==(C=null==T?void 0:T.size)&&void 0!==C?C:{x:0,y:0,width:0,height:0};Wt(Math.ceil(1e9*Math.random()),{size:{x:D-.5,y:E-.5,width:P+1,height:F+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},i)}),null!=t&&null!==(y=t.test)&&void 0!==y&&null!==(y=y.answer)&&void 0!==y&&y.multichoice&&z.length&&(null==t||null===(g=t.test)||void 0===g||null===(g=g.answer)||void 0===g||g.multichoice.forEach(T=>{var C;let Q=V.findNode(T.value),{x:E,y:P,width:F,height:M}=null!==(C=null==Q?void 0:Q.size)&&void 0!==C?C:{x:0,y:0,width:0,height:0};Wt(Math.ceil(1e9*Math.random()),{size:{x:E-2,y:P-2,width:F+4,height:M+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},i)}))}break;case"fill":var O,x;null!=t&&null!==(O=t.test)&&void 0!==O&&null!==(O=O.answer)&&void 0!==O&&O.fill&&(null==t||null===(x=t.test)||void 0===x||null===(x=x.answer)||void 0===x||x.fill.forEach(z=>{jQuery("#"+e.id).find(`input[type="text"][data-key="${z.key}"]`).val(z.value)}));break;case"matching":var w,S,J,j;if(null!=t&&null!==(w=t.test)&&void 0!==w&&null!==(w=w.answer)&&void 0!==w&&w.matching)if("matching-empty"==(null===(S=e.source)||void 0===S||null===(S=S.test)||void 0===S?void 0:S.type))null==t||null===(j=t.test)||void 0===j||null===(j=j.answer)||void 0===j||j.matching.filter(z=>{var T;return z.key==(null===(T=e.source)||void 0===T||null===(T=T.test)||void 0===T||null===(T=T.matching)||void 0===T?void 0:T.key)}).forEach(z=>{});else if("matching-content"==(null===(J=e.source)||void 0===J||null===(J=J.test)||void 0===J?void 0:J.type)){var B;null==t||null===(B=t.test)||void 0===B||null===(B=B.answer)||void 0===B||B.matching.filter(z=>{var T;return z.value==(null===(T=e.source)||void 0===T||null===(T=T.test)||void 0===T||null===(T=T.matching)||void 0===T?void 0:T.key)}).forEach(z=>{})}}};class kt{constructor(t){this._points=[],this._options=t}start(t){this._points.length=0,this._points.push([t.x,t.y]),this._options.start(t)}move(t,e){this._points.push([t.x,t.y]),this._options.move(t,this._points,e)}end(){this._options.end(this.offsetLast,this._points)}get offsetFirst(){return this._points.length>=1?{x:(t=this._points[0])[0],y:t[1]}:{x:0,y:0};var t}get offsetLast(){return this._points.length>=1?{x:(t=this._points[this._points.length-1])[0],y:t[1]}:{x:0,y:0};var t}}const At=(i,t,e,n)=>(i.x-=n.x,i.y-=n.y,i.x/=t,i.y/=t,i.x-=e.x,i.y-=e.y,i.x=A(i.x),i.y=A(i.y),i),Tt=(i,t,e,n,r)=>{var l,a,o;let s=null,d=0,u=0;i.mouseEvent?(s=i.mouseEvent.target,d=i.mouseEvent.offsetX,u=i.mouseEvent.offsetY):i.touchEvent&&(s=i.touchEvent.target,i.touchEvent.touches.length&&(d=i.touchEvent.touches[0].clientX,u=i.touchEvent.touches[0].clientY));let c=null!=e?e:p.screen.scale,h=null!=n?n:p.screen.dislocation,f=null!=r?r:p.screen.offset,v=()=>{};var b=new kt({start:null!==(l=null==t?void 0:t.start)&&void 0!==l?l:v,move:null!==(a=null==t?void 0:t.move)&&void 0!==a?a:v,end:null!==(o=null==t?void 0:t.end)&&void 0!==o?o:v});i.mouseEvent?b.start(At({x:d,y:u},c,h,{x:0,y:0})):i.touchEvent&&b.start(At({x:d,y:u},c,h,f));let y=j=>{b.move(At({x:j.clientX,y:j.clientY},c,h,f),{ctrlKey:j.ctrlKey,shiftKey:j.shiftKey,altKey:j.altKey})},g=j=>{b.end(),[vt.SHAPE,vt.FOREIGNOBJECT,vt.IMAGE,vt.TEXT].includes(p.pointer.pointer_type)&&(j.shiftKey||(p.pointer.pointer_type=vt.POINTER))},O=j=>{j.touches.length&&y({clientX:j.touches[0].clientX,clientY:j.touches[0].clientY,ctrlKey:j.ctrlKey,shiftKey:j.shiftKey,altKey:j.altKey})},x=j=>{g({ctrlKey:j.ctrlKey,shiftKey:j.shiftKey,altKey:j.altKey}),window.removeEventListener("touchmove",O,!1),window.removeEventListener("touchend",x,!1)},w=j=>{0==j.button&&y({clientX:j.clientX,clientY:j.clientY,ctrlKey:j.ctrlKey,shiftKey:j.shiftKey,altKey:j.altKey})},S=j=>{0==j.button&&(g({shiftKey:j.shiftKey,ctrlKey:j.ctrlKey,altKey:j.altKey}),window.removeEventListener("mousemove",w,!1),window.removeEventListener("mouseup",S,!1))};if(i.mouseEvent)window.addEventListener("mousemove",w,!1),window.addEventListener("mouseup",S,!1);else if(i.touchEvent){var J;window.addEventListener("touchmove",O,!1),window.addEventListener("touchend",x,!1),null===(J=s)||void 0===J||J.addEventListener("touchmove",function(j){j.preventDefault()})}},on=(i,t,e,n,r)=>{let{x:l,y:a,width:o,height:s}=e;0==o&&(o=1),0==s&&(s=1);let d=n.map(y=>Object.assign({},y.size)),c=[],v=!1;Tt(i,{start:y=>{n.forEach(y=>{let{id:g,size:O,attribute:x}=y;c.push({id:g,type:"size",from:JSON.parse(JSON.stringify({id:g,size:O,attribute:x}))})})},move:(y,g,O)=>{((y,g,O,x,w)=>{let S=O-y,J=x-g;(()=>{let B,j=(o||1)/(s||1);switch(t){case"rect-center":B=null!=w&&w.shiftKey?Math.abs(O-y)>=Math.abs(x-g)?{x:l+O-y,y:a,width:o,height:s}:{x:l,y:a+x-g,width:o,height:s}:{x:l+O-y,y:a+x-g,width:o,height:s};break;case"rect-top-left":B=null!=w&&w.shiftKey&&null!=w&&w.altKey?j>=1?{x:l+(O-y),y:a+(O-y)/j,width:o-2*(O-y),height:s-2*(O-y)/j}:{x:l+(x-g)*j,y:a+(x-g),width:o-2*(x-g)*j,height:s-2*(x-g)}:null!=w&&w.shiftKey?j>=1?{x:l+(O-y),y:a+(O-y)/j,width:o-(O-y),height:s-(O-y)/j}:{x:l+(x-g)*j,y:a+(x-g),width:o-(x-g)*j,height:s-(x-g)}:null!=w&&w.altKey?{x:l+(O-y),y:a+(x-g),width:o-2*(O-y),height:s-2*(x-g)}:{x:l+(O-y),y:a+(x-g),width:o-(O-y),height:s-(x-g)};break;case"rect-top-right":B=null!=w&&w.shiftKey&&null!=w&&w.altKey?j>=1?{x:l-(O-y),y:a-(O-y)/j,width:o+2*(O-y),height:s+2*(O-y)/j}:{x:l+(x-g)*j,y:a+(x-g),width:o-2*(x-g)*j,height:s-2*(x-g)}:null!=w&&w.shiftKey?j>=1?{x:l,y:a-(O-y)/j,width:o+(O-y),height:s+(O-y)/j}:{x:l,y:a+(x-g),width:o-(x-g)*j,height:s-(x-g)}:null!=w&&w.altKey?{x:l-(O-y),y:a+(x-g),width:o+2*(O-y),height:s-2*(x-g)}:{x:l,y:a+(x-g),width:o+(O-y),height:s-(x-g)};break;case"rect-bottom-left":B=null!=w&&w.shiftKey&&null!=w&&w.altKey?j>=1?{x:l+(O-y),y:a+(O-y)/j,width:o-2*(O-y),height:s-2*(O-y)/j}:{x:l-(x-g)*j,y:a-(x-g),width:o+2*(x-g)*j,height:s+2*(x-g)}:null!=w&&w.shiftKey?j>=1?{x:l+(O-y),y:a,width:o-(O-y),height:s-(O-y)/j}:{x:l-(x-g)*j,y:a,width:o+(x-g)*j,height:s+(x-g)}:null!=w&&w.altKey?{x:l+(O-y),y:a-(x-g),width:o-2*(O-y),height:s+2*(x-g)}:{x:l+(O-y),y:a,width:o-(O-y),height:s+(x-g)};break;case"rect-bottom-right":B=null!=w&&w.shiftKey&&null!=w&&w.altKey?j>=1?{x:l-(O-y),y:a-(O-y)/j,width:o+2*(O-y),height:s+2*(O-y)/j}:{x:l-(x-g)*j,y:a-(x-g),width:o+2*(x-g)*j,height:s+2*(x-g)}:null!=w&&w.shiftKey?j>=1?{x:l,y:a,width:o+(O-y),height:s+(O-y)/j}:{x:l,y:a,width:o+(x-g)*j,height:s+(x-g)}:null!=w&&w.altKey?{x:l-(O-y),y:a-(x-g),width:o+2*(O-y),height:s+2*(x-g)}:{x:l,y:a,width:o+(O-y),height:s+(x-g)};break;case"rect-top":B=null!=w&&w.shiftKey?{x:l+J/2*j,y:a+J,width:o-J*j,height:s-J}:null!=w&&w.altKey?{x:l,y:a+J,width:o,height:s-2*J}:{x:l,y:a+J,width:o,height:s-J};break;case"rect-bottom":B=null!=w&&w.shiftKey?{x:l-J/2*j,y:a,width:o+J*j,height:s+J}:null!=w&&w.altKey?{x:l,y:a-J,width:o,height:s+2*J}:{x:l,y:a,width:o,height:s+J};break;case"rect-left":B=null!=w&&w.shiftKey?{x:l+S,y:a+S/2/j,width:o-S,height:s-S/j}:null!=w&&w.altKey?{x:l+S,y:a,width:o-2*S,height:s}:{x:l+S,y:a,width:o-S,height:s};break;case"rect-right":B=null!=w&&w.shiftKey?{x:l,y:a-S/2/j,width:o+S,height:s+S/j}:null!=w&&w.altKey?{x:l-S,y:a,width:o+2*S,height:s}:{x:l,y:a,width:o+S,height:s};break;default:B={x:l+O-y,y:a+x-g,width:o,height:s}}B.width<=0&&(B.width=1),B.height<=0&&(B.height=1),B.x=A(B.x,1),B.y=A(B.y,1),B.width=A(B.width,1),B.height=A(B.height,1),Object.assign(e,B),U(r,n,B),(()=>{let z=l-B.x,T=a-B.y,C=(B.width-o)/o,Q=(B.height-s)/s;n.forEach((D,E)=>{let P=d[E],M=a-P.y,K={x:A(P.x-(z+(l-P.x)*C),100),y:A(P.y-(T+M*Q),100),width:A(P.width+P.width*C,100),height:A(P.height+P.height*Q,100)},{id:W,type:tt,size:Z,attribute:X}=D;Object.assign(Z,K),Object.assign(X,nt(tt,Z,X)),m(window.document.getElementById(W),X)})})()})()})(g[0][0],g[0][1],y.x,y.y,O),v=!0},end:(y,g)=>{v&&(n.forEach(y=>{let{id:g,size:O,attribute:x}=y,w=c.find(S=>S.id==g);w&&(w.to=JSON.parse(JSON.stringify({id:g,size:O,attribute:x})))}),p.history.push(c))}})},sn=(i,t,e,n)=>{let v,{id:r,type:l,size:a,attribute:o}=e,{x:s,y:d,width:u,height:c,ratios:h}=a,f=(u||1)/(c||1),y=null,x=!1;Tt(i,{start:S=>{y=JSON.parse(JSON.stringify({id:r,size:a,attribute:o}))},move:(S,J,j)=>{((S,J,j,B,z)=>{let T=j-S,C=B-J;switch(t){case"rect-center":v=null!=z&&z.shiftKey?Math.abs(T)>=Math.abs(C)?{x:s+T,y:d,width:u,height:c}:{x:s,y:d+C,width:u,height:c}:{x:s+T,y:d+C,width:u,height:c};break;case"rect-top-left":v=null!=z&&z.shiftKey&&null!=z&&z.altKey?f>=1?{x:s+T,y:d+T/f,width:u-2*T,height:c-2*T/f}:{x:s+C*f,y:d+C,width:u-2*C*f,height:c-2*C}:null!=z&&z.shiftKey?f>=1?{x:s+T,y:d+T/f,width:u-T,height:c-T/f}:{x:s+C*f,y:d+C,width:u-C*f,height:c-C}:null!=z&&z.altKey?{x:s+T,y:d+C,width:u-2*T,height:c-2*C}:{x:s+T,y:d+C,width:u-T,height:c-C};break;case"rect-top-right":v=null!=z&&z.shiftKey&&null!=z&&z.altKey?f>=1?{x:s-T,y:d-T/f,width:u+2*T,height:c+2*T/f}:{x:s+C*f,y:d+C,width:u-2*C*f,height:c-2*C}:null!=z&&z.shiftKey?f>=1?{x:s,y:d-T/f,width:u+T,height:c+T/f}:{x:s,y:d+C,width:u-C*f,height:c-C}:null!=z&&z.altKey?{x:s-T,y:d+C,width:u+2*T,height:c-2*C}:{x:s,y:d+C,width:u+T,height:c-C};break;case"rect-bottom-left":v=null!=z&&z.shiftKey&&null!=z&&z.altKey?f>=1?{x:s+T,y:d+T/f,width:u-2*T,height:c-2*T/f}:{x:s-C*f,y:d-C,width:u+2*C*f,height:c+2*C}:null!=z&&z.shiftKey?f>=1?{x:s+T,y:d,width:u-T,height:c-T/f}:{x:s-C*f,y:d,width:u+C*f,height:c+C}:null!=z&&z.altKey?{x:s+T,y:d-C,width:u-2*T,height:c+2*C}:{x:s+T,y:d,width:u-T,height:c+C};break;case"rect-bottom-right":v=null!=z&&z.shiftKey&&null!=z&&z.altKey?f>=1?{x:s-T,y:d-T/f,width:u+2*T,height:c+2*T/f}:{x:s-C*f,y:d-C,width:u+2*C*f,height:c+2*C}:null!=z&&z.shiftKey?f>=1?{x:s,y:d,width:u+T,height:c+T/f}:{x:s,y:d,width:u+C*f,height:c+C}:null!=z&&z.altKey?{x:s-T,y:d-C,width:u+2*T,height:c+2*C}:{x:s,y:d,width:u+T,height:c+C};break;case"rect-top":v=null!=z&&z.shiftKey?{x:s+C/2*f,y:d+C,width:u-C*f,height:c-C}:null!=z&&z.altKey?{x:s,y:d+C,width:u,height:c-2*C}:{x:s,y:d+C,width:u,height:c-C};break;case"rect-bottom":v=null!=z&&z.shiftKey?{x:s-C/2*f,y:d,width:u+C*f,height:c+C}:null!=z&&z.altKey?{x:s,y:d-C,width:u,height:c+2*C}:{x:s,y:d,width:u,height:c+C};break;case"rect-left":v=null!=z&&z.shiftKey?{x:s+T,y:d+T/2/f,width:u-T,height:c-T/f}:null!=z&&z.altKey?{x:s+T,y:d,width:u-2*T,height:c}:{x:s+T,y:d,width:u-T,height:c};break;case"rect-right":v=null!=z&&z.shiftKey?{x:s,y:d-T/2/f,width:u+T,height:c+T/f}:null!=z&&z.altKey?{x:s-T,y:d,width:u+2*T,height:c}:{x:s,y:d,width:u+T,height:c};break;default:v=t.match(/^point-(\d+)/)?{x:s,y:d,width:u,height:c}:{x:s+T,y:d+C,width:u,height:c}}v.width<=0&&(v.width=1),v.height<=0&&(v.height=1);let Q=t.match(/^point-(\d+)/);if(Q){let E=parseInt(Q[1]);if("number"==typeof E){var D;v.ratios=null==h?void 0:h.map((K,W)=>W==E?[A(K[0]+(0==v.width?0:T/v.width),100),A(K[1]+(0==v.height?0:C/v.height),100)]:K);let P=lr(v.x,v.y,v.width,v.height,null!==(D=v.ratios)&&void 0!==D?D:[]),F=ha(P),M=dn(F.x,F.y,F.width,F.height,P);v={x:F.x,y:F.y,width:F.width,height:F.height,ratios:M}}}v.x=A(v.x,1),v.y=A(v.y,1),v.width=A(v.width,1),v.height=A(v.height,1),Object.assign(a,v),Object.assign(o,nt(l,a,o)),m(window.document.getElementById(r),o),G(n,e)})(J[0][0],J[0][1],S.x,S.y,j),x=!0},end:(S,J)=>{x&&y&&p.history.push([{type:"size",from:y,to:JSON.parse(JSON.stringify({id:r,size:a,attribute:o}))}])}})},lr=(i,t,e,n,r)=>r.map(l=>[i+e*l[0],t+n*l[1]]),dn=(i,t,e,n,r)=>r.map(l=>[0==e?0:A((l[0]-i)/e,100),0==n?0:A((l[1]-t)/n,100)]),ha=i=>{let t=[],e=[];i.map(o=>{t.push(o[0]),e.push(o[1])});let n=Math.min.apply(null,t),r=Math.min.apply(null,e);return{x:n,y:r,width:Math.max.apply(null,t)-n||1,height:Math.max.apply(null,e)-r||1}},$t=i=>{i.length>1?(i=>{let t=999999,e=999999,n=-999999,r=-999999;i.forEach(o=>{t=Math.min(t,o.size.x),e=Math.min(e,o.size.y),n=Math.max(n,o.size.x+o.size.width),r=Math.max(r,o.size.y+o.size.height)});let l=N(lt.RESIZE_GROUP,"g"),a=Ht(t,e,n,r);a.x=A(a.x,100),a.y=A(a.y,100),a.width=A(a.width,100),a.height=A(a.height,100),U(l,i,a).forEach(o=>{((i,t,e,n,r)=>{let l=!1;null==i||i.addEventListener("touchstart",a=>{l=!0,on({touchEvent:a},t,e,n,r)}),null==i||i.addEventListener("mousedown",a=>{if(0==a.button){if(l)return void(l=!1);on({mouseEvent:a},t,e,n,r)}})})(o.element,o.posType,a,i,l)})})(i):1==i.length&&(i=>{let t=N(lt.RESIZE_GROUP,"g");if(i.length>0){let e=i[0];G(t,e).forEach(n=>{((i,t,e,n)=>{let r=!1;null==i||i.addEventListener("touchstart",l=>{r=!0,sn({touchEvent:l},t,e,n)}),null==i||i.addEventListener("mousedown",l=>{if(0==l.button){if(r)return void(r=!1);sn({mouseEvent:l},t,e,n)}})})(n.element,n.posType,e,t)})}})(i)},ga=(i,t,e)=>{let{id:n,type:r,source:l}=i,a=JSON.parse(JSON.stringify({id:n,type:r,source:l}));var o;if(l)if(l.text){var d;l.text.textContent=t,l.text.variableKeywords=null!==(d=(null!=t?t:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==d?d:[]}else{var s;l.text={textContent:t,variableKeywords:null!==(s=(null!=t?t:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==s?s:[]}}else l={text:{textContent:t,variableKeywords:null!==(o=(null!=t?t:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==o?o:[]}};e||k(window.document.getElementById(n),r,l),p.history.push([{type:"source",from:a,to:JSON.parse(JSON.stringify({id:n,type:r,source:l}))}])},Lr=(i,t,e)=>{var n;let{id:r,type:l,source:a}=i,o=JSON.parse(JSON.stringify({id:r,type:l,source:a})),s=u=>{var c;return null!==(c=(null!=u?u:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==c?c:[]},d=u=>{var c;return(null!==(c=(null!=u?u:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==c?c:[]).filter((f,v,b)=>b.indexOf(f)==v)};a?a.html?(a.html.htmlContent=t,a.html.variableKeywords=s(t),a.html.fillKeywords=d(t)):a.html={htmlContent:t,variableKeywords:s(t),fillKeywords:d(t)}:a={html:{htmlContent:t,variableKeywords:s(t),fillKeywords:d(t)}},"fill"==(null===(n=a.test)||void 0===n?void 0:n.type)&&(a.test.fill=d(t).map(u=>{var c,h;return{key:u,value:null!==(c=null===(h=a)||void 0===h||null===(h=h.test)||void 0===h||null===(h=h.fill)||void 0===h||null===(h=h.find(f=>f.key==u))||void 0===h?void 0:h.value)&&void 0!==c?c:[]}})),e||k(window.document.getElementById(r),l,a),p.history.push([{type:"source",from:o,to:JSON.parse(JSON.stringify({id:r,type:l,source:a}))}])},ya=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.link?(r.link.url=t.url,r.link.title=t.title,r.link.description=t.description):r.link=t:r={link:t},k(window.document.getElementById(e),n,r),p.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},pa=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.image?(r.image.url=null==t?void 0:t.url,r.image.path=null==t?void 0:t.path,r.image.name=null==t?void 0:t.name,r.image.base64=void 0):r.image=t:r={image:t},k(window.document.getElementById(e),n,r),p.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},ma=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.audio?(r.audio.url=t.url,r.audio.path=t.path,r.audio.name=t.name):r.audio=t:r={audio:t},k(window.document.getElementById(e),n,r),p.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},wa=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.video?(r.video.url=t.url,r.video.path=t.path,r.video.name=t.name):r.video=t:r={video:t},k(window.document.getElementById(e),n,r),p.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},ba=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.file?(r.file.url=t.url,r.file.path=t.path,r.file.name=t.name):r.file=t:r={file:t},k(window.document.getElementById(e),n,r),p.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},xa=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.iframe?(r.iframe.url=null==t?void 0:t.url,r.iframe.path=null==t?void 0:t.path,r.iframe.name=null==t?void 0:t.name):r.iframe=t:r={iframe:t},k(window.document.getElementById(e),n,r),p.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},Sa=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.input?r.input.placeholder=t:r.input={placeholder:t}:r={input:{placeholder:t}},k(window.document.getElementById(e),n,r),p.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},ka=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.embed?(r.embed.type=null==t?void 0:t.type,r.embed.oss=null==t?void 0:t.oss,r.embed.name=null==t?void 0:t.name,r.embed.path=null==t?void 0:t.path,r.embed.url=null==t?void 0:t.url):r.embed=t:r={embed:t},k(window.document.getElementById(e),n,r),p.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},Na=i=>{var t,e,n,r,l,a,o;let s=(null===(t=i.mouseEvent)||void 0===t?void 0:t.target)||(null===(e=i.touchEvent)||void 0===e?void 0:e.target),d=(null===(n=s)||void 0===n?void 0:n.getAttribute("id"))||"",u=null===(r=s)||void 0===r?void 0:r.nodeName;p.dataSelect.nodeName.includes(u)||(s=jQuery(s).parents("foreignObject").get(0),s&&(d=s.getAttribute("id")||"",u=s.nodeName));let c=(null===(l=s)||void 0===l||null===(l=l.parentNode)||void 0===l?void 0:l.getAttribute("id"))||"";var h,f,v;if([lt.RESIZE_GROUP,lt.SELECT_GROUP].includes(c))return null===(h=i.mouseEvent)||void 0===h||h.stopPropagation(),null===(f=i.mouseEvent)||void 0===f||f.preventDefault(),void("dblclick"==(null===(v=i.mouseEvent)||void 0===v?void 0:v.type)&&1==p.dataSelect.ids.length&&(i=>{if(1==i.length){p.dataSelect.openEditable();let t=i[0],e=$(`#${t.id}`).find("[contenteditable]");e.on("input",()=>{Lr(t,e.html(),!0)}).on("focusout",()=>{p.dataSelect.closeEditable()}).focus();let n=e.get(0);if(n){let r=document.createRange(),l=window.getSelection();l&&(r.selectNodeContents(n),l.removeAllRanges(),l.addRange(r))}}})(p.dataSelect.nodes));if(null!==(a=i.mouseEvent)&&void 0!==a&&a.altKey||null!==(o=i.touchEvent)&&void 0!==o&&o.altKey||!d||d.match(/[^0-9]/)||!p.dataSelect.nodeName.includes(u)){var b;p.dataSelect.ids.length&&(p.dataSelect.ids=[]),(0==(null===(b=i.mouseEvent)||void 0===b?void 0:b.button)||i.touchEvent)&&(i=>{let l=N(lt.SCAN_GROUP,"g"),a=Ht(0,0,1,1);H(l,a),((i,t,e)=>{Tt(i,{start:l=>{},move:(l,a)=>{((l,a,o,s)=>{t=Ht(l,a,o,s),H(e,t)})(a[0][0],a[0][1],l.x,l.y)},end:(l,a)=>{null==e||e.remove(),p.dataSelect.ids=p.data.getNodeInArea(Math.min(a[0][0],l.x),Math.min(a[0][1],l.y),Math.max(a[0][0],l.x),Math.max(a[0][1],l.y)),$t(p.dataSelect.nodes)}})})(i,a,l)})(i)}else{var y,g;let O=parseFloat(d||"0");if(O==p.dataSelect.contenteditable_id)return;p.dataSelect.ids=null!==(y=i.mouseEvent)&&void 0!==y&&y.shiftKey||null!==(g=i.touchEvent)&&void 0!==g&&g.shiftKey?[O].concat(p.dataSelect.ids).filter((x,w,S)=>S.indexOf(x)==w):[O],$t(p.dataSelect.nodes)}};class Ea{constructor(){let{x:t,y:e}=p.screen.dislocation;var n=(r,l,a,o)=>{p.screen.move({x:t,y:e},{x:a-r,y:o-l})};return{start:r=>{},move:(r,l)=>{n(l[0][0],l[0][1],r.x,r.y)},end:(r,l)=>{n(l[0][0],l[0][1],r.x,r.y)}}}}class Ta{constructor(){let t=N(lt.CREATE_GROUP,"g"),{nodeId:e,element:n,attribute:r,size:l}=ge(Math.ceil(1e9*Math.random())),a=(o,s,d,u)=>{l=Ht(o,s,d,u,{ratio:1}),l.x=A(l.x),l.y=A(l.y),l.width=A(l.width),l.height=A(l.height),Object.assign(r,nt(L.CIRCLE,l,r)),m(n,r),I(t,l)};return{start:o=>{a(o.x,o.y,o.x+l.width,o.y+l.height)},move:(o,s)=>{a(s[0][0],s[0][1],o.x,o.y)},end:(o,s)=>{(l.width<=8||l.height<=8)&&(l.width=80,l.height=80,l.x=l.x-l.width/2,l.y=l.y-l.height/2,Object.assign(r,nt(L.CIRCLE,l,r)),m(n,r)),p.data.node=Object.assign({id:e,type:L.CIRCLE,name:"Circle"},{size:l,attribute:r}),null==t||t.remove()}}}}class Ia{constructor(){let t=N(lt.CREATE_GROUP,"g"),{nodeId:e,element:n,attribute:r,size:l}=Ii(Math.ceil(1e9*Math.random()));var a=(o,s,d,u)=>{l=Ht(o,s,d,u),l.x=A(l.x),l.y=A(l.y),l.width=A(l.width),l.height=A(l.height),Object.assign(r,nt(L.ELLIPSE,l,r)),m(n,r),I(t,l)};return{start:o=>{a(o.x,o.y,o.x+l.width,o.y+l.height)},move:(o,s)=>{a(s[0][0],s[0][1],o.x,o.y)},end:(o,s)=>{l.width<4&&(l.width=4),l.height<4&&(l.height=4),l.width+l.height<8&&(l.width=90,l.height=60,l.x=l.x-l.width/2,l.y=l.y-l.height/2,Object.assign(r,nt(L.ELLIPSE,l,r)),m(n,r)),p.data.node=Object.assign({id:e,type:L.ELLIPSE,name:"Ellipse"},{size:l,attribute:r}),null==t||t.remove()}}}}class Aa{constructor(){let t=N(lt.CREATE_GROUP,"g"),{nodeId:e,element:n,attribute:r,size:l}=Wt(Math.ceil(1e9*Math.random()));var a=(o,s,d,u)=>{l=Ht(o,s,d,u),l.x=A(l.x),l.y=A(l.y),l.width=A(l.width),l.height=A(l.height),Object.assign(r,nt(L.RECT,l,r)),m(n,r),I(t,l)};return{start:o=>{a(o.x,o.y,o.x+l.width,o.y+l.height)},move:(o,s)=>{a(s[0][0],s[0][1],o.x,o.y)},end:(o,s)=>{l.width<1&&(l.width=1),l.height<1&&(l.height=1),l.width+l.height<8&&(l.width=80,l.height=80,l.x=l.x-l.width/2,l.y=l.y-l.height/2,Object.assign(r,nt(L.RECT,l,r)),m(n,r)),p.data.node=Object.assign({id:e,type:L.RECT,name:"Rect"},{size:l,attribute:r}),null==t||t.remove()}}}}class Ca{constructor(t){let e=N(lt.CREATE_GROUP,"g"),n=t||[[0,0],[1,1],[0,1]],{nodeId:r,element:l,attribute:a,size:o}=Ci(Math.ceil(1e9*Math.random()));o.ratios=n;var s=(d,u,c,h)=>{o=Ht(d,u,c,h,{ratios:n}),o.x=A(o.x),o.y=A(o.y),o.width=A(o.width),o.height=A(o.height),Object.assign(a,nt(L.POLYGON,o,a)),m(l,a),I(e,o)};return{start:d=>{s(d.x,d.y,d.x+o.width,d.y+o.height)},move:(d,u)=>{s(u[0][0],u[0][1],d.x,d.y)},end:(d,u)=>{o.width<1&&(o.width=1),o.height<1&&(o.height=1),o.width+o.height<8&&(o.width=80,o.height=80,o.x=o.x-o.width/2,o.y=o.y-o.height/2,Object.assign(a,nt(L.POLYGON,o,a)),m(l,a)),p.data.node=Object.assign({id:r,type:L.POLYGON,name:"Polygon"},{size:o,attribute:a}),null==e||e.remove()}}}}class Ja{constructor(){let t=N(lt.CREATE_GROUP,"g"),{nodeId:e,element:n,attribute:r,size:l}=Ai(Math.ceil(1e9*Math.random()));return{start:o=>{},move:(o,s)=>{((o,s,d,u)=>{l=Ht(o,s,d,u),l.x=A(l.x),l.y=A(l.y),l.width=A(l.width),l.height=A(l.height),Object.assign(r,nt(L.LINE,l,r)),m(n,r),I(t,l)})(s[0][0],s[0][1],o.x,o.y)},end:(o,s)=>{s.length>=2?(l.width<8&&(l.width=0),l.height<8&&(l.height=0),l.width+l.height<8&&(l.width=80,l.height=0,l.x=l.x-l.width/2,l.y=l.y-l.height/2,Object.assign(r,nt(L.LINE,l,r)),m(n,r)),p.data.node=Object.assign({id:e,type:L.LINE,name:"Line"},{size:l,attribute:r})):null==n||n.remove(),null==t||t.remove()}}}}class Br{constructor(){let{nodeId:t,element:e,attribute:n,size:r}=Ne(Math.ceil(1e9*Math.random())),a="";return{start:s=>{a=`M ${s.x} ${s.y} L ${s.x} ${s.y}`},move:(s,d)=>{((s,d)=>{a+=` ${s} ${d}`,e.setAttribute("d",a)})(s.x,s.y)},end:(s,d)=>{let u=Be(a),{minX:c,minY:h,maxX:f,maxY:v}=He(u);r.x=c,r.y=h,r.width=f-c||1,r.height=v-h||1,r.ratioMaps=Vt(r,u),p.data.node=Object.assign({id:t,type:L.PATH,name:"Path"},{size:r,attribute:n})}}}}class Pr{constructor(){let t=N(lt.CREATE_GROUP,"g"),{nodeId:e,element:n,size:r,attribute:l,style:a,source:o}=de(Math.ceil(1e9*Math.random()));var s=(d,u,c,h)=>{r=Ht(d,u,c,h),r.x=A(r.x),r.y=A(r.y),r.width=A(r.width),r.height=A(r.height),Object.assign(l,nt(L.FOREIGNOBJECT,r,l)),m(n,l),I(t,r)};return{start:d=>{s(d.x,d.y,d.x+r.width,d.y+r.height)},move:(d,u)=>{s(u[0][0],u[0][1],d.x,d.y)},end:(d,u)=>{(r.width<=16||r.height<=16)&&(r.width=90,r.height=60,r.x=r.x-r.width/2,r.y=r.y-r.height/2,Object.assign(l,nt(L.FOREIGNOBJECT,r,l)),m(n,l)),p.data.node=Object.assign({id:e,type:L.FOREIGNOBJECT,name:"ForeignObject"},{size:r,attribute:l,style:a,source:o}),null==t||t.remove()}}}}class Mr{constructor(){var t,e;let n=N(lt.CREATE_GROUP,"g"),{nodeId:r,element:l,size:a,attribute:o,source:s}=ke(Math.ceil(1e9*Math.random())),d=1;(c=>{if(!c)return;let h=new Image;h.onload=()=>{d=A(h.naturalWidth/h.naturalHeight,100)},h.onerror=f=>{console.error(`ImgSrc load failed -> ${c}`,f)},h.src=c})(null!==(t=null===(e=s.image)||void 0===e?void 0:e.url)&&void 0!==t?t:"");var u=(c,h,f,v)=>{a=Ht(c,h,f,v,{ratio:d}),a.x=A(a.x),a.y=A(a.y),a.width=A(a.width),a.height=A(a.height),Object.assign(o,nt(L.IMAGE,a,o)),m(l,o),I(n,a)};return{start:c=>{u(c.x,c.y,c.x+a.width,c.y+a.height)},move:(c,h)=>{u(h[0][0],h[0][1],c.x,c.y)},end:(c,h)=>{(a.width<=16||a.height<=16)&&(a.width=80,a.height=80,a.x=a.x-a.width/2,a.y=a.y-a.height/2,Object.assign(o,nt(L.IMAGE,a,o)),m(l,o)),p.data.node=Object.assign({id:r,type:L.IMAGE,name:"Image"},{size:a,attribute:o,source:s}),null==n||n.remove()}}}}var Re=xi(467),Ze=xi(8547);Ze.config({driver:[Ze.INDEXEDDB,Ze.LOCALSTORAGE,Ze.WEBSQL],name:"_localDataDB",version:1});const ue={create:(i=(0,Re.A)(function*(){return Ze}),function(){return i.apply(this,arguments)}),get:function(){var i=(0,Re.A)(function*(t){return Ze.getItem(t)});return function(e){return i.apply(this,arguments)}}(),set:function(){var i=(0,Re.A)(function*(t,e){return Ze.setItem(t,e)});return function(e,n){return i.apply(this,arguments)}}()},ja=function(){var i=(0,Re.A)(function*(t){yield ue.create();var e=(yield ue.get("icdt-data"))||[];"function"==typeof t.callback&&t.callback(e)});return function(e){return i.apply(this,arguments)}}(),za=function(){var i=(0,Re.A)(function*(t){yield ue.create(),t.params=t.params||{};try{yield ue.set("icdt-data",t.params),"function"==typeof t.callback&&t.callback(t.params)}catch(e){"function"==typeof t.callback&&t.callback(null),console.error(e)}});return function(e){return i.apply(this,arguments)}}(),Fa=function(){var i=(0,Re.A)(function*(t){yield ue.create();try{var e=(yield ue.get("icdt-config"))||{};"function"==typeof t.callback&&t.callback(e)}catch(n){"function"==typeof t.callback&&t.callback(null),console.error(n)}});return function(e){return i.apply(this,arguments)}}(),La=function(){var i=(0,Re.A)(function*(t){yield ue.create(),t.params=t.params||{};try{yield ue.set("icdt-config",t.params),"function"==typeof t.callback&&t.callback(t.params)}catch(e){"function"==typeof t.callback&&t.callback(null),console.error(e)}});return function(e){return i.apply(this,arguments)}}(),Kr=function(){var i=(0,Re.A)(function*(t){yield ue.create();try{var e=(yield ue.get("icdt-clipboard"))||{};"function"==typeof t.callback&&t.callback(e)}catch(n){"function"==typeof t.callback&&t.callback(null),console.error(n)}});return function(e){return i.apply(this,arguments)}}(),Dr=function(){var i=(0,Re.A)(function*(t){yield ue.create(),t.params=t.params||{};try{yield ue.set("icdt-clipboard",t.params),"function"==typeof t.callback&&t.callback(t.params)}catch(e){"function"==typeof t.callback&&t.callback(null),console.error(e)}});return function(e){return i.apply(this,arguments)}}(),ce=(i,t,e)=>{var n;if(t&&!(null!=e?e:window).document.getElementById(t))return;if(t){let l=(null!=e?e:window).document.getElementById(t);jQuery(l).find("#"+lt.BACKGROUND_GROUP).empty();let a=N(lt.BACKGROUND_GROUP,"g",void 0,l);st(a,i)}else{jQuery(p.target).find("#"+lt.BACKGROUND_GROUP).empty();let l=N(lt.BACKGROUND_GROUP,"g",void 0,p.target);st(l,i)}let r=(l,a)=>{a=t&&a?`${t}-${a}`:null!=t?t:a,null==l||l.forEach(o=>{let s=t?`${t}-${o.id}`:o.id;var d;if(o.isdeleted)null===(d=(null!=e?e:window).document.getElementById(s))||void 0===d||d.remove();else switch(o.type){case L.GROUP:Me(s,{},a?(null!=e?e:window).document.getElementById(a):null),r(o.nodes,o.id);break;case L.CIRCLE:ge(s,{size:o.size,attribute:o.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case L.ELLIPSE:Ii(s,{size:o.size,attribute:o.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case L.LINE:Ai(s,{size:o.size,attribute:o.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case L.RECT:Wt(s,{size:o.size,attribute:o.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case L.POLYGON:Ci(s,{size:o.size,attribute:o.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case L.POLYLINE:an(s,{size:o.size,attribute:o.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case L.FOREIGNOBJECT:de(s,{size:o.size,attribute:o.attribute,style:o.style,source:o.source},a?(null!=e?e:window).document.getElementById(a):null);break;case L.IMAGE:ke(s,{size:o.size,attribute:o.attribute,source:o.source},a?(null!=e?e:window).document.getElementById(a):null);break;case L.TEXT:Ce(s,{size:o.size,attribute:o.attribute,source:o.source},a?(null!=e?e:window).document.getElementById(a):null);break;case L.TSPAN:Ji(s,{size:o.size,attribute:o.attribute,source:o.source},a?(null!=e?e:window).document.getElementById(a):null);break;case L.PATH:Ne(s,{size:o.size,attribute:o.attribute},a?(null!=e?e:window).document.getElementById(a):null)}})};r(null==i||null===(n=i.svg)||void 0===n?void 0:n.nodes)},un=(i,t)=>{var e;if(t&&!window.document.getElementById(t))return;let n=(r,l)=>{l=l?`${t}-${l}`:t,null==r||r.forEach(a=>{jQuery("#"+(t?`${t}-${a.id}`:a.id)).appendTo(l?window.document.getElementById(l):p.target),a.type==L.GROUP&&n(a.nodes,a.id)})};n(null==i||null===(e=i.svg)||void 0===e?void 0:e.nodes)},ar=(i,t)=>{let{id:e,type:n,size:r,attribute:l}=i,a=JSON.parse(JSON.stringify({id:e,size:r,attribute:l}));r.x=A(t||0),Object.assign(l,nt(n,r,l)),m(window.document.getElementById(e),l),p.history.push([{type:"size",from:a,to:JSON.parse(JSON.stringify({id:e,size:r,attribute:l}))}])},or=(i,t)=>{let{id:e,type:n,size:r,attribute:l}=i,a=JSON.parse(JSON.stringify({id:e,size:r,attribute:l}));r.y=A(t||0),Object.assign(l,nt(n,r,l)),m(window.document.getElementById(e),l),p.history.push([{type:"size",from:a,to:JSON.parse(JSON.stringify({id:e,size:r,attribute:l}))}])},Ba=(i,t,e)=>{let{id:n,type:r,size:l,attribute:a}=i;t<=0&&(t=1);let o=JSON.parse(JSON.stringify({id:n,size:l,attribute:a}));e&&(l.height=A(t*l.height/(l.width||1))),l.width=A(t),Object.assign(a,nt(r,l,a)),m(window.document.getElementById(n),a),p.history.push([{type:"size",from:o,to:JSON.parse(JSON.stringify({id:n,size:l,attribute:a}))}])},Pa=(i,t,e)=>{let{id:n,type:r,size:l,attribute:a}=i;t<=0&&(t=1);let o=JSON.parse(JSON.stringify({id:n,size:l,attribute:a}));e&&(l.width=A(t*l.width/(l.height||1))),l.height=A(t),Object.assign(a,nt(r,l,a)),m(window.document.getElementById(n),a),p.history.push([{type:"size",from:o,to:JSON.parse(JSON.stringify({id:n,size:l,attribute:a}))}])},Ma=(i,t)=>{let{id:e,type:n,size:r,attribute:l}=i,a=JSON.parse(JSON.stringify({id:e,size:r,attribute:l}));r.rotate="number"==typeof t?A(t,100):void 0,Object.assign(l,nt(n,r,l)),m(window.document.getElementById(e),l),p.history.push([{type:"size",from:a,to:JSON.parse(JSON.stringify({id:e,size:r,attribute:l}))}])};var i;const Gr=new class Ka{constructor(){this._fnChanges=[],this.onchange={type:"keydown",key:mt.Escape,fn:()=>{p.dataSelect.ids.length&&(p.dataSelect.ids=[])}},this.onchange={type:"keydown",key:mt.Delete,fn:()=>{p.dataSelect.deleteNode()}},this.onchange={type:"keydown",key:mt.Space,fn:()=>{p.pointer.pointer_type_temp=vt.HAND}},this.onchange={type:"keyup",key:mt.Space,fn:()=>{p.pointer.pointer_type_temp=vt.POINTER}},this.onchange={type:"keydown",key:mt.ArrowLeft,fn:()=>{p.dataSelect.ids.length||p.data.backSlide()}},this.onchange={type:"keydown",key:mt.ArrowRight,fn:()=>{p.dataSelect.ids.length||p.data.nextSlide()}},this.onchange={type:"keydown",key:mt.PageDown,fn:()=>{p.dataSelect.ids.length||p.data.backSlide()}},this.onchange={type:"keydown",key:mt.PageUp,fn:()=>{p.dataSelect.ids.length||p.data.nextSlide()}},this.onchange={type:"keydown",key:mt.ArrowLeft,fn:()=>{p.dataSelect.ids.length&&(p.dataSelect.nodes.forEach(t=>{ar(t,A(t.size.x-at(1)))}),$t(p.dataSelect.nodes))}},this.onchange={type:"keydown",key:mt.ArrowRight,fn:()=>{p.dataSelect.ids.length&&(p.dataSelect.nodes.forEach(t=>{ar(t,A(t.size.x+at(1)))}),$t(p.dataSelect.nodes))}},this.onchange={type:"keydown",key:mt.ArrowUp,fn:()=>{p.dataSelect.ids.length&&(p.dataSelect.nodes.forEach(t=>{or(t,A(t.size.y-at(1)))}),$t(p.dataSelect.nodes))}},this.onchange={type:"keydown",key:mt.ArrowDown,fn:()=>{p.dataSelect.ids.length&&(p.dataSelect.nodes.forEach(t=>{or(t,A(t.size.y+at(1)))}),$t(p.dataSelect.nodes))}},this.onchange={type:"keydown",key:mt.Digit1,fn:t=>{t.shiftKey&&(p.reloadView(),p.screen.zoomTo="fit")}},this.onchange={type:"keydown",key:mt.Digit0,fn:t=>{t.ctrlKey&&(p.screen.zoomTo=100)}},this.onchange={type:"keydown",key:mt.Equal,fn:t=>{t.ctrlKey&&p.screen.zoomIn()}},this.onchange={type:"keydown",key:mt.Minus,fn:t=>{t.ctrlKey&&p.screen.zoomOut()}},this.onchange={type:"keydown",key:mt.KeyA,fn:t=>{t.ctrlKey&&(p.dataSelect.ids=p.data.getNodeAll(),$t(p.dataSelect.nodes))}},this.onchange={type:"keydown",key:mt.KeyC,fn:t=>{if(t.ctrlKey){let e=p.dataSelect.nodes;e&&Dr({params:{type:"nodes",nodes:e}})}}},this.onchange={type:"keydown",key:mt.KeyV,fn:t=>{t.ctrlKey&&Kr({callback:e=>{var n,r;"nodes"==(null==e?void 0:e.type)&&null!=e&&null!==(n=e.nodes)&&void 0!==n&&n.length&&(null==e||null===(r=e.nodes)||void 0===r||r.forEach(l=>{t.shiftKey||p.data.findNode(l.id).id&&(l.size.x+=16,l.size.y+=16),l.id=Math.ceil(1e9*Math.random()),p.data.node=l}),ce(p.data.slide))}})}},this.onchange={type:"keydown",key:mt.KeyZ,fn:t=>{t.ctrlKey&&t.shiftKey?p.history.redo():t.ctrlKey&&p.history.undo()}},this.onchange={type:"keydown",key:mt.BracketLeft,fn:t=>{t.ctrlKey&&t.shiftKey?p.data.sendToBack(p.dataSelect.ids):t.ctrlKey?p.data.sendToBackStep(p.dataSelect.ids,-2):p.data.sendToBackArea(p.dataSelect.ids)}},this.onchange={type:"keydown",key:mt.BracketRight,fn:t=>{t.ctrlKey&&t.shiftKey?p.data.bringToFront(p.dataSelect.ids):t.ctrlKey?p.data.bringToFrontStep(p.dataSelect.ids,1):p.data.bringToFrontArea(p.dataSelect.ids)}}}set onchange(t){let e=this._fnChanges.find(n=>n.eventType==t.type&&n.eventKey==t.key);e?e.fns.push(t.fn):this._fnChanges.push({eventType:t.type,eventKey:t.key,fns:[t.fn]})}change(t,e,n){var r;p.dataSelect.contenteditable_id||null===(r=this._fnChanges.find(l=>l.eventType==t&&l.eventKey==e))||void 0===r||r.fns.forEach(l=>l(n))}},Qr=i=>{Gr.change(i.type,i.keyCode||i.which||i.charCode||0,i)};function Da(){}function sr(i){return null==i?Da:function(){return this.querySelector(i)}}function Ua(){return[]}function Ur(i){return null==i?Ua:function(){return this.querySelectorAll(i)}}function Hr(i){return function(){return this.matches(i)}}function Wr(i){return function(t){return t.matches(i)}}var Ya=Array.prototype.find;function qa(){return this.firstElementChild}var Va=Array.prototype.filter;function $a(){return Array.from(this.children)}function Yr(i){return new Array(i.length)}function cn(i,t){this.ownerDocument=i.ownerDocument,this.namespaceURI=i.namespaceURI,this._next=null,this._parent=i,this.__data__=t}function lo(i,t,e,n,r,l){for(var o,a=0,s=t.length,d=l.length;a<d;++a)(o=t[a])?(o.__data__=l[a],n[a]=o):e[a]=new cn(i,l[a]);for(;a<s;++a)(o=t[a])&&(r[a]=o)}function ao(i,t,e,n,r,l,a){var o,s,f,d=new Map,u=t.length,c=l.length,h=new Array(u);for(o=0;o<u;++o)(s=t[o])&&(h[o]=f=a.call(s,s.__data__,o,t)+"",d.has(f)?r[o]=s:d.set(f,s));for(o=0;o<c;++o)f=a.call(i,l[o],o,l)+"",(s=d.get(f))?(n[o]=s,s.__data__=l[o],d.delete(f)):e[o]=new cn(i,l[o]);for(o=0;o<u;++o)(s=t[o])&&d.get(h[o])===s&&(r[o]=s)}function oo(i){return i.__data__}function uo(i){return"object"==typeof i&&"length"in i?i:Array.from(i)}function yo(i,t){return i<t?-1:i>t?1:i>=t?0:NaN}cn.prototype={constructor:cn,appendChild:function(i){return this._parent.insertBefore(i,this._next)},insertBefore:function(i,t){return this._parent.insertBefore(i,t)},querySelector:function(i){return this._parent.querySelector(i)},querySelectorAll:function(i){return this._parent.querySelectorAll(i)}};var dr="http://www.w3.org/1999/xhtml";const Xr={svg:"http://www.w3.org/2000/svg",xhtml:dr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function hn(i){var t=i+="",e=t.indexOf(":");return e>=0&&"xmlns"!==(t=i.slice(0,e))&&(i=i.slice(e+1)),Xr.hasOwnProperty(t)?{space:Xr[t],local:i}:i}function ko(i){return function(){this.removeAttribute(i)}}function Oo(i){return function(){this.removeAttributeNS(i.space,i.local)}}function No(i,t){return function(){this.setAttribute(i,t)}}function _o(i,t){return function(){this.setAttributeNS(i.space,i.local,t)}}function Eo(i,t){return function(){var e=t.apply(this,arguments);null==e?this.removeAttribute(i):this.setAttribute(i,e)}}function To(i,t){return function(){var e=t.apply(this,arguments);null==e?this.removeAttributeNS(i.space,i.local):this.setAttributeNS(i.space,i.local,e)}}function qr(i){return i.ownerDocument&&i.ownerDocument.defaultView||i.document&&i||i.defaultView}function Ao(i){return function(){this.style.removeProperty(i)}}function Co(i,t,e){return function(){this.style.setProperty(i,t,e)}}function Jo(i,t,e){return function(){var n=t.apply(this,arguments);null==n?this.style.removeProperty(i):this.style.setProperty(i,n,e)}}function hi(i,t){return i.style.getPropertyValue(t)||qr(i).getComputedStyle(i,null).getPropertyValue(t)}function jo(i){return function(){delete this[i]}}function zo(i,t){return function(){this[i]=t}}function Fo(i,t){return function(){var e=t.apply(this,arguments);null==e?delete this[i]:this[i]=e}}function Zr(i){return i.trim().split(/^|\s+/)}function ur(i){return i.classList||new Vr(i)}function Vr(i){this._node=i,this._names=Zr(i.getAttribute("class")||"")}function $r(i,t){for(var e=ur(i),n=-1,r=t.length;++n<r;)e.add(t[n])}function tl(i,t){for(var e=ur(i),n=-1,r=t.length;++n<r;)e.remove(t[n])}function Bo(i){return function(){$r(this,i)}}function Po(i){return function(){tl(this,i)}}function Mo(i,t){return function(){(t.apply(this,arguments)?$r:tl)(this,i)}}function Do(){this.textContent=""}function Go(i){return function(){this.textContent=i}}function Qo(i){return function(){var t=i.apply(this,arguments);this.textContent=null==t?"":t}}function Ho(){this.innerHTML=""}function Wo(i){return function(){this.innerHTML=i}}function Yo(i){return function(){var t=i.apply(this,arguments);this.innerHTML=null==t?"":t}}function qo(){this.nextSibling&&this.parentNode.appendChild(this)}function Vo(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ts(i){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===dr&&t.documentElement.namespaceURI===dr?t.createElement(i):t.createElementNS(e,i)}}function es(i){return function(){return this.ownerDocument.createElementNS(i.space,i.local)}}function el(i){var t=hn(i);return(t.local?es:ts)(t)}function ns(){return null}function ls(){var i=this.parentNode;i&&i.removeChild(this)}function os(){var i=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(i,this.nextSibling):i}function ss(){var i=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(i,this.nextSibling):i}function fs(i){return function(){var t=this.__on;if(t){for(var l,e=0,n=-1,r=t.length;e<r;++e)l=t[e],i.type&&l.type!==i.type||l.name!==i.name?t[++n]=l:this.removeEventListener(l.type,l.listener,l.options);++n?t.length=n:delete this.__on}}}function vs(i,t,e){return function(){var r,n=this.__on,l=function cs(i){return function(t){i.call(this,t,this.__data__)}}(t);if(n)for(var a=0,o=n.length;a<o;++a)if((r=n[a]).type===i.type&&r.name===i.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=l,r.options=e),void(r.value=t);this.addEventListener(i.type,l,e),r={type:i.type,name:i.name,value:t,listener:l,options:e},n?n.push(r):this.__on=[r]}}function il(i,t,e){var n=qr(i),r=n.CustomEvent;"function"==typeof r?r=new r(t,e):(r=n.document.createEvent("Event"),e?(r.initEvent(t,e.bubbles,e.cancelable),r.detail=e.detail):r.initEvent(t,!1,!1)),i.dispatchEvent(r)}function ys(i,t){return function(){return il(this,i,t)}}function ps(i,t){return function(){return il(this,i,t.apply(this,arguments))}}Vr.prototype={add:function(i){this._names.indexOf(i)<0&&(this._names.push(i),this._node.setAttribute("class",this._names.join(" ")))},remove:function(i){var t=this._names.indexOf(i);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(i){return this._names.indexOf(i)>=0}};var bs=[null];function pe(i,t){this._groups=i,this._parents=t}function nl(){return new pe([[document.documentElement]],bs)}pe.prototype=nl.prototype={constructor:pe,select:function Ga(i){"function"!=typeof i&&(i=sr(i));for(var t=this._groups,e=t.length,n=new Array(e),r=0;r<e;++r)for(var s,d,l=t[r],a=l.length,o=n[r]=new Array(a),u=0;u<a;++u)(s=l[u])&&(d=i.call(s,s.__data__,u,l))&&("__data__"in s&&(d.__data__=s.__data__),o[u]=d);return new pe(n,this._parents)},selectAll:function Wa(i){i="function"==typeof i?function Ha(i){return function(){return function Qa(i){return null==i?[]:Array.isArray(i)?i:Array.from(i)}(i.apply(this,arguments))}}(i):Ur(i);for(var t=this._groups,e=t.length,n=[],r=[],l=0;l<e;++l)for(var s,a=t[l],o=a.length,d=0;d<o;++d)(s=a[d])&&(n.push(i.call(s,s.__data__,d,a)),r.push(s));return new pe(n,r)},selectChild:function Za(i){return this.select(null==i?qa:function Xa(i){return function(){return Ya.call(this.children,i)}}("function"==typeof i?i:Wr(i)))},selectChildren:function eo(i){return this.selectAll(null==i?$a:function to(i){return function(){return Va.call(this.children,i)}}("function"==typeof i?i:Wr(i)))},filter:function io(i){"function"!=typeof i&&(i=Hr(i));for(var t=this._groups,e=t.length,n=new Array(e),r=0;r<e;++r)for(var s,l=t[r],a=l.length,o=n[r]=[],d=0;d<a;++d)(s=l[d])&&i.call(s,s.__data__,d,l)&&o.push(s);return new pe(n,this._parents)},data:function so(i,t){if(!arguments.length)return Array.from(this,oo);var e=t?ao:lo,n=this._parents,r=this._groups;"function"!=typeof i&&(i=function ro(i){return function(){return i}}(i));for(var l=r.length,a=new Array(l),o=new Array(l),s=new Array(l),d=0;d<l;++d){var u=n[d],c=r[d],h=c.length,f=uo(i.call(u,u&&u.__data__,d,n)),v=f.length,b=o[d]=new Array(v),y=a[d]=new Array(v);e(u,c,b,y,s[d]=new Array(h),f,t);for(var w,S,O=0,x=0;O<v;++O)if(w=b[O]){for(O>=x&&(x=O+1);!(S=y[x])&&++x<v;);w._next=S||null}}return(a=new pe(a,n))._enter=o,a._exit=s,a},enter:function no(){return new pe(this._enter||this._groups.map(Yr),this._parents)},exit:function co(){return new pe(this._exit||this._groups.map(Yr),this._parents)},join:function ho(i,t,e){var n=this.enter(),r=this,l=this.exit();return"function"==typeof i?(n=i(n))&&(n=n.selection()):n=n.append(i+""),null!=t&&(r=t(r))&&(r=r.selection()),null==e?l.remove():e(l),n&&r?n.merge(r).order():r},merge:function fo(i){for(var t=i.selection?i.selection():i,e=this._groups,n=t._groups,r=e.length,a=Math.min(r,n.length),o=new Array(r),s=0;s<a;++s)for(var f,d=e[s],u=n[s],c=d.length,h=o[s]=new Array(c),v=0;v<c;++v)(f=d[v]||u[v])&&(h[v]=f);for(;s<r;++s)o[s]=e[s];return new pe(o,this._parents)},selection:function xs(){return this},order:function vo(){for(var i=this._groups,t=-1,e=i.length;++t<e;)for(var a,n=i[t],r=n.length-1,l=n[r];--r>=0;)(a=n[r])&&(l&&4^a.compareDocumentPosition(l)&&l.parentNode.insertBefore(a,l),l=a);return this},sort:function go(i){function t(c,h){return c&&h?i(c.__data__,h.__data__):!c-!h}i||(i=yo);for(var e=this._groups,n=e.length,r=new Array(n),l=0;l<n;++l){for(var d,a=e[l],o=a.length,s=r[l]=new Array(o),u=0;u<o;++u)(d=a[u])&&(s[u]=d);s.sort(t)}return new pe(r,this._parents).order()},call:function po(){var i=arguments[0];return arguments[0]=this,i.apply(null,arguments),this},nodes:function mo(){return Array.from(this)},node:function wo(){for(var i=this._groups,t=0,e=i.length;t<e;++t)for(var n=i[t],r=0,l=n.length;r<l;++r){var a=n[r];if(a)return a}return null},size:function bo(){let i=0;for(const t of this)++i;return i},empty:function xo(){return!this.node()},each:function So(i){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var o,r=t[e],l=0,a=r.length;l<a;++l)(o=r[l])&&i.call(o,o.__data__,l,r);return this},attr:function Io(i,t){var e=hn(i);if(arguments.length<2){var n=this.node();return e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}return this.each((null==t?e.local?Oo:ko:"function"==typeof t?e.local?To:Eo:e.local?_o:No)(e,t))},style:function Ro(i,t,e){return arguments.length>1?this.each((null==t?Ao:"function"==typeof t?Jo:Co)(i,t,null==e?"":e)):hi(this.node(),i)},property:function Lo(i,t){return arguments.length>1?this.each((null==t?jo:"function"==typeof t?Fo:zo)(i,t)):this.node()[i]},classed:function Ko(i,t){var e=Zr(i+"");if(arguments.length<2){for(var n=ur(this.node()),r=-1,l=e.length;++r<l;)if(!n.contains(e[r]))return!1;return!0}return this.each(("function"==typeof t?Mo:t?Bo:Po)(e,t))},text:function Uo(i){return arguments.length?this.each(null==i?Do:("function"==typeof i?Qo:Go)(i)):this.node().textContent},html:function Xo(i){return arguments.length?this.each(null==i?Ho:("function"==typeof i?Yo:Wo)(i)):this.node().innerHTML},raise:function Zo(){return this.each(qo)},lower:function $o(){return this.each(Vo)},append:function is(i){var t="function"==typeof i?i:el(i);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function rs(i,t){var e="function"==typeof i?i:el(i),n=null==t?ns:"function"==typeof t?t:sr(t);return this.select(function(){return this.insertBefore(e.apply(this,arguments),n.apply(this,arguments)||null)})},remove:function as(){return this.each(ls)},clone:function ds(i){return this.select(i?ss:os)},datum:function us(i){return arguments.length?this.property("__data__",i):this.node().__data__},on:function gs(i,t,e){var r,a,n=function hs(i){return i.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(i+""),l=n.length;if(!(arguments.length<2)){for(o=t?vs:fs,r=0;r<l;++r)this.each(o(n[r],t,e));return this}var o=this.node().__on;if(o)for(var u,s=0,d=o.length;s<d;++s)for(r=0,u=o[s];r<l;++r)if((a=n[r]).type===u.type&&a.name===u.name)return u.value},dispatch:function ms(i,t){return this.each(("function"==typeof t?ps:ys)(i,t))},[Symbol.iterator]:function*ws(){for(var i=this._groups,t=0,e=i.length;t<e;++t)for(var a,n=i[t],r=0,l=n.length;r<l;++r)(a=n[r])&&(yield a)}};const Fi=nl;var Ss={value:()=>{}};function rl(){for(var n,i=0,t=arguments.length,e={};i<t;++i){if(!(n=arguments[i]+"")||n in e||/[\s.]/.test(n))throw new Error("illegal type: "+n);e[n]=[]}return new fn(e)}function fn(i){this._=i}function Os(i,t){for(var r,e=0,n=i.length;e<n;++e)if((r=i[e]).name===t)return r.value}function ll(i,t,e){for(var n=0,r=i.length;n<r;++n)if(i[n].name===t){i[n]=Ss,i=i.slice(0,n).concat(i.slice(n+1));break}return null!=e&&i.push({name:t,value:e}),i}fn.prototype=rl.prototype={constructor:fn,on:function(i,t){var r,e=this._,n=function ks(i,t){return i.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}})}(i+"",e),l=-1,a=n.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++l<a;)if(r=(i=n[l]).type)e[r]=ll(e[r],i.name,t);else if(null==t)for(r in e)e[r]=ll(e[r],i.name,null);return this}for(;++l<a;)if((r=(i=n[l]).type)&&(r=Os(e[r],i.name)))return r},copy:function(){var i={},t=this._;for(var e in t)i[e]=t[e].slice();return new fn(i)},call:function(i,t){if((r=arguments.length-2)>0)for(var r,l,e=new Array(r),n=0;n<r;++n)e[n]=arguments[n+2];if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(n=0,r=(l=this._[i]).length;n<r;++n)l[n].value.apply(t,e)},apply:function(i,t,e){if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(var n=this._[i],r=0,l=n.length;r<l;++r)n[r].value.apply(t,e)}};const Ns=rl;var vn,Pi,fi=0,Li=0,Bi=0,al=1e3,gn=0,Ve=0,yn=0,Mi="object"==typeof performance&&performance.now?performance:Date,ol="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(i){setTimeout(i,17)};function cr(){return Ve||(ol(_s),Ve=Mi.now()+yn)}function _s(){Ve=0}function pn(){this._call=this._time=this._next=null}function sl(i,t,e){var n=new pn;return n.restart(i,t,e),n}function dl(){Ve=(gn=Mi.now())+yn,fi=Li=0;try{!function Es(){cr(),++fi;for(var t,i=vn;i;)(t=Ve-i._time)>=0&&i._call.call(void 0,t),i=i._next;--fi}()}finally{fi=0,function Is(){for(var i,e,t=vn,n=1/0;t;)t._call?(n>t._time&&(n=t._time),i=t,t=t._next):(e=t._next,t._next=null,t=i?i._next=e:vn=e);Pi=i,hr(n)}(),Ve=0}}function Ts(){var i=Mi.now(),t=i-gn;t>al&&(yn-=t,gn=i)}function hr(i){fi||(Li&&(Li=clearTimeout(Li)),i-Ve>24?(i<1/0&&(Li=setTimeout(dl,i-Mi.now()-yn)),Bi&&(Bi=clearInterval(Bi))):(Bi||(gn=Mi.now(),Bi=setInterval(Ts,al)),fi=1,ol(dl)))}function ul(i,t,e){var n=new pn;return n.restart(r=>{n.stop(),i(r+t)},t=null==t?0:+t,e),n}pn.prototype=sl.prototype={constructor:pn,restart:function(i,t,e){if("function"!=typeof i)throw new TypeError("callback is not a function");e=(null==e?cr():+e)+(null==t?0:+t),!this._next&&Pi!==this&&(Pi?Pi._next=this:vn=this,Pi=this),this._call=i,this._time=e,hr()},stop:function(){this._call&&(this._call=null,this._time=1/0,hr())}};var As=Ns("start","end","cancel","interrupt"),Cs=[],cl=0,mn=3;function bn(i,t,e,n,r,l){var a=i.__transition;if(a){if(e in a)return}else i.__transition={};!function Js(i,t,e){var r,n=i.__transition;function a(d){var u,c,h,f;if(1!==e.state)return s();for(u in n)if((f=n[u]).name===e.name){if(f.state===mn)return ul(a);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",i,i.__data__,f.index,f.group),delete n[u]):+u<t&&(f.state=6,f.timer.stop(),f.on.call("cancel",i,i.__data__,f.index,f.group),delete n[u])}if(ul(function(){e.state===mn&&(e.state=4,e.timer.restart(o,e.delay,e.time),o(d))}),e.state=2,e.on.call("start",i,i.__data__,e.index,e.group),2===e.state){for(e.state=mn,r=new Array(h=e.tween.length),u=0,c=-1;u<h;++u)(f=e.tween[u].value.call(i,i.__data__,e.index,e.group))&&(r[++c]=f);r.length=c+1}}function o(d){for(var u=d<e.duration?e.ease.call(null,d/e.duration):(e.timer.restart(s),e.state=5,1),c=-1,h=r.length;++c<h;)r[c].call(i,u);5===e.state&&(e.on.call("end",i,i.__data__,e.index,e.group),s())}function s(){for(var d in e.state=6,e.timer.stop(),delete n[t],n)return;delete i.__transition}n[t]=e,e.timer=sl(function l(d){e.state=1,e.timer.restart(a,e.delay,e.time),e.delay<=d&&a(d-e.delay)},0,e.time)}(i,e,{name:t,index:n,group:r,on:As,tween:Cs,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:cl})}function gr(i,t){var e=me(i,t);if(e.state>cl)throw new Error("too late; already scheduled");return e}function _e(i,t){var e=me(i,t);if(e.state>mn)throw new Error("too late; already running");return e}function me(i,t){var e=i.__transition;if(!e||!(e=e[t]))throw new Error("transition not found");return e}function De(i,t){return i=+i,t=+t,function(e){return i*(1-e)+t*e}}var xn,vl=180/Math.PI,yr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function gl(i,t,e,n,r,l){var a,o,s;return(a=Math.sqrt(i*i+t*t))&&(i/=a,t/=a),(s=i*e+t*n)&&(e-=i*s,n-=t*s),(o=Math.sqrt(e*e+n*n))&&(e/=o,n/=o,s/=o),i*n<t*e&&(i=-i,t=-t,s=-s,a=-a),{translateX:r,translateY:l,rotate:Math.atan2(t,i)*vl,skewX:Math.atan(s)*vl,scaleX:a,scaleY:o}}function yl(i,t,e,n){function r(d){return d.length?d.pop()+" ":""}return function(d,u){var c=[],h=[];return d=i(d),u=i(u),function l(d,u,c,h,f,v){if(d!==c||u!==h){var b=f.push("translate(",null,t,null,e);v.push({i:b-4,x:De(d,c)},{i:b-2,x:De(u,h)})}else(c||h)&&f.push("translate("+c+t+h+e)}(d.translateX,d.translateY,u.translateX,u.translateY,c,h),function a(d,u,c,h){d!==u?(d-u>180?u+=360:u-d>180&&(d+=360),h.push({i:c.push(r(c)+"rotate(",null,n)-2,x:De(d,u)})):u&&c.push(r(c)+"rotate("+u+n)}(d.rotate,u.rotate,c,h),function o(d,u,c,h){d!==u?h.push({i:c.push(r(c)+"skewX(",null,n)-2,x:De(d,u)}):u&&c.push(r(c)+"skewX("+u+n)}(d.skewX,u.skewX,c,h),function s(d,u,c,h,f,v){if(d!==c||u!==h){var b=f.push(r(f)+"scale(",null,",",null,")");v.push({i:b-4,x:De(d,c)},{i:b-2,x:De(u,h)})}else(1!==c||1!==h)&&f.push(r(f)+"scale("+c+","+h+")")}(d.scaleX,d.scaleY,u.scaleX,u.scaleY,c,h),d=u=null,function(f){for(var y,v=-1,b=h.length;++v<b;)c[(y=h[v]).i]=y.x(f);return c.join("")}}}var Ls=yl(function zs(i){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(i+"");return t.isIdentity?yr:gl(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),Bs=yl(function Fs(i){return null!=i&&(xn||(xn=document.createElementNS("http://www.w3.org/2000/svg","g")),xn.setAttribute("transform",i),i=xn.transform.baseVal.consolidate())?gl((i=i.matrix).a,i.b,i.c,i.d,i.e,i.f):yr},", ",")",")");function Ps(i,t){var e,n;return function(){var r=_e(this,i),l=r.tween;if(l!==e)for(var a=0,o=(n=e=l).length;a<o;++a)if(n[a].name===t){(n=n.slice()).splice(a,1);break}r.tween=n}}function Ms(i,t,e){var n,r;if("function"!=typeof e)throw new Error;return function(){var l=_e(this,i),a=l.tween;if(a!==n){r=(n=a).slice();for(var o={name:t,value:e},s=0,d=r.length;s<d;++s)if(r[s].name===t){r[s]=o;break}s===d&&r.push(o)}l.tween=r}}function pr(i,t,e){var n=i._id;return i.each(function(){var r=_e(this,n);(r.value||(r.value={}))[t]=e.apply(this,arguments)}),function(r){return me(r,n).value[t]}}function mr(i,t,e){i.prototype=t.prototype=e,e.constructor=i}function pl(i,t){var e=Object.create(i.prototype);for(var n in t)e[n]=t[n];return e}function Ki(){}var Sn=1/.7,vi="\\s*([+-]?\\d+)\\s*",Gi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ee="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ds=/^#([0-9a-f]{3,8})$/,Gs=new RegExp(`^rgb\\(${vi},${vi},${vi}\\)$`),Qs=new RegExp(`^rgb\\(${Ee},${Ee},${Ee}\\)$`),Us=new RegExp(`^rgba\\(${vi},${vi},${vi},${Gi}\\)$`),Hs=new RegExp(`^rgba\\(${Ee},${Ee},${Ee},${Gi}\\)$`),Ws=new RegExp(`^hsl\\(${Gi},${Ee},${Ee}\\)$`),Ys=new RegExp(`^hsla\\(${Gi},${Ee},${Ee},${Gi}\\)$`),ml={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function wl(){return this.rgb().formatHex()}function bl(){return this.rgb().formatRgb()}function Qi(i){var t,e;return i=(i+"").trim().toLowerCase(),(t=Ds.exec(i))?(e=t[1].length,t=parseInt(t[1],16),6===e?xl(t):3===e?new le(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===e?kn(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===e?kn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Gs.exec(i))?new le(t[1],t[2],t[3],1):(t=Qs.exec(i))?new le(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Us.exec(i))?kn(t[1],t[2],t[3],t[4]):(t=Hs.exec(i))?kn(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Ws.exec(i))?Ol(t[1],t[2]/100,t[3]/100,1):(t=Ys.exec(i))?Ol(t[1],t[2]/100,t[3]/100,t[4]):ml.hasOwnProperty(i)?xl(ml[i]):"transparent"===i?new le(NaN,NaN,NaN,0):null}function xl(i){return new le(i>>16&255,i>>8&255,255&i,1)}function kn(i,t,e,n){return n<=0&&(i=t=e=NaN),new le(i,t,e,n)}function On(i,t,e,n){return 1===arguments.length?function Zs(i){return i instanceof Ki||(i=Qi(i)),i?new le((i=i.rgb()).r,i.g,i.b,i.opacity):new le}(i):new le(i,t,e,null==n?1:n)}function le(i,t,e,n){this.r=+i,this.g=+t,this.b=+e,this.opacity=+n}function Sl(){return`#${ti(this.r)}${ti(this.g)}${ti(this.b)}`}function kl(){const i=Nn(this.opacity);return`${1===i?"rgb(":"rgba("}${$e(this.r)}, ${$e(this.g)}, ${$e(this.b)}${1===i?")":`, ${i})`}`}function Nn(i){return isNaN(i)?1:Math.max(0,Math.min(1,i))}function $e(i){return Math.max(0,Math.min(255,Math.round(i)||0))}function ti(i){return((i=$e(i))<16?"0":"")+i.toString(16)}function Ol(i,t,e,n){return n<=0?i=t=e=NaN:e<=0||e>=1?i=t=NaN:t<=0&&(i=NaN),new we(i,t,e,n)}function Nl(i){if(i instanceof we)return new we(i.h,i.s,i.l,i.opacity);if(i instanceof Ki||(i=Qi(i)),!i)return new we;if(i instanceof we)return i;var t=(i=i.rgb()).r/255,e=i.g/255,n=i.b/255,r=Math.min(t,e,n),l=Math.max(t,e,n),a=NaN,o=l-r,s=(l+r)/2;return o?(a=t===l?(e-n)/o+6*(e<n):e===l?(n-t)/o+2:(t-e)/o+4,o/=s<.5?l+r:2-l-r,a*=60):o=s>0&&s<1?0:a,new we(a,o,s,i.opacity)}function we(i,t,e,n){this.h=+i,this.s=+t,this.l=+e,this.opacity=+n}function _l(i){return(i=(i||0)%360)<0?i+360:i}function _n(i){return Math.max(0,Math.min(1,i||0))}function wr(i,t,e){return 255*(i<60?t+(e-t)*i/60:i<180?e:i<240?t+(e-t)*(240-i)/60:t)}function El(i,t,e,n,r){var l=i*i,a=l*i;return((1-3*i+3*l-a)*t+(4-6*l+3*a)*e+(1+3*i+3*l-3*a)*n+a*r)/6}mr(Ki,Qi,{copy(i){return Object.assign(new this.constructor,this,i)},displayable(){return this.rgb().displayable()},hex:wl,formatHex:wl,formatHex8:function Xs(){return this.rgb().formatHex8()},formatHsl:function qs(){return Nl(this).formatHsl()},formatRgb:bl,toString:bl}),mr(le,On,pl(Ki,{brighter(i){return i=null==i?Sn:Math.pow(Sn,i),new le(this.r*i,this.g*i,this.b*i,this.opacity)},darker(i){return i=null==i?.7:Math.pow(.7,i),new le(this.r*i,this.g*i,this.b*i,this.opacity)},rgb(){return this},clamp(){return new le($e(this.r),$e(this.g),$e(this.b),Nn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Sl,formatHex:Sl,formatHex8:function Vs(){return`#${ti(this.r)}${ti(this.g)}${ti(this.b)}${ti(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:kl,toString:kl})),mr(we,function $s(i,t,e,n){return 1===arguments.length?Nl(i):new we(i,t,e,null==n?1:n)},pl(Ki,{brighter(i){return i=null==i?Sn:Math.pow(Sn,i),new we(this.h,this.s,this.l*i,this.opacity)},darker(i){return i=null==i?.7:Math.pow(.7,i),new we(this.h,this.s,this.l*i,this.opacity)},rgb(){var i=this.h%360+360*(this.h<0),t=isNaN(i)||isNaN(this.s)?0:this.s,e=this.l,n=e+(e<.5?e:1-e)*t,r=2*e-n;return new le(wr(i>=240?i-240:i+120,r,n),wr(i,r,n),wr(i<120?i+240:i-120,r,n),this.opacity)},clamp(){return new we(_l(this.h),_n(this.s),_n(this.l),Nn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const i=Nn(this.opacity);return`${1===i?"hsl(":"hsla("}${_l(this.h)}, ${100*_n(this.s)}%, ${100*_n(this.l)}%${1===i?")":`, ${i})`}`}}));const Tl=i=>()=>i;function Al(i,t){var e=t-i;return e?function Il(i,t){return function(e){return i+e*t}}(i,e):Tl(isNaN(i)?t:i)}const Cl=function i(t){var e=function nd(i){return 1==(i=+i)?Al:function(t,e){return e-t?function id(i,t,e){return i=Math.pow(i,e),t=Math.pow(t,e)-i,e=1/e,function(n){return Math.pow(i+n*t,e)}}(t,e,i):Tl(isNaN(t)?e:t)}}(t);function n(r,l){var a=e((r=On(r)).r,(l=On(l)).r),o=e(r.g,l.g),s=e(r.b,l.b),d=Al(r.opacity,l.opacity);return function(u){return r.r=a(u),r.g=o(u),r.b=s(u),r.opacity=d(u),r+""}}return n.gamma=i,n}(1);function Jl(i){return function(t){var a,o,e=t.length,n=new Array(e),r=new Array(e),l=new Array(e);for(a=0;a<e;++a)o=On(t[a]),n[a]=o.r||0,r[a]=o.g||0,l[a]=o.b||0;return n=i(n),r=i(r),l=i(l),o.opacity=1,function(s){return o.r=n(s),o.g=r(s),o.b=l(s),o+""}}}Jl(function td(i){var t=i.length-1;return function(e){var n=e<=0?e=0:e>=1?(e=1,t-1):Math.floor(e*t),r=i[n],l=i[n+1];return El((e-n/t)*t,n>0?i[n-1]:2*r-l,r,l,n<t-1?i[n+2]:2*l-r)}}),Jl(function ed(i){var t=i.length;return function(e){var n=Math.floor(((e%=1)<0?++e:e)*t);return El((e-n/t)*t,i[(n+t-1)%t],i[n%t],i[(n+1)%t],i[(n+2)%t])}});var br=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xr=new RegExp(br.source,"g");function ad(i,t){var n,r,l,e=br.lastIndex=xr.lastIndex=0,a=-1,o=[],s=[];for(i+="",t+="";(n=br.exec(i))&&(r=xr.exec(t));)(l=r.index)>e&&(l=t.slice(e,l),o[a]?o[a]+=l:o[++a]=l),(n=n[0])===(r=r[0])?o[a]?o[a]+=r:o[++a]=r:(o[++a]=null,s.push({i:a,x:De(n,r)})),e=xr.lastIndex;return e<t.length&&(l=t.slice(e),o[a]?o[a]+=l:o[++a]=l),o.length<2?s[0]?function ld(i){return function(t){return i(t)+""}}(s[0].x):function rd(i){return function(){return i}}(t):(t=s.length,function(d){for(var c,u=0;u<t;++u)o[(c=s[u]).i]=c.x(d);return o.join("")})}function Rl(i,t){var e;return("number"==typeof t?De:t instanceof Qi?Cl:(e=Qi(t))?(t=e,Cl):ad)(i,t)}function od(i){return function(){this.removeAttribute(i)}}function sd(i){return function(){this.removeAttributeNS(i.space,i.local)}}function dd(i,t,e){var n,l,r=e+"";return function(){var a=this.getAttribute(i);return a===r?null:a===n?l:l=t(n=a,e)}}function ud(i,t,e){var n,l,r=e+"";return function(){var a=this.getAttributeNS(i.space,i.local);return a===r?null:a===n?l:l=t(n=a,e)}}function cd(i,t,e){var n,r,l;return function(){var a,s,o=e(this);return null==o?void this.removeAttribute(i):(a=this.getAttribute(i))===(s=o+"")?null:a===n&&s===r?l:(r=s,l=t(n=a,o))}}function hd(i,t,e){var n,r,l;return function(){var a,s,o=e(this);return null==o?void this.removeAttributeNS(i.space,i.local):(a=this.getAttributeNS(i.space,i.local))===(s=o+"")?null:a===n&&s===r?l:(r=s,l=t(n=a,o))}}function yd(i,t){var e,n;function r(){var l=t.apply(this,arguments);return l!==n&&(e=(n=l)&&function gd(i,t){return function(e){this.setAttributeNS(i.space,i.local,t.call(this,e))}}(i,l)),e}return r._value=t,r}function pd(i,t){var e,n;function r(){var l=t.apply(this,arguments);return l!==n&&(e=(n=l)&&function vd(i,t){return function(e){this.setAttribute(i,t.call(this,e))}}(i,l)),e}return r._value=t,r}function wd(i,t){return function(){gr(this,i).delay=+t.apply(this,arguments)}}function bd(i,t){return t=+t,function(){gr(this,i).delay=t}}function Sd(i,t){return function(){_e(this,i).duration=+t.apply(this,arguments)}}function kd(i,t){return t=+t,function(){_e(this,i).duration=t}}var Bd=Fi.prototype.constructor;function jl(i){return function(){this.style.removeProperty(i)}}var iu=0;function je(i,t,e,n){this._groups=i,this._parents=t,this._name=e,this._id=n}function zl(){return++iu}var ze=Fi.prototype;je.prototype=function nu(i){return Fi().transition(i)}.prototype={constructor:je,select:function Fd(i){var t=this._name,e=this._id;"function"!=typeof i&&(i=sr(i));for(var n=this._groups,r=n.length,l=new Array(r),a=0;a<r;++a)for(var u,c,o=n[a],s=o.length,d=l[a]=new Array(s),h=0;h<s;++h)(u=o[h])&&(c=i.call(u,u.__data__,h,o))&&("__data__"in u&&(c.__data__=u.__data__),d[h]=c,bn(d[h],t,e,h,d,me(u,e)));return new je(l,this._parents,t,e)},selectAll:function Ld(i){var t=this._name,e=this._id;"function"!=typeof i&&(i=Ur(i));for(var n=this._groups,r=n.length,l=[],a=[],o=0;o<r;++o)for(var u,s=n[o],d=s.length,c=0;c<d;++c)if(u=s[c]){for(var f,h=i.call(u,u.__data__,c,s),v=me(u,e),b=0,y=h.length;b<y;++b)(f=h[b])&&bn(f,t,e,b,h,v);l.push(h),a.push(u)}return new je(l,a,t,e)},selectChild:ze.selectChild,selectChildren:ze.selectChildren,filter:function Id(i){"function"!=typeof i&&(i=Hr(i));for(var t=this._groups,e=t.length,n=new Array(e),r=0;r<e;++r)for(var s,l=t[r],a=l.length,o=n[r]=[],d=0;d<a;++d)(s=l[d])&&i.call(s,s.__data__,d,l)&&o.push(s);return new je(n,this._parents,this._name,this._id)},merge:function Ad(i){if(i._id!==this._id)throw new Error;for(var t=this._groups,e=i._groups,n=t.length,l=Math.min(n,e.length),a=new Array(n),o=0;o<l;++o)for(var h,s=t[o],d=e[o],u=s.length,c=a[o]=new Array(u),f=0;f<u;++f)(h=s[f]||d[f])&&(c[f]=h);for(;o<n;++o)a[o]=t[o];return new je(a,this._parents,this._name,this._id)},selection:function Pd(){return new Bd(this._groups,this._parents)},transition:function tu(){for(var i=this._name,t=this._id,e=zl(),n=this._groups,r=n.length,l=0;l<r;++l)for(var s,a=n[l],o=a.length,d=0;d<o;++d)if(s=a[d]){var u=me(s,t);bn(s,i,e,d,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new je(n,this._parents,i,e)},call:ze.call,nodes:ze.nodes,node:ze.node,size:ze.size,empty:ze.empty,each:ze.each,on:function Rd(i,t){var e=this._id;return arguments.length<2?me(this.node(),e).on.on(i):this.each(function Jd(i,t,e){var n,r,l=function Cd(i){return(i+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(t)?gr:_e;return function(){var a=l(this,i),o=a.on;o!==n&&(r=(n=o).copy()).on(t,e),a.on=r}}(e,i,t))},attr:function fd(i,t){var e=hn(i),n="transform"===e?Bs:Rl;return this.attrTween(i,"function"==typeof t?(e.local?hd:cd)(e,n,pr(this,"attr."+i,t)):null==t?(e.local?sd:od)(e):(e.local?ud:dd)(e,n,t))},attrTween:function md(i,t){var e="attr."+i;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;var n=hn(i);return this.tween(e,(n.local?yd:pd)(n,t))},style:function Qd(i,t,e){var n="transform"==(i+="")?Ls:Rl;return null==t?this.styleTween(i,function Md(i,t){var e,n,r;return function(){var l=hi(this,i),a=(this.style.removeProperty(i),hi(this,i));return l===a?null:l===e&&a===n?r:r=t(e=l,n=a)}}(i,n)).on("end.style."+i,jl(i)):"function"==typeof t?this.styleTween(i,function Dd(i,t,e){var n,r,l;return function(){var a=hi(this,i),o=e(this),s=o+"";return null==o&&(this.style.removeProperty(i),s=o=hi(this,i)),a===s?null:a===n&&s===r?l:(r=s,l=t(n=a,o))}}(i,n,pr(this,"style."+i,t))).each(function Gd(i,t){var e,n,r,o,l="style."+t,a="end."+l;return function(){var s=_e(this,i),d=s.on,u=null==s.value[l]?o||(o=jl(t)):void 0;(d!==e||r!==u)&&(n=(e=d).copy()).on(a,r=u),s.on=n}}(this._id,i)):this.styleTween(i,function Kd(i,t,e){var n,l,r=e+"";return function(){var a=hi(this,i);return a===r?null:a===n?l:l=t(n=a,e)}}(i,n,t),e).on("end.style."+i,null)},styleTween:function Wd(i,t,e){var n="style."+(i+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;return this.tween(n,function Hd(i,t,e){var n,r;function l(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&function Ud(i,t,e){return function(n){this.style.setProperty(i,t.call(this,n),e)}}(i,a,e)),n}return l._value=t,l}(i,t,null==e?"":e))},text:function qd(i){return this.tween("text","function"==typeof i?function Xd(i){return function(){var t=i(this);this.textContent=null==t?"":t}}(pr(this,"text",i)):function Yd(i){return function(){this.textContent=i}}(null==i?"":i+""))},textTween:function $d(i){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==i)return this.tween(t,null);if("function"!=typeof i)throw new Error;return this.tween(t,function Vd(i){var t,e;function n(){var r=i.apply(this,arguments);return r!==e&&(t=(e=r)&&function Zd(i){return function(t){this.textContent=i.call(this,t)}}(r)),t}return n._value=i,n}(i))},remove:function zd(){return this.on("end.remove",function jd(i){return function(){var t=this.parentNode;for(var e in this.__transition)if(+e!==i)return;t&&t.removeChild(this)}}(this._id))},tween:function Ks(i,t){var e=this._id;if(i+="",arguments.length<2){for(var a,n=me(this.node(),e).tween,r=0,l=n.length;r<l;++r)if((a=n[r]).name===i)return a.value;return null}return this.each((null==t?Ps:Ms)(e,i,t))},delay:function xd(i){var t=this._id;return arguments.length?this.each(("function"==typeof i?wd:bd)(t,i)):me(this.node(),t).delay},duration:function Od(i){var t=this._id;return arguments.length?this.each(("function"==typeof i?Sd:kd)(t,i)):me(this.node(),t).duration},ease:function _d(i){var t=this._id;return arguments.length?this.each(function Nd(i,t){if("function"!=typeof t)throw new Error;return function(){_e(this,i).ease=t}}(t,i)):me(this.node(),t).ease},easeVarying:function Td(i){if("function"!=typeof i)throw new Error;return this.each(function Ed(i,t){return function(){var e=t.apply(this,arguments);if("function"!=typeof e)throw new Error;_e(this,i).ease=e}}(this._id,i))},end:function eu(){var i,t,e=this,n=e._id,r=e.size();return new Promise(function(l,a){var o={value:a},s={value:function(){0==--r&&l()}};e.each(function(){var d=_e(this,n),u=d.on;u!==i&&((t=(i=u).copy())._.cancel.push(o),t._.interrupt.push(o),t._.end.push(s)),d.on=t}),0===r&&l()})},[Symbol.iterator]:ze[Symbol.iterator]};var lu={time:null,delay:0,duration:250,ease:function ru(i){return((i*=2)<=1?i*i*i:(i-=2)*i*i+2)/2}};function au(i,t){for(var e;!(e=i.__transition)||!(e=e[t]);)if(!(i=i.parentNode))throw new Error(`transition ${t} not found`);return e}Fi.prototype.interrupt=function js(i){return this.each(function(){!function Rs(i,t){var n,r,a,e=i.__transition,l=!0;if(e){for(a in t=null==t?null:t+"",e)(n=e[a]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",i,i.__data__,n.index,n.group),delete e[a]):l=!1;l&&delete i.__transition}}(this,i)})},Fi.prototype.transition=function ou(i){var t,e;i instanceof je?(t=i._id,i=i._name):(t=zl(),(e=lu).time=cr(),i=null==i?null:i+"");for(var n=this._groups,r=n.length,l=0;l<r;++l)for(var s,a=n[l],o=a.length,d=0;d<o;++d)(s=a[d])&&bn(s,i,t,d,a,e||au(s,t));return new je(n,this._parents,i,t)};Math;function Ui(i){return{type:i}}function pi(i){return function(){return i}}function Kl(i){this._context=i}function yu(i){return new Kl(i)}["w","e"].map(Ui),["n","s"].map(Ui),["n","w","e","s","nw","ne","sw","se"].map(Ui),Kl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(i,t){switch(i=+i,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(i,t):this._context.moveTo(i,t);break;case 1:this._point=2;default:this._context.lineTo(i,t)}}};const _r=Math.PI,Er=2*_r,ei=1e-6,pu=Er-ei;function Dl(i){this._+=i[0];for(let t=1,e=i.length;t<e;++t)this._+=arguments[t]+i[t]}class In{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?Dl:function mu(i){let t=Math.floor(i);if(!(t>=0))throw new Error(`invalid digits: ${i}`);if(t>15)return Dl;const e=10**t;return function(n){this._+=n[0];for(let r=1,l=n.length;r<l;++r)this._+=Math.round(arguments[r]*e)/e+n[r]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,r){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(t,e,n,r,l,a){this._append`C${+t},${+e},${+n},${+r},${this._x1=+l},${this._y1=+a}`}arcTo(t,e,n,r,l){if(t=+t,e=+e,n=+n,r=+r,(l=+l)<0)throw new Error(`negative radius: ${l}`);let a=this._x1,o=this._y1,s=n-t,d=r-e,u=a-t,c=o-e,h=u*u+c*c;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(h>ei)if(Math.abs(c*s-d*u)>ei&&l){let f=n-a,v=r-o,b=s*s+d*d,y=f*f+v*v,g=Math.sqrt(b),O=Math.sqrt(h),x=l*Math.tan((_r-Math.acos((b+h-y)/(2*g*O)))/2),w=x/O,S=x/g;Math.abs(w-1)>ei&&this._append`L${t+w*u},${e+w*c}`,this._append`A${l},${l},0,0,${+(c*f>u*v)},${this._x1=t+S*s},${this._y1=e+S*d}`}else this._append`L${this._x1=t},${this._y1=e}`}arc(t,e,n,r,l,a){if(t=+t,e=+e,a=!!a,(n=+n)<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(r),s=n*Math.sin(r),d=t+o,u=e+s,c=1^a,h=a?r-l:l-r;null===this._x1?this._append`M${d},${u}`:(Math.abs(this._x1-d)>ei||Math.abs(this._y1-u)>ei)&&this._append`L${d},${u}`,n&&(h<0&&(h=h%Er+Er),h>pu?this._append`A${n},${n},0,1,${c},${t-o},${e-s}A${n},${n},0,1,${c},${this._x1=d},${this._y1=u}`:h>ei&&this._append`A${n},${n},0,${+(h>=_r)},${c},${this._x1=t+n*Math.cos(l)},${this._y1=e+n*Math.sin(l)}`)}rect(t,e,n,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function xu(i){return i[0]}function Su(i){return i[1]}function Gl(i,t){var e=pi(!0),n=null,r=yu,l=null,a=function bu(i){let t=3;return i.digits=function(e){if(!arguments.length)return t;if(null==e)t=null;else{const n=Math.floor(e);if(!(n>=0))throw new RangeError(`invalid digits: ${e}`);t=n}return i},()=>new In(t)}(o);function o(s){var d,c,f,u=(s=function gu(i){return"object"==typeof i&&"length"in i?i:Array.from(i)}(s)).length,h=!1;for(null==n&&(l=r(f=a())),d=0;d<=u;++d)!(d<u&&e(c=s[d],d,s))===h&&((h=!h)?l.lineStart():l.lineEnd()),h&&l.point(+i(c,d,s),+t(c,d,s));if(f)return l=null,f+""||null}return i="function"==typeof i?i:void 0===i?xu:pi(i),t="function"==typeof t?t:void 0===t?Su:pi(t),o.x=function(s){return arguments.length?(i="function"==typeof s?s:pi(+s),o):i},o.y=function(s){return arguments.length?(t="function"==typeof s?s:pi(+s),o):t},o.defined=function(s){return arguments.length?(e="function"==typeof s?s:pi(!!s),o):e},o.curve=function(s){return arguments.length?(r=s,null!=n&&(l=r(n)),o):r},o.context=function(s){return arguments.length?(null==s?n=l=null:l=r(n=s),o):n},o}function Ql(i,t,e){i._context.bezierCurveTo((2*i._x0+i._x1)/3,(2*i._y0+i._y1)/3,(i._x0+2*i._x1)/3,(i._y0+2*i._y1)/3,(i._x0+4*i._x1+t)/6,(i._y0+4*i._y1+e)/6)}function Ul(i){this._context=i}function Hl(i){return new Ul(i)}function mi(i,t,e){this.k=i,this.x=t,this.y=e}Ul.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ql(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(i,t){switch(i=+i,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(i,t):this._context.moveTo(i,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ql(this,i,t)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=t}},mi.prototype={constructor:mi,scale:function(i){return 1===i?this:new mi(this.k*i,this.x,this.y)},translate:function(i,t){return 0===i&0===t?this:new mi(this.k,this.x+this.k*i,this.y+this.k*t)},apply:function(i){return[i[0]*this.k+this.x,i[1]*this.k+this.y]},applyX:function(i){return i*this.k+this.x},applyY:function(i){return i*this.k+this.y},invert:function(i){return[(i[0]-this.x)/this.k,(i[1]-this.y)/this.k]},invertX:function(i){return(i-this.x)/this.k},invertY:function(i){return(i-this.y)/this.k},rescaleX:function(i){return i.copy().domain(i.range().map(this.invertX,this).map(i.invert,i))},rescaleY:function(i){return i.copy().domain(i.range().map(this.invertY,this).map(i.invert,i))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new mi(1,0,0);class Au{constructor(){let t={stroke:p.attribute.stroke,strokeWidth:p.attribute.strokeWidth,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:e,element:n,attribute:r,size:l}=Ne(Math.ceil(1e9*Math.random()),{attribute:t});m(n,r);let a="",o="";return{start:d=>{a=`M ${d.x} ${d.y} L ${d.x} ${d.y}`},move:(d,u)=>{((d,u)=>{a+=` ${d} ${u}`,n.setAttribute("d",a)})(d.x,d.y)},end:(d,u)=>{var c;u.length>=3?(o=null!==(c=Gl().x(O=>O[0]).y(O=>O[1]).curve(Hl)(u))&&void 0!==c?c:"",n.setAttribute("d",o)):n.setAttribute("d",a);let h=Be(o||a),{minX:f,minY:v,maxX:b,maxY:y}=He(h);l.x=f,l.y=v,l.width=b-f||1,l.height=y-v||1,l.ratioMaps=Vt(l,h),p.data.node=Object.assign({id:e,type:L.PATH,name:"Path"},{size:l,attribute:r})}}}}class Cu{constructor(){let t={stroke:p.attribute.stroke,strokeOpacity:.4,strokeWidth:p.attribute.strokeWidth,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:e,element:n,attribute:r,size:l}=Ne(Math.ceil(1e9*Math.random()),{attribute:t});m(n,r);let a="";return{start:d=>{a=`M ${d.x} ${d.y} L ${d.x} ${d.y}`},move:(d,u)=>{((d,u)=>{a+=` ${d} ${u}`,n.setAttribute("d",a)})(d.x,d.y)},end:(d,u)=>{let c=Be(a),{minX:h,minY:f,maxX:v,maxY:b}=He(c);l.x=h,l.y=f,l.width=v-h||1,l.height=b-f||1,l.ratioMaps=Vt(l,c),p.data.node=Object.assign({id:e,type:L.PATH,name:"Path"},{size:l,attribute:r})}}}}class Yl{constructor(t,e){var n,r;let l={stroke:"#FF0000",strokeWidth:at(2),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:at(8)},{element:a}=Ne(Math.ceil(1e9*Math.random()),{size:e});window.document.getElementById(lt.INTERACTIVE_GROUP).querySelectorAll("path").forEach(f=>null==f?void 0:f.remove()),window.document.getElementById(lt.INTERACTIVE_GROUP).querySelectorAll("circle").forEach(f=>null==f?void 0:f.remove()),null===(n=window.document.getElementById(lt.INTERACTIVE_GROUP))||void 0===n||n.appendChild(a);var d=f=>{if(!f.length)return;let v=[];if(1==f.length){var b;let{size:y}=null!==(b=null!=t?t:p.dataSelect.nodes[0])&&void 0!==b?b:{};if(!y)return;v=[[y.x+y.width/2,y.y+y.height/2],f[0]]}else v=[...f];c(v),u(v[0],"start"),u(v[v.length-1],"end")},u=(f,v)=>{f&&((b=>{let{element:y}=ge(Math.ceil(1e9*Math.random()),{attribute:{fill:"start"==v?"#FF0000":"#00BA00",strokeWidth:at(1)},size:{x:f[0]-5,y:f[1]-5,width:10,height:10}});null===(b=window.document.getElementById(lt.INTERACTIVE_GROUP))||void 0===b||b.prepend(y)})(),((b,y)=>{let{size:g}=null!==(b=null!=t?t:p.dataSelect.nodes[0])&&void 0!==b?b:{};if(!g)return;let O=[[f[0]-g.width/2,f[1]-g.height/2],[f[0]+g.width/2,f[1]-g.height/2],[f[0]+g.width/2,f[1]+g.height/2],[f[0]-g.width/2,f[1]+g.height/2],[f[0]-g.width/2,f[1]-g.height/2]],{element:x}=Ne(Math.ceil(1e9*Math.random()),{attribute:{fill:"#FFFFFF",fillOpacity:.6,stroke:"#5f6ce1",strokeWidth:at(1),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:at(8)},size:{x:0,y:0,width:10,height:10,points:O}});null===(y=window.document.getElementById(lt.INTERACTIVE_GROUP))||void 0===y||y.prepend(x)})())},c=f=>{let b=Gl().x(y=>y[0]).y(y=>y[1]).curve(Hl)(f);a.setAttribute("d",b)};m(a,l),d(null!==(r=null==e?void 0:e.points)&&void 0!==r?r:[]);let h="";return{start:f=>{h=`M ${f.x} ${f.y} L ${f.x} ${f.y}`},move:(f,v)=>{h+=` ${f.x} ${f.y}`,a.setAttribute("d",h)},end:(f,v)=>{d(v),v.length&&(window.interactivePoints=v)}}}}const Xl=i=>{var t,e;((i,t)=>{at(-1),at(1),at(8),N("icdt-temp-interactive-rect-center","rect",{attribute:Object.assign({x:t.x,y:t.y,width:t.width,height:t.height,class:"cursor-draw"},{fill:"transparent"})},i)})(N(lt.INTERACTIVE_GROUP,"g"),null!==(t=null===(e=p.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:(()=>{let{width:l,height:a}=p.screen.get;return{x:0,y:0,width:l,height:a}})()),i&&Tt(i,new Yl)};function ii(i,t,e,n){return Math.sqrt(Math.pow(e-i,2)+Math.pow(n-t,2))}function Hi(i,t,e,n,r){return ii(i,t,e,n)<r?1:0}function Tr(i,t,e,n,r,l,a){var o=[];return o.push(Hi(i,t,e,n,a)),o.push(Hi(i,t,r,l,a)),o.push(function zu(i,t,e,n,r,l,a){var o=[r-e,l-n],s=[i-e,t-n],d=[-o[1],o[0]],u=Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)),c=[d[0]/u,d[1]/u],h=Math.sqrt(Math.pow(o[0],2)+Math.pow(o[1],2)),f=[o[0]/h,o[1]/h],v=s[0]*f[0]+s[1]*f[1];if(v<=0||v>=h)return 0;var b=s[0]*c[0]+s[1]*c[1];return b>=a||b<=-a?0:1}(i,t,e,n,r,l,a)),o}function ql(i,t,e,n,r){var l=[e-i,n-t],a=[-l[1],l[0]],o=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)),s=[a[0]/o,a[1]/o];return[[i+r*s[0],t+r*s[1]],[i-r*s[0],t-r*s[1]],[e-r*s[0],n-r*s[1]],[e+r*s[0],n+r*s[1]]]}function wi(i,t,e,n,r,l,a){var v,o=[r-i,l-t],s=[e-i,n-t],d=Math.sqrt(Math.pow(s[0],2)+Math.pow(s[1],2)),u=[s[0]/d,s[1]/d],c=o[0]*u[0]+o[1]*u[1],h=[i+c*u[0],t+c*u[1]],f=Math.sqrt(Math.pow(r-h[0],2)+Math.pow(l-h[1],2));v=0===f?a:Math.sqrt(Math.pow(a,2)-Math.pow(f,2));var b=[i+c*u[0]+v*u[0],t+c*u[1]+v*u[1]];return b[0]===i&&b[1]===t?null:b}function ni(i,t,e,n,r,l,a){var o=[r-i,l-t],s=[e-i,n-t],d=[-s[1],s[0]],u=Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)),c=[d[0]/u,d[1]/u],h=o[0]*c[0]+o[1]*c[1],f=Bu([i,t],[e,n],[r,l]);if(Vl([f[0]-r,f[1]-l])>=a)return null;var b=Math.sqrt(Math.pow(a,2)-Math.pow(h,2)),y=[r-h*c[0],l-h*c[1]],g=Math.sqrt(Math.pow(s[0],2)+Math.pow(s[1],2)),O=[s[0]/g,s[1]/g],x=[[y[0]-O[0]*b,y[1]-O[1]*b],[y[0]+O[0]*b,y[1]+O[1]*b]];return x[0][0]===i&&x[0][1]===t?null:x}function Te(i,t,e,n,r,l,a,o){var s,d,u,c,h,f;return-(u=a-r)*(d=n-t)+(s=e-i)*(c=o-l)==0?null:(f=(u*(t-l)-c*(i-r))/(-u*d+s*c),(h=(-d*(i-r)+s*(t-l))/(-u*d+s*c))>=0&&h<=1&&f>=0&&f<=1?[i+f*s,t+f*d]:null)}function Zl(i,t,e,n,r,l,a,o,s,d){var u=ql(l,a,o,s,d),c=[];if(e[0]&&!e[1])c.push(wi(i,t,n,r,l,a,d)),c.push(Te(i,t,n,r,u[0][0],u[0][1],u[3][0],u[3][1])),c.push(Te(i,t,n,r,u[1][0],u[1][1],u[2][0],u[2][1])),(h=ni(i,t,n,r,o,s,d))&&c.push(h[0],h[1]);else if(!e[0]&&e[1])c.push(wi(i,t,n,r,o,s,d)),c.push(Te(i,t,n,r,u[0][0],u[0][1],u[3][0],u[3][1])),c.push(Te(i,t,n,r,u[1][0],u[1][1],u[2][0],u[2][1])),(h=ni(i,t,n,r,l,a,d))&&c.push(h[0],h[1]);else if(e[0]&&e[1])c.push(wi(i,t,n,r,l,a,d)),c.push(Te(i,t,n,r,u[0][0],u[0][1],u[3][0],u[3][1])),c.push(Te(i,t,n,r,u[1][0],u[1][1],u[2][0],u[2][1])),c.push(wi(i,t,n,r,o,s,d));else{var h=ni(i,t,n,r,o,s,d),f=ni(i,t,n,r,l,a,d);h&&c.push(h[0],h[1]),f&&c.push(f[0],f[1]),c.push(Te(i,t,n,r,u[0][0],u[0][1],u[3][0],u[3][1])),c.push(Te(i,t,n,r,u[1][0],u[1][1],u[2][0],u[2][1]))}for(var v=[i,t],b=0;b<c.length;b++)c[b]&&ii(c[b][0],c[b][1],n,r)<ii(v[0],v[1],n,r)&&(v=c[b]);return v[0]===i&&v[1]===t?null:v}function Fu(i,t,e,n,r,l,a,o,s){var d=ql(r,l,a,o,s),u=[],c=ni(i,t,e,n,r,l,s);c&&u.push(c[0],c[1]),(c=ni(i,t,e,n,a,o,s))&&u.push(c[0],c[1]),u.push(Te(i,t,e,n,d[0][0],d[0][1],d[3][0],d[3][1])),u.push(Te(i,t,e,n,d[1][0],d[1][1],d[2][0],d[2][1]));for(var h=[e,n],f=[i,t],v=0;v<u.length;v++)u[v]&&ii(u[v][0],u[v][1],i,t)<ii(h[0],h[1],i,t)&&(h=u[v]);for(var b=0;b<u.length;b++)u[b]&&ii(u[b][0],u[b][1],e,n)<ii(f[0],f[1],e,n)&&(f=u[b]);return h[0]===e&&h[1]===n||f[0]===i&&f[1]===t?null:[h,f]}var Vl=function(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])},Bu=function(i,t,e){var n=[t[0]-i[0],t[1]-i[1]],r=Vl(n);if(r<1e-6)return i;var l=[e[0]-i[0],e[1]-i[1]],a=(n[0]*l[0]+n[1]*l[1])/r;return a<0?i:a>r?t:[i[0]+n[0]*a/r,i[1]+n[1]*a/r]};class Pu{constructor(){let{element:n,size:l}=Ne(Math.ceil(1e9*Math.random()));m(n,{stroke:"#ddd",strokeWidth:10,strokeLinecap:"round",strokeLinejoin:"round"});let a="";return{start:d=>{a=`M ${d.x} ${d.y} L ${d.x} ${d.y}`},move:(d,u)=>{((d,u)=>{a+=` ${d} ${u}`,n.setAttribute("d",a)})(d.x,d.y)},end:(d,u)=>{n.remove(),(d=>{let u=9999,c=9999,h=-9999,f=-9999;d.forEach(b=>{u=Math.min(u,b[0]),c=Math.min(c,b[1]),h=Math.max(h,b[0]),f=Math.max(f,b[1])}),l=Ht(u,c,h,f,{points:d}),p.data.getNodeInArea(0,0,1920,1920,L.PATH).forEach(b=>{let g=((i,t,e)=>{e=e||20;var n=[],r=function(u){var c=t[0][0],h=t[0][1],f=0,v=0;if(1!==u.length||Hi(u[0][0],u[0][1],c,h,e)){for(var b;f<u.length-1;){var y=u[f],g=u[f+1],O=Hi(y[0],y[1],c,h,e),x=Hi(g[0],g[1],c,h,e);if(O&&x)v=++f;else if(O&&!x)(w=wi(y[0],y[1],g[0],g[1],c,h,e))?(u[f]=w,v=f):f++;else if(!O&&x){var w;(w=wi(g[0],g[1],y[0],y[1],c,h,e))&&((b=u.slice(v,f+1)).push(w),n.push(b)),v=++f}else{var S=ni(y[0],y[1],g[0],g[1],c,h,e);S?(((b=u.slice(v,f+1))[b.length-1][0]!==S[0][0]||b[b.length-1][1]!==S[0][1])&&b.push(S[0]),b.length>1&&n.push(b),u[f]=S[1],u[f+1]&&u[f+1][0]==S[1][0]&&u[f+1][1]==S[1][1]&&f++,v=f):f++}}v!==f&&(b=u.slice(v,u.length))&&n.push(b)}else n.push(u)},l=function(u,c){var g,h=t[c],f=t[c+1],v=0,b=0;if(1!==u.length||-1!==(y=Tr(u[0][0],u[0][1],h[0],h[1],f[0],f[1],e)).indexOf(1)){for(;v<u.length-1;){var O=u[v],x=u[v+1],y=Tr(O[0],O[1],h[0],h[1],f[0],f[1],e),w=Tr(x[0],x[1],h[0],h[1],f[0],f[1],e);if(-1!==y.indexOf(1)&&-1!==w.indexOf(1))b=++v;else if(-1!==y.indexOf(1)&&-1===w.indexOf(1))(S=Zl(O[0],O[1],y,x[0],x[1],h[0],h[1],f[0],f[1],e))?(u[v]=S,b=v):v++;else if(-1===y.indexOf(1)&&-1!==w.indexOf(1)){var S;(S=Zl(x[0],x[1],w,O[0],O[1],h[0],h[1],f[0],f[1],e))?((g=u.slice(b,v+1)).push(S),n.push(g),b=++v):v++}else{var J=Fu(O[0],O[1],x[0],x[1],h[0],h[1],f[0],f[1],e);J?(((g=u.slice(b,v+1))[g.length-1][0]!==J[0][0]||g[g.length-1][1]!==J[0][1])&&g.push(J[0]),g.length>1&&n.push(g),u[v]=J[1],u[v+1]&&u[v+1][0]==J[1][0]&&u[v+1][1]==J[1][1]&&v++,b=v):v++}}b!==v&&(g=u.slice(b,u.length))&&n.push(g)}else n.push(u)};if(t=function ju(i){var t=[];if(1===i.length)t=i;else{for(var e=0;e<i.length-1;)(i[e][0]!==i[e+1][0]||i[e][1]!==i[e+1][1])&&t.push(i[e]),e++;0!==i.length&&0===t.length&&t.push(i[0]),(i[i.length-1][0]!==i[t.length-1][0]||i[i.length-1][1]!==i[t.length-1][1])&&t.push(i[e])}return t}(t),1===t.length){for(var a=0;a<i.length;a++)r(i[a]);i=n}else for(var o=0;o<t.length-1;o++){for(a=0;a<i.length;a++)l(i[a],o);i=n,n=[]}for(var s=0;s<i.length;s++)for(var d=0;d<i[s].length;d++)i[s][d][0]=Math.round(i[s][d][0]),i[s][d][1]=Math.round(i[s][d][1]);return i})(p.data.getNode(b).size.points,d,2);console.log(g)})})(u)}}}}class Ku{constructor(){let t=N(lt.CREATE_GROUP,"g"),{nodeId:e,element:n,attribute:r,size:l,source:a}=Ce(Math.ceil(1e9*Math.random())),o=(s,d,u,c)=>{l=Ht(s,d,u,c),l.x=A(l.x),l.y=A(l.y),l.width=A(l.width),l.height=A(l.height),Object.assign(r,nt(L.TEXT,l,r)),m(n,r),I(t,l)};return{start:s=>{o(s.x,s.y,s.x+l.width,s.y+l.height)},move:(s,d)=>{o(d[0][0],d[0][1],s.x,s.y)},end:(s,d)=>{l.width<100&&(l.width=100),l.height<20&&(l.height=20),l.width+l.height<8&&(l.width=100,l.height=20,l.x=l.x-l.width/2,l.y=l.y-l.height/2,Object.assign(r,nt(L.TEXT,l,r)),m(n,r)),p.data.node=Object.assign({id:e,type:L.TEXT,name:"Text"},{size:l,attribute:r,source:a}),null==t||t.remove()}}}}const Wu=i=>{var t,e,n,r;let l=(null===(t=i.mouseEvent)||void 0===t?void 0:t.target)||(null===(e=i.touchEvent)||void 0===e?void 0:e.target),a=(null==l?void 0:l.getAttribute("id"))||"",o=null==l?void 0:l.nodeName,s=jQuery(l).parents("g[id]").attr("id")||"";if(![lt.INDEX_GROUP].includes(s))if(null!==(n=i.mouseEvent)&&void 0!==n&&n.altKey||null!==(r=i.touchEvent)&&void 0!==r&&r.altKey||!a||a.match(/[^0-9]/)||!p.dataSelect.nodeName.includes(o)){var d;p.dataSelect.ids.length&&(p.dataSelect.ids=[]),(0==(null===(d=i.mouseEvent)||void 0===d?void 0:d.button)||i.touchEvent)&&((i,t)=>{let a=N(lt.SCAN_GROUP,"g"),o=Ht(0,0,1,1);H(a,o),((i,t,e,n)=>{Tt(i,{start:a=>{},move:(a,o)=>{((a,o,s,d)=>{t=Ht(a,o,s,d),H(e,t)})(o[0][0],o[0][1],a.x,a.y)},end:(a,o)=>{null==e||e.remove(),p.dataSelect.ids=p.data.getNodeInArea(Math.min(o[0][0],a.x),Math.min(o[0][1],a.y),Math.max(o[0][0],a.x),Math.max(o[0][1],a.y)),n(p.dataSelect.nodes)}})})(i,o,a,t)})(i,$l)}else{var u,c;let h=parseFloat(a||"0");p.dataSelect.ids=null!==(u=i.mouseEvent)&&void 0!==u&&u.shiftKey||null!==(c=i.touchEvent)&&void 0!==c&&c.shiftKey?[h].concat(p.dataSelect.ids).filter((v,b,y)=>y.indexOf(v)==b):[h],$l(p.dataSelect.nodes)}},$l=i=>{var t,e;let n=1;var r,l;if(i.length&&(n=Math.max.apply(null,null!==(r=null===(l=p.data.slide)||void 0===l||null===(l=l.svg)||void 0===l?void 0:l.nodes.map(o=>{var s;return null!==(s=o.idx)&&void 0!==s?s:0}))&&void 0!==r?r:[0])+1),1==i.length)i[0].idx||(i[0].idx=n,i[0].time=0);else if(i.length>=0){let o=i.map(d=>{var u;return null!==(u=d.idx)&&void 0!==u?u:0}).filter(d=>d>0),s=o.length?Math.min.apply(null,o):n;i.forEach(d=>{var u;d.idx=s,d.time=null!==(u=d.time)&&void 0!==u?u:0})}let a=N(lt.INDEX_GROUP,"g");rt(a,null!==(t=null===(e=p.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.nodes)&&void 0!==t?t:[])},Yu=i=>{var t,e,n;null!=i&&null!==(t=i.svg)&&void 0!==t&&t.nodes&&i.svg.nodes.forEach(l=>{l.idx=0,l.time=null});let r=N(lt.INDEX_GROUP,"g");rt(r,null!==(e=null===(n=p.data.slide)||void 0===n||null===(n=n.svg)||void 0===n?void 0:n.nodes)&&void 0!==e?e:[])};class ta{constructor(){this._nodeName=["circle","ellipse","line","polygon","polyline","rect","text","tspan","path","image","foreignObject"],this._selected_Ids=[],this._contenteditable_Id=0,this._fnChanges=[]}get nodeName(){return this._nodeName}get ids(){return this._selected_Ids}set ids(t){this._selected_Ids=t,this.closeEditable(),this.change(this.ids)}get contenteditable_id(){return this._contenteditable_Id}get nodes(){return this._selected_Ids.map(t=>p.data.getNode(t)).filter(t=>!t.isfake)}set onchange(t){this._fnChanges.push(t)}change(t){this.cleanSelected(),this._fnChanges.forEach(e=>e(t))}deleteNode(){for(let t of this._selected_Ids){let e=p.data.deleteNode(t);p.history.push([{type:"delete",from:{id:e},to:{id:e}}])}p.dataSelect.ids=[]}groupNode(){let t=[];if(p.dataSelect.ids.length>=2){let e=p.data.getNode(p.dataSelect.ids[0]),{nodeId:n,attribute:r,size:l}=Me(Math.ceil(1e9*Math.random()),void 0,e.pid?window.document.getElementById(e.pid):null);p.data.node=Object.assign({id:n,type:L.GROUP,name:"G"},{size:l,attribute:r});for(let a of p.dataSelect.ids)t.push(p.data.addGroup(a,n))}t.length&&(p.dataSelect.ids=t,$t(p.dataSelect.nodes))}ungroupNode(){let t=[];for(let e of p.dataSelect.ids)t.push(p.data.unGroup(e));t.length&&(p.dataSelect.ids=t,$t(p.dataSelect.nodes))}cleanSelected(){var t,e,n,r,l;null===(t=window.document.getElementById(lt.RESIZE_GROUP))||void 0===t||t.remove(),null===(e=window.document.getElementById(lt.SELECT_GROUP))||void 0===e||e.remove(),null===(n=window.document.getElementById(lt.SCAN_GROUP))||void 0===n||n.remove(),null===(r=window.document.getElementById(lt.CREATE_GROUP))||void 0===r||r.remove(),null===(l=window.document.getElementById(lt.INTERACTIVE_GROUP))||void 0===l||l.remove(),jQuery('[id^="icdt-temp-"]').remove()}openEditable(){1==this._selected_Ids.length&&(this._contenteditable_Id=this._selected_Ids[0]);let t=p.data.getNode(this._contenteditable_Id);if(t.id){let{id:e,type:n,source:r}=t;k(document.getElementById(e.toString()),n,r,e)}this.cleanSelected()}closeEditable(){if(!this._contenteditable_Id)return;let t=p.data.getNode(this._contenteditable_Id);if(t.id){this._contenteditable_Id=0;let{id:e,type:n,source:r}=t;k(document.getElementById(e.toString()),n,r,e),this.cleanSelected(),$t(p.dataSelect.nodes)}}}class ea{createNodeImage(t,e){var n,r,l,a;let{nodeId:s,element:d,size:u,attribute:c,source:h}=ke(Math.ceil(1e9*Math.random()),{size:{x:(null!==(n=null==e?void 0:e.x)&&void 0!==n?n:50)-50,y:(null!==(r=null==e?void 0:e.y)&&void 0!==r?r:50)-50,width:100,height:100},source:{type:"image",image:Et(t)}});(f=>{if(!f)return;let v=new Image;v.onload=()=>{let b=A(v.naturalWidth/v.naturalHeight,100);b>=1?(u.width=Math.min(v.naturalWidth,512),u.height=A(u.width/b,100)):(u.height=Math.min(v.naturalHeight,512),u.width=A(u.height*b,100)),u.x=A(u.x+50-u.width/2,100),u.y=A(u.y+50-u.height/2,100),Object.assign(c,nt(L.IMAGE,u,c)),m(d,c),p.data.node=Object.assign({id:s,type:L.IMAGE,name:"Image"},{size:u,attribute:c,source:h})},v.onerror=b=>{console.error(`ImgSrc load failed -> ${f}`,b),null==d||d.remove()},v.src=f})(null!==(l=null===(a=h.image)||void 0===a?void 0:a.url)&&void 0!==l?l:"")}createNodeIframe(t,e){var n,r;let{nodeId:a,element:o,size:s,attribute:d,style:u,source:c}=de(Math.ceil(1e9*Math.random()),{size:{x:(null!==(n=null==e?void 0:e.x)&&void 0!==n?n:50)-50,y:(null!==(r=null==e?void 0:e.y)&&void 0!==r?r:50)-50,width:100,height:100},style:{},source:{type:"iframe",iframe:Et(t)}});(h=>{let f=(null===(h=p.data.slide)||void 0===h||null===(h=h.svg)||void 0===h?void 0:h.viewBox)||{x:0,y:0,width:100,height:100},v=A(f.width/f.height,100);v>=1?(s.width=Math.min(f.width,512),s.height=A(s.width/v,100)):(s.height=Math.min(f.height,512),s.width=A(s.height*v,100)),s.x=A(s.x+50-s.width/2,100),s.y=A(s.y+50-s.height/2,100),Object.assign(d,nt(L.IMAGE,s,d)),m(o,d),p.data.node=Object.assign({id:a,type:L.FOREIGNOBJECT,name:"ForeignObject"},{size:s,attribute:d,style:u,source:c})})()}createNodeEmbed(t,e){var n,r;let l={x:50,y:50,width:640,height:360};902==t.type&&(l.width=480,l.height=80);let{nodeId:a,element:o,size:s,attribute:d,style:u,source:c}=de(Math.ceil(1e9*Math.random()),{size:{x:(null!==(n=null==e?void 0:e.x)&&void 0!==n?n:l.x)-l.x,y:(null!==(r=null==e?void 0:e.y)&&void 0!==r?r:l.y)-l.y,width:l.width,height:l.height},style:{},source:{type:"embed",embed:Object.assign(t,Et(t))}});(()=>{let h=A(l.width/l.height,100);h>=1?(s.width=Math.min(s.width,l.width),s.height=A(s.width/h,1)):(s.height=Math.min(s.height,l.height),s.width=A(s.height*h,1)),s.x=A(s.x+l.x-s.width/2,1),s.y=A(s.y+l.y-s.height/2,1),Object.assign(d,nt(L.FOREIGNOBJECT,s,d)),m(o,d),p.data.node=Object.assign({id:a,type:L.FOREIGNOBJECT,name:"ForeignObject"},{size:s,attribute:d,style:u,source:c})})()}createNodeMedia(t,e){var n,r,l,a;let{nodeId:s,element:d,size:u,attribute:c,source:h}=ke(Math.ceil(1e9*Math.random()),{size:{x:(null!==(n=null==e?void 0:e.x)&&void 0!==n?n:50)-50,y:(null!==(r=null==e?void 0:e.y)&&void 0!==r?r:50)-50,width:100,height:100},source:{type:"image",image:Et(t.cover)}}),f={click:{media:t.media}};(v=>{if(!v)return;let b=new Image;b.onload=()=>{let y=A(b.naturalWidth/b.naturalHeight,100);y>=1?(u.width=Math.min(b.naturalWidth,512),u.height=A(u.width/y,100)):(u.height=Math.min(b.naturalHeight,512),u.width=A(u.height*y,100)),u.x=A(u.x+50-u.width/2,100),u.y=A(u.y+50-u.height/2,100),Object.assign(c,nt(L.IMAGE,u,c)),m(d,c),p.data.node=Object.assign({id:s,type:L.IMAGE,name:"Image"},{size:u,attribute:c,source:h,interactive:f})},b.onerror=y=>{console.error(`ImgSrc load failed -> ${v}`,y),null==d||d.remove()},b.src=v})(null!==(l=null===(a=h.image)||void 0===a?void 0:a.url)&&void 0!==l?l:"")}createNodeText(t,e){var n,r;let{nodeId:a,element:o,size:s,attribute:d,style:u,source:c}=de(Math.ceil(1e9*Math.random()),{size:{x:(null!==(n=null==e?void 0:e.x)&&void 0!==n?n:0)-0,y:(null!==(r=null==e?void 0:e.y)&&void 0!==r?r:0)-0,width:320,height:80},style:{},source:{type:"html",html:{htmlContent:`<span style="font-family: Roboto; font-size: 24px;">${t.content}</span>`}}});(()=>{let h=A(4,100);h>=1?(s.width=Math.min(s.width,320),s.height=A(s.width/h,1)):(s.height=Math.min(s.height,80),s.width=A(s.height*h,1)),s.x=A(s.x+0-s.width/2,1),s.y=A(s.y+0-s.height/2,1),Object.assign(d,nt(L.FOREIGNOBJECT,s,d)),m(o,d),p.data.node=Object.assign({id:a,type:L.FOREIGNOBJECT,name:"ForeignObject"},{size:s,attribute:d,style:u,source:c})})()}insert(t){var e;if(p.data.insertSlide(p.data.slideId,1),t.title){let{nodeId:n,size:r,attribute:l,style:a,source:o}=de(Math.ceil(1e9*Math.random()),{size:{x:100,y:100,width:800,height:150},source:{type:"html",html:{htmlContent:`<span style="font-size: 40px;">${t.title}</span>`}}});p.data.node=Object.assign({id:n,type:L.FOREIGNOBJECT,name:"ForeignObject"},{size:r,attribute:l,style:a,source:o})}if(t.description){let{nodeId:n,size:r,attribute:l,style:a,source:o}=de(Math.ceil(1e9*Math.random()),{size:{x:100,y:300,width:600,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 24px;">${t.description.replace(/\n/g,"<br/>")}</span>`}}});p.data.node=Object.assign({id:n,type:L.FOREIGNOBJECT,name:"ForeignObject"},{size:r,attribute:l,style:a,source:o})}null!==(e=t.media)&&void 0!==e&&e.prompt&&((()=>{let{nodeId:n,size:r,attribute:l}=Wt(Math.ceil(1e9*Math.random()),{size:{x:775,y:275,width:350,height:350},attribute:{fill:"#FFFFFF",stroke:"#E6E6E6",strokeWidth:1,strokeDasharray:1,rx:4}});p.data.node=Object.assign({id:n,type:L.RECT,name:"Rect"},{size:r,attribute:l})})(),(n=>{let{nodeId:r,size:l,attribute:a,style:o,source:s}=de(Math.ceil(1e9*Math.random()),{size:{x:800,y:300,width:300,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 18px; color: #6633cc"><i>${null===(n=t.media)||void 0===n?void 0:n.prompt}</i></span>`}}});p.data.node=Object.assign({id:r,type:L.FOREIGNOBJECT,name:"ForeignObject"},{size:l,attribute:a,style:o,source:s})})())}}class ia{get newSlideId(){return Math.ceil(1e9*Math.random())}get _defaultSlide(){return JSON.parse(JSON.stringify({id:this.newSlideId,name:"Trang m\u1edbi",svg:{viewBox:p.screen.frameSize,nodes:[]}}))}constructor(){this._dataSource={slides:[],resources:[]},this._slideIdx=0,this._fnChangeSlides=[],this.getNodeAll=()=>{var t;let e=null===(t=this._dataSource.slides)||void 0===t?void 0:t.find((l,a)=>a==this._slideIdx),n=null==e?void 0:e.svg,r=l=>{let a=[];return l.filter(o=>!o.isdeleted).forEach(o=>{o.type==L.GROUP?a=a.concat(r(o.nodes||[])):a.push(o.id)}),a};return r((null==n?void 0:n.nodes)||[])}}get get(){var t;let e=n=>{var r,l;return null===(r=n)||void 0===r||r.filter(a=>a.type==L.GROUP).forEach(a=>{var o;a.nodes=e(null===(o=a.nodes)||void 0===o?void 0:o.filter(s=>!s.isdeleted))}),(n=null===(l=n)||void 0===l?void 0:l.filter(a=>{var o,s;return a.type!=L.GROUP||(null!==(o=null===(s=a.nodes)||void 0===s?void 0:s.length)&&void 0!==o?o:0)>0}))||[]};return null===(t=this._dataSource.slides)||void 0===t||t.forEach(n=>{var r;n.svg&&(n.svg.nodes=e(null===(r=n.svg)||void 0===r||null===(r=r.nodes)||void 0===r?void 0:r.filter(l=>!l.isdeleted)))}),this._dataSource}get getResource(){var t;let e=[];return null===(t=this._dataSource.slides)||void 0===t||t.forEach(n=>{var r,l,a,o,s,d,u,c;e.push(null===(r=n.svg)||void 0===r||null===(r=r.background)||void 0===r?void 0:r.path),null===(l=n.svg)||void 0===l||l.nodes.forEach(h=>{var f,v,b,y,g,O,x,w,S,J;e.push(null===(f=h.source)||void 0===f||null===(f=f.image)||void 0===f?void 0:f.path),e.push(null===(v=h.source)||void 0===v||null===(v=v.audio)||void 0===v?void 0:v.path),e.push(null===(b=h.source)||void 0===b||null===(b=b.video)||void 0===b?void 0:b.path),e.push(null===(y=h.source)||void 0===y||null===(y=y.file)||void 0===y?void 0:y.path),e.push(null===(g=h.source)||void 0===g||null===(g=g.iframe)||void 0===g?void 0:g.path),e.push(null===(O=h.source)||void 0===O||null===(O=O.track)||void 0===O?void 0:O.path),e.push(null===(x=h.interactive)||void 0===x||null===(x=x.show)||void 0===x||null===(x=x.audio)||void 0===x||null===(x=x.source)||void 0===x?void 0:x.path),e.push(null===(w=h.interactive)||void 0===w||null===(w=w.click)||void 0===w||null===(w=w.audio)||void 0===w||null===(w=w.source)||void 0===w?void 0:w.path),e.push(null===(S=h.interactive)||void 0===S||null===(S=S.click)||void 0===S||null===(S=S.image)||void 0===S||null===(S=S.source)||void 0===S?void 0:S.path),e.push(null===(J=h.interactive)||void 0===J||null===(J=J.click)||void 0===J||null===(J=J.video)||void 0===J||null===(J=J.source)||void 0===J?void 0:J.path)}),e.push(null===(a=n.test)||void 0===a||null===(a=a.audiotrue)||void 0===a?void 0:a.path),e.push(null===(o=n.test)||void 0===o||null===(o=o.audiofalse)||void 0===o?void 0:o.path),e.push(null===(s=n.test)||void 0===s||null===(s=s.effecttrue)||void 0===s?void 0:s.path),e.push(null===(d=n.test)||void 0===d||null===(d=d.effectfalse)||void 0===d?void 0:d.path),e.push(null===(u=n.test)||void 0===u||null===(u=u.icontrue)||void 0===u?void 0:u.path),e.push(null===(c=n.test)||void 0===c||null===(c=c.iconfalse)||void 0===c?void 0:c.path)}),e.filter(n=>n).map(n=>n.replace(/(\?|\#)[^\?\#]+/g,"").toLowerCase()).filter((n,r,l)=>l.indexOf(n)==r)}get getFonts(){var t;return xt(JSON.stringify(null!==(t=this._dataSource.slides)&&void 0!==t?t:[]))}set set(t){this._dataSource=t,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),ci(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get dataSource(){var t;let e=n=>{var r,l;return null===(r=n)||void 0===r||r.filter(a=>a.type==L.GROUP).forEach(a=>{var o;a.nodes=e(null===(o=a.nodes)||void 0===o?void 0:o.filter(s=>!s.isdeleted))}),(n=null===(l=n)||void 0===l?void 0:l.filter(a=>{var o,s;return a.type!=L.GROUP||(null!==(o=null===(s=a.nodes)||void 0===s?void 0:s.length)&&void 0!==o?o:0)>0}))||[]};return null===(t=this._dataSource.slides)||void 0===t||t.forEach(n=>{var r;n.svg&&(n.svg.nodes=e(null===(r=n.svg)||void 0===r||null===(r=r.nodes)||void 0===r?void 0:r.filter(l=>!l.isdeleted)))}),this._dataSource.resources=this.getResource,this._dataSource}set dataSource(t){this._dataSource=t,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),ci(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get slideId(){var t,e;return null!==(t=null===(e=this.slide)||void 0===e?void 0:e.id)&&void 0!==t?t:0}get slideIdx(){return this._slideIdx}get slide(){var t;return null===(t=this._dataSource.slides)||void 0===t?void 0:t.find((e,n)=>n==this._slideIdx)}get slides(){return this._dataSource.slides||[]}backSlide(){this._slideIdx>0&&(this._slideIdx-=1,this.openSlide(void 0,this._slideIdx))}nextSlide(){var t,e;this._slideIdx<(null!==(t=null===(e=this._dataSource.slides)||void 0===e?void 0:e.length)&&void 0!==t?t:0)-1&&(this._slideIdx+=1,this.openSlide(void 0,this._slideIdx))}refreshSlide(){ci(),ce(this.slide)}openSlide(t,e){var n,r,l,a,o;if(t)for(let h=0,f=null!==(s=null===(d=this._dataSource.slides)||void 0===d?void 0:d.length)&&void 0!==s?s:0;h<f;h++){var s,d,u;if((null!==(u=this._dataSource.slides)&&void 0!==u?u:[])[h].id==t){this._slideIdx=h;break}}else if(e&&e>=0&&e<(null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.length)&&void 0!==n?n:0))this._slideIdx=null!=e?e:0;else{var c;this._slideIdx=0,null!==(c=this._dataSource.slides)&&void 0!==c&&c.length||(this._dataSource.slides=[JSON.parse(JSON.stringify(this._defaultSlide))])}ci(),null!==(l=this.slide)&&void 0!==l&&null!==(l=l.svg)&&void 0!==l&&l.viewBox&&(p.screen.frameSize=this.slide.svg.viewBox),ce(this.slide),this.changeSlide(this.slides,this.slideIdx,null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.length)&&void 0!==a?a:0,this.slide)}addSlide(){var t,e,n;null===(t=this._dataSource.slides)||void 0===t||t.push(this._defaultSlide),this._slideIdx=(null!==(e=null===(n=this._dataSource.slides)||void 0===n?void 0:n.length)&&void 0!==e?e:0)-1,this.openSlide(void 0,this._slideIdx)}tryMergeSlide(t,e,n){var r,l,a;let o=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(s=>s.id==t);return o?null!==(l=o.test)&&void 0!==l&&l.type&&null!==(a=e.test)&&void 0!==a&&a.type?"boolean"!=typeof n?-1:n?this.mergeSlide(t,o,e):this.insertSlide(t,1,e):this.mergeSlide(t,o,e):this.insertSlide(t,1,e)}tryReplaceSlide(t,e){var n,r,l,a,o;let s=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find(u=>u.id==t);if(!s||null!=s&&null!==(r=s.svg)&&void 0!==r&&r.nodes.filter(u=>!u.isdeleted).length)return this.insertSlide(t,1,e);let d=null!==(l=null===(a=this._dataSource.slides)||void 0===a?void 0:a.indexOf(s))&&void 0!==l?l:0;return null===(o=this._dataSource.slides)||void 0===o||o.splice(d,1,e),this._slideIdx=d,this.openSlide(void 0,this._slideIdx),1}mergeSlide(t,e,n){var r,l,a,o;return e.test=null!==(r=n.test)&&void 0!==r?r:e.test,e.audio=null!==(l=n.audio)&&void 0!==l?l:e.audio,e.svg?e.svg.nodes=e.svg.nodes.concat(null!==(a=null===(o=n.svg)||void 0===o?void 0:o.nodes)&&void 0!==a?a:[]):e.svg=n.svg,this.openSlide(t),1}insertSlide(t,e,n){var r,l,a,o,s;let d=null!==(r=null===(l=this._dataSource.slides)||void 0===l?void 0:l.find(h=>h.id==t))&&void 0!==r?r:this._defaultSlide,u=(null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(d))&&void 0!==a?a:0)+e;var c;return n?(n.id=this.newSlideId,n.code=void 0,n.name||(n.name="Trang m\u1edbi"),null!==(c=n.svg)&&void 0!==c&&c.viewBox||n.svg&&(n.svg.viewBox=p.screen.frameSize)):n=this._defaultSlide,null===(s=this._dataSource.slides)||void 0===s||s.splice(u,0,n),this._slideIdx=u,this.openSlide(void 0,this._slideIdx),1}copySlide(t){var e,n,r,l,a,o,s;let d=null!==(e=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find(h=>h.id==t))&&void 0!==e?e:this._defaultSlide,u=(null!==(r=null===(l=this._dataSource.slides)||void 0===l?void 0:l.indexOf(d))&&void 0!==r?r:0)+1,c=Object.assign(JSON.parse(JSON.stringify(d)),{id:this.newSlideId,code:void 0,name:`${d.name} + (Copy)`});null===(a=this._dataSource.slides)||void 0===a||a.splice(u,0,c),this.changeSlide(this.slides,this.slideIdx,null!==(o=null===(s=this._dataSource.slides)||void 0===s?void 0:s.length)&&void 0!==o?o:0,this.slide)}moveSlide(t,e){var n,r,l,a,o,s;let d=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(c=>c.id==t))&&void 0!==n?n:this._defaultSlide,u=null!==(l=null===(a=this._dataSource.slides)||void 0===a?void 0:a.indexOf(d))&&void 0!==l?l:0;null===(o=this._dataSource.slides)||void 0===o||o.splice(u+e,0,null===(s=this._dataSource.slides)||void 0===s?void 0:s.splice(u,1)[0])}deleteSlide(t){var e,n,r,l,a,o;let s=null!==(e=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find(h=>h.id==t))&&void 0!==e?e:this._defaultSlide,d=null!==(r=null===(l=this._dataSource.slides)||void 0===l?void 0:l.indexOf(s))&&void 0!==r?r:0;if(null===(a=this._dataSource.slides)||void 0===a||a.splice(d,1),null!==(o=this._dataSource.slides)&&void 0!==o&&o.length)if(d<this._slideIdx){var u,c;--this._slideIdx,this.changeSlide(this.slides,this.slideIdx,null!==(u=null===(c=this._dataSource.slides)||void 0===c?void 0:c.length)&&void 0!==u?u:0,this.slide)}else d==this._slideIdx&&(--this._slideIdx,this.openSlide(void 0,this._slideIdx));else this.addSlide()}deleteSlide1(t){var e,n,r,l,a;let o=null!==(e=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find(d=>d.id==t))&&void 0!==e?e:this._defaultSlide,s=null!==(r=null===(l=this._dataSource.slides)||void 0===l?void 0:l.indexOf(o))&&void 0!==r?r:0;if(o.isdeleted=!0,null!==(a=this._dataSource.slides)&&void 0!==a&&null!==(a=a.filter(d=>!d.isdeleted))&&void 0!==a&&a.length){let d=!0;for(;o.isdeleted;)d?s++:s--,this._dataSource.slides[s]?o=this._dataSource.slides[s]:d=!d;this.openSlide(o.id)}else this.addSlide()}set onChangeSlide(t){this._fnChangeSlides.push(t)}changeSlide(t,e,n,r){this._fnChangeSlides.forEach(l=>l(t,e,n,r))}set node(t){var e,n;let r=null===(e=this._dataSource.slides)||void 0===e?void 0:e.find((l,a)=>a==this._slideIdx);null!=r&&null!==(n=r.svg)&&void 0!==n&&n.nodes&&r.svg.nodes.push(t),p.history.push([{type:"add",from:{id:t.id},to:{id:t.id}}]),ce(r),ce(r,null==r?void 0:r.id)}findNode(t){var e;let n=null===(e=this._dataSource.slides)||void 0===e?void 0:e.find((h,f)=>f==this._slideIdx),r=null==n?void 0:n.svg,l=(h,f)=>{let v=null==h?void 0:h.find(g=>g.id==t);if(v)return v.pid=f,v;let b=0,y=h.length||0;for(;b<y&&!v&&(v=l(h[b].nodes||[],h[b].id),!v);)b++;return v},a=l((null==r?void 0:r.nodes)||[]);var o,s,d,u,c;return a?(a.style=null!==(o=a.style)&&void 0!==o?o:{},a.source=null!==(s=a.source)&&void 0!==s?s:{},a.animate=null!==(d=a.animate)&&void 0!==d?d:{},a.interactive=null!==(u=a.interactive)&&void 0!==u?u:{},a.variable=null!==(c=a.variable)&&void 0!==c?c:{},a):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}getNode(t){var e;let n=null===(e=this._dataSource.slides)||void 0===e?void 0:e.find((o,s)=>s==this._slideIdx),r=null==n?void 0:n.svg,a=o=>{let s=(null==o?void 0:o.find(v=>v.id==t))||(o=>{let s=null,d=0,u=o.length||0;for(;d<u&&!s;){if(s=a(o[d].nodes),s){s.pid=o[d].id;break}d++}var c,h,f,v,b;return s&&(s.style=null!==(c=s.style)&&void 0!==c?c:{},s.source=null!==(h=s.source)&&void 0!==h?h:{},s.animate=null!==(f=s.animate)&&void 0!==f?f:{},s.interactive=null!==(v=s.interactive)&&void 0!==v?v:{},s.variable=null!==(b=s.variable)&&void 0!==b?b:{}),s})((null==o?void 0:o.filter(v=>v.type==L.GROUP))||[]);var d,u,c,h,f;return s&&(s.style=null!==(d=s.style)&&void 0!==d?d:{},s.source=null!==(u=s.source)&&void 0!==u?u:{},s.animate=null!==(c=s.animate)&&void 0!==c?c:{},s.interactive=null!==(h=s.interactive)&&void 0!==h?h:{},s.variable=null!==(f=s.variable)&&void 0!==f?f:{}),s};return a((null==r?void 0:r.nodes)||[])||{id:null,pid:null,type:null,element:document.createElement("div"),size:{x:0,y:0,width:0,height:0,points:[]},attribute:{},style:{},source:{},animate:{},interactive:{},variable:{},isfake:!0,isdeleted:!1,nodes:[]}}getNodeInArea(t,e,n,r,l){var a;let o=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find((u,c)=>c==this._slideIdx),s=null==o?void 0:o.svg,d=u=>{let c=[];return u.filter(h=>!h.isdeleted).forEach(h=>{h.type==L.GROUP?c=c.concat(d(h.nodes||[])):t>h.size.x||e>h.size.y||n<h.size.x+h.size.width||r<h.size.y+h.size.height||(l?h.type==l&&c.push(h.id):c.push(h.id))}),c};return d((null==s?void 0:s.nodes)||[])}getNodeOnArea(t,e,n,r,l){var a;let o=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find((u,c)=>c==this._slideIdx),s=null==o?void 0:o.svg,d=u=>{let c=[];return u.filter(h=>!h.isdeleted).forEach(h=>{h.type==L.GROUP?c=c.concat(d(h.nodes||[])):h.size.x+h.size.width<t||h.size.y+h.size.height<e||h.size.x>n||h.size.y>r||(l?h.type==l&&c.push(h.id):c.push(h.id))}),c};return d((null==s?void 0:s.nodes)||[])}deleteNode(t,e){var n;return this.getNode(t).isdeleted=null==e||e,ce(this.slide),ce(this.slide,null===(n=this.slide)||void 0===n?void 0:n.id),t}unGroup(t){var e,n;let r=this.getNode(t),l=Math.ceil(1e9*Math.random());return null===(e=this.slide)||void 0===e||null===(e=e.svg)||void 0===e||e.nodes.push(Object.assign(JSON.parse(JSON.stringify(r)),{id:l})),Object.assign(r,{isdeleted:!0}),ce(this.slide),ce(this.slide,null===(n=this.slide)||void 0===n?void 0:n.id),l}addGroup(t,e){var n;let r=this.getNode(t),l=this.getNode(e);l.nodes=l.nodes||[];let a=Math.ceil(1e9*Math.random());return l.nodes.push(Object.assign(JSON.parse(JSON.stringify(r)),{id:a})),Object.assign(r,{isdeleted:!0}),ce(this.slide),ce(this.slide,null===(n=this.slide)||void 0===n?void 0:n.id),a}setNodeP(t,e){var n;let r=null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n?void 0:n.nodes.find(l=>l.id==t);r&&(r.pid=e||null)}bringToFront(t){this.bringToFrontStep(t,0)}sendToBack(t){this.sendToBackStep(t,0)}bringToFrontStep(t,e){var n,r,l,a,o,s;null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((u,c)=>{u.index=c+1});let d=(null!==(r=null===(l=this.slide)||void 0===l||null===(l=l.svg)||void 0===l?void 0:l.nodes.length)&&void 0!==r?r:0)+1;t.map(u=>{var c,h;return{id:u,index:null!==(c=null===(h=this.slide)||void 0===h||null===(h=h.svg)||void 0===h||null===(h=h.nodes.find(f=>f.id==u))||void 0===h?void 0:h.index)&&void 0!==c?c:0}}).sort((u,c)=>u.index-c.index).forEach(u=>{var h,c;e?null===(h=this.slide)||void 0===h||null===(h=h.svg)||void 0===h||h.nodes.filter((f,v)=>f.id==u.id).forEach(f=>{f.index=e+u.index+u.index/1e3}):null===(c=this.slide)||void 0===c||null===(c=c.svg)||void 0===c||c.nodes.filter(f=>f.id==u.id).forEach(f=>{f.index=d+u.index})}),null===(a=this.slide)||void 0===a||null===(a=a.svg)||void 0===a||a.nodes.sort((u,c)=>{var h,f;return(null!==(h=u.index)&&void 0!==h?h:0)-(null!==(f=c.index)&&void 0!==f?f:0)}),un(this.slide),null===(o=window.document.getElementById(lt.RESIZE_GROUP))||void 0===o||o.remove(),null===(s=window.document.getElementById(lt.SELECT_GROUP))||void 0===s||s.remove(),$t(p.dataSelect.nodes)}sendToBackStep(t,e){var n,r,l,a;null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((o,s)=>{o.index=s+1}),t.map(o=>{var s,d;return{id:o,index:null!==(s=null===(d=this.slide)||void 0===d||null===(d=d.svg)||void 0===d||null===(d=d.nodes.find(u=>u.id==o))||void 0===d?void 0:d.index)&&void 0!==s?s:0}}).sort((o,s)=>o.index-s.index).forEach(o=>{var d,s;e?null===(d=this.slide)||void 0===d||null===(d=d.svg)||void 0===d||d.nodes.filter(u=>u.id==o.id).forEach(u=>{u.index=e+o.index+o.index/1e3}):null===(s=this.slide)||void 0===s||null===(s=s.svg)||void 0===s||s.nodes.filter(u=>u.id==o.id).forEach(u=>{u.index=o.index/100-1})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((o,s)=>{var d,u;return(null!==(d=o.index)&&void 0!==d?d:0)-(null!==(u=s.index)&&void 0!==u?u:0)}),un(this.slide),null===(l=window.document.getElementById(lt.RESIZE_GROUP))||void 0===l||l.remove(),null===(a=window.document.getElementById(lt.SELECT_GROUP))||void 0===a||a.remove(),$t(p.dataSelect.nodes)}bringToFrontArea(t){var e,n,r,l;let a=t.map(v=>p.data.getNode(v)).filter(v=>!v.isfake),{x1:o,y1:s,x2:d,y2:u}=na(a),c=this.getNodeOnArea(o,s,d,u);null===(e=this.slide)||void 0===e||null===(e=e.svg)||void 0===e||e.nodes.forEach((v,b)=>{v.index=b+1});let h=c.map(v=>{var b,y;return null!==(b=null===(y=this.slide)||void 0===y||null===(y=y.svg)||void 0===y||null===(y=y.nodes.find(g=>g.id==v))||void 0===y?void 0:y.index)&&void 0!==b?b:0}),f=Math.max.apply(null,h);t.forEach((v,b)=>{var y;null===(y=this.slide)||void 0===y||null===(y=y.svg)||void 0===y||y.nodes.filter(g=>g.id==v).forEach(g=>{g.index=f+(b+1)/100})}),null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.sort((v,b)=>{var y,g;return(null!==(y=v.index)&&void 0!==y?y:0)-(null!==(g=b.index)&&void 0!==g?g:0)}),un(this.slide),null===(r=window.document.getElementById(lt.RESIZE_GROUP))||void 0===r||r.remove(),null===(l=window.document.getElementById(lt.SELECT_GROUP))||void 0===l||l.remove(),$t(p.dataSelect.nodes)}sendToBackArea(t){var e,n,r,l;let a=t.map(v=>p.data.getNode(v)).filter(v=>!v.isfake),{x1:o,y1:s,x2:d,y2:u}=na(a),c=this.getNodeOnArea(o,s,d,u);null===(e=this.slide)||void 0===e||null===(e=e.svg)||void 0===e||e.nodes.forEach((v,b)=>{v.index=b+1});let h=c.map(v=>{var b,y;return null!==(b=null===(y=this.slide)||void 0===y||null===(y=y.svg)||void 0===y||null===(y=y.nodes.find(g=>g.id==v))||void 0===y?void 0:y.index)&&void 0!==b?b:0}),f=Math.min.apply(null,h)-1;t.forEach((v,b)=>{var y;null===(y=this.slide)||void 0===y||null===(y=y.svg)||void 0===y||y.nodes.filter(g=>g.id==v).forEach(g=>{g.index=f+(b+1)/100})}),null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.sort((v,b)=>{var y,g;return(null!==(y=v.index)&&void 0!==y?y:0)-(null!==(g=b.index)&&void 0!==g?g:0)}),un(this.slide),null===(r=window.document.getElementById(lt.RESIZE_GROUP))||void 0===r||r.remove(),null===(l=window.document.getElementById(lt.SELECT_GROUP))||void 0===l||l.remove(),$t(p.dataSelect.nodes)}}const na=i=>{let t=999999,e=999999,n=-999999,r=-999999;return i.forEach(l=>{t=Math.min(t,l.size.x),e=Math.min(e,l.size.y),n=Math.max(n,l.size.x+l.size.width),r=Math.max(r,l.size.y+l.size.height)}),{x1:t,y1:e,x2:n,y2:r}};class ra{constructor(){this._index=-1,this._dataSource=[],this.undoExecute=t=>{t.forEach(function(e){switch(e.type){case"add":p.data.deleteNode(e.from.id);break;case"edit":break;case"delete":p.data.deleteNode(e.from.id,!1);break;case"size":{let{id:n,type:r,size:l,attribute:a}=p.data.getNode(e.from.id);Object.assign(l,e.from.size),Object.assign(a,nt(r,l,a)),m(window.document.getElementById(n),a);break}case"attribute":{let{id:n,attribute:r}=p.data.getNode(e.from.id);Object.assign(r,e.from.attribute),m(window.document.getElementById(n),r);break}case"style":{let{id:n,style:r}=p.data.getNode(e.from.id);Object.assign(null!=r?r:{},e.from.style),_(window.document.getElementById(n),r);break}case"source":{let{id:n,type:r,source:l}=p.data.getNode(e.from.id);Object.assign(null!=l?l:{},e.from.source),k(window.document.getElementById(n),r,null!=l?l:{});break}case"animate":{let{animate:n}=p.data.getNode(e.from.id);Object.assign(null!=n?n:{},e.from.animate);break}case"interactive":{let{interactive:n}=p.data.getNode(e.from.id);Object.assign(null!=n?n:{},e.from.interactive);break}case"variable":{let{variable:n}=p.data.getNode(e.from.id);Object.assign(null!=n?n:{},e.from.variable);break}}}),p.dataSelect.ids=[]},this.redoExecute=t=>{t.forEach(function(e){switch(e.type){case"add":p.data.deleteNode(e.to.id,!1);break;case"edit":break;case"delete":p.data.deleteNode(e.to.id,!0);break;case"size":{let{id:n,type:r,size:l,attribute:a}=p.data.getNode(e.to.id);Object.assign(l,e.to.size),Object.assign(a,nt(r,l,a)),m(window.document.getElementById(n),a);break}case"attribute":{let{id:n,attribute:r}=p.data.getNode(e.to.id);Object.assign(r,e.to.attribute),m(window.document.getElementById(n),r);break}case"style":{let{id:n,style:r}=p.data.getNode(e.to.id);Object.assign(null!=r?r:{},e.to.style),_(window.document.getElementById(n),r);break}case"source":{let{id:n,type:r,source:l}=p.data.getNode(e.to.id);Object.assign(null!=l?l:{},e.to.source),k(window.document.getElementById(n),r,null!=l?l:{});break}case"animate":{let{animate:n}=p.data.getNode(e.to.id);Object.assign(null!=n?n:{},e.to.animate);break}case"interactive":{let{interactive:n}=p.data.getNode(e.to.id);Object.assign(null!=n?n:{},e.to.interactive);break}case"variable":{let{variable:n}=p.data.getNode(e.to.id);Object.assign(null!=n?n:{},e.to.variable);break}}}),p.dataSelect.ids=[]},this._fnChanges=[],this._index=-1,this._dataSource=[]}get index(){return this._index}get total(){return this._dataSource.length}get dataSource(){return this._dataSource}renew(){this._index=-1,this._dataSource=[],this.change()}push(t){this._index<0?(this._index=0,this._dataSource.length=0,this._dataSource[this._index]={data:t}):(this._index<this._dataSource.length-1&&this._dataSource.splice(this._index+1,this._dataSource.length-this._index-1),this._index++,this._dataSource.push({data:t})),this.change()}undo(){this._index<0||(this.undoExecute(this._dataSource[this._index].data),this._index--,this.change())}redo(){this._index>=this._dataSource.length-1||(this._index++,this.redoExecute(this._dataSource[this._index].data),this.change())}set onchange(t){this._fnChanges.push(t)}change(){this._fnChanges.forEach(t=>t(this.index,this.total))}}class la{constructor(){this._x=0,this._y=0,this._width=0,this._height=0,this._scale=1,this._dislocation={x:0,y:0},this._offset={x:0,y:0},this._svgSize={x:0,y:0,width:0,height:0},this._svgViewBox={x:0,y:0,width:0,height:0},this._frameSize={x:0,y:0,width:1280,height:720},this._actived=!1,this._fnZoomChanges=[]}get actived(){return this._actived}set actived(t){this._actived=t}get get(){return{x:this._frameSize.x,y:this._frameSize.y,w:this._frameSize.width,h:this._frameSize.height,width:this._frameSize.width,height:this._frameSize.height}}set set(t){var e,n;this._frameSize.width=null!==(e=null==t?void 0:t.width)&&void 0!==e?e:1080,this._frameSize.height=null!==(n=null==t?void 0:t.height)&&void 0!==n?n:1080,this.zoomTo="fit"}get width(){return this._width}get height(){return this._height}get scale(){return this._scale}get dislocation(){return this._dislocation}get offset(){return this._offset}get svgSize(){return this._svgSize}get svgViewBox(){return this._svgViewBox}set svgViewBox(t){this._svgViewBox=t}get frameSize(){return this._frameSize}set frameSize(t){this._frameSize.x=t.x,this._frameSize.y=t.y,this._frameSize.width=t.width,this._frameSize.height=t.height,this.reset()}set screen(t){this._offset=t.offset,this._width=t.width,this._height=t.height,this.reset()}reset(){this.scaleTo(this._scale,void 0,!0)}scaleTo(t,e,n){var r;if(!(t<.01||t>100)){if(e=null!==(r=e)&&void 0!==r?r:{x:this._width/2,y:this._height/2},n)this._dislocation.x=this._width/t/2-e.x,this._dislocation.y=this._height/t/2-e.y,this._dislocation.x+=(this._width-this._frameSize.width)/2,this._dislocation.y+=(this._height-this._frameSize.height)/2;else{var l={x:Math.max(0,Math.min(A(e.x/this._width,1e3),1)),y:Math.max(0,Math.min(A(e.y/this._height,1e3),1))},a={x:(this._width/t-this._width/this._scale)*l.x,y:(this._height/t-this._height/this._scale)*l.y};this._dislocation.x+=a.x,this._dislocation.y+=a.y}this._scale=t,this.change(),this.zoomChange(this.scale)}}set zoomTo(t){"fit"==t?this.scaleTo(Math.min((this._width-80)/this._frameSize.width,(this._height-80)/this._frameSize.height),void 0,!0):"number"==typeof t&&this.scaleTo(t/100,void 0,!0)}zoomIn(){this.scaleTo(this._scale+.04*this._scale)}zoomOut(){this.scaleTo(this._scale-.04*this._scale)}init(){return{svgViewBox:this.svgViewBox,svgSize:this.svgSize}}move(t,e){this._dislocation.x=t.x+e.x/this._scale,this._dislocation.y=t.y+e.y/this._scale,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this.refScreen()}change(){this._svgSize.x=this._x,this._svgSize.y=this._y,this._svgSize.width=this._width,this._svgSize.height=this._height,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this._svgViewBox.width=this._width/this._scale,this._svgViewBox.height=this._height/this._scale,this.refScreen()}refScreen(){(()=>{let i=p.screen.svgViewBox,t=p.screen.svgSize;p.target&&(p.target.setAttributeNS(null,"viewBox",`${i.x} ${i.y} ${i.width} ${i.height}`),p.target.style.left=`${t.x}px`,p.target.style.top=`${t.y}px`,p.target.style.width=`${t.width}px`,p.target.style.height=`${t.height}px`)})()}set onZoomChange(t){this._fnZoomChanges.push(t)}zoomChange(t){this._fnZoomChanges.forEach(e=>e(t))}}class aa{constructor(){this._fill="#D9D9D9",this._stroke="#AAAAAA",this._strokeWidth=1,this._strokeLinecap="round",this._strokeLinejoin="round",this._fontFamily=void 0,this._fontSize=20,this._textLength=void 0,this._fnChangeFills=[],this._fnChangeStrokes=[],this._fnChangeStrokeWidths=[],this.loadConfig()}loadConfig(){Fa({callback:t=>{this._fill=(null==t?void 0:t.fill)||this._fill,this._stroke=(null==t?void 0:t.stroke)||this._stroke,this._strokeWidth=(null==t?void 0:t.strokeWidth)||this._strokeWidth,this._strokeLinecap=(null==t?void 0:t.strokeLinecap)||this._strokeLinecap,this._strokeLinejoin=(null==t?void 0:t.strokeLinejoin)||this._strokeLinejoin,this.changeFill(this.fill),this.changeStroke(this.stroke),this.changeStrokeWidth(this.strokeWidth)}})}saveConfig(){La({params:{fill:this._fill,stroke:this._stroke,strokeWidth:this._strokeWidth,strokeLinecap:this._strokeLinecap,strokeLinejoin:this._strokeLinejoin}})}get fill(){return this._fill}set fill(t){this._fill=t,this.changeFill(this.fill)}get stroke(){return this._stroke}set stroke(t){this._stroke=t,this.changeStroke(this.stroke)}get strokeWidth(){return this._strokeWidth}set strokeWidth(t){this._strokeWidth=t,this.changeStrokeWidth(this.strokeWidth)}get strokeLinecap(){return this._strokeLinecap}set strokeLinecap(t){this._strokeLinecap=t}get strokeLinejoin(){return this._strokeLinejoin}set strokeLinejoin(t){this._strokeLinejoin=t}get fontFamily(){return this._fontFamily}get fontSize(){return this._fontSize}get textLength(){return this._textLength}set onchangefill(t){this._fnChangeFills.push(t)}changeFill(t){this._fnChangeFills.forEach(e=>e(t)),this.saveConfig()}set onchangestroke(t){this._fnChangeStrokes.push(t)}changeStroke(t){this._fnChangeStrokes.forEach(e=>e(t)),this.saveConfig()}set onchangestrokewidth(t){this._fnChangeStrokeWidths.push(t)}changeStrokeWidth(t){this._fnChangeStrokeWidths.forEach(e=>e(t)),this.saveConfig()}}var ae=function(i){return i&&JSON.parse(JSON.stringify(i))},Wi=[{key:"FinishedTest",type:"boolean",value:!1,note:"Ho\xe0n th\xe0nh BKT",system:!0,readonly:!1},{key:"TotalTest",type:"number",value:0,note:"T\u1ed5ng s\u1ed1 BKT",system:!0,readonly:!1},{key:"TotalTestDidNotPass",type:"number",value:0,note:"S\u1ed1 BKT kh\xf4ng v\u01b0\u1ee3t qua",system:!0,readonly:!1},{key:"TotalTestPassed",type:"number",value:0,note:"S\u1ed1 BKT \u0111\xe3 v\u01b0\u1ee3t qua",system:!0,readonly:!1}],Ir=[],Zu={key:"BienSo",value:"0",type:"number",note:null,readonly:!1},Vu={if:[{type:"variable",variable:"BienSo",variables:null,slide:null,node:null,condition:">",operator:null,valuetype:"value",value:5}],then:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo > 5"}],else:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo <= 5"}],id:"57623302",idx:1,variables:["BienSo"]};class oa{constructor(){this._data_variables=ae(Wi).concat(ae(Ir)),this._data_conditions=[],this.GetActionExecutings=[],this.GetActionExecuteds=[],this.FuncGetExecuteds=t=>{"function"==typeof t&&this.GetActionExecuteds.push(t)},this.OnGetActionExecuted=t=>{this.GetActionExecuteds.forEach(e=>{e(t)})},this.SetActionExecutings=[],this.FuncSetExecutings=t=>{"function"==typeof t&&this.SetActionExecutings.push(t)},this.OnSetActionExecuting=t=>{this.SetActionExecutings.forEach(e=>{e(t)})},this.SetActionExecuteds=[],this.FuncSetExecuteds=t=>{"function"==typeof t&&this.SetActionExecuteds.push(t)},this.OnSetActionExecuted=t=>{for(var e of(this.SetActionExecuteds.forEach(n=>{n(t)}),this.getCondition(t.key)||[]))e.if&&e.if.length>0&&(this.checkValueConditions(e.if)?this.setValueOperators(e.then||[]):this.setValueOperators(e.else||[]))}}renew(){this._data_variables=ae(Wi).concat(ae(Ir)),this._data_conditions=[]}get totalVariable(){return this._data_variables.length}get totalCondition(){return this._data_conditions.length}get get(){return{variables:this._data_variables||[],conditions:this._data_conditions||[]}}set set(t){if(!t)return;let e={};"string"==typeof t?e=JSON.parse(t):"object"==typeof t&&(e=t),this._data_variables=e.variables||[],this._data_conditions=e.conditions||(n=>(this._data_variables.map(r=>r.change||[]).forEach(r=>{n=n.concat(r)}),n))([]),Wi.forEach(n=>{var r=this._data_variables.filter(l=>l.key==n.key);r.length?r.forEach(function(l,a,o){l.type=n.type,l.readonly=n.readonly,l.system=n.system}):this._data_variables.push(n)})}getVariableTemp(){return ae(Zu)}getConditionTemp(){return ae(Vu)}getKeys(){return this._data_variables.map(function(t){return t.key}).sort(function(t,e){return t.localeCompare(e)})}getVariableAll(){return this._data_variables.length?ae(function(i,t){return function(e){for(var n of i.map(function(r){return r[t]}).sort())i.filter(function(r){return r[t]==n}).forEach(function(r){e.push(r)}),i=i.filter(function(r){return r[t]!=n});return e}([])}(this._data_variables,"key")):ae(Wi).concat(ae(Ir))}setVariableAll(t){t&&("string"==typeof t&&(t=JSON.parse(t)),"object"==typeof t&&(this._data_variables=t),Wi.forEach(e=>{var n=this._data_variables.filter(r=>r.key==e.key);n.length?n.forEach((r,l,a)=>{r.type=e.type,r.readonly=e.readonly,r.system=e.system}):this._data_variables.push(e)}))}getVariable(t){return t?ae(this._data_variables.filter(e=>e.key==t)[0]||{}):{}}setVariable(t,e,n){if(t){switch([null,void 0,NaN,1/0].indexOf(e)>=0&&(e=""),n||(n=(this._data_variables.filter(l=>l.key==t)[0]||{}).type||null),n){case"string":"string"!=typeof e&&(e=e.toString().trim());break;case"number":"number"!=typeof e&&(e=parseFloat(e)||0);break;case"boolean":"string"==typeof e&&(e=e.toLowerCase()),"boolean"!=typeof e&&(e="1"==e||"true"==e||"yes"==e||"dung"==e)}var r=this._data_variables.filter(l=>l.key==t);r.length?r.forEach(function(l,a,o){l.value=e,l.type=n}):this._data_variables.push({key:t,value:e,type:n})}}getValue(t,e){if(!t)return"";var n=this._data_variables.filter(function(a){return a.key==t});if(n.length){var l,r=n[0]||{};switch(this.OnGetActionExecuting(r),e||(e=r.type||null),e){case"string":l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":"string"==typeof r.value?r.value||"":r.value.toString().trim();break;case"number":l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?0:"number"==typeof r.value?r.value||0:parseFloat(r.value)||0;break;case"boolean":[null,void 0,NaN,1/0].indexOf(r.value)>=0?l=!1:"boolean"==typeof r.value?l=r.value:(l=(r.value+"").toLowerCase(),l="1"==r.value||"true"==r.value||"yes"==r.value||"dung"==r.value);break;case"audio-src":l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":r.value?`<audio controls style="width:280px;vertical-align:middle;"><source src="${r.value}"></source></audio>`:"";break;case"video-src":l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":r.value?`<video controls style="width:280px;vertical-align:middle;"><source src="${r.value}"></source></video>`:"";break;case"img-src":l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":r.value?`<img style="width:100%;vertical-align:middle;" src="${r.value}"/>`:"";break;default:l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":r.value}return this.OnGetActionExecuted(r),l}return null}setValue(t,e,n){if(t){switch([null,void 0,NaN,1/0].indexOf(e)>=0&&(e=""),n||(n=(this._data_variables.filter(function(a){return a.key==t})[0]||{}).type||null),n){case"string":"string"!=typeof e&&(e=e.toString().trim());break;case"number":"number"!=typeof e&&(e=parseFloat(e)||0);break;case"boolean":"string"==typeof e&&(e=e.toLowerCase()),"boolean"!=typeof e&&(e="1"==e||"true"==e||"yes"==e||"dung"==e)}var r=this._data_variables.filter(function(a){return a.key==t});if(r.length){var l=r[0];this.OnSetActionExecuting(l),l&&(l.value=e),this.OnSetActionExecuted(l)}}}getConditionAll(){return ae(this._data_conditions.sort(function(t,e){return t.idx-e.idx}))}setConditionAll(t){t&&("string"==typeof t&&(t=JSON.parse(t)),"object"==typeof t&&(this._data_conditions=t))}getCondition(t){return t?ae(this._data_conditions.filter(e=>e.variable==t||(e.variables||[]).indexOf(t)>=0).sort(function(e,n){return e.idx-n.idx})):{}}switchCondition(t,e,n){switch(t){case"==":return"string"==typeof n?(n=n.toLowerCase().trim(),"string"==typeof e&&(e=e.toLowerCase().trim()),n.split(";").map(function(r){return e==r.trim()?1:0}).reduce(function(r,l){return r+l})>0):e==n;case"!=":return"string"==typeof n?(n=n.toLowerCase().trim(),"string"==typeof e&&(e=e.toLowerCase().trim()),0==n.split(";").map(function(r){return e==r.trim()?1:0}).reduce(function(r,l){return r+l})):e!=n;case">=":return e>=n;case"<=":return e<=n;case">":return e>n;case"<":return e<n;case"\u2208":return n=(n+"").toLowerCase().trim(),e=(e+"").toLowerCase().trim(),n.split(";").map(function(r){return e.indexOf(r.trim())>=0?1:0}).reduce(function(r,l){return r+l})>0;case"\u2209":return n=(n+"").toLowerCase().trim(),e=(e+"").toLowerCase().trim(),0==n.split(";").map(function(r){return e.indexOf(r.trim())>=0?1:0}).reduce(function(r,l){return r+l});default:return!1}}switchOperator(t,e,n){switch(t){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"/":return e/n;case"=":return n;case"=!":return!n;case"==":return e==n;case"!=":return e!=n}}switchFormula(t,e){switch(t){case"sum":return e.reduce(function(r,l){return r+l});case"sub":return e.reduce(function(r,l){return r-l});case"pro":return e.reduce(function(r,l){return r*l});case"div":return e.reduce(function(r,l){return r/l});case"avg":var n=e.reduce(function(r,l){return r+l})/(e.length||1);return Math.round(1e4*(n+Number.EPSILON))/1e4;case"min":return Math.min.apply(null,e);case"max":return Math.max.apply(null,e);case"and":return e.reduce(function(r,l){return r&&l});case"or":return e.reduce(function(r,l){return r||l});default:return 0}}switchValueType_Condition(t){switch(t.valuetype){case"value":return this.switchCondition(t.condition,this.getValue(t.variable),t.value);case"variable":return this.switchCondition(t.condition,this.getValue(t.variable),this.getValue(t.value));default:return 0}}switchValueType_Operator(t){switch(t.valuetype){case"value":return this.switchOperator(t.operator,this.getValue(t.variable),t.value);case"variable":return this.switchOperator(t.operator,this.getValue(t.variable),this.getValue(t.value));case"variables":var e=this.switchFormula(t.valueformula,t.value.map(n=>this.getValue(n)));return this.switchOperator(t.operator,this.getValue(t.variable),e)}}checkValueCondition(t){return this.switchValueType_Condition(t)}getValueOperator(t){return this.switchValueType_Operator(t)}setValueOperator(t){null!=t&&t.variable&&this.setValue(t.variable,this.getValueOperator(t))}checkValueConditions(t){return 0==t.map(e=>{switch(e.type){case"variable":return this.switchValueType_Condition(e)?0:1;case"variables":return 0==e.variables.map(n=>this.switchValueType_Condition(Object.assign(ae(e),{variable:n}))?0:1).reduce(function(n,r){return n+r})?0:1;default:return 0}}).reduce((e,n)=>(null!=e?e:0)+(null!=n?n:0))}setValueOperators(t){for(var e of t)switch(e.type){case"variable":this.setValue(e.variable,this.getValueOperator(e));break;case"variables":for(var n of e.variables)this.setValue(n,this.getValueOperator(Object.assign(ae(e),{variable:n})));break;case"slide":V.runSlide(void 0,void 0,e.slide);break;case"node":{var r;Oe({id:e.node,nodeStatus:V.nodeStatus,slideStatus:V.slideStatus});let l=V.findNode(e.node);null!=l&&null!==(r=l.interactive)&&void 0!==r&&r.click&&Ye(l,V.nodeStatus,V.slideStatus);break}}}FuncGetExecutings(t){"function"==typeof t&&this.GetActionExecutings.push(t)}OnGetActionExecuting(t){this.GetActionExecutings.forEach(e=>{e(t)})}}class sa{constructor(){this._fnChangePointerTypes=[],this._fnChangePointerTypeTemps=[],this._fnChangePenTypes=[],this._fnChangeShapeTypes=[],this._fnChangePolygonTypes=[],this._fnChanges=[],this._pointer_type=0,this._pointer_type_temp=0,this._pen_type=0,this._shape_type=0,this._polygon_type=0}setPointer_nochange(t,e,n){if(this._pointer_type=t,e)switch(t){case vt.PEN:this._pen_type=e;break;case vt.SHAPE:this._shape_type=e,n&&e===L.POLYGON&&(this._polygon_type=n)}}get pointer_type(){return this._pointer_type}set pointer_type(t){switch(this._pointer_type=t,t){case vt.PEN:this._pen_type||(this._pen_type=Mt.DRAW);break;case vt.SHAPE:this._shape_type||(this._shape_type=L.RECT)}this.changePointerType(this.pointer_type),this.change(this.pointer_type)}get pointer_type_temp(){return this._pointer_type_temp}set pointer_type_temp(t){this._pointer_type_temp=t,this.changePointerTypeTemp(this.pointer_type),this.change(this.pointer_type_temp)}get pen_type(){return this._pen_type}set pen_type(t){this._pen_type=t,this.changePenType(this.pointer_type,this.pen_type),this.change(this.pointer_type,this.pen_type)}get shape_type(){return this._shape_type}set shape_type(t){this._shape_type=t,this.changeShapeType(this.pointer_type,this.shape_type),this.change(this.pointer_type,this.shape_type)}get polygon_type(){return this._polygon_type}set polygon_type(t){this._polygon_type=t,this.changePolygonType(this.pointer_type,this.shape_type,this.polygon_type),this.change(this.pointer_type,this.shape_type,this.polygon_type)}set onchangePointerType(t){this._fnChangePointerTypes.push(t)}changePointerType(t,e,n){this._fnChangePointerTypes.forEach(r=>r(t,e,n))}set onchangePointerTypeTemp(t){this._fnChangePointerTypeTemps.push(t)}changePointerTypeTemp(t,e,n){this._fnChangePointerTypeTemps.forEach(r=>r(t,e,n))}set onchangePenType(t){this._fnChangePenTypes.push(t)}changePenType(t,e,n){this._fnChangePenTypes.forEach(r=>r(t,e,n))}set onchangeShapeType(t){this._fnChangeShapeTypes.push(t)}changeShapeType(t,e,n){this._fnChangeShapeTypes.forEach(r=>r(t,e,n))}set onchangePolygonType(t){this._fnChangePolygonTypes.push(t)}changePolygonType(t,e,n){this._fnChangePolygonTypes.forEach(r=>r(t,e,n))}set onchange(t){this._fnChanges.push(t)}change(t,e,n){this._fnChanges.forEach(r=>r(t,e,n))}}const p=new class $u{constructor(){this._container="",this._svg="",this._screen=la.prototype,this._data=ia.prototype,this._dataSelect=ta.prototype,this._slide=ea.prototype,this._history=ra.prototype,this._attribute=aa.prototype,this._pointer=sa.prototype,this._variable=oa.prototype,this._data=new ia,this._dataSelect=new ta,this._slide=new ea,this._history=new ra,this._attribute=new aa,this._pointer=new sa,this._variable=new oa,this._pointer.onchangePointerType=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._data.onChangeSlide=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])}}get config(){return this._config}set config(t){this._config=t}get dataSource(){return{modules:"icdtV2",screen:this._screen.get,data:this._data.get,variable:this._variable.get,resources:this._data.getResource,fonts:this._data.getFonts,info:{}}}set dataSource(t){this._screen.set=t.screen||{width:1080,height:1080},this._data.set=t.data||{},this._variable.set=t.variable||{}}get container(){return this._container}set container(t){this._container=t}get svg(){return this._svg}set svg(t){this._svg=t}get target(){return window.document.querySelector(this._svg)}get screen(){return this._screen}get data(){return this._data}get dataSelect(){return this._dataSelect}get slide(){return this._slide}get history(){return this._history}get attribute(){return this._attribute}get pointer(){return this._pointer}get variable(){return this._variable}reloadView(){var t,e,n,r,l;this._screen.screen=(t=jQuery(this._container).offset(),e=jQuery(this._container).width(),n=jQuery(this._container).height(),{offset:{x:null!==(r=null==t?void 0:t.left)&&void 0!==r?r:0,y:null!==(l=null==t?void 0:t.top)&&void 0!==l?l:0},width:null!=e?e:0,height:null!=n?n:0})}init(t){this._container=t.container,this._svg=t.target,this._screen=new la,(i=>{new rr(i.container,i.target);var t=(r,l,a,o)=>{switch(r){case vt.POINTER:jQuery(i.target).css({cursor:"auto"});break;case vt.HAND:o?jQuery(i.target).css({cursor:"grabbing"}):jQuery(i.target).css({cursor:"grab"});break;case vt.PEN:switch(l){case Mt.DRAW:jQuery(i.target).css({cursor:"url(assets/images/svg/icon/viet.png) 12 32,default"});break;case Mt.HIGHTLIGH:jQuery(i.target).css({cursor:"url(assets/images/svg/icon/highlight1.png) 12 32,default"})}break;case vt.ERASER:jQuery(i.target).css({cursor:"url(assets/images/svg/icon/gom.png) 22 22,default"});break;case vt.SHAPE:jQuery(i.target).css({cursor:"url(assets/images/svg/icon/point.png) 22 22,default"});break;case vt.TEXT:case vt.FOREIGNOBJECT:jQuery(i.target).css({cursor:"url(assets/images/svg/icon/textmouse.png) 22 22,default"})}};p.pointer.onchange=(r,l,a)=>{t(r,l)},jQuery(i.container).off("mousedown.icdt-init-icon").on("mousedown.icdt-init-icon",r=>{t(p.pointer.pointer_type,void 0,0,!0)}).off("mouseup.icdt-init-icon").on("mouseup.icdt-init-icon",r=>{t(p.pointer.pointer_type,void 0,0,!1)}),document.addEventListener("wheel",r=>{r.ctrlKey&&r.preventDefault()},{passive:!1}),jQuery(i.container).off("wheel.icdt-init").on("wheel.icdt-init",r=>{var l;r.preventDefault();let a=null!==(l=r.originalEvent)&&void 0!==l?l:r;if(!a.deltaX&&a.deltaY!=Math.floor(a.deltaY)||a.ctrlKey){var o=p.screen.scale;p.screen.scaleTo(o-.04*o*(a.deltaY>0?1:-1),At({x:r.clientX,y:r.clientY},1,{x:0,y:0},p.screen.offset))}else p.screen.move(p.screen.dislocation,{x:-a.deltaX,y:-a.deltaY})}),jQuery(window).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{p.screen.actived=!!jQuery(r.target).parents(p.container).length}),jQuery(i.container).off("mouseenter.icdt-init").on("mouseenter.icdt-init",r=>{}),jQuery(i.container).off("mouseleave.icdt-init").on("mouseleave.icdt-init",r=>{p.pointer.pointer_type_temp==vt.HAND&&(p.pointer.pointer_type_temp=vt.POINTER)}),jQuery(i.container).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{0==r.button&&(i.container.includes("#")&&i.container.includes(r.target.getAttribute("id"))||i.container.includes(".")&&i.container.includes(r.target.getAttribute("class"))||i.container.includes(r.target.nodeName))&&(p.pointer.pointer_type_temp||p.pointer.pointer_type)===vt.POINTER&&(p.dataSelect.ids=[])}),jQuery(i.container).off("touchmove.icdt-init").on("touchmove.icdt-init",r=>{r.preventDefault()});const e=r=>{switch(p.pointer.pointer_type_temp||p.pointer.pointer_type){case vt.POINTER:var a,o,s;("touchstart"==(null===(a=r.touchEvent)||void 0===a?void 0:a.type)||"mousedown"==(null===(o=r.mouseEvent)||void 0===o?void 0:o.type)||"dblclick"==(null===(s=r.mouseEvent)||void 0===s?void 0:s.type))&&Na(r);break;case vt.HAND:var d,u;("touchstart"==(null===(d=r.touchEvent)||void 0===d?void 0:d.type)||"mousedown"==(null===(u=r.mouseEvent)||void 0===u?void 0:u.type))&&(i=>{Tt(i,new Ea,1,{x:0,y:0})})(r);break;case vt.PEN:var c,h;("touchstart"==(null===(c=r.touchEvent)||void 0===c?void 0:c.type)||"mousedown"==(null===(h=r.mouseEvent)||void 0===h?void 0:h.type))&&(i=>{switch(p.pointer.pen_type){case Mt.DRAW:Tt(i,new Au);break;case Mt.HIGHTLIGH:Tt(i,new Cu);break;case Mt.INTERACTIVE:Xl(i)}})(r);break;case vt.SHAPE:var f,v;("touchstart"==(null===(f=r.touchEvent)||void 0===f?void 0:f.type)||"mousedown"==(null===(v=r.mouseEvent)||void 0===v?void 0:v.type))&&(i=>{var t=null;switch(p.pointer.shape_type){case L.CIRCLE:t=new Ta;break;case L.ELLIPSE:t=new Ia;break;case L.LINE:t=new Ja;break;case L.RECT:t=new Aa;break;case L.POLYGON:var e;t=new Ca(null===(e=Qt.find(n=>n.type==p.pointer.polygon_type))||void 0===e?void 0:e.ratios);break;case L.FOREIGNOBJECT:t=new Pr;break;case L.IMAGE:t=new Mr;break;case L.TEXT:case L.PATH:t=new Br}t&&Tt(i,t)})(r);break;case vt.FOREIGNOBJECT:var b,y;("touchstart"==(null===(b=r.touchEvent)||void 0===b?void 0:b.type)||"mousedown"==(null===(y=r.mouseEvent)||void 0===y?void 0:y.type))&&(i=>{Tt(i,new Pr)})(r);break;case vt.IMAGE:var g,O;("touchstart"==(null===(g=r.touchEvent)||void 0===g?void 0:g.type)||"mousedown"==(null===(O=r.mouseEvent)||void 0===O?void 0:O.type))&&(i=>{Tt(i,new Mr)})(r);break;case vt.TEXT:var x,w;("touchstart"==(null===(x=r.touchEvent)||void 0===x?void 0:x.type)||"mousedown"==(null===(w=r.mouseEvent)||void 0===w?void 0:w.type))&&(i=>{Tt(i,new Ku)})(r);break;case vt.ERASER:var S,J;("touchstart"==(null===(S=r.touchEvent)||void 0===S?void 0:S.type)||"mousedown"==(null===(J=r.mouseEvent)||void 0===J?void 0:J.type))&&(i=>{Tt(i,new Pu)})(r);break;case vt.INDEX:var j,B;("touchstart"==(null===(j=r.touchEvent)||void 0===j?void 0:j.type)||"mousedown"==(null===(B=r.mouseEvent)||void 0===B?void 0:B.type))&&Wu(r)}};let n=!1;jQuery(i.target).off("touchstart.icdt-init").on("touchstart.icdt-init",r=>{n=!0,e({touchEvent:r})}),jQuery(i.target).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{if(1!=r.button){if(n)return void(n=!1);e({mouseEvent:r})}}),jQuery(i.target).off("dblclick.icdt-init").on("dblclick.icdt-init",r=>{if(1!=r.button){if(n)return void(n=!1);e({mouseEvent:r})}}),i.iskeyboard&&(jQuery(window).off("keydown.icdt-init").on("keydown.icdt-init",r=>{p.screen.actived&&(p.dataSelect.contenteditable_id||((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),Qr(r)))}),jQuery(window).off("keyup.icdt-init").on("keyup.icdt-init",r=>{p.screen.actived&&(p.dataSelect.contenteditable_id||((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),Qr(r)))}))})({container:t.container,target:t.target,iskeyboard:t.iskeyboard})}},Ge=i=>!!i.match("^#[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$"),Ar=i=>!!i.match(/^rgba?/),da=i=>!!i.match(/^none|transparent$/),tc=(i,t)=>{ca(i,null,t,i);var n=s=>{var d;"text"==s.nodeName?(s=>{var d;null!==(d=s.child)&&void 0!==d&&d.length&&(s.nodeName="g",s.child=s.child.reduce((u,c,h,f)=>{if("tspan"==c.nodeName){let y=u.find(g=>g.fill==c.fill&&g.y==c.y&&g["font-family"]==c["font-family"]&&g["font-weight"]==c["font-weight"]&&g["font-style"]==c["font-style"]&&g["font-size"]==c["font-size"]);var v,b;y?(y.x=Math.min(parseFloat(null!==(v=y.x)&&void 0!==v?v:"0"),parseFloat(null!==(b=c.x)&&void 0!==b?b:"0")),y.textContent+=c.textContent):(c.nodeName="text",u.push(c))}else u.push(c);return u},[]))})(s):null!==(d=s.child)&&void 0!==d&&d.length&&s.child.forEach(u=>n(u))},r=s=>s.reduce((d,u,c,h)=>{var f;if("g"==u.nodeName&&null!==(f=u.child)&&void 0!==f&&f.length&&(u.child=r(u.child)),"text"==u.nodeName){let y=d.find(g=>g.fill==u.fill&&g.y==u.y&&g["font-family"]==u["font-family"]&&g["font-weight"]==u["font-weight"]&&g["font-style"]==u["font-style"]&&g["font-size"]==u["font-size"]);var v,b;y?(y.x=Math.min(parseFloat(null!==(v=y.x)&&void 0!==v?v:"0"),parseFloat(null!==(b=u.x)&&void 0!==b?b:"0")),y.textContent+=u.textContent):d.push(u)}else d.push(u);return d},[]);t.forEach(s=>n(s)),t=r(t),console.log("SVG2JSON",t);let l=((s,d,u,c,h)=>{let f=null===(s=i.getAttribute("viewBox"))||void 0===s||null===(s=s.replace(/^([0-9\.]+)[\s]([0-9\.]+)[\s\,]([0-9\.]+)[\s\,]([0-9\.]+)$/g,"$1,$2,$3,$4"))||void 0===s||null===(s=s.split(","))||void 0===s?void 0:s.map(v=>A(parseFloat(v),1));return 4==(null==f?void 0:f.length)?{x:f[0],y:f[1],width:f[2],height:f[3]}:{x:null!==(d=Cn(i.getAttribute("x")))&&void 0!==d?d:0,y:null!==(u=Cn(i.getAttribute("y")))&&void 0!==u?u:0,width:null!==(c=Cn(i.getAttribute("width")))&&void 0!==c?c:0,height:null!==(h=Cn(i.getAttribute("height")))&&void 0!==h?h:0}})(),a={id:p.data.newSlideId,name:"SVG",svg:{viewBox:l,nodes:ua(t)}};if(console.log(a),a.svg&&(!a.svg.viewBox.width||!a.svg.viewBox.height)){var o;let s=0,d=0,u=c=>{c.forEach(h=>{var f;let{size:v}=h;s=Math.max(s,v.width),d=Math.max(d,v.height),u(null!==(f=h.nodes)&&void 0!==f?f:[])})};u(null!==(o=a.svg.nodes)&&void 0!==o?o:[]),a.svg.viewBox.width=s,a.svg.viewBox.height=d}return a},ua=(i,t)=>{let e=[];return i.forEach(n=>{let r={id:Math.ceil(1e9*Math.random()),pid:t,name:n.nodeName,type:(()=>{switch(n.nodeName){case"polygon":return L.POLYGON;case"polyline":return L.POLYLINE;case"path":return L.PATH;case"circle":return L.CIRCLE;case"ellipse":return L.ELLIPSE;case"line":return L.LINE;case"rect":return L.RECT;case"foreignObject":return L.FOREIGNOBJECT;case"image":return L.IMAGE;case"text":return L.TEXT;case"tspan":return L.TSPAN;case"g":return L.GROUP}return 0})(),size:((l,a)=>{let o={},s=0,d=0,u=0,c=0,h=null!==(l=n.rotate)&&void 0!==l?l:null;switch(n.nodeName){case"circle":{let f=parseFloat(n.cx||"0"),v=parseFloat(n.cy||"0"),b=parseFloat(n.r||"0");s=f-b,d=v-b,u=2*b,c=2*b;break}case"ellipse":{let f=parseFloat(n.cx||"0"),v=parseFloat(n.cy||"0"),b=parseFloat(n.rx||"0"),y=parseFloat(n.ry||"0");s=f-b,d=v-y,u=2*b,c=2*y;break}case"line":{let f=parseFloat(n.x1||"0"),v=parseFloat(n.y1||"0"),b=parseFloat(n.x2||"0"),y=parseFloat(n.y2||"0"),g=999999999,O=999999999,x=0,w=0;g=Math.min(f,b),O=Math.min(v,y),x=Math.max(f,b),w=Math.max(v,y),s=g,d=O,u=x-s||1,c=w-d||1,Object.assign(o,{ratios:[[(f-s)/u,(v-d)/c],[(b-s)/u,(y-d)/c]]});break}case"rect":s=parseFloat(n.x||"0"),d=parseFloat(n.y||"0"),u=parseFloat(n.width||"0"),c=parseFloat(n.height||"0"),Object.assign(o,{x:s,y:d,width:u,height:c});break;case"foreignObject":case"image":s=parseFloat(n.x||"0"),d=parseFloat(n.y||"0"),u=parseFloat(n.width||"0"),c=parseFloat(n.height||"0");break;case"text":case"tspan":o.x||o.y||(n.x&&(s=parseFloat(n.x||"0")),n.y&&(d=parseFloat(n.y||"0"))),(f=>{let v=16;var b,y,g;f&&(v=f.match(/rem/)?16*parseInt(f):parseInt(f)),c=1.2*(b=v),u=b/14*8*(null!==(y=null===(g=n.textContent)||void 0===g?void 0:g.length)&&void 0!==y?y:1),n["alignment-baseline"]||n["dominant-baseline"]||(d-=b)})(n["font-size"]||"16");break;case"polygon":case"polyline":{if(!n.points)break;let f=(i=>{return(t=i.replace(/\,/g," ").replace(/\-/g," -").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim())?t.split(/\s/).map(e=>parseFloat(e)):[];var t})(n.points),{minX:v,minY:b,maxX:y,maxY:g}=(i=>{let t=[],e=[];return i.forEach((n,r)=>{r%2==0?t.push(n):e.push(n)}),{minX:Math.min.apply(null,t),minY:Math.min.apply(null,e),maxX:Math.max.apply(null,t),maxY:Math.max.apply(null,e)}})(f);s=v,d=b,u=y-s||1,c=g-d||1,Object.assign(o,{ratios:jn({x:s,y:d,width:u,height:c},f)});break}case"path":{if(!n.d)break;let f=Be(n.d),{minX:v,minY:b,maxX:y,maxY:g}=He(f);s=v,d=b,u=y-s||1,c=g-d||1,Object.assign(o,{ratioMaps:Vt({x:s,y:d,width:u,height:c},f)});break}}return null!=(f=null===(a=n.transform)||void 0===a||null===(a=a.replace(/\,/," "))||void 0===a?void 0:a.replace(/\s+/g," "))&&f.match(/rotate\([^\)]+\)/)&&(O=null===(v=null!==(b=null==f?void 0:f.match(/rotate\([^\)]+\)/))&&void 0!==b?b:[])||void 0===v||null===(v=v.shift())||void 0===v?void 0:v.toString())&&(w=null==O||null===(x=O.replace(/[^0-9\-\.\,\ ]/g,""))||void 0===x||null===(x=x.replace(/\,/g," "))||void 0===x||null===(x=x.replace(/\s+/g," "))||void 0===x?void 0:x.split(" ")).length&&Object.assign(o,{rotate:parseFloat(w[0]||"0")}),null!=f&&f.match(/translate\([^\)]+\)/)&&(O=>{var x;O&&(w=>{w.length>=2&&(s+=parseFloat(w[0]||"0"),d+=parseFloat(w[1]||"0"))})(null==O||null===(x=O.replace(/[^0-9\-\.\,\ ]/g,""))||void 0===x||null===(x=x.replace(/\,/g," "))||void 0===x||null===(x=x.replace(/\s+/g," "))||void 0===x?void 0:x.split(" "))})(null===(y=null!==(g=null==f?void 0:f.match(/translate\([^\)]+\)/))&&void 0!==g?g:[])||void 0===y||null===(y=y.shift())||void 0===y?void 0:y.toString()),null!=f&&f.match(/matrix\([^\)]+\)/)&&(O=>{if(O){var x;let w=li({x:s,y:d},O);s=w.x,d=w.y,h=null!==(x=w.rotate)&&void 0!==x?x:null}})(f),Object.assign(o,{x:s,y:d,width:u,height:c,rotate:h}),o;var f,v,b,O,x,w,y,g})(),attribute:(()=>{let l={};switch(n.fill&&(l.fill=Ar(w=n.fill)?ht(w):Ge(w)?w:da(w)?"rgba(0,0,0,0)":"#000000"),n["fill-opacity"]&&(l.fillOpacity=n["fill-opacity"]),n["fill-rule"]&&(l.fillRule=n["fill-rule"]),n.stroke&&(w=>{l.stroke=Ar(w)?ht(w):Ge(w)?w:da(w)?"rgba(0,0,0,0)":"#000000"})(n.stroke),n["stroke-opacity"]&&(l.strokeOpacity=n["stroke-opacity"]),n["stroke-width"]&&(l.strokeWidth=parseFloat(n["stroke-width"])||0),n["stroke-linecap"]&&(l.strokeLinecap=n["stroke-linecap"]),n["stroke-linejoin"]&&(l.strokeLinejoin=n["stroke-linejoin"]),n["stroke-miterlimit"]&&(l.strokeMiterlimit=parseFloat(n["stroke-miterlimit"])||0),n["stroke-dasharray"]&&(l.strokeDasharray=parseFloat(n["stroke-dasharray"])||0),n.nodeName){case"polygon":case"polyline":{var a;let w=null!==(a=n.points)&&void 0!==a?a:null;Object.assign(l,{points:w});break}case"path":{var o;let w=null!==(o=n.d)&&void 0!==o?o:null;Object.assign(l,{d:w});break}case"circle":case"ellipse":case"line":case"rect":case"foreignObject":case"image":break;case"text":case"tspan":{var s,d,u,c,h,f,v,b,y;let w=null!==(s=n["font-family"])&&void 0!==s?s:null,S=null!==(d=n["font-weight"])&&void 0!==d?d:null,J=null!==(u=n["font-style"])&&void 0!==u?u:null,j=null!==(c=n["font-size"])&&void 0!==c?c:null,B=null!==(h=n["letter-spacing"])&&void 0!==h?h:null,z=null!==(f=n["word-spacing"])&&void 0!==f?f:null,T=null!==(v=n["alignment-baseline"])&&void 0!==v?v:null,C=null!==(b=n["dominant-baseline"])&&void 0!==b?b:null,Q=null!==(y=n["text-anchor"])&&void 0!==y?y:null;if(w){var g,O,x;let D=et(w);w=null!==(g=D.fontFamily)&&void 0!==g?g:w,S=null!==(O=D.fontWeight)&&void 0!==O?O:S,J=null!==(x=D.fontStyle)&&void 0!==x?x:J}T||C||(C="text-before-edge"),Object.assign(l,{fontFamily:w,fontWeight:S,fontStyle:J,letterSpacing:B,wordSpacing:z,alignmentBaseline:T,dominantBaseline:C,textAnchor:Q}),j&&(j.match(/rem/)?Object.assign(l,{fontSize:16*parseInt(j)}):Object.assign(l,{fontSize:parseInt(j)}));break}}var w;return l})(),style:{},source:(()=>{let l={};switch(n.nodeName){case"polygon":case"polyline":case"circle":case"ellipse":case"line":case"rect":case"foreignObject":break;case"image":n.base64&&Object.assign(l,{type:"image",image:{base64:n.base64}});break;case"text":case"tspan":n.textContent&&Object.assign(l,{type:"text",text:{textContent:n.textContent}})}return l})()};if(e.push(r),n.child){let l=ua(n.child,r.id);e=[...e,...l]}}),e},ca=(i,t,e,n)=>{i.querySelectorAll(":scope > *").forEach(r=>{if(["defs","script"].includes(r.nodeName))return;let l=[],a={};switch("use"===(An(r,a),a=Object.assign({},null!=t?t:{},a),a.nodeName)&&(a.href?An(n.querySelector(a.href),a):a["xlink:href"]&&An(n.querySelector(a["xlink:href"]),a)),a.nodeName){case"circle":case"ellipse":var o;if(null!==(o=a.transform)&&void 0!==o&&o.match(/matrix\([^\)]+\)/)){var s,d;let C=parseFloat(null!==(s=a.x)&&void 0!==s?s:"0"),Q=parseFloat(null!==(d=a.y)&&void 0!==d?d:"0");(D=>{if(D){var E;let P=li({x:C,y:Q},D);a.x=P.x,a.y=P.y,a.rotate=null!==(E=P.rotate)&&void 0!==E?E:null}})(a.transform),a.transform=null}break;case"text":{var u,c;if(null!==(u=a.transform)&&void 0!==u&&u.match(/matrix\([^\)]+\)/)){var h,f;let Q=parseFloat(null!==(h=a.x)&&void 0!==h?h:"0"),D=parseFloat(null!==(f=a.y)&&void 0!==f?f:"0");(E=>{if(E){var P;let F=li({x:Q,y:D},E);a.x=F.x,a.y=F.y,a.rotate=null!==(P=F.rotate)&&void 0!==P?P:null}})(a.transform),a.transform=null}else if(null!==(c=a.transform)&&void 0!==c&&c.match(/translate\([^\)]+\)/)){var v,b,y,g,O;let Q=parseFloat(null!==(v=a.x)&&void 0!==v?v:"0"),D=parseFloat(null!==(b=a.y)&&void 0!==b?b:"0");(E=null===(y=null!==(g=null===(O=a.transform)||void 0===O?void 0:O.match(/translate\([^\)]+\)/))&&void 0!==g?g:[])||void 0===y||null===(y=y.shift())||void 0===y?void 0:y.toString())&&(F=null==E||null===(P=E.replace(/[^0-9\-\.\,\ ]/g,""))||void 0===P||null===(P=P.replace(/\,/g," "))||void 0===P||null===(P=P.replace(/\s+/g," "))||void 0===P?void 0:P.split(" ")).length>=2&&(a.x=Q+parseFloat(F[0]||"0"),a.y=D+parseFloat(F[1]||"0")),a.transform=null}let C=r.textContent;C&&Object.assign(a,{textContent:C}),!a.fill&&!a.stroke&&(a.fill="#000000");break}case"tspan":{var x;if(null!==(x=a.transform)&&void 0!==x&&x.match(/matrix\([^\)]+\)/)){var w,S;let Q=parseFloat(null!==(w=a.x)&&void 0!==w?w:"0"),D=parseFloat(null!==(S=a.y)&&void 0!==S?S:"0");(E=>{if(E){let P=li({x:Q,y:D},E);a.x=P.x,a.y=P.y}})(a.transform),a.transform=null}else{var J,j,B,z;let Q=parseFloat(null!==(J=a.x)&&void 0!==J?J:"0"),D=parseFloat(null!==(j=a.y)&&void 0!==j?j:"0");a.x=A(null!==(B=Q+(null==t?void 0:t.x))&&void 0!==B?B:0,10),a.y=A(null!==(z=D+(null==t?void 0:t.y))&&void 0!==z?z:0,10)}let C=r.textContent;C&&Object.assign(a,{textContent:C}),!a.fill&&!a.stroke&&(a.fill="#000000");break}case"path":if(a.d){var T;let C=((i,t)=>{let e=Zi(t);return e?window.Snap.path.map(i,window.Snap.matrix(e.a,e.b,e.c,e.d,e.e,e.f)).toString():i})(a.d,null!==(T=a.transform)&&void 0!==T&&T.match(/matrix/)?a.transform:"matrix(1 0 0 1 0 0)");Object.assign(a,{d:C}),a.transform=null}!a.fill&&!a.stroke&&(a.fill="#000000");break;case"image":{let C=a["xlink:href"]||a.href;null!=C&&C.match(/;base64,/)&&Object.assign(a,{base64:C});break}}var E,P,F;ca(r,a,l,n),l.length&&Object.assign(a,{child:l}),e.push(a)})},An=(i,t)=>{if(i){if(["symbol"].includes(i.nodeName))return void An((i.querySelectorAll(":scope > *")||[])[0],t);t.nodeName=i.nodeName,[["x","y","width","height"],["x1","x2","y1","y2"],["rx","ry","r"],["cx","cy"],["fill","fill-opacity","fill-rule"],["stroke","stroke-opacity","stroke-width","stroke-miterlimit","stroke-linecap","stroke-linejoin","stroke-dasharray"],["d","points"],["font-family","font-weight","font-style","font-size","letter-spacing","word-spacing","alignment-baseline","dominant-baseline","text-anchor"],["transform","transform-origin"],["href","xlink:href"]].forEach(e=>{e.forEach(n=>{ec(i,t,n)})})}},ec=(i,t,e)=>{let n=i.getAttribute(e);if(n){let r={};r[e]=n.trim(),Object.assign(t,r)}},Cn=i=>{return i?"string"==typeof i?i.match(/in/)?A(96*parseFloat(null!==(t=i.replace(/[^0-9\.]/g,""))&&void 0!==t?t:"0"),1):A(parseFloat(null!==(e=i.replace(/[^0-9\.]/g,""))&&void 0!==e?e:"0"),1):"number"==typeof i?i:0:0;var t,e},ic=(i,t)=>{var e={data:{slides:[]},info:{},resources:[],screen:{w:0,h:0,width:0,height:0},variable:{conditions:[],variables:[]}};return(e=i.shift()).data=e.data||{},e.data.slides=e.data.slides||[],e.variable=e.variable||{},e.variable.conditions=e.variable.conditions||[],e.variable.variables=e.variable.variables||[],i.forEach((n,r)=>{var a=(n.data||{}).slides||[],o=n.variable||{},s=o.conditions||[],d=o.variables||[];a.forEach(function(h){if(a.find(function(b){return b.id==h.id})){var f=h.id.toString(),v=p.data.newSlideId;h.id=v,a.forEach(function(b){var y;null!==(y=b.svg)&&void 0!==y&&y.nodes&&(b.svg.nodes=JSON.parse(JSON.stringify(b.svg.nodes).replace(new RegExp(f,"g"),v.toString())))}),s=JSON.parse(JSON.stringify(s).replace(new RegExp(f,"g"),v.toString()))}});var u=e.variable.variables.map(function(h){return h.key});d=d.filter(function(h){return u.indexOf(h.key)<0});var c=e.variable.conditions.length;s.sort(function(h,f){return h.idx-f.idx}).map(function(h,f){return h.idx=f+1,h}).forEach(function(h,f){console.log(`${r}(b=${n.board_id}) -> ${h.idx} + ${c} = ${h.idx+c}`),h.idx=h.idx+c}),e.data.slides=e.data.slides.concat(a),e.variable.conditions=e.variable.conditions.concat(s),e.variable.variables=e.variable.variables.concat(d)}),e},nc=(i,t)=>{let{id:e,size:n,animate:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,animate:r}));r?r.value=t:r={value:t},p.history.push([{type:"animate",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,animate:r}))}])},rc=(i,t)=>{let{id:e,size:n,animate:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,animate:r}));r?r.in=t:r={in:t},p.history.push([{type:"animate",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,animate:r}))}])},lc=(i,t)=>{let{id:e,size:n,animate:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,animate:r}));r?r.out=t:r={out:t},p.history.push([{type:"animate",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,animate:r}))}])},ac=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.action?n.show.action.value=t:n.show.action={value:t}:n.show={action:{value:t}}:n={show:{action:{value:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},oc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.action?n.show.action.points=t:n.show.action={points:t}:n.show={action:{points:t}}:n={show:{action:{points:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},sc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.action?n.show.action.time=t:n.show.action={time:t}:n.show={action:{time:t}}:n={show:{action:{time:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},dc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.action?n.show.action.iteration=t:n.show.action={iteration:t}:n.show={action:{iteration:t}}:n={show:{action:{iteration:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},uc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.action?n.show.action.finish=t:n.show.action={finish:t}:n.show={action:{finish:t}}:n={show:{action:{finish:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},cc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.audio?n.show.audio.source=t:n.show.audio={source:t}:n.show={audio:{source:t}}:n={show:{audio:{source:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},hc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.audio?n.show.audio.iteration=t:n.show.audio={iteration:t}:n.show={audio:{iteration:t}}:n={show:{audio:{iteration:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}]),-1==t&&Cr(i,"change-slide")},fc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.audio?n.show.audio.finish=t:n.show.audio={finish:t}:n.show={audio:{finish:t}}:n={show:{audio:{finish:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Cr=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.audio?n.show.audio.async=t:n.show.audio={async:t}:n.show={audio:{async:t}}:n={show:{audio:{async:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},vc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.audio?n.show.audio.time=t:n.show.audio={time:t}:n.show={audio:{time:t}}:n={show:{audio:{time:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},gc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggershow?n.show.triggershow.id=t:n.show.triggershow={id:t}:n.show={triggershow:{id:t}}:n={show:{triggershow:{id:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},yc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggershow?n.show.triggershow.ids=t:n.show.triggershow={ids:t}:n.show={triggershow:{ids:t}}:n={show:{triggershow:{ids:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},pc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggershow?n.show.triggershow.async=t:n.show.triggershow={async:t}:n.show={triggershow:{async:t}}:n={show:{triggershow:{async:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},mc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggershow?n.show.triggershow.time=t:n.show.triggershow={time:t}:n.show={triggershow:{time:t}}:n={show:{triggershow:{time:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},wc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerrun?n.show.triggerrun.id=t:n.show.triggerrun={id:t}:n.show={triggerrun:{id:t}}:n={show:{triggerrun:{id:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},bc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerrun?n.show.triggerrun.ids=t:n.show.triggerrun={ids:t}:n.show={triggerrun:{ids:t}}:n={show:{triggerrun:{ids:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},xc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerrun?n.show.triggerrun.async=t:n.show.triggerrun={async:t}:n.show={triggerrun:{async:t}}:n={show:{triggerrun:{async:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Sc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerrun?n.show.triggerrun.time=t:n.show.triggerrun={time:t}:n.show={triggerrun:{time:t}}:n={show:{triggerrun:{time:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},kc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerhide?n.show.triggerhide.id=t:n.show.triggerhide={id:t}:n.show={triggerhide:{id:t}}:n={show:{triggerhide:{id:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Oc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerhide?n.show.triggerhide.ids=t:n.show.triggerhide={ids:t}:n.show={triggerhide:{ids:t}}:n={show:{triggerhide:{ids:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Nc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerhide?n.show.triggerhide.async=t:n.show.triggerhide={async:t}:n.show={triggerhide:{async:t}}:n={show:{triggerhide:{async:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},_c=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerhide?n.show.triggerhide.time=t:n.show.triggerhide={time:t}:n.show={triggerhide:{time:t}}:n={show:{triggerhide:{time:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Ec=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.action?n.click.action.value=t:n.click.action={value:t}:n.click={action:{value:t}}:n={click:{action:{value:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Tc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.action?n.click.action.points=t:n.click.action={points:t}:n.click={action:{points:t}}:n={click:{action:{points:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Ic=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.action?n.click.action.time=t:n.click.action={time:t}:n.click={action:{time:t}}:n={click:{action:{time:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Ac=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.action?n.click.action.iteration=t:n.click.action={iteration:t}:n.click={action:{iteration:t}}:n={click:{action:{iteration:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Cc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.action?n.click.action.finish=t:n.click.action={finish:t}:n.click={action:{finish:t}}:n={click:{action:{finish:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Jc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.audio?n.click.audio.source=t:n.click.audio={source:t}:n.click={audio:{source:t}}:n={click:{audio:{source:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Rc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.audio?n.click.audio.iteration=t:n.click.audio={iteration:t}:n.click={audio:{iteration:t}}:n={click:{audio:{iteration:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}]),-1==t&&Cr(i,"change-slide")},jc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.audio?n.click.audio.finish=t:n.click.audio={finish:t}:n.click={audio:{finish:t}}:n={click:{audio:{finish:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},zc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.audio?n.click.audio.async=t:n.click.audio={async:t}:n.click={audio:{async:t}}:n={click:{audio:{async:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Fc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.audio?n.click.audio.time=t:n.click.audio={time:t}:n.click={audio:{time:t}}:n={click:{audio:{time:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Lc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggershow?n.click.triggershow.id=t:n.click.triggershow={id:t}:n.click={triggershow:{id:t}}:n={click:{triggershow:{id:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Bc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggershow?n.click.triggershow.ids=t:n.click.triggershow={ids:t}:n.click={triggershow:{ids:t}}:n={click:{triggershow:{ids:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Pc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggershow?n.click.triggershow.async=t:n.click.triggershow={async:t}:n.click={triggershow:{async:t}}:n={click:{triggershow:{async:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Mc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggershow?n.click.triggershow.time=t:n.click.triggershow={time:t}:n.click={triggershow:{time:t}}:n={click:{triggershow:{time:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Kc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerrun?n.click.triggerrun.id=t:n.click.triggerrun={id:t}:n.click={triggerrun:{id:t}}:n={click:{triggerrun:{id:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Dc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerrun?n.click.triggerrun.ids=t:n.click.triggerrun={ids:t}:n.click={triggerrun:{ids:t}}:n={click:{triggerrun:{ids:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Gc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerrun?n.click.triggerrun.async=t:n.click.triggerrun={async:t}:n.click={triggerrun:{async:t}}:n={click:{triggerrun:{async:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Qc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerrun?n.click.triggerrun.time=t:n.click.triggerrun={time:t}:n.click={triggerrun:{time:t}}:n={click:{triggerrun:{time:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Uc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerhide?n.click.triggerhide.id=t:n.click.triggerhide={id:t}:n.click={triggerhide:{id:t}}:n={click:{triggerhide:{id:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Hc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerhide?n.click.triggerhide.ids=t:n.click.triggerhide={ids:t}:n.click={triggerhide:{ids:t}}:n={click:{triggerhide:{ids:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Wc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerhide?n.click.triggerhide.async=t:n.click.triggerhide={async:t}:n.click={triggerhide:{async:t}}:n={click:{triggerhide:{async:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Yc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerhide?n.click.triggerhide.time=t:n.click.triggerhide={time:t}:n.click={triggerhide:{time:t}}:n={click:{triggerhide:{time:t}}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Xc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.slide?(n.click.slide.id=null==t?void 0:t.id,n.click.slide.code=null==t?void 0:t.code):n.click.slide=t:n.click={slide:t}:n={click:{slide:t}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},qc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.media=t:n.click={media:t}:n={click:{media:t}},p.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Zc=(i,t)=>{let{id:e,variable:n}=i,r=JSON.parse(JSON.stringify({id:e,variable:n}));n?n.input?n.input.variable=t:n.input={variable:t}:n={input:{variable:t}},p.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:e,variable:n}))}])},Vc=(i,t)=>{let{id:e,variable:n}=i,r=JSON.parse(JSON.stringify({id:e,variable:n}));n?n.click?n.click.variable=t:n.click={variable:t}:n={click:{variable:t}},p.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:e,variable:n}))}])},$c=(i,t)=>{let{id:e,variable:n}=i,r=JSON.parse(JSON.stringify({id:e,variable:n}));n?n.click?n.click.operator=t:n.click={operator:t}:n={click:{operator:t}},p.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:e,variable:n}))}])},th=(i,t)=>{let{id:e,variable:n}=i,r=JSON.parse(JSON.stringify({id:e,variable:n}));n?n.click?n.click.valuetype=t:n.click={valuetype:t}:n={click:{valuetype:t}},p.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:e,variable:n}))}])},eh=(i,t)=>{let{id:e,variable:n}=i,r=JSON.parse(JSON.stringify({id:e,variable:n}));n?n.click?n.click.value=t:n.click={value:t}:n={click:{value:t}},p.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:e,variable:n}))}])},ih=i=>{let t=[];i.forEach((n,r)=>{let{id:l,size:a,attribute:o}=n;t.push(JSON.parse(JSON.stringify({id:l,size:a,attribute:o})))});let e=999999;for(let{size:n}of i)e=Math.min(e,n.x);for(let{id:n,type:r,size:l,attribute:a}of i)l.x=e,Object.assign(a,nt(r,l,a)),m(window.document.getElementById(n),a);p.history.push(i.map((n,r)=>{let{id:l,size:a,attribute:o}=n;return{type:"size",from:t[r],to:JSON.parse(JSON.stringify({id:l,size:a,attribute:o}))}}))},nh=i=>{let t=[];i.forEach((n,r)=>{let{id:l,size:a,attribute:o}=n;t.push(JSON.parse(JSON.stringify({id:l,size:a,attribute:o})))});let e=999999;for(let{size:n}of i)e=Math.min(e,n.y);for(let{id:n,type:r,size:l,attribute:a}of i)l.y=e,Object.assign(a,nt(r,l,a)),m(window.document.getElementById(n),a);p.history.push(i.map((n,r)=>{let{id:l,size:a,attribute:o}=n;return{type:"size",from:t[r],to:JSON.parse(JSON.stringify({id:l,size:a,attribute:o}))}}))},rh=i=>{let t=[];i.forEach((n,r)=>{let{id:l,size:a,attribute:o}=n;t.push(JSON.parse(JSON.stringify({id:l,size:a,attribute:o})))});let e=-999999;for(let{size:n}of i)e=Math.max(e,n.x+n.width);for(let{id:n,type:r,size:l,attribute:a}of i)l.x=e-l.width,Object.assign(a,nt(r,l,a)),m(window.document.getElementById(n),a);p.history.push(i.map((n,r)=>{let{id:l,size:a,attribute:o}=n;return{type:"size",from:t[r],to:JSON.parse(JSON.stringify({id:l,size:a,attribute:o}))}}))},lh=i=>{let t=[];i.forEach((n,r)=>{let{id:l,size:a,attribute:o}=n;t.push(JSON.parse(JSON.stringify({id:l,size:a,attribute:o})))});let e=-999999;for(let{size:n}of i)e=Math.max(e,n.y+n.height);for(let{id:n,type:r,size:l,attribute:a}of i)l.y=e-l.height,Object.assign(a,nt(r,l,a)),m(window.document.getElementById(n),a);p.history.push(i.map((n,r)=>{let{id:l,size:a,attribute:o}=n;return{type:"size",from:t[r],to:JSON.parse(JSON.stringify({id:l,size:a,attribute:o}))}}))},ah=i=>{let t=[];i.forEach((l,a)=>{let{id:o,size:s,attribute:d}=l;t.push(JSON.parse(JSON.stringify({id:o,size:s,attribute:d})))});let e=999999,n=-999999,r=0;for(let{size:l}of i)e=Math.min(e,l.x),n=Math.max(n,l.x+l.width);r=A((e+n)/2);for(let{id:l,type:a,size:o,attribute:s}of i)o.x=A(r-o.width/2),Object.assign(s,nt(a,o,s)),m(window.document.getElementById(l),s);p.history.push(i.map((l,a)=>{let{id:o,size:s,attribute:d}=l;return{type:"size",from:t[a],to:JSON.parse(JSON.stringify({id:o,size:s,attribute:d}))}}))},oh=i=>{let t=[];i.forEach((l,a)=>{let{id:o,size:s,attribute:d}=l;t.push(JSON.parse(JSON.stringify({id:o,size:s,attribute:d})))});let e=999999,n=-999999,r=0;for(let{size:l}of i)e=Math.min(e,l.y),n=Math.max(n,l.y+l.height);r=A((e+n)/2);for(let{id:l,type:a,size:o,attribute:s}of i)o.y=A(r-o.height/2),Object.assign(s,nt(a,o,s)),m(window.document.getElementById(l),s);p.history.push(i.map((l,a)=>{let{id:o,size:s,attribute:d}=l;return{type:"size",from:t[a],to:JSON.parse(JSON.stringify({id:o,size:s,attribute:d}))}}))},sh=i=>{var t,e;let n=[];i.forEach((l,a)=>{let{id:o,size:s,attribute:d}=l;n.push(JSON.parse(JSON.stringify({id:o,size:s,attribute:d})))});let r=null!==(t=null===(e=p.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox.x)&&void 0!==t?t:0;for(let{id:l,type:a,size:o,attribute:s}of i)o.x=r,Object.assign(s,nt(a,o,s)),m(window.document.getElementById(l),s);p.history.push(i.map((l,a)=>{let{id:o,size:s,attribute:d}=l;return{type:"size",from:n[a],to:JSON.parse(JSON.stringify({id:o,size:s,attribute:d}))}}))},dh=i=>{var t,e;let n=[];i.forEach((l,a)=>{let{id:o,size:s,attribute:d}=l;n.push(JSON.parse(JSON.stringify({id:o,size:s,attribute:d})))});let r=null!==(t=null===(e=p.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox.y)&&void 0!==t?t:0;for(let{id:l,type:a,size:o,attribute:s}of i)o.y=r,Object.assign(s,nt(a,o,s)),m(window.document.getElementById(l),s);p.history.push(i.map((l,a)=>{let{id:o,size:s,attribute:d}=l;return{type:"size",from:n[a],to:JSON.parse(JSON.stringify({id:o,size:s,attribute:d}))}}))},uh=i=>{var t,e;let n=[];i.forEach((o,s)=>{let{id:d,size:u,attribute:c}=o;n.push(JSON.parse(JSON.stringify({id:d,size:u,attribute:c})))});let{x:r,width:l}=null!==(t=null===(e=p.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{x:0,width:0},a=r+l;for(let{id:o,type:s,size:d,attribute:u}of i)d.x=a-d.width,Object.assign(u,nt(s,d,u)),m(window.document.getElementById(o),u);p.history.push(i.map((o,s)=>{let{id:d,size:u,attribute:c}=o;return{type:"size",from:n[s],to:JSON.parse(JSON.stringify({id:d,size:u,attribute:c}))}}))},ch=i=>{var t,e;let n=[];i.forEach((o,s)=>{let{id:d,size:u,attribute:c}=o;n.push(JSON.parse(JSON.stringify({id:d,size:u,attribute:c})))});let{y:r,height:l}=null!==(t=null===(e=p.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{y:0,height:0},a=r+l;for(let{id:o,type:s,size:d,attribute:u}of i)d.y=a-d.height,Object.assign(u,nt(s,d,u)),m(window.document.getElementById(o),u);p.history.push(i.map((o,s)=>{let{id:d,size:u,attribute:c}=o;return{type:"size",from:n[s],to:JSON.parse(JSON.stringify({id:d,size:u,attribute:c}))}}))},hh=i=>{var t,e;let n=[];i.forEach((d,u)=>{let{id:c,size:h,attribute:f}=d;n.push(JSON.parse(JSON.stringify({id:c,size:h,attribute:f})))});let{x:r,width:l}=null!==(t=null===(e=p.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{x:0,width:0},s=A((r+(r+l))/2);for(let{id:d,type:u,size:c,attribute:h}of i)c.x=A(s-c.width/2),Object.assign(h,nt(u,c,h)),m(window.document.getElementById(d),h);p.history.push(i.map((d,u)=>{let{id:c,size:h,attribute:f}=d;return{type:"size",from:n[u],to:JSON.parse(JSON.stringify({id:c,size:h,attribute:f}))}}))},fh=i=>{var t,e;let n=[];i.forEach((d,u)=>{let{id:c,size:h,attribute:f}=d;n.push(JSON.parse(JSON.stringify({id:c,size:h,attribute:f})))});let{y:r,height:l}=null!==(t=null===(e=p.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{y:0,height:0},s=A((r+(r+l))/2);for(let{id:d,type:u,size:c,attribute:h}of i)c.y=A(s-c.height/2),Object.assign(h,nt(u,c,h)),m(window.document.getElementById(d),h);p.history.push(i.map((d,u)=>{let{id:c,size:h,attribute:f}=d;return{type:"size",from:n[u],to:JSON.parse(JSON.stringify({id:c,size:h,attribute:f}))}}))},vh=i=>{if(i.length<3)return;let t=[];i.forEach((o,s)=>{let{id:d,size:c,attribute:h}=o;t.push(JSON.parse(JSON.stringify({id:d,size:c,attribute:h})))});let e=999999,n=-999999,r=[],l=i.length;for(let o=0;o<l;o++){let{id:s,size:d}=i[o];r.push({idx:o,id:s,x:d.x+d.width/2})}r=r.sort((o,s)=>o.x-s.x),e=r[0].x,n=r[l-1].x;let a=n-e;for(let o=1,s=r.length-2;o<=s;o++){let{id:d,type:u,size:c,attribute:h}=i[r[o].idx];c.x=e+a*o/(l-1)-c.width/2,Object.assign(h,nt(u,c,h)),m(window.document.getElementById(d),h)}p.history.push(i.map((o,s)=>{let{id:d,size:c,attribute:h}=o;return{type:"size",from:t[s],to:JSON.parse(JSON.stringify({id:d,size:c,attribute:h}))}}))},gh=i=>{if(i.length<3)return;let t=[];i.forEach((o,s)=>{let{id:d,size:u,attribute:c}=o;t.push(JSON.parse(JSON.stringify({id:d,size:u,attribute:c})))});let e=999999,n=-999999,r=[],l=i.length;for(let o=0;o<l;o++){let{id:s,size:d}=i[o];r.push({idx:o,id:s,y:d.y+d.height/2})}r=r.sort((o,s)=>o.y-s.y),e=r[0].y,n=r[l-1].y;let a=n-e;for(let o=1,s=r.length-2;o<=s;o++){let{id:d,type:u,size:c,attribute:h}=i[r[o].idx];c.y=e+a*o/(l-1)-c.height/2,Object.assign(h,nt(u,c,h)),m(window.document.getElementById(d),h)}p.history.push(i.map((o,s)=>{let{id:d,size:u,attribute:c}=o;return{type:"size",from:t[s],to:JSON.parse(JSON.stringify({id:d,size:u,attribute:c}))}}))},yh=i=>{var t,e;let n=[];i.forEach((a,o)=>{let{id:s,size:u,attribute:c}=a;n.push(JSON.parse(JSON.stringify({id:s,size:u,attribute:c})))});let{x:r,width:l}=null!==(t=null===(e=p.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{x:0,width:0};for(let{id:a,type:o,size:s,attribute:d}of i)s.x=r,s.width=l,Object.assign(d,nt(o,s,d)),m(window.document.getElementById(a),d);p.history.push(i.map((a,o)=>{let{id:s,size:u,attribute:c}=a;return{type:"size",from:n[o],to:JSON.parse(JSON.stringify({id:s,size:u,attribute:c}))}}))},ph=i=>{var t,e;let n=[];i.forEach((a,o)=>{let{id:s,size:d,attribute:u}=a;n.push(JSON.parse(JSON.stringify({id:s,size:d,attribute:u})))});let{y:r,height:l}=null!==(t=null===(e=p.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{y:0,height:0};for(let{id:a,type:o,size:s,attribute:d}of i)s.y=r,s.height=l,Object.assign(d,nt(o,s,d)),m(window.document.getElementById(a),d);p.history.push(i.map((a,o)=>{let{id:s,size:d,attribute:u}=a;return{type:"size",from:n[o],to:JSON.parse(JSON.stringify({id:s,size:d,attribute:u}))}}))},mh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));t?Ge(t)&&(r.fill=t):r.fill=void 0,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},wh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.fillOpacity="number"==typeof t?A(t/100,100):void 0,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},bh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));t?Ge(t)&&(r.stroke=t):r.stroke=void 0,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},xh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.strokeOpacity="number"==typeof t?A(t/100,100):void 0,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Sh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.strokeWidth="number"==typeof t?A(t,100):void 0,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},kh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.strokeDasharray="number"==typeof t?A(t,100):void 0,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Oh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.strokeLinecap=t,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Nh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.strokeLinejoin=t,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},_h=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.fontFamily=t,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Eh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.fontWeight=t,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Th=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.fontStyle=t,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Ih=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.fontSize="number"==typeof t?A(t,100):void 0,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Ah=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.textLength="number"==typeof t?A(t,100):void 0,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Ch=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.letterSpacing="number"==typeof t?A(t,100):void 0,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Jh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.wordSpacing="number"==typeof t?A(t,100):void 0,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Rh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.textDecoration=t,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},jh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.textAnchor=t,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},zh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.dominantBaseline=t,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Fh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.rx="number"==typeof t?A(t,100):void 0,m(window.document.getElementById(e),r),p.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Lh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.padding=A(t):n={padding:A(t)},_(window.document.getElementById(e),n),p.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Bh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.borderWidth=t:n={borderWidth:t},_(window.document.getElementById(e),n),p.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Ph=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.borderStyle=t:n={borderStyle:t},_(window.document.getElementById(e),n),p.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Mh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n})),l=a=>{n?n.borderColor=a:n={borderColor:a}};t?Ge(t)&&l(t):l(),_(window.document.getElementById(e),n),p.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Kh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.borderOpacity="number"==typeof t?A(t/100,100):void 0:n={borderOpacity:"number"==typeof t?A(t/100,100):void 0},_(window.document.getElementById(e),n),p.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Dh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.borderRadius=A(t):n={borderRadius:A(t)},_(window.document.getElementById(e),n),p.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Gh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.fontFamily=t:n={fontFamily:t},_(window.document.getElementById(e),n),p.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Qh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.fontSize=t:n={fontSize:t},_(window.document.getElementById(e),n),p.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Uh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n})),l=a=>{n?n.color=a:n={color:a}};t?Ge(t)&&l(t):l(),_(window.document.getElementById(e),n),p.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Hh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.opacity="number"==typeof t?A(t/100,100):void 0:n={opacity:"number"==typeof t?A(t/100,100):void 0},_(window.document.getElementById(e),n),p.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Wh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n})),l=a=>{n?n.backgroundColor=a:n={backgroundColor:a}};t?Ge(t)&&l(t):l(),_(window.document.getElementById(e),n),p.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Yh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.backgroundOpacity="number"==typeof t?A(t/100,100):void 0:n={backgroundOpacity:"number"==typeof t?A(t/100,100):void 0},_(window.document.getElementById(e),n),p.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Xh=(i,t)=>{i.svg?i.svg.viewBox?i.svg.viewBox.x=A(t):i.svg.viewBox={x:A(t),y:0,width:1e3,height:1e3}:i.svg={viewBox:{x:A(t),y:0,width:1e3,height:1e3}}},qh=(i,t)=>{i.svg?i.svg.viewBox?i.svg.viewBox.y=A(t):i.svg.viewBox={x:0,y:A(t),width:1e3,height:1e3}:i.svg={viewBox:{x:0,y:A(t),width:1e3,height:1e3}}},Zh=(i,t,e)=>{i.svg?i.svg.viewBox?(e&&(i.svg.viewBox.height=A(t*i.svg.viewBox.height/i.svg.viewBox.width)),i.svg.viewBox.width=A(t)):i.svg.viewBox={x:0,y:0,width:A(t),height:A(t)}:i.svg={viewBox:{x:0,y:0,width:A(t),height:A(t)}}},Vh=(i,t,e)=>{i.svg?i.svg.viewBox?(e&&(i.svg.viewBox.width=A(t*i.svg.viewBox.width/i.svg.viewBox.height)),i.svg.viewBox.height=A(t)):i.svg.viewBox={x:0,y:0,width:A(t),height:A(t)}:i.svg={viewBox:{x:0,y:0,width:A(t),height:A(t)}}},$h=(i,t)=>{i.svg?i.svg.background?i.svg.background.color=t:i.svg.background={color:t}:i.svg={background:{color:t}},ui(i)},tf=(i,t)=>{i.svg?i.svg.background?i.svg.background.opacity="number"==typeof t?A(t/100,100):void 0:i.svg.background={opacity:"number"==typeof t?A(t/100,100):void 0}:i.svg={background:{opacity:"number"==typeof t?A(t/100,100):void 0}},ui(i)},ef=(i,t)=>{i.svg?i.svg.background?(i.svg.background.path=null==t?void 0:t.path,i.svg.background.url=null==t?void 0:t.url,i.svg.background.name=null==t?void 0:t.name):i.svg.background=t:i.svg={background:t},ui(i)}},8547:Rr=>{Rr.exports=function vt(Mt,L,yt){function Qt(Lt,mt){if(!L[Lt]){if(!Mt[Lt]){if(Nt)return Nt(Lt,!0);var ot=new Error("Cannot find module '"+Lt+"'");throw ot.code="MODULE_NOT_FOUND",ot}var pt=L[Lt]={exports:{}};Mt[Lt][0].call(pt.exports,function(_t){return Qt(Mt[Lt][1][_t]||_t)},pt,pt.exports,vt,Mt,L,yt)}return L[Lt].exports}for(var Nt=void 0,wt=0;wt<yt.length;wt++)Qt(yt[wt]);return Qt}({1:[function(vt,Mt,L){(function(yt){"use strict";var Nt,Qt=yt.MutationObserver||yt.WebKitMutationObserver;if(Qt){var wt=0,Lt=new Qt(_t),mt=yt.document.createTextNode("");Lt.observe(mt,{characterData:!0}),Nt=function(){mt.data=wt=++wt%2}}else if(!yt.setImmediate&&typeof yt.MessageChannel<"u"){var it=new yt.MessageChannel;it.port1.onmessage=_t,Nt=function(){it.port2.postMessage(0)}}else Nt="document"in yt&&"onreadystatechange"in yt.document.createElement("script")?function(){var Rt=yt.document.createElement("script");Rt.onreadystatechange=function(){_t(),Rt.onreadystatechange=null,Rt.parentNode.removeChild(Rt),Rt=null},yt.document.documentElement.appendChild(Rt)}:function(){setTimeout(_t,0)};var ot,pt=[];function _t(){ot=!0;for(var Rt,ie,Ct=pt.length;Ct;){for(ie=pt,pt=[],Rt=-1;++Rt<Ct;)ie[Rt]();Ct=pt.length}ot=!1}Mt.exports=function Yt(Rt){1===pt.push(Rt)&&!ot&&Nt()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(vt,Mt,L){"use strict";var yt=vt(1);function Qt(){}var Nt={},wt=["REJECTED"],Lt=["FULFILLED"],mt=["PENDING"];function it(et){if("function"!=typeof et)throw new TypeError("resolver must be a function");this.state=mt,this.queue=[],this.outcome=void 0,et!==Qt&&Yt(this,et)}function ot(et,xt,ht){this.promise=et,"function"==typeof xt&&(this.onFulfilled=xt,this.callFulfilled=this.otherCallFulfilled),"function"==typeof ht&&(this.onRejected=ht,this.callRejected=this.otherCallRejected)}function pt(et,xt,ht){yt(function(){var St;try{St=xt(ht)}catch(Kt){return Nt.reject(et,Kt)}St===et?Nt.reject(et,new TypeError("Cannot resolve promise with itself")):Nt.resolve(et,St)})}function _t(et){var xt=et&&et.then;if(et&&("object"==typeof et||"function"==typeof et)&&"function"==typeof xt)return function(){xt.apply(et,arguments)}}function Yt(et,xt){var ht=!1;function St(Ut){ht||(ht=!0,Nt.reject(et,Ut))}function Kt(Ut){ht||(ht=!0,Nt.resolve(et,Ut))}var ne=Rt(function Zt(){xt(Kt,St)});"error"===ne.status&&St(ne.value)}function Rt(et,xt){var ht={};try{ht.value=et(xt),ht.status="success"}catch(St){ht.status="error",ht.value=St}return ht}Mt.exports=it,it.prototype.catch=function(et){return this.then(null,et)},it.prototype.then=function(et,xt){if("function"!=typeof et&&this.state===Lt||"function"!=typeof xt&&this.state===wt)return this;var ht=new this.constructor(Qt);return this.state!==mt?pt(ht,this.state===Lt?et:xt,this.outcome):this.queue.push(new ot(ht,et,xt)),ht},ot.prototype.callFulfilled=function(et){Nt.resolve(this.promise,et)},ot.prototype.otherCallFulfilled=function(et){pt(this.promise,this.onFulfilled,et)},ot.prototype.callRejected=function(et){Nt.reject(this.promise,et)},ot.prototype.otherCallRejected=function(et){pt(this.promise,this.onRejected,et)},Nt.resolve=function(et,xt){var ht=Rt(_t,xt);if("error"===ht.status)return Nt.reject(et,ht.value);var St=ht.value;if(St)Yt(et,St);else{et.state=Lt,et.outcome=xt;for(var Kt=-1,Zt=et.queue.length;++Kt<Zt;)et.queue[Kt].callFulfilled(xt)}return et},Nt.reject=function(et,xt){et.state=wt,et.outcome=xt;for(var ht=-1,St=et.queue.length;++ht<St;)et.queue[ht].callRejected(xt);return et},it.resolve=function ie(et){return et instanceof this?et:Nt.resolve(new this(Qt),et)},it.reject=function Ct(et){var xt=new this(Qt);return Nt.reject(xt,et)},it.all=function Si(et){var xt=this;if("[object Array]"!==Object.prototype.toString.call(et))return this.reject(new TypeError("must be an array"));var ht=et.length,St=!1;if(!ht)return this.resolve([]);for(var Kt=new Array(ht),Zt=0,ne=-1,Ut=new this(Qt);++ne<ht;)oe(et[ne],ne);return Ut;function oe(Ue,ri){xt.resolve(Ue).then(function A(at){Kt[ri]=at,++Zt===ht&&!St&&(St=!0,Nt.resolve(Ut,Kt))},function(at){St||(St=!0,Nt.reject(Ut,at))})}},it.race=function se(et){var xt=this;if("[object Array]"!==Object.prototype.toString.call(et))return this.reject(new TypeError("must be an array"));var ht=et.length,St=!1;if(!ht)return this.resolve([]);for(var Kt=-1,Zt=new this(Qt);++Kt<ht;)xt.resolve(et[Kt]).then(function(oe){St||(St=!0,Nt.resolve(Zt,oe))},function(oe){St||(St=!0,Nt.reject(Zt,oe))});return Zt}},{1:1}],3:[function(vt,Mt,L){(function(yt){"use strict";"function"!=typeof yt.Promise&&(yt.Promise=vt(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(vt,Mt,L){"use strict";var yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(m){return typeof m}:function(m){return m&&"function"==typeof Symbol&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m};var wt=function Nt(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}();function mt(m,_){m=m||[],_=_||{};try{return new Blob(m,_)}catch(I){if("TypeError"!==I.name)throw I;for(var R=new(typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder),N=0;N<m.length;N+=1)R.append(m[N]);return R.getBlob(_.type)}}typeof Promise>"u"&&vt(3);var it=Promise;function ot(m,_){_&&m.then(function(k){_(null,k)},function(k){_(k)})}function pt(m,_,k){"function"==typeof _&&m.then(_),"function"==typeof k&&m.catch(k)}function _t(m){return"string"!=typeof m&&(console.warn(m+" used as a key, but it is not a string."),m=String(m)),m}function Yt(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var Rt="local-forage-detect-blob-support",ie=void 0,Ct={},Si=Object.prototype.toString,se="readonly",et="readwrite";function xt(m){for(var _=m.length,k=new ArrayBuffer(_),R=new Uint8Array(k),N=0;N<_;N++)R[N]=m.charCodeAt(N);return k}function St(m){return"boolean"==typeof ie?it.resolve(ie):function ht(m){return new it(function(_){var k=m.transaction(Rt,et),R=mt([""]);k.objectStore(Rt).put(R,"key"),k.onabort=function(N){N.preventDefault(),N.stopPropagation(),_(!1)},k.oncomplete=function(){var N=navigator.userAgent.match(/Chrome\/(\d+)/),I=navigator.userAgent.match(/Edge\//);_(I||!N||parseInt(N[1],10)>=43)}}).catch(function(){return!1})}(m).then(function(_){return ie=_})}function Kt(m){var _=Ct[m.name],k={};k.promise=new it(function(R,N){k.resolve=R,k.reject=N}),_.deferredOperations.push(k),_.dbReady=_.dbReady?_.dbReady.then(function(){return k.promise}):k.promise}function Zt(m){var k=Ct[m.name].deferredOperations.pop();if(k)return k.resolve(),k.promise}function ne(m,_){var R=Ct[m.name].deferredOperations.pop();if(R)return R.reject(_),R.promise}function Ut(m,_){return new it(function(k,R){if(Ct[m.name]=Ct[m.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},m.db){if(!_)return k(m.db);Kt(m),m.db.close()}var N=[m.name];_&&N.push(m.version);var I=wt.open.apply(wt,N);_&&(I.onupgradeneeded=function(G){var U=I.result;try{U.createObjectStore(m.storeName),G.oldVersion<=1&&U.createObjectStore(Rt)}catch(Y){if("ConstraintError"!==Y.name)throw Y;console.warn('The database "'+m.name+'" has been upgraded from version '+G.oldVersion+" to version "+G.newVersion+', but the storage "'+m.storeName+'" already exists.')}}),I.onerror=function(G){G.preventDefault(),R(I.error)},I.onsuccess=function(){var G=I.result;G.onversionchange=function(U){U.target.close()},k(G),Zt(m)}})}function oe(m){return Ut(m,!1)}function Ue(m){return Ut(m,!0)}function ri(m,_){if(!m.db)return!0;var k=!m.db.objectStoreNames.contains(m.storeName),N=m.version>m.db.version;if(m.version<m.db.version&&(m.version!==_&&console.warn('The database "'+m.name+"\" can't be downgraded from version "+m.db.version+" to version "+m.version+"."),m.version=m.db.version),N||k){if(k){var I=m.db.version+1;I>m.version&&(m.version=I)}return!0}return!1}function at(m){return mt([xt(atob(m.data))],{type:m.type})}function Be(m){return m&&m.__local_forage_encoded_blob}function jr(m){var _=this,k=_._initReady().then(function(){var R=Ct[_._dbInfo.name];if(R&&R.dbReady)return R.dbReady});return pt(k,m,m),k}function Vt(m,_,k,R){void 0===R&&(R=1);try{var N=m.db.transaction(m.storeName,_);k(null,N)}catch(I){if(R>0&&(!m.db||"InvalidStateError"===I.name||"NotFoundError"===I.name))return it.resolve().then(function(){if(!m.db||"NotFoundError"===I.name&&!m.db.objectStoreNames.contains(m.storeName)&&m.version<=m.db.version)return m.db&&(m.version=m.db.version+1),Ue(m)}).then(function(){return function He(m){Kt(m);for(var _=Ct[m.name],k=_.forages,R=0;R<k.length;R++){var N=k[R];N._dbInfo.db&&(N._dbInfo.db.close(),N._dbInfo.db=null)}return m.db=null,oe(m).then(function(I){return m.db=I,ri(m)?Ue(m):I}).then(function(I){m.db=_.db=I;for(var G=0;G<k.length;G++)k[G]._dbInfo.db=I}).catch(function(I){throw ne(m,I),I})}(m).then(function(){Vt(m,_,k,R-1)})}).catch(k);k(I)}}var nt={_driver:"asyncStorage",_initStorage:function Jn(m){var _=this,k={db:null};if(m)for(var R in m)k[R]=m[R];var N=Ct[k.name];N||(Ct[k.name]=N={forages:[],db:null,dbReady:null,deferredOperations:[]}),N.forages.push(_),_._initReady||(_._initReady=_.ready,_.ready=jr);var I=[];function G(){return it.resolve()}for(var U=0;U<N.forages.length;U++){var Y=N.forages[U];Y!==_&&I.push(Y._initReady().catch(G))}var H=N.forages.slice(0);return it.all(I).then(function(){return k.db=N.db,oe(k)}).then(function(q){return k.db=q,ri(k,_._defaultConfig.version)?Ue(k):q}).then(function(q){k.db=N.db=q,_._dbInfo=k;for(var rt=0;rt<H.length;rt++){var st=H[rt];st!==_&&(st._dbInfo.db=k.db,st._dbInfo.version=k.version)}})},_support:function Lt(){try{if(!wt||!wt.open)return!1;var m=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),_="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!m||_)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}(),iterate:function jn(m,_){var k=this,R=new it(function(N,I){k.ready().then(function(){Vt(k._dbInfo,se,function(G,U){if(G)return I(G);try{var H=U.objectStore(k._dbInfo.storeName).openCursor(),q=1;H.onsuccess=function(){var rt=H.result;if(rt){var st=rt.value;Be(st)&&(st=at(st));var ct=m(st,rt.key,q++);void 0!==ct?N(ct):rt.continue()}else N()},H.onerror=function(){I(H.error)}}catch(rt){I(rt)}})}).catch(I)});return ot(R,_),R},getItem:function Rn(m,_){var k=this;m=_t(m);var R=new it(function(N,I){k.ready().then(function(){Vt(k._dbInfo,se,function(G,U){if(G)return I(G);try{var H=U.objectStore(k._dbInfo.storeName).get(m);H.onsuccess=function(){var q=H.result;void 0===q&&(q=null),Be(q)&&(q=at(q)),N(q)},H.onerror=function(){I(H.error)}}catch(q){I(q)}})}).catch(I)});return ot(R,_),R},setItem:function zn(m,_,k){var R=this;m=_t(m);var N=new it(function(I,G){var U;R.ready().then(function(){return U=R._dbInfo,"[object Blob]"===Si.call(_)?St(U.db).then(function(Y){return Y?_:function A(m){return new it(function(_,k){var R=new FileReader;R.onerror=k,R.onloadend=function(N){var I=btoa(N.target.result||"");_({__local_forage_encoded_blob:!0,data:I,type:m.type})},R.readAsBinaryString(m)})}(_)}):_}).then(function(Y){Vt(R._dbInfo,et,function(H,q){if(H)return G(H);try{var rt=q.objectStore(R._dbInfo.storeName);null===Y&&(Y=void 0);var st=rt.put(Y,m);q.oncomplete=function(){void 0===Y&&(Y=null),I(Y)},q.onabort=q.onerror=function(){G(st.error?st.error:st.transaction.error)}}catch(ct){G(ct)}})}).catch(G)});return ot(N,k),N},removeItem:function li(m,_){var k=this;m=_t(m);var R=new it(function(N,I){k.ready().then(function(){Vt(k._dbInfo,et,function(G,U){if(G)return I(G);try{var H=U.objectStore(k._dbInfo.storeName).delete(m);U.oncomplete=function(){N()},U.onerror=function(){I(H.error)},U.onabort=function(){I(H.error?H.error:H.transaction.error)}}catch(q){I(q)}})}).catch(I)});return ot(R,_),R},clear:function Zi(m){var _=this,k=new it(function(R,N){_.ready().then(function(){Vt(_._dbInfo,et,function(I,G){if(I)return N(I);try{var Y=G.objectStore(_._dbInfo.storeName).clear();G.oncomplete=function(){R()},G.onabort=G.onerror=function(){N(Y.error?Y.error:Y.transaction.error)}}catch(H){N(H)}})}).catch(N)});return ot(k,m),k},length:function Fn(m){var _=this,k=new it(function(R,N){_.ready().then(function(){Vt(_._dbInfo,se,function(I,G){if(I)return N(I);try{var Y=G.objectStore(_._dbInfo.storeName).count();Y.onsuccess=function(){R(Y.result)},Y.onerror=function(){N(Y.error)}}catch(H){N(H)}})}).catch(N)});return ot(k,m),k},key:function Ln(m,_){var k=this,R=new it(function(N,I){m<0?N(null):k.ready().then(function(){Vt(k._dbInfo,se,function(G,U){if(G)return I(G);try{var Y=U.objectStore(k._dbInfo.storeName),H=!1,q=Y.openKeyCursor();q.onsuccess=function(){var rt=q.result;rt?0===m||H?N(rt.key):(H=!0,rt.advance(m)):N(null)},q.onerror=function(){I(q.error)}}catch(rt){I(rt)}})}).catch(I)});return ot(R,_),R},keys:function Bn(m){var _=this,k=new it(function(R,N){_.ready().then(function(){Vt(_._dbInfo,se,function(I,G){if(I)return N(I);try{var Y=G.objectStore(_._dbInfo.storeName).openKeyCursor(),H=[];Y.onsuccess=function(){var q=Y.result;q?(H.push(q.key),q.continue()):R(H)},Y.onerror=function(){N(Y.error)}}catch(q){N(q)}})}).catch(N)});return ot(k,m),k},dropInstance:function Ht(m,_){_=Yt.apply(this,arguments);var N,k=this.config();return(m="function"!=typeof m&&m||{}).name||(m.name=m.name||k.name,m.storeName=m.storeName||k.storeName),ot(N=m.name?(m.name===k.name&&this._dbInfo.db?it.resolve(this._dbInfo.db):oe(m).then(function(U){var Y=Ct[m.name],H=Y.forages;Y.db=U;for(var q=0;q<H.length;q++)H[q]._dbInfo.db=U;return U})).then(m.storeName?function(U){if(U.objectStoreNames.contains(m.storeName)){var Y=U.version+1;Kt(m);var H=Ct[m.name],q=H.forages;U.close();for(var rt=0;rt<q.length;rt++){var st=q[rt];st._dbInfo.db=null,st._dbInfo.version=Y}return new it(function(kt,At){var zt=wt.open(m.name,Y);zt.onerror=function(Tt){zt.result.close(),At(Tt)},zt.onupgradeneeded=function(){zt.result.deleteObjectStore(m.storeName)},zt.onsuccess=function(){var Tt=zt.result;Tt.close(),kt(Tt)}}).then(function(kt){H.db=kt;for(var At=0;At<q.length;At++){var zt=q[At];zt._dbInfo.db=kt,Zt(zt._dbInfo)}}).catch(function(kt){throw(ne(m,kt)||it.resolve()).catch(function(){}),kt})}}:function(U){Kt(m);var Y=Ct[m.name],H=Y.forages;U.close();for(var q=0;q<H.length;q++)H[q]._dbInfo.db=null;return new it(function(ct,kt){var At=wt.deleteDatabase(m.name);At.onerror=function(){var zt=At.result;zt&&zt.close(),kt(At.error)},At.onblocked=function(){console.warn('dropInstance blocked for database "'+m.name+'" until all open connections are closed')},At.onsuccess=function(){var zt=At.result;zt&&zt.close(),ct(zt)}}).then(function(ct){Y.db=ct;for(var kt=0;kt<H.length;kt++)Zt(H[kt]._dbInfo)}).catch(function(ct){throw(ne(m,ct)||it.resolve()).catch(function(){}),ct})}):it.reject("Invalid arguments"),_),N}};var Wt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ge=/^~~local_forage_type~([^~]+)~/,ai="__lfsc__:",Pe="arbf",oi="blob",Me=Object.prototype.toString;function Pn(m){var R,I,G,U,Y,_=.75*m.length,k=m.length,N=0;"="===m[m.length-1]&&(_--,"="===m[m.length-2]&&_--);var H=new ArrayBuffer(_),q=new Uint8Array(H);for(R=0;R<k;R+=4)I=Wt.indexOf(m[R]),G=Wt.indexOf(m[R+1]),U=Wt.indexOf(m[R+2]),Y=Wt.indexOf(m[R+3]),q[N++]=I<<2|G>>4,q[N++]=(15&G)<<4|U>>2,q[N++]=(3&U)<<6|63&Y;return H}function Ni(m){var R,_=new Uint8Array(m),k="";for(R=0;R<_.length;R+=3)k+=Wt[_[R]>>2],k+=Wt[(3&_[R])<<4|_[R+1]>>4],k+=Wt[(15&_[R+1])<<2|_[R+2]>>6],k+=Wt[63&_[R+2]];return _.length%3==2?k=k.substring(0,k.length-1)+"=":_.length%3==1&&(k=k.substring(0,k.length-2)+"=="),k}var _i={serialize:function Mn(m,_){var k="";if(m&&(k=Me.call(m)),m&&("[object ArrayBuffer]"===k||m.buffer&&"[object ArrayBuffer]"===Me.call(m.buffer))){var R,N=ai;m instanceof ArrayBuffer?(R=m,N+=Pe):(R=m.buffer,"[object Int8Array]"===k?N+="si08":"[object Uint8Array]"===k?N+="ui08":"[object Uint8ClampedArray]"===k?N+="uic8":"[object Int16Array]"===k?N+="si16":"[object Uint16Array]"===k?N+="ur16":"[object Int32Array]"===k?N+="si32":"[object Uint32Array]"===k?N+="ui32":"[object Float32Array]"===k?N+="fl32":"[object Float64Array]"===k?N+="fl64":_(new Error("Failed to get type for BinaryArray"))),_(N+Ni(R))}else if("[object Blob]"===k){var I=new FileReader;I.onload=function(){var G="~~local_forage_type~"+m.type+"~"+Ni(this.result);_(ai+oi+G)},I.readAsArrayBuffer(m)}else try{_(JSON.stringify(m))}catch(G){console.error("Couldn't convert value into a JSON string: ",m),_(null,G)}},deserialize:function Kn(m){if(m.substring(0,9)!==ai)return JSON.parse(m);var R,_=m.substring(13),k=m.substring(9,13);if(k===oi&&ge.test(_)){var N=_.match(ge);R=N[1],_=_.substring(N[0].length)}var I=Pn(_);switch(k){case Pe:return I;case oi:return mt([I],{type:R});case"si08":return new Int8Array(I);case"ui08":return new Uint8Array(I);case"uic8":return new Uint8ClampedArray(I);case"si16":return new Int16Array(I);case"ur16":return new Uint16Array(I);case"si32":return new Int32Array(I);case"ui32":return new Uint32Array(I);case"fl32":return new Float32Array(I);case"fl64":return new Float64Array(I);default:throw new Error("Unkown type: "+k)}},stringToBuffer:Pn,bufferToString:Ni};function Ei(m,_,k,R){m.executeSql("CREATE TABLE IF NOT EXISTS "+_.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],k,R)}function Dt(m,_,k,R,N,I){m.executeSql(k,R,N,function(G,U){U.code===U.SYNTAX_ERR?G.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[_.storeName],function(Y,H){H.rows.length?I(Y,U):Ei(Y,_,function(){Y.executeSql(k,R,N,I)},I)},I):I(G,U)},I)}function en(m,_,k,R){var N=this;m=_t(m);var I=new it(function(G,U){N.ready().then(function(){void 0===_&&(_=null);var Y=_,H=N._dbInfo;H.serializer.serialize(_,function(q,rt){rt?U(rt):H.db.transaction(function(st){Dt(st,H,"INSERT OR REPLACE INTO "+H.storeName+" (key, value) VALUES (?, ?)",[m,q],function(){G(Y)},function(ct,kt){U(kt)})},function(st){if(st.code===st.QUOTA_ERR){if(R>0)return void G(en.apply(N,[m,Y,k,R-1]));U(st)}})})}).catch(U)});return ot(I,k),I}var Xn={_driver:"webSQLStorage",_initStorage:function Dn(m){var _=this,k={db:null};if(m)for(var R in m)k[R]="string"!=typeof m[R]?m[R].toString():m[R];var N=new it(function(I,G){try{k.db=openDatabase(k.name,String(k.version),k.description,k.size)}catch(U){return G(U)}k.db.transaction(function(U){Ei(U,k,function(){_._dbInfo=k,I()},function(Y,H){G(H)})},G)});return k.serializer=_i,N},_support:function zr(){return"function"==typeof openDatabase}(),iterate:function tn(m,_){var k=this,R=new it(function(N,I){k.ready().then(function(){var G=k._dbInfo;G.db.transaction(function(U){Dt(U,G,"SELECT * FROM "+G.storeName,[],function(Y,H){for(var q=H.rows,rt=q.length,st=0;st<rt;st++){var ct=q.item(st),kt=ct.value;if(kt&&(kt=G.serializer.deserialize(kt)),void 0!==(kt=m(kt,ct.key,st+1)))return void N(kt)}N()},function(Y,H){I(H)})})}).catch(I)});return ot(R,_),R},getItem:function Gn(m,_){var k=this;m=_t(m);var R=new it(function(N,I){k.ready().then(function(){var G=k._dbInfo;G.db.transaction(function(U){Dt(U,G,"SELECT * FROM "+G.storeName+" WHERE key = ? LIMIT 1",[m],function(Y,H){var q=H.rows.length?H.rows.item(0).value:null;q&&(q=G.serializer.deserialize(q)),N(q)},function(Y,H){I(H)})})}).catch(I)});return ot(R,_),R},setItem:function Qn(m,_,k){return en.apply(this,[m,_,k,1])},removeItem:function Un(m,_){var k=this;m=_t(m);var R=new it(function(N,I){k.ready().then(function(){var G=k._dbInfo;G.db.transaction(function(U){Dt(U,G,"DELETE FROM "+G.storeName+" WHERE key = ?",[m],function(){N()},function(Y,H){I(H)})})}).catch(I)});return ot(R,_),R},clear:function Ti(m){var _=this,k=new it(function(R,N){_.ready().then(function(){var I=_._dbInfo;I.db.transaction(function(G){Dt(G,I,"DELETE FROM "+I.storeName,[],function(){R()},function(U,Y){N(Y)})})}).catch(N)});return ot(k,m),k},length:function Hn(m){var _=this,k=new it(function(R,N){_.ready().then(function(){var I=_._dbInfo;I.db.transaction(function(G){Dt(G,I,"SELECT COUNT(key) as c FROM "+I.storeName,[],function(U,Y){var H=Y.rows.item(0).c;R(H)},function(U,Y){N(Y)})})}).catch(N)});return ot(k,m),k},key:function Wn(m,_){var k=this,R=new it(function(N,I){k.ready().then(function(){var G=k._dbInfo;G.db.transaction(function(U){Dt(U,G,"SELECT key FROM "+G.storeName+" WHERE id = ? LIMIT 1",[m+1],function(Y,H){var q=H.rows.length?H.rows.item(0).key:null;N(q)},function(Y,H){I(H)})})}).catch(I)});return ot(R,_),R},keys:function Yn(m){var _=this,k=new it(function(R,N){_.ready().then(function(){var I=_._dbInfo;I.db.transaction(function(G){Dt(G,I,"SELECT key FROM "+I.storeName,[],function(U,Y){for(var H=[],q=0;q<Y.rows.length;q++)H.push(Y.rows.item(q).key);R(H)},function(U,Y){N(Y)})})}).catch(N)});return ot(k,m),k},dropInstance:function jt(m,_){_=Yt.apply(this,arguments);var k=this.config();(m="function"!=typeof m&&m||{}).name||(m.name=m.name||k.name,m.storeName=m.storeName||k.storeName);var N,R=this;return ot(N=m.name?new it(function(I){var G;G=m.name===k.name?R._dbInfo.db:openDatabase(m.name,"","",0),I(m.storeName?{db:G,storeNames:[m.storeName]}:function Et(m){return new it(function(_,k){m.transaction(function(R){R.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(N,I){for(var G=[],U=0;U<I.rows.length;U++)G.push(I.rows.item(U).name);_({db:m,storeNames:G})},function(N,I){k(I)})},function(R){k(R)})})}(G))}).then(function(I){return new it(function(G,U){I.db.transaction(function(Y){function H(ct){return new it(function(kt,At){Y.executeSql("DROP TABLE IF EXISTS "+ct,[],function(){kt()},function(zt,Tt){At(Tt)})})}for(var q=[],rt=0,st=I.storeNames.length;rt<st;rt++)q.push(H(I.storeNames[rt]));it.all(q).then(function(){G()}).catch(function(ct){U(ct)})},function(Y){U(Y)})})}):it.reject("Invalid arguments"),_),N}};function nn(m,_){var k=m.name+"/";return m.storeName!==_.storeName&&(k+=m.storeName+"/"),k}function Vn(){return!function Zn(){var m="_localforage_support_test";try{return localStorage.setItem(m,!0),localStorage.removeItem(m),!1}catch{return!0}}()||localStorage.length>0}var de={_driver:"localStorageWrapper",_initStorage:function $n(m){var k={};if(m)for(var R in m)k[R]=m[R];return k.keyPrefix=nn(m,this._defaultConfig),Vn()?(this._dbInfo=k,k.serializer=_i,it.resolve()):it.reject()},_support:function qn(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}(),iterate:function er(m,_){var k=this,R=k.ready().then(function(){for(var N=k._dbInfo,I=N.keyPrefix,G=I.length,U=localStorage.length,Y=1,H=0;H<U;H++){var q=localStorage.key(H);if(0===q.indexOf(I)){var rt=localStorage.getItem(q);if(rt&&(rt=N.serializer.deserialize(rt)),void 0!==(rt=m(rt,q.substring(G),Y++)))return rt}}});return ot(R,_),R},getItem:function rn(m,_){var k=this;m=_t(m);var R=k.ready().then(function(){var N=k._dbInfo,I=localStorage.getItem(N.keyPrefix+m);return I&&(I=N.serializer.deserialize(I)),I});return ot(R,_),R},setItem:function Ai(m,_,k){var R=this;m=_t(m);var N=R.ready().then(function(){void 0===_&&(_=null);var I=_;return new it(function(G,U){var Y=R._dbInfo;Y.serializer.serialize(_,function(H,q){if(q)U(q);else try{localStorage.setItem(Y.keyPrefix+m,H),G(I)}catch(rt){("QuotaExceededError"===rt.name||"NS_ERROR_DOM_QUOTA_REACHED"===rt.name)&&U(rt),U(rt)}})})});return ot(N,k),N},removeItem:function Ii(m,_){var k=this;m=_t(m);var R=k.ready().then(function(){localStorage.removeItem(k._dbInfo.keyPrefix+m)});return ot(R,_),R},clear:function tr(m){var _=this,k=_.ready().then(function(){for(var R=_._dbInfo.keyPrefix,N=localStorage.length-1;N>=0;N--){var I=localStorage.key(N);0===I.indexOf(R)&&localStorage.removeItem(I)}});return ot(k,m),k},length:function ir(m){var k=this.keys().then(function(R){return R.length});return ot(k,m),k},key:function Ke(m,_){var k=this,R=k.ready().then(function(){var I,N=k._dbInfo;try{I=localStorage.key(m)}catch{I=null}return I&&(I=I.substring(N.keyPrefix.length)),I});return ot(R,_),R},keys:function ln(m){var _=this,k=_.ready().then(function(){for(var R=_._dbInfo,N=localStorage.length,I=[],G=0;G<N;G++){var U=localStorage.key(G);0===U.indexOf(R.keyPrefix)&&I.push(U.substring(R.keyPrefix.length))}return I});return ot(k,m),k},dropInstance:function Ci(m,_){if(_=Yt.apply(this,arguments),!(m="function"!=typeof m&&m||{}).name){var k=this.config();m.name=m.name||k.name,m.storeName=m.storeName||k.storeName}var N,R=this;return ot(N=m.name?new it(function(I){I(m.storeName?nn(m,R._defaultConfig):m.name+"/")}).then(function(I){for(var G=localStorage.length-1;G>=0;G--){var U=localStorage.key(G);0===U.indexOf(I)&&localStorage.removeItem(U)}}):it.reject("Invalid arguments"),_),N}},Ne=function(_,k){return _===k||"number"==typeof _&&"number"==typeof k&&isNaN(_)&&isNaN(k)},an=function(_,k){for(var R=_.length,N=0;N<R;){if(Ne(_[N],k))return!0;N++}return!1},Ji=Array.isArray||function(m){return"[object Array]"===Object.prototype.toString.call(m)},Xe={},si={},Je={INDEXEDDB:nt,WEBSQL:Xn,LOCALSTORAGE:de},nr=[Je.INDEXEDDB._driver,Je.WEBSQL._driver,Je.LOCALSTORAGE._driver],V=["dropInstance"],di=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(V),rr={description:"",driver:nr.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ui(m,_){m[_]=function(){var k=arguments;return m.ready().then(function(){return m[_].apply(m,k)})}}function Ri(){for(var m=1;m<arguments.length;m++){var _=arguments[m];if(_)for(var k in _)_.hasOwnProperty(k)&&(arguments[0][k]=Ji(_[k])?_[k].slice():_[k])}return arguments[0]}var ci=function(){function m(_){for(var k in function Qt(m,_){if(!(m instanceof _))throw new TypeError("Cannot call a class as a function")}(this,m),Je)if(Je.hasOwnProperty(k)){var R=Je[k],N=R._driver;this[k]=N,Xe[N]||this.defineDriver(R)}this._defaultConfig=Ri({},rr),this._config=Ri({},this._defaultConfig,_),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return m.prototype.config=function(k){if("object"===(typeof k>"u"?"undefined":yt(k))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var R in k){if("storeName"===R&&(k[R]=k[R].replace(/\W/g,"_")),"version"===R&&"number"!=typeof k[R])return new Error("Database version must be a number.");this._config[R]=k[R]}return!("driver"in k)||!k.driver||this.setDriver(this._config.driver)}return"string"==typeof k?this._config[k]:this._config},m.prototype.defineDriver=function(k,R,N){var I=new it(function(G,U){try{var Y=k._driver,H=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!k._driver)return void U(H);for(var q=di.concat("_initStorage"),rt=0,st=q.length;rt<st;rt++){var ct=q[rt];if((!an(V,ct)||k[ct])&&"function"!=typeof k[ct])return void U(H)}!function(){for(var qe=function(sn){return function(){var lr=new Error("Method "+sn+" is not implemented by the current driver"),dn=it.reject(lr);return ot(dn,arguments[arguments.length-1]),dn}},ji=0,on=V.length;ji<on;ji++){var zi=V[ji];k[zi]||(k[zi]=qe(zi))}}();var zt=function(qe){Xe[Y]&&console.info("Redefining LocalForage driver: "+Y),Xe[Y]=k,si[Y]=qe,G()};"_support"in k?k._support&&"function"==typeof k._support?k._support().then(zt,U):zt(!!k._support):zt(!0)}catch(Tt){U(Tt)}});return pt(I,R,N),I},m.prototype.driver=function(){return this._driver||null},m.prototype.getDriver=function(k,R,N){var I=Xe[k]?it.resolve(Xe[k]):it.reject(new Error("Driver not found."));return pt(I,R,N),I},m.prototype.getSerializer=function(k){var R=it.resolve(_i);return pt(R,k),R},m.prototype.ready=function(k){var R=this,N=R._driverSet.then(function(){return null===R._ready&&(R._ready=R._initDriver()),R._ready});return pt(N,k,k),N},m.prototype.setDriver=function(k,R,N){var I=this;Ji(k)||(k=[k]);var G=this._getSupportedDrivers(k);function U(){I._config.driver=I.driver()}function Y(rt){return I._extend(rt),U(),I._ready=I._initStorage(I._config),I._ready}var q=null!==this._driverSet?this._driverSet.catch(function(){return it.resolve()}):it.resolve();return this._driverSet=q.then(function(){var rt=G[0];return I._dbInfo=null,I._ready=null,I.getDriver(rt).then(function(st){I._driver=st._driver,U(),I._wrapLibraryMethodsWithReady(),I._initDriver=function H(rt){return function(){var st=0;return function ct(){for(;st<rt.length;){var kt=rt[st];return st++,I._dbInfo=null,I._ready=null,I.getDriver(kt).then(Y).catch(ct)}U();var At=new Error("No available storage method found.");return I._driverSet=it.reject(At),I._driverSet}()}}(G)})}).catch(function(){U();var rt=new Error("No available storage method found.");return I._driverSet=it.reject(rt),I._driverSet}),pt(this._driverSet,R,N),this._driverSet},m.prototype.supports=function(k){return!!si[k]},m.prototype._extend=function(k){Ri(this,k)},m.prototype._getSupportedDrivers=function(k){for(var R=[],N=0,I=k.length;N<I;N++){var G=k[N];this.supports(G)&&R.push(G)}return R},m.prototype._wrapLibraryMethodsWithReady=function(){for(var k=0,R=di.length;k<R;k++)ui(this,di[k])},m.prototype.createInstance=function(k){return new m(k)},m}(),re=new ci;Mt.exports=re},{3:3}]},{},[4])(4)}}]);