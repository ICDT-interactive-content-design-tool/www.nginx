"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6617],{8671:(N,j,p)=>{p.d(j,{$:()=>F});var C=p(5972);function F(u){u.params=u.params||{},(0,C.hm)({url:"api/Lookup/get",params:{lookup_key:u.params.lookup_key||null},success:r=>{"function"==typeof u.callback&&u.callback(null==r?void 0:r.data)},error:r=>{"function"==typeof u.callback&&u.callback(),console.error(u,r)},loading:u.loading,loadingController:u.loadingController})}},6617:(N,j,p)=>{p.r(j),p.d(j,{KnowledgeQAPageModule:()=>Mt});var C=p(177),F=p(9417),u=p(6637),r=p(3658),f=p(467),T=p(5972),w=p(2635),$=p(8405),I=p(7331),R=p(3753),A=p(1312),O=p(1038),M=p(5414);function g(o){var c,l,n,e,i,a,s,d;o.params=o.params||{},(0,T.Ll)({url:"api/TextBook/AddUpdate",params:{user_id:null!==(c=o.params.userid)&&void 0!==c?c:null,textbook_id:null!==(l=o.params.textbook_id)&&void 0!==l?l:null,textbook_title:null!==(n=o.params.textbook_title)&&void 0!==n?n:null,topic_id:null!==(e=o.params.topic_id)&&void 0!==e?e:null,category_id:null!==(i=o.params.category_id)&&void 0!==i?i:null,v_textbook_catg:null!==(a=o.params.v_textbook_catg)&&void 0!==a?a:null,v_publisher:null!==(s=o.params.v_publisher)&&void 0!==s?s:null,filepath:null!==(d=o.params.filepath)&&void 0!==d?d:null},success:_=>{var k;"function"==typeof o.callback&&o.callback(null!==(k=_.data)&&void 0!==k?k:null)},error:_=>{"function"==typeof o.callback&&o.callback(),console.error(_)},loading:o.loading,loadingController:o.loadingController})}var t=p(4438),v=p(31);function E(o,c){if(1&o){const l=t.RV6();t.j41(0,"button",18),t.bIt("click",function(e){t.eBV(l);const i=t.XpG();return t.Njj(i.clearTopic(e))}),t.nrm(1,"ion-icon",19),t.k0s()}}function L(o,c){if(1&o){const l=t.RV6();t.j41(0,"button",18),t.bIt("click",function(e){t.eBV(l);const i=t.XpG();return t.Njj(i.clearCategory(e))}),t.nrm(1,"ion-icon",19),t.k0s()}}function Y(o,c){if(1&o){const l=t.RV6();t.j41(0,"button",18),t.bIt("click",function(e){t.eBV(l);const i=t.XpG();return t.Njj(i.clearTextbookCatg(e))}),t.nrm(1,"ion-icon",19),t.k0s()}}function J(o,c){if(1&o){const l=t.RV6();t.j41(0,"button",18),t.bIt("click",function(e){t.eBV(l);const i=t.XpG();return t.Njj(i.clearPublisher(e))}),t.nrm(1,"ion-icon",19),t.k0s()}}let S=(()=>{var o;class c{constructor(n,e,i,a){this.modalController=n,this.toastController=e,this.loadingController=i,this.popoverController=a,this.textbook={},this.isfullscreen=!1,this.appsettings={}}ngOnInit(){var n=this;this.isfullscreen=window.document.body.classList.contains("modal-fullscreen"),(0,f.A)(function*(){n.appsettings=yield(0,T.AC)(),n.appsettings.madonvi&&(n.user=yield(0,w.Nk)(),n.refreshData())})()}toggleFullScreen(){this.isfullscreen?window.document.body.classList.remove("modal-fullscreen"):window.document.body.classList.add("modal-fullscreen"),this.isfullscreen=window.document.body.classList.contains("modal-fullscreen")}close(){return this.modalController.dismiss(null,"cancel")}refreshData(){}presentPopoverTopic(n){var e=this;return(0,f.A)(function*(){const i=yield e.popoverController.create({component:I.E,componentProps:{selectedId:e.textbook.topic_id,filter:{for:"textbook"}},event:n,dismissOnSelect:!1,animated:!1,side:"right"});i.onDidDismiss().then(a=>{var s,d;"confirm"==a.role&&Object.assign(e.textbook,{topic_id:null===(s=a.data)||void 0===s?void 0:s.topic_id,topic_title:null===(d=a.data)||void 0===d?void 0:d.topic_title})}),i.present()})()}clearTopic(n){Object.assign(this.textbook,{topic_id:null,topic_title:null})}changeTopic(n){var e;this.textbook.topic_id=null!==(e=parseInt(n))&&void 0!==e?e:0}presentPopoverCategory(n){var e=this;return(0,f.A)(function*(){const i=yield e.popoverController.create({component:$.P,componentProps:{selectedId:e.textbook.category_id,filter:{for:"textbook"}},event:n,dismissOnSelect:!1,animated:!1,side:"right"});i.onDidDismiss().then(a=>{var s,d;"confirm"==a.role&&Object.assign(e.textbook,{category_id:null===(s=a.data)||void 0===s?void 0:s.category_id,category_title:null===(d=a.data)||void 0===d?void 0:d.category_title})}),i.present()})()}clearCategory(n){Object.assign(this.textbook,{category_id:null,category_title:null})}changeCategory(n){var e;this.textbook.category_id=null!==(e=parseInt(n))&&void 0!==e?e:0}presentPopoverLookupTextbookCatg(n){var e=this;return(0,f.A)(function*(){const i=yield e.popoverController.create({component:R.t,componentProps:{selectedId:e.textbook.v_textbook_catg,lookup_key:"v_textbook_catg"},event:n,dismissOnSelect:!1,animated:!1});i.onDidDismiss().then(a=>{var s,d;"confirm"==a.role&&Object.assign(e.textbook,{v_textbook_catg:null===(s=a.data)||void 0===s?void 0:s.lookup_value,v_textbook_catg_title:null===(d=a.data)||void 0===d?void 0:d.lookup_title})}),i.present()})()}clearTextbookCatg(n){Object.assign(this.textbook,{v_textbook_catg:null,v_textbook_catg_title:null})}changeTextbookCatg(n){var e;this.textbook.v_textbook_catg=null!==(e=parseInt(n))&&void 0!==e?e:0}presentPopoverLookupPublisher(n){var e=this;return(0,f.A)(function*(){const i=yield e.popoverController.create({component:R.t,componentProps:{selectedId:e.textbook.v_publisher,lookup_key:"v_publisher"},event:n,dismissOnSelect:!1,animated:!1});i.onDidDismiss().then(a=>{var s,d;"confirm"==a.role&&Object.assign(e.textbook,{v_publisher:null===(s=a.data)||void 0===s?void 0:s.lookup_value,v_publisher_title:null===(d=a.data)||void 0===d?void 0:d.lookup_title})}),i.present()})()}clearPublisher(n){Object.assign(this.textbook,{v_publisher:null,v_publisher_title:null})}changePublisher(n){var e;this.textbook.v_publisher=null!==(e=parseInt(n))&&void 0!==e?e:0}selectFile(){(0,A.oG)({accept:".pdf,.doc,.docx",multiple:!1},n=>{var e,i;null!=n&&n.length&&(this.textbookFile=n[0],this.textbook.filename=n[0].name,this.textbook.textbook_title=null!==(e=this.textbook.textbook_title)&&void 0!==e?e:null===(i=n[0].name)||void 0===i?void 0:i.split(".").shift())})}changeTextBookTitle(n){var e;this.textbook.textbook_title=null==n||null===(e=n.target)||void 0===e?void 0:e.value}save(){var n=[];this.textbookFile&&n.push(new Promise((i,a)=>{(0,O.v)({loadingController:this.loadingController,params:{file:this.textbookFile,subFolder:"textbook",fileType:"pdf,office"},callback:s=>{0==(null==s?void 0:s.ReturnCode)?(this.textbook.filepath=s.path+"/"+s.file.name,this.textbookFile=void 0):(0,M.c)(this.toastController,{},{returncode:null==s?void 0:s.ReturnCode,returnmsg:null==s?void 0:s.ReturnName}).then(d=>{d.present()}),i(s)}})}));var e=()=>{var i;this.textbook.filepath?g({loadingController:this.loadingController,params:{userid:null===(i=this.user)||void 0===i?void 0:i.userid,textbook_title:this.textbook.textbook_title,filepath:this.textbook.filepath,topic_id:this.textbook.topic_id,category_id:this.textbook.category_id,v_textbook_catg:this.textbook.v_textbook_catg,v_publisher:this.textbook.v_publisher},callback:a=>{0==(null==a?void 0:a.returncode)?this.modalController.dismiss(a.id,"success"):(0,M.c)(this.toastController,{},a).then(s=>{s.present()})}}):(0,M.c)(this.toastController,{color:"danger",message:"Kh\xf4ng t\xecm th\u1ea5y \u0111\u01b0\u1eddng d\u1eabn t\u1eadp tin!"}).then(a=>{a.present()})};n.length?Promise.all(n).then(()=>{e()}):e()}}return(o=c).\u0275fac=function(n){return new(n||o)(t.rXU(u.W3),t.rXU(u.K_),t.rXU(u.Xi),t.rXU(u.IE))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-modal-textbook-add"]],inputs:{textbook:"textbook"},decls:77,vars:35,consts:[["slot","end","mode","ios","color","tertiary",3,"click"],["slot","end"],["color","dark",1,"d-none","d-md-block",3,"click"],[3,"src"],["color","dark",3,"click"],["src","../../../assets/icon/16x16/close.svg"],[1,"container-fluid","py-3"],[1,"form-group"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],["type","text","readonly","",1,"form-control",3,"value"],[1,"input-group-append"],["type","button",1,"btn","btn-outline-secondary","btn-popover",3,"click"],["name","folder-open-outline"],["type","text",1,"form-control",3,"change","ngModel"],["type","button","class","btn btn-outline-secondary",3,"click",4,"ngIf"],["name","chevron-down-outline"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["name","close-outline"]],template:function(n,e){if(1&n&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.nI1(4,"translate"),t.k0s(),t.j41(5,"ion-button",0),t.bIt("click",function(){return e.save()}),t.j41(6,"ion-label"),t.EFF(7),t.nI1(8,"translate"),t.k0s()(),t.j41(9,"ion-buttons",1)(10,"ion-button",2),t.bIt("click",function(){return e.toggleFullScreen()}),t.nrm(11,"ion-icon",3),t.k0s(),t.j41(12,"ion-button",4),t.bIt("click",function(){return e.close()}),t.nrm(13,"ion-icon",5),t.k0s()()()(),t.j41(14,"ion-content")(15,"div",6)(16,"div",7)(17,"div",8)(18,"div",9)(19,"label",10),t.EFF(20),t.nI1(21,"translate"),t.k0s()(),t.nrm(22,"input",11),t.j41(23,"div",12)(24,"button",13),t.bIt("click",function(){return e.selectFile()}),t.nrm(25,"ion-icon",14),t.k0s()()()(),t.j41(26,"div",7)(27,"div",8)(28,"div",9)(29,"label",10),t.EFF(30),t.nI1(31,"translate"),t.k0s()(),t.j41(32,"input",15),t.bIt("change",function(a){return e.changeTextBookTitle(a)}),t.k0s()()(),t.j41(33,"div",7)(34,"div",8)(35,"div",9)(36,"label",10),t.EFF(37),t.nI1(38,"translate"),t.k0s()(),t.nrm(39,"input",11),t.j41(40,"div",12),t.DNE(41,E,2,0,"button",16),t.j41(42,"button",13),t.bIt("click",function(a){return e.presentPopoverTopic(a)}),t.nrm(43,"ion-icon",17),t.k0s()()()(),t.j41(44,"div",7)(45,"div",8)(46,"div",9)(47,"label",10),t.EFF(48),t.nI1(49,"translate"),t.k0s()(),t.nrm(50,"input",11),t.j41(51,"div",12),t.DNE(52,L,2,0,"button",16),t.j41(53,"button",13),t.bIt("click",function(a){return e.presentPopoverCategory(a)}),t.nrm(54,"ion-icon",17),t.k0s()()()(),t.j41(55,"div",7)(56,"div",8)(57,"div",9)(58,"label",10),t.EFF(59),t.nI1(60,"translate"),t.k0s()(),t.nrm(61,"input",11),t.j41(62,"div",12),t.DNE(63,Y,2,0,"button",16),t.j41(64,"button",13),t.bIt("click",function(a){return e.presentPopoverLookupTextbookCatg(a)}),t.nrm(65,"ion-icon",17),t.k0s()()()(),t.j41(66,"div",7)(67,"div",8)(68,"div",9)(69,"label",10),t.EFF(70),t.nI1(71,"translate"),t.k0s()(),t.nrm(72,"input",11),t.j41(73,"div",12),t.DNE(74,J,2,0,"button",16),t.j41(75,"button",13),t.bIt("click",function(a){return e.presentPopoverLookupPublisher(a)}),t.nrm(76,"ion-icon",17),t.k0s()()()()()()),2&n){let i,a,s,d,_;t.R7$(3),t.JRh(t.bMT(4,19,"AddTextBook")),t.R7$(4),t.JRh(t.bMT(8,21,"Add")),t.R7$(4),t.Y8G("src",e.isfullscreen?"assets/icon/16x16/fullscreen-exit.svg":"assets/icon/16x16/fullscreen.svg"),t.R7$(9),t.JRh(t.bMT(21,23,"File")),t.R7$(2),t.Y8G("value",null!==(i=e.textbook.filename)&&void 0!==i?i:""),t.R7$(8),t.JRh(t.bMT(31,25,"TextBookName")),t.R7$(2),t.Y8G("ngModel",e.textbook.textbook_title),t.R7$(5),t.JRh(t.bMT(38,27,"GradeLevel")),t.R7$(2),t.Y8G("value",null!==(a=e.textbook.topic_title)&&void 0!==a?a:""),t.R7$(2),t.Y8G("ngIf",e.textbook.topic_id),t.R7$(7),t.JRh(t.bMT(49,29,"Subject")),t.R7$(2),t.Y8G("value",null!==(s=e.textbook.category_title)&&void 0!==s?s:""),t.R7$(2),t.Y8G("ngIf",e.textbook.category_id),t.R7$(7),t.JRh(t.bMT(60,31,"Catalogue")),t.R7$(2),t.Y8G("value",null!==(d=e.textbook.v_textbook_catg_title)&&void 0!==d?d:""),t.R7$(2),t.Y8G("ngIf",e.textbook.v_textbook_catg),t.R7$(7),t.JRh(t.bMT(71,33,"Publisher")),t.R7$(2),t.Y8G("value",null!==(_=e.textbook.v_publisher_title)&&void 0!==_?_:""),t.R7$(2),t.Y8G("ngIf",e.textbook.v_publisher)}},dependencies:[C.bT,F.me,F.BC,F.vS,u.Jm,u.QW,u.W9,u.eU,u.iq,u.he,u.BC,u.ai,v.D9],styles:[".input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{outline:none!important;box-shadow:none!important}.input-group[_ngcontent-%COMP%]   .input-group-prepend[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%]{min-width:120px}.input-group[_ngcontent-%COMP%]   .input-group-append[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{line-height:0}.input-group[_ngcontent-%COMP%]   .input-group-append[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.input-group[_ngcontent-%COMP%]   .form-control-plaintext[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem;border:1px solid #ddd;border-radius:4px}.input-group[_ngcontent-%COMP%]   .form-control-plaintext[_ngcontent-%COMP%]:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.input-group[_ngcontent-%COMP%]   .form-control-plaintext[_ngcontent-%COMP%]:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-color:#fff}"]}),c})();var X=p(5312),U=p(8295),Q=p(5446),z=p(6539),V=p(2313),W=p(7704),H=p(2706);const B=o=>({$implicit:o});function Z(o,c){if(1&o&&(t.j41(0,"div",37),t.eu8(1,38),t.k0s()),2&o){const l=c.$implicit;t.XpG(3);const n=t.sdS(108);t.R7$(),t.Y8G("ngTemplateOutlet",n)("ngTemplateOutletContext",t.eq3(2,B,l))}}function q(o,c){if(1&o&&(t.j41(0,"ion-content",35)(1,"div",36),t.Z7z(2,Z,2,4,"div",37,t.fX1),t.k0s()()),2&o){const l=t.XpG(2);t.R7$(2),t.Dyx(l.textBooks)}}function tt(o,c){if(1&o&&(t.j41(0,"div",31)(1,"span",32),t.EFF(2),t.k0s(),t.nrm(3,"ion-icon",33),t.k0s(),t.j41(4,"ion-popover",34),t.DNE(5,q,4,0,"ng-template"),t.k0s()),2&o){const l=t.XpG();t.R7$(2),t.JRh(l.textBook.textbook_title)}}function et(o,c){}function ot(o,c){if(1&o&&(t.j41(0,"div",40)(1,"b"),t.EFF(2,"Ch\u01b0a hu\u1ea5n luy\u1ec7n AI"),t.k0s(),t.j41(3,"div")(4,"a",41),t.EFF(5),t.k0s()()()),2&o){const l=t.XpG(2);t.R7$(4),t.Y8G("href",l.readfileuploadurl+l.textBook.filepath,t.B4B),t.R7$(),t.JRh(l.readfileuploadurl+l.textBook.filepath)}}function nt(o,c){if(1&o&&(t.j41(0,"div",39),t.DNE(1,ot,6,2,"div",40),t.k0s()),2&o){const l=t.XpG();t.R7$(),t.vxM(1,l.textBook.isaitrained?-1:1)}}function it(o,c){if(1&o&&(t.j41(0,"div",46),t.eu8(1,38),t.k0s()),2&o){const l=c.$implicit;t.XpG(2);const n=t.sdS(108);t.R7$(),t.Y8G("ngTemplateOutlet",n)("ngTemplateOutletContext",t.eq3(2,B,l))}}function lt(o,c){if(1&o&&(t.j41(0,"div",42)(1,"div",43),t.EFF(2,"Ch\u1ecdn ch\u01b0\u01a1ng tr\xecnh h\u1ecdc"),t.k0s(),t.j41(3,"div",21)(4,"ion-content")(5,"div",44)(6,"div",45),t.Z7z(7,it,2,4,"div",46,t.fX1),t.k0s()()()()()),2&o){const l=t.XpG();t.R7$(7),t.Dyx(l.textBooks)}}function rt(o,c){if(1&o&&t.eu8(0,20),2&o){t.XpG();const l=t.sdS(106);t.Y8G("ngTemplateOutlet",l)}}function at(o,c){if(1&o){const l=t.RV6();t.j41(0,"ion-button",51),t.bIt("click",function(){t.eBV(l);const e=t.XpG(2);return t.Njj(e.trainningAI())}),t.j41(1,"ion-label"),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.nrm(4,"ion-icon",52),t.k0s()}2&o&&(t.R7$(2),t.JRh(t.bMT(3,1,"TrainningAI")))}function ct(o,c){if(1&o){const l=t.RV6();t.j41(0,"ion-button",53),t.bIt("click",function(){t.eBV(l),t.XpG(2);const e=t.sdS(91);return t.Njj(null==e?null:e.present())}),t.j41(1,"ion-label"),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.nrm(4,"ion-icon",54),t.k0s()}2&o&&(t.R7$(2),t.JRh(t.bMT(3,1,"ViewTextBook")))}function st(o,c){if(1&o){const l=t.RV6();t.j41(0,"div",23),t.DNE(1,at,5,3,"ion-button",47)(2,ct,5,3,"ion-button",48),t.j41(3,"ion-button",49),t.bIt("click",function(){t.eBV(l);const e=t.XpG();return t.Njj(e.presentModalTextbookAdd())}),t.j41(4,"ion-label"),t.EFF(5),t.nI1(6,"translate"),t.k0s(),t.nrm(7,"ion-icon",50),t.k0s()()}if(2&o){const l=t.XpG();t.R7$(),t.vxM(1,l.textBook&&!l.textBook.isaitrained?1:-1),t.R7$(),t.vxM(2,l.textBook&&l.textBook.filepath?2:-1),t.R7$(3),t.JRh(t.bMT(6,3,"Upload"))}}function dt(o,c){if(1&o){const l=t.RV6();t.j41(0,"iframe",59),t.nI1(1,"safe"),t.bIt("load",function(e){t.eBV(l);const i=t.XpG(2);return t.Njj(i.loadIframe(e))}),t.k0s()}if(2&o){const l=t.XpG(2);t.Y8G("src",t.i5U(1,1,"assets/iframe/lib/PDFReader/web/viewer.html?file="+(l.readfileuploadurl+(null==l.textBook?null:l.textBook.filepath)),"resourceUrl"),t.f$h)}}function ut(o,c){if(1&o){const l=t.RV6();t.j41(0,"iframe",59),t.nI1(1,"safe"),t.bIt("load",function(e){t.eBV(l);const i=t.XpG(2);return t.Njj(i.loadIframe(e))}),t.k0s()}if(2&o){const l=t.XpG(2);t.Y8G("src",t.i5U(1,1,"https://view.officeapps.live.com/op/view.aspx?src="+(l.readfileuploadurl+(null==l.textBook?null:l.textBook.filepath)),"resourceUrl"),t.f$h)}}function pt(o,c){if(1&o){const l=t.RV6();t.j41(0,"iframe",59),t.nI1(1,"safe"),t.bIt("load",function(e){t.eBV(l);const i=t.XpG(2);return t.Njj(i.loadIframe(e))}),t.k0s()}if(2&o){const l=t.XpG(2);t.Y8G("src",t.i5U(1,1,"https://view.officeapps.live.com/op/view.aspx?src="+(l.readfileuploadurl+(null==l.textBook?null:l.textBook.filepath)),"resourceUrl"),t.f$h)}}function _t(o,c){if(1&o){const l=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s(),t.j41(4,"ion-buttons",55)(5,"ion-button",56),t.bIt("click",function(){t.eBV(l),t.XpG();const e=t.sdS(91);return t.Njj(null==e?null:e.dismiss())}),t.nrm(6,"ion-icon",57),t.k0s()()()(),t.j41(7,"ion-content",58),t.DNE(8,dt,2,4)(9,ut,2,4)(10,pt,2,4),t.k0s()}if(2&o){let l;const n=t.XpG();t.R7$(3),t.JRh(null==n.textBook?null:n.textBook.textbook_title),t.R7$(5),t.vxM(8,"pdf"===(l=null==n.textBook||null==n.textBook.filepath||null==(l=n.textBook.filepath.split("."))||null==(l=l.pop())?null:l.toLowerCase())?8:"doc"===l?9:"docx"===l?10:-1)}}function gt(o,c){if(1&o&&t.eu8(0,38),2&o){const l=c.$implicit;t.XpG(2);const n=t.sdS(104);t.Y8G("ngTemplateOutlet",n)("ngTemplateOutletContext",t.eq3(2,B,l))}}function mt(o,c){if(1&o&&(t.j41(0,"ion-list",60)(1,"ul"),t.DNE(2,gt,1,4,"ng-container",61),t.k0s()()),2&o){const l=t.XpG();t.R7$(2),t.Y8G("ngForOf",l.filterTopic(l.topics))}}function ft(o,c){1&o&&t.nrm(0,"ion-icon",69)}function vt(o,c){1&o&&t.nrm(0,"ion-icon",70)}function kt(o,c){if(1&o&&(t.j41(0,"ion-badge",71),t.EFF(1),t.k0s()),2&o){const l=t.XpG().$implicit,n=t.XpG();t.R7$(),t.JRh(n.APP_FUNC_FormatNumber(l.total_textbook))}}function bt(o,c){if(1&o&&t.eu8(0,38),2&o){const l=c.$implicit;t.XpG(3);const n=t.sdS(104);t.Y8G("ngTemplateOutlet",n)("ngTemplateOutletContext",t.eq3(2,B,l))}}function ht(o,c){if(1&o&&(t.qex(0),t.j41(1,"ul"),t.DNE(2,bt,1,4,"ng-container",61),t.k0s(),t.bVm()),2&o){const l=t.XpG().$implicit,n=t.XpG();t.R7$(2),t.Y8G("ngForOf",n.filterTopic(n.topics,l.topic_id))}}function xt(o,c){if(1&o){const l=t.RV6();t.j41(0,"li")(1,"ion-item",62),t.bIt("click",function(){const e=t.eBV(l).$implicit,i=t.XpG();return t.Njj(e.disabled?null:i.applyFilterTopic({topic_id:e.topic_id,topic_title:e.topic_title}))}),t.j41(2,"ion-button",63),t.bIt("click",function(e){const i=t.eBV(l).$implicit,a=t.XpG();return t.Njj(a.expandTopic(e,i.topic_id,i.isexpanded))}),t.DNE(3,ft,1,0,"ion-icon",64)(4,vt,1,0,"ion-icon",65),t.k0s(),t.j41(5,"ion-label",66),t.EFF(6),t.k0s(),t.DNE(7,kt,2,1,"ion-badge",67),t.k0s(),t.DNE(8,ht,3,1,"ng-container",68),t.k0s()}if(2&o){const l=c.$implicit,n=t.XpG();t.R7$(),t.HbH(l.topic_id==n.filter.topic_id?"actived":""),t.R7$(),t.BMQ("style",l.ishaschild?"visibility:unset":"visibility:hidden",t.$dS),t.R7$(),t.Y8G("ngIf",!l.isexpanded),t.R7$(),t.Y8G("ngIf",l.isexpanded),t.R7$(),t.Y8G("title",l.topic_title),t.R7$(),t.JRh(l.topic_title),t.R7$(),t.Y8G("ngIf",l.total_textbook),t.R7$(),t.Y8G("ngIf",l.isexpanded)}}function Ct(o,c){1&o&&(t.j41(0,"div",72),t.nrm(1,"ion-img",73),t.j41(2,"div",74),t.EFF(3,"Ch\u1ecdn ch\u01b0\u01a1ng tr\xecnh h\u1ecdc b\u1ea1n c\u1ea7n gi\u1ea3i \u0111\xe1p!"),t.k0s(),t.nrm(4,"ion-img",75),t.k0s())}function Tt(o,c){if(1&o){const l=t.RV6();t.j41(0,"div",76),t.bIt("click",function(){const e=t.eBV(l).$implicit,i=t.XpG();return t.Njj(i.detailTextBook(e.textbook_id))}),t.j41(1,"div",77)(2,"div",78),t.nrm(3,"ion-icon",79),t.k0s(),t.j41(4,"div",80)(5,"div",81),t.EFF(6),t.k0s(),t.j41(7,"div",82),t.EFF(8),t.k0s()()()()}if(2&o){let l,n;const e=c.$implicit;t.HbH(e.isaitrained?"bg-light bg-active-hover":"bg-secondary"),t.R7$(3),t.Mz_("src","../../../assets/icon/subject/",null!==(l=e.category_icon)&&void 0!==l?l:"none.svg",""),t.R7$(2),t.Y8G("title",e.textbook_title),t.R7$(),t.JRh(e.textbook_title),t.R7$(2),t.JRh(null!==(n=e.v_publisher_title)&&void 0!==n?n:e.v_textbook_catg_title)}}const Et=[{path:"",component:(()=>{var o;class c{constructor(n,e,i,a,s){this.router=n,this.activatedRoute=e,this.modalController=i,this.toastController=a,this.loadingController=s,this.APP_FUNC_FormatNumber=A.gs,this.envVersion=X.c.version,this.appsettings={},this.readfileuploadurl="",this.filter={},this.topics=[],this.textBooks=[]}ngOnInit(){var n=this;this.filter.topic_id=parseInt(this.activatedRoute.snapshot.queryParamMap.get("topic")||"0"),(0,f.A)(function*(){var e;n.appsettings=yield(0,T.AC)(),n.appsettings.madonvi&&(n.user=yield(0,z.sx)(),n.readfileuploadurl=null!==(e=n.appsettings.readfileuploadurl)&&void 0!==e?e:"",n.refreshDataAll())})()}refreshDataAll(n){Promise.all([new Promise((e,i)=>{this.refreshDataTopic(a=>{e(a)})})]).finally(()=>{this.filter.topic_id&&this.refreshDataTextBook()})}filterChange(n){this.getRecursiveTopicTitle(this.filter.topic_id),this.router.navigate([],{relativeTo:this.activatedRoute,queryParams:{topic:this.filter.topic_id||null},queryParamsHandling:"merge",replaceUrl:!0}),this.getRecursiveTopicTitle(this.filter.topic_id),this.refreshDataTextBook()}refreshDataTopic(n){this.loadTopic(void 0,()=>{if(n&&n(),this.filter.topic_id){var e;let{topic_id:a,topic_title:s}=null!==(e=this.topics.find(d=>d.topic_id==this.filter.topic_id))&&void 0!==e?e:{};var i;a&&s?(Object.assign(this.filter,{topic_id:a,topic_title:s}),this.getRecursiveTopicTitle(a)):(0,Q.Y5)({params:{userid:null===(i=this.user)||void 0===i?void 0:i.userid,topic_id:this.filter.topic_id,statistic:V.C.textbook,page:1,limit:-1},callback:d=>{var _;let k=d||[];k.forEach(x=>{let P=this.topics.find(K=>K.topic_id==x.topic_id);P?Object.assign(P,x):this.topics.push(x)}),k.map(x=>x.topic_pid).filter((x,P,K)=>K.indexOf(x)==P).forEach(x=>{this.topics.filter(P=>P.topic_id==x).forEach(P=>{P.isexpanded=!0,P.isloadedchild=!0})});let{topic_id:b,topic_title:y}=null!==(_=this.topics.find(x=>x.topic_id==this.filter.topic_id))&&void 0!==_?_:{};b&&y&&(Object.assign(this.filter,{topic_id:b,topic_title:y}),this.getRecursiveTopicTitle(b))}})}},!0)}loadTopic(n,e,i){var a;(0,Q.At)({loadingController:this.loadingController,params:{userid:null===(a=this.user)||void 0===a?void 0:a.userid,topic_pid:n,statistic:V.C.textbook,page:1,limit:-1},callback:s=>{if(this.topics=i?s||[]:this.topics.concat(s||[]),i){let d=[];this.topics.forEach(_=>{_.disabled=!0,_.isexpanded=!0,_.isloadedchild=!0,d.push(new Promise(k=>{this.loadTopic(_.topic_id,k)}))}),Promise.all(d).then(()=>{e&&e()})}else e&&e()}})}filterTopic(n,e){return n.filter(e?i=>i.topic_pid==e:i=>null==i.topic_pid||0==i.topic_pid)}expandTopic(n,e,i){n.preventDefault(),n.stopPropagation(),this.topics.filter(a=>a.topic_id==e).forEach(a=>{a.isexpanded=!i,a.isloadedchild||(a.isloadedchild=!0,this.loadTopic(a.topic_id))})}applyFilterTopic(n){this.filter.topic_id==n.topic_id||Object.assign(this.filter,n),this.filterChange()}clearFilterTopic(n){Object.assign(this.filter,{topic_id:null,topic_title:null}),this.filterChange()}getRecursiveTopicTitle(n,e){let i=this.topics.find(_=>_.topic_id==n);var a,s,d;i?((e=null!==(a=e)&&void 0!==a?a:[]).push(null!==(s=i.topic_title)&&void 0!==s?s:""),this.getRecursiveTopicTitle(i.topic_pid,e)):this.filter.topic_titles=null===(d=e)||void 0===d?void 0:d.reverse()}setFilterTopic(n){n&&(this.filter.topic_id=n,this.filterChange())}refreshDataTextBook(n){this.loadTextBook(e=>{1==e.length?this.detailTextBook(e[0].textbook_id,n):(this.textBook=void 0,this.iframeUrl=void 0,n&&n())},!0)}loadTextBook(n,e){var i;!function D(o){var c,l,n,e,i,a,s,d,_,k;o.params=o.params||{},o.params.page=o.params.page||1,o.params.limit=o.params.limit||1,(0,T.hm)({url:"api/TextBook/Search",params:{getby:null!==(c=o.params.userid)&&void 0!==c?c:null,textbook_id:null!==(l=o.params.textbook_id)&&void 0!==l?l:null,textbook_ids:null!==(n=o.params.textbook_ids)&&void 0!==n?n:null,textbook_title:null!==(e=o.params.textbook_title)&&void 0!==e?e:null,topic_id:null!==(i=o.params.topic_id)&&void 0!==i?i:null,category_id:null!==(a=o.params.category_id)&&void 0!==a?a:null,v_textbook_catg:null!==(s=o.params.v_textbook_catg)&&void 0!==s?s:null,v_publisher:null!==(d=o.params.v_publisher)&&void 0!==d?d:null,createdby:o.params.createdby||null,sortfield:null!==(_=o.params.sortfield)&&void 0!==_?_:null,sorttype:null!==(k=o.params.sorttype)&&void 0!==k?k:null,posstart:(o.params.page-1)*o.params.limit,numofrow:o.params.limit},success:b=>{var y;"function"==typeof o.callback&&o.callback(null!==(y=b.data)&&void 0!==y?y:null)},error:b=>{"function"==typeof o.callback&&o.callback(),console.error(b)},loading:o.loading,loadingController:o.loadingController})}({loadingController:this.loadingController,params:{userid:null===(i=this.user)||void 0===i?void 0:i.userid,topic_id:this.filter.topic_id,category_id:this.filter.category_id,v_textbook_catg:this.filter.v_textbook_catg,v_publisher:this.filter.v_publisher,page:1,limit:-1},callback:a=>{this.textBooks=e?a||[]:this.textBooks.concat(a||[]),n&&n(this.textBooks)}})}detailTextBook(n,e){var i;n?function G(o){var c,l;o.params=o.params||{},(0,T.hm)({url:"api/TextBook/Detail",params:{getby:null!==(c=o.params.userid)&&void 0!==c?c:null,textbook_id:null!==(l=o.params.textbook_id)&&void 0!==l?l:null},success:n=>{var e;"function"==typeof o.callback&&o.callback(null!==(e=n.data)&&void 0!==e?e:null)},error:n=>{"function"==typeof o.callback&&o.callback(),console.error(n)},loading:o.loading,loadingController:o.loadingController})}({loadingController:this.loadingController,params:{userid:null===(i=this.user)||void 0===i?void 0:i.userid,textbook_id:n,page:1,limit:-1},callback:a=>{this.textBook=null!=a?a:{},this.iframeUrl=this.textBook.textbook_id&&this.textBook.isaitrained?`https://ai.codx.vn/ChatBox/DocumentIFrame?k=${X.c.ai_key}&docIds=${this.textBook.textbook_id}`:void 0,e&&e()}}):e&&e()}addTextBook(n){var e;g({loadingController:this.loadingController,params:{userid:null===(e=this.user)||void 0===e?void 0:e.userid,textbook_title:n.fileName,filepath:n.filePath,topic_id:this.filter.topic_id,category_id:this.filter.category_id,v_textbook_catg:10801,v_publisher:10901},callback:i=>{0==(null==i?void 0:i.returncode)?this.detailTextBook(i.id):(0,M.c)(this.toastController,{},i).then(a=>{a.present()})}})}loadIframe(n){return(0,f.A)(function*(){})()}uploadTextBook(){var n=this;return(0,f.A)(function*(){(0,A.oG)({accept:".pdf,.doc,.docx",multiple:!1},e=>{null!=e&&e.length&&(0,O.v)({loadingController:n.loadingController,params:{file:e[0],subFolder:"textbook",fileType:"pdf,office"},callback:i=>{0==(null==i?void 0:i.ReturnCode)?n.addTextBook({fileName:i.name.replace(/.[a-zA-Z0-9]+$/,""),filePath:i.path+"/"+i.file.name}):(0,M.c)(n.toastController,{},{returncode:null==i?void 0:i.ReturnCode,returnmsg:null==i?void 0:i.ReturnName}).then(a=>{a.present()})}})})})()}trainningAI(){var n=this;return(0,f.A)(function*(){var e,i,a,s;null===(e=n.textBook)||void 0===e||!e.textbook_id||null===(i=n.textBook)||void 0===i||!i.filepath||(0,U.fA)({loadingController:n.loadingController,params:{DocumentExternalId:null===(a=n.textBook)||void 0===a?void 0:a.textbook_id,FileUrl:n.readfileuploadurl+(null===(s=n.textBook)||void 0===s?void 0:s.filepath)},callback:d=>{var _,k;null!=d&&d.Succeeded&&function m(o){var c,l,n;o.params=o.params||{},(0,T.Ll)({url:"api/TextBook/UpdateAiCode",params:{user_id:null!==(c=o.params.userid)&&void 0!==c?c:null,textbook_id:null!==(l=o.params.textbook_id)&&void 0!==l?l:null,ai_code:null!==(n=o.params.ai_code)&&void 0!==n?n:null},success:e=>{var i;"function"==typeof o.callback&&o.callback(null!==(i=e.data)&&void 0!==i?i:null)},error:e=>{"function"==typeof o.callback&&o.callback(),console.error(e)},loading:o.loading,loadingController:o.loadingController})}({params:{userid:null===(_=n.user)||void 0===_?void 0:_.userid,textbook_id:null===(k=n.textBook)||void 0===k?void 0:k.textbook_id,ai_code:"lamgicoaicode"},callback:b=>{0==(null==b?void 0:b.returncode)?n.detailTextBook(null==b?void 0:b.id):(0,M.c)(n.toastController,{},b).then(y=>{y.present()})}})}})})()}presentModalTextbookAdd(){var n=this;return(0,f.A)(function*(){let{topic_id:e,topic_title:i,category_id:a,category_title:s}=n.filter;const d=yield n.modalController.create({component:S,componentProps:{textbook:Object.assign({},{topic_id:e,topic_title:i,category_id:a,category_title:s,v_textbook_catg:10801,v_publisher:10901})}});d.onDidDismiss().then(_=>{"success"==_.role&&_.data&&n.detailTextBook(_.data)}),d.present()})()}}return(o=c).\u0275fac=function(n){return new(n||o)(t.rXU(r.Ix),t.rXU(r.nX),t.rXU(u.W3),t.rXU(u.K_),t.rXU(u.Xi))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-knowledge-qa"]],decls:109,vars:10,consts:[["modalViewTextBook",""],["treeTopic",""],["treeTopicNode",""],["templateBegin",""],["templateTextBook",""],[3,"isFullWidth"],["scroll-x","false","scroll-y","false"],[1,"w-100","h-100","d-flex"],[1,"flex-grow-1","d-flex","flex-column"],[1,"min-h-50","d-flex","align-items-center","bg-linear"],[1,"w-240","min-w-240","d-flex","align-items-center","justify-content-center"],[1,"fs-18"],[1,"flex-grow-1","d-flex","align-items-center","justify-content-between","px-3"],[1,"flex-grow-1","d-flex","align-items-center","justify-content-between"],[1,"flex-grow-1","d-flex","tree-topic"],[1,"w-240","min-w-240","h-100"],[1,"component-container"],["lines","none","detail","false"],["slot","start","src","../../../assets/icon-svg/dashboard/topic.svg",1,"mr-3"],[1,"fw-700"],[3,"ngTemplateOutlet"],[1,"flex-grow-1"],[1,"w-480","min-w-480","d-flex","flex-column"],[1,"min-h-50","d-flex","align-items-center","justify-content-end","bg-warning","px-3"],[1,"p-4"],[1,"ion-modal-lg","ion-modal-bottom"],[1,"px-3","py-1"],[1,"fs-14"],[1,"d-flex","align-items-center","line-height-0","mt-1"],["src","../../../assets/favicon/favicon-16x16.png","alt","Tabca-16x16"],[1,"text-muted","ml-1","fs-12"],["id","present-popover-select-textbook",1,"d-flex","align-items-center","justify-content-between","min-w-200","max-w-240","h-32","px-2","text-ellipsis","cursor-pointer","select-textbook"],[1,"fs-14","mr-2","text-ellipsis"],["name","chevron-down-outline",1,"fs-16"],["mode","ios","trigger","present-popover-select-textbook","triggerAction","click"],[1,"ion-padding"],[1,"w-320","max-h-240","row","align-items-start"],[1,"col-12","pb-3"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-100","h-100","d-flex","align-items-center","justify-content-center"],[1,"mw-100","p-3","text-center","text-wrap"],["target","_blank",3,"href"],[1,"w-100","h-100","d-flex","flex-column"],[1,"fs-30","fw-700","text-center","my-3"],[1,"px-4"],[1,"row","align-items-start"],[1,"col-12","col-xxl-6","mb-3"],["mode","ios","size","small","color","linear"],["mode","ios","size","small","color","medium"],["mode","ios","size","small","color","primary",3,"click"],["name","cloud-upload-outline",1,"ml-2"],["mode","ios","size","small","color","linear",3,"click"],["name","sparkles-outline",1,"ml-2"],["mode","ios","size","small","color","medium",3,"click"],["name","eye-outline",1,"ml-2"],["slot","end"],[3,"click"],["name","close-outline",1,"fs-24"],[1,"line-height-0"],["frameborder","0","allowfullscreen","","webkitallowfullscreen","","allowtransparency","true","allow","autoplay; fullscreen",1,"w-100","h-100",3,"load","src"],["lines","none"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngFor","ngForOf"],["button","","detail","false",1,"ion-no-padding",3,"click"],["slot","start","color","medium","fill","clear",3,"click"],["name","caret-forward-outline",4,"ngIf"],["name","caret-down-outline",4,"ngIf"],[3,"title"],["class","fs-12","color","medium",4,"ngIf"],[4,"ngIf"],["name","caret-forward-outline"],["name","caret-down-outline"],["color","medium",1,"fs-12"],[1,"w-100","h-100","d-flex","flex-column","align-items-center","justify-content-center","p-3"],["src","../../../assets/image/ai/knowledge-qa.png",1,"w-200"],[1,"fs-28","fw-500","mt-2","mb-4",2,"color","#311A8C"],["src","../../../assets/image/ai/tabca-bot.png",1,"w-280"],[1,"mw-100","textbook-item","d-inline-block","cursor-pointer",3,"click"],[1,"min-w-200","mw-100","min-h-60","d-flex","align-items-center"],[1,"min-w-60","d-flex","align-items-center","justify-content-center"],[1,"fs-30",3,"src"],[1,"py-2","pr-3","text-ellipsis"],[1,"line-height-24","fs-18","fw-500","text-ellipsis",3,"title"],[1,"line-height-20","fs-14","text-muted"]],template:function(n,e){if(1&n&&(t.nrm(0,"app-header",5),t.j41(1,"ion-content",6)(2,"div",7)(3,"div",8)(4,"div",9)(5,"div",10)(6,"span",11),t.EFF(7,"AI-H\u1ecfi \u0111\xe1p ki\u1ebfn th\u1ee9c"),t.k0s()(),t.j41(8,"div",12)(9,"div",13)(10,"span",11),t.EFF(11),t.k0s(),t.DNE(12,tt,6,1),t.k0s()()(),t.j41(13,"div",14)(14,"div",15)(15,"ion-content",16)(16,"ion-item",17),t.nrm(17,"ion-icon",18),t.j41(18,"ion-label",19),t.EFF(19),t.nI1(20,"translate"),t.k0s()(),t.eu8(21,20),t.k0s()(),t.j41(22,"div",21),t.DNE(23,et,0,0)(24,nt,2,1)(25,lt,9,0)(26,rt,1,1),t.k0s()()(),t.j41(27,"div",22),t.DNE(28,st,8,5,"div",23),t.j41(29,"div",21)(30,"ion-content")(31,"div",24),t.EFF(32,' "\xc2m nh\u1ea1c"'),t.nrm(33,"br"),t.EFF(34,' "C\xf4ng ngh\u1ec7"'),t.nrm(35,"br"),t.EFF(36,' "\u0110\u1ea1o \u0111\u1ee9c"'),t.nrm(37,"br"),t.EFF(38,' "\u0110\u1ecba l\xed"'),t.nrm(39,"br"),t.EFF(40,' "Gi\xe1o d\u1ee5c c\xf4ng d\xe2n"'),t.nrm(41,"br"),t.EFF(42,' "Gi\xe1o d\u1ee5c kinh t\u1ebf v\xe0 ph\xe1p lu\u1eadt"'),t.nrm(43,"br"),t.EFF(44,' "Gi\xe1o d\u1ee5c Qu\u1ed1c ph\xf2ng"'),t.nrm(45,"br"),t.EFF(46,' "Gi\xe1o d\u1ee5c th\u1ec3 ch\u1ea5t"'),t.nrm(47,"br"),t.EFF(48,' "H\xf3a h\u1ecdc"'),t.nrm(49,"br"),t.EFF(50,' "Ho\u1ea1t \u0111\u1ed9ng tr\u1ea3i nghi\u1ec7m"'),t.nrm(51,"br"),t.EFF(52,' "Ho\u1ea1t \u0111\u1ed9ng tr\u1ea3i nghi\u1ec7m h\u01b0\u1edbng nghi\u1ec7p"'),t.nrm(53,"br"),t.EFF(54,' "Khoa ho\u0323c"'),t.nrm(55,"br"),t.EFF(56,' "Khoa h\u1ecdc t\u1ef1 nhi\xean"'),t.nrm(57,"br"),t.EFF(58,' "K\u0129 thu\xe2\u0323t"'),t.nrm(59,"br"),t.EFF(60,' "L\u1ecbch s\u1eed"'),t.nrm(61,"br"),t.EFF(62,' "Li\u0323ch s\u01b0\u0309 va\u0300 \u0110i\u0323a l\xed"'),t.nrm(63,"br"),t.EFF(64,' "M\u0129 thu\u1eadt"'),t.nrm(65,"br"),t.EFF(66,' "Ngh\u1ec7 thu\u1eadt"'),t.nrm(67,"br"),t.EFF(68,' "Ng\u1eef v\u0103n"'),t.nrm(69,"br"),t.EFF(70,' "N\u1ed9i dung gi\xe1o d\u1ee5c c\u1ee7a \u0111\u1ecba ph\u01b0\u01a1ng"'),t.nrm(71,"br"),t.EFF(72,' "Sinh h\u1ecdc"'),t.nrm(73,"br"),t.EFF(74,' "Th\u1ec3 d\u1ee5c"'),t.nrm(75,"br"),t.EFF(76,' "Ti\u1ebfng Anh"'),t.nrm(77,"br"),t.EFF(78,' "Ti\u1ebfng Nh\u1eadt"'),t.nrm(79,"br"),t.EFF(80,' "Ti\u1ebfng Vi\u1ec7t"'),t.nrm(81,"br"),t.EFF(82,' "Tin ho\u0323c"'),t.nrm(83,"br"),t.EFF(84,' "To\xe1n"'),t.nrm(85,"br"),t.EFF(86,' "T\u1ef1 nhi\xean X\xe3 h\u1ed9i"'),t.nrm(87,"br"),t.EFF(88,' "V\u1eadt l\xed"'),t.nrm(89,"br"),t.k0s()()()()(),t.j41(90,"ion-modal",25,0),t.DNE(92,_t,11,2,"ng-template"),t.k0s()(),t.j41(93,"ion-footer")(94,"div",26)(95,"div",27),t.EFF(96,"\xa9 Copyright 2024 by L\u1ea1c Vi\u1ec7t"),t.k0s(),t.j41(97,"div",28),t.nrm(98,"img",29),t.j41(99,"span",30),t.EFF(100),t.k0s()()()(),t.DNE(101,mt,3,1,"ng-template",null,1,t.C5r)(103,xt,9,9,"ng-template",null,2,t.C5r)(105,Ct,5,0,"ng-template",null,3,t.C5r)(107,Tt,9,7,"ng-template",null,4,t.C5r)),2&n){const i=t.sdS(102);t.Y8G("isFullWidth",!0),t.R7$(11),t.JRh(null==e.filter.topic_titles?null:e.filter.topic_titles.join(" / ")),t.R7$(),t.vxM(12,e.textBook&&e.textBooks.length>1?12:-1),t.R7$(7),t.JRh(t.bMT(20,8,"GradeLevel")),t.R7$(2),t.Y8G("ngTemplateOutlet",i),t.R7$(2),t.vxM(23,e.iframeUrl?23:e.textBook?24:e.textBooks.length>1?25:26),t.R7$(5),t.vxM(28,1300==(null==e.user?null:e.user.v_role)?28:-1),t.R7$(72),t.SpI("v",e.envVersion,"")}},dependencies:[C.Sq,C.bT,C.T3,u.In,u.Jm,u.QW,u.W9,u.M0,u.eU,u.iq,u.KW,u.uz,u.he,u.nf,u.BC,u.ai,u.Sb,u.CF,W.l,H.m,v.D9],styles:["[_nghost-%COMP%]{--color-active: #333333;--background-active: #FFDB59}.container-grid[_ngcontent-%COMP%]{display:flex;width:100%;height:100%}.container-grid.grid-row[_ngcontent-%COMP%]{flex-flow:row}.container-grid.grid-column[_ngcontent-%COMP%]{flex-flow:column}.container-grid[_ngcontent-%COMP%]   .grid-grow[_ngcontent-%COMP%]{flex-grow:1}.container-body[_ngcontent-%COMP%]{position:relative;z-index:1}.container-body[_ngcontent-%COMP%]   .container-left[_ngcontent-%COMP%], .container-body[_ngcontent-%COMP%]   .container-right[_ngcontent-%COMP%]{position:relative;z-index:2}.container-body[_ngcontent-%COMP%]   .container-center[_ngcontent-%COMP%]{position:relative;z-index:1;flex:auto}.tree-topic[_ngcontent-%COMP%]{position:relative;border-right:1px solid #ECECEC}.tree-topic[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:block;padding:0;margin:0}.tree-topic[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:block}.tree-topic[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:block;padding-left:1rem}.tree-topic[_ngcontent-%COMP%]   ion-button[slot=start][_ngcontent-%COMP%]{margin-right:2px}.tree-topic[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--inner-padding-end: .5rem;font-size:14px}.tree-topic[_ngcontent-%COMP%]   ion-item.actived[_ngcontent-%COMP%]{--color: var(--color-active, #333);--background: var(--background-active, #E5F4FF)}.tree-topic[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.tree-topic[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{background:transparent;color:#999}.select-textbook[_ngcontent-%COMP%]{border-radius:4px;border:1px solid #444;background-color:#ffffff59;color:#000}.textbook-item[_ngcontent-%COMP%]{border:1px solid var(--ion-color-dark);border-radius:6px}.box-chat[_ngcontent-%COMP%]{position:relative;width:100%;max-width:1080px;height:100%;border-right:1px solid #ECECEC}.box-chat[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-weight:500;font-size:18px}.box-chat[_ngcontent-%COMP%]   .component-header[_ngcontent-%COMP%]{height:3rem}.box-chat[_ngcontent-%COMP%]   .component-header[_ngcontent-%COMP%] + .component-content[_ngcontent-%COMP%]{padding-top:3.5rem}.box-chat[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{display:block;width:100%;height:100%;padding:0;margin:0;border:0;outline:none;background-color:#fff}.main-content[_ngcontent-%COMP%]{position:relative;min-width:240px}.main-content[_ngcontent-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: #f5f5f5}.main-content[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{display:block;width:100%;height:100%;padding:0;margin:0;border:0;outline:none;background-color:#fff}"]}),c})()}];let Pt=(()=>{var o;class c{}return(o=c).\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[r.iI.forChild(Et),r.iI]}),c})();var Ft=p(3890);let Mt=(()=>{var o;class c{}return(o=c).\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[C.MD,F.YN,u.bv,Pt,Ft.x]}),c})()},3753:(N,j,p)=>{p.d(j,{t:()=>G});var C=p(467),F=p(8671),u=p(2635),r=p(4438),f=p(6637),T=p(177),w=p(31);function $(g,h){1&g&&(r.qex(0),r.j41(1,"ion-content")(2,"div",2)(3,"div",3),r.nrm(4,"ion-spinner",4),r.k0s()()(),r.bVm())}function I(g,h){if(1&g){const m=r.RV6();r.qex(0),r.j41(1,"ion-item",9),r.bIt("click",function(){const v=r.eBV(m).$implicit,E=r.XpG(3);return r.Njj(E.filterChange(v.lookup_value))}),r.j41(2,"ion-label"),r.EFF(3),r.k0s()(),r.bVm()}if(2&g){const m=h.$implicit,t=r.XpG(3);r.R7$(),r.BMQ("color",m.lookup_value==t.selectedId?"primary":""),r.R7$(2),r.JRh(m.lookup_title)}}function R(g,h){if(1&g&&(r.j41(0,"ion-list",7),r.DNE(1,I,4,2,"ng-container",8),r.k0s()),2&g){const m=r.XpG(2);r.R7$(),r.Y8G("ngForOf",m.lookups)}}function A(g,h){1&g&&(r.j41(0,"div",3)(1,"i"),r.EFF(2),r.nI1(3,"translate"),r.k0s()()),2&g&&(r.R7$(2),r.JRh(r.bMT(3,1,"DataNotFound")))}function O(g,h){if(1&g){const m=r.RV6();r.qex(0),r.j41(1,"ion-item",9),r.bIt("click",function(){const v=r.eBV(m).$implicit,E=r.XpG(3);return r.Njj(E.filterChange(v.lookup_value))}),r.j41(2,"ion-label",10),r.EFF(3),r.k0s()(),r.bVm()}if(2&g){const m=h.$implicit,t=r.XpG(3);r.R7$(),r.BMQ("color",m.lookup_value==t.selectedId?"primary":""),r.R7$(),r.Y8G("color",m.color),r.R7$(),r.JRh(m.lookup_title)}}function M(g,h){if(1&g&&(r.qex(0),r.nrm(1,"hr"),r.j41(2,"ion-list",7),r.DNE(3,O,4,3,"ng-container",8),r.k0s(),r.bVm()),2&g){const m=r.XpG(2);r.R7$(3),r.Y8G("ngForOf",m.lookups_d2)}}function D(g,h){if(1&g&&(r.qex(0),r.DNE(1,R,2,1,"ion-list",5)(2,A,4,3,"div",6)(3,M,4,1,"ng-container",1),r.bVm()),2&g){const m=r.XpG();r.R7$(),r.Y8G("ngIf",m.lookups.length),r.R7$(),r.Y8G("ngIf",!m.lookups.length),r.R7$(),r.Y8G("ngIf",m.lookups_d2.length)}}let G=(()=>{var g;class h{constructor(t){this.popoverController=t,this.selectedId=0,this.lookup_key="",this.lookups_d2=[],this.dataInit={loading:!0},this.lookups=[]}ngOnInit(){var t=this;(0,C.A)(function*(){t.user=yield(0,u.Nk)(),t.loadLookup()})()}loadLookup(){var t;(0,F.$)({loading:v=>{this.dataInit.loading=v},params:{userid:null===(t=this.user)||void 0===t?void 0:t.userid,lookup_key:this.lookup_key},callback:v=>{this.lookups=v||[]}})}filterChange(t){var v;this.popoverController.dismiss(null!==(v=this.lookups.find(E=>E.lookup_value==t))&&void 0!==v?v:this.lookups_d2.find(E=>E.lookup_value==t),"confirm")}}return(g=h).\u0275fac=function(t){return new(t||g)(r.rXU(f.IE))},g.\u0275cmp=r.VBU({type:g,selectors:[["app-popover-lookup"]],inputs:{selectedId:"selectedId",lookup_key:"lookup_key",lookups_d2:"lookups_d2"},decls:3,vars:2,consts:[[1,"menu-lookup","overflow-auto"],[4,"ngIf"],[1,"d-flex","w-100","h-100","align-items-center","justify-content-center"],[1,"px-3","py-1"],["name","dots","color","dark",1,"align-middle"],["lines","full",4,"ngIf"],["class","px-3 py-1",4,"ngIf"],["lines","full"],[4,"ngFor","ngForOf"],["button","","detail","false",3,"click"],[3,"color"]],template:function(t,v){1&t&&(r.j41(0,"div",0),r.DNE(1,$,5,0,"ng-container",1)(2,D,4,3,"ng-container",1),r.k0s()),2&t&&(r.R7$(),r.Y8G("ngIf",v.dataInit.loading),r.R7$(),r.Y8G("ngIf",!v.dataInit.loading))},dependencies:[T.Sq,T.bT,f.W9,f.uz,f.he,f.nf,f.w2,w.D9],styles:[".menu-lookup[_ngcontent-%COMP%]{width:240px;max-height:480px;border-top:3px solid #5F6CE1}hr[_ngcontent-%COMP%]{margin:0}"]}),h})()}}]);