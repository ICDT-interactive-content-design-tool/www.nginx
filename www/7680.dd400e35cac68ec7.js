"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7680],{3377:(It,it,w)=>{w.d(it,{Kr:()=>A,LE:()=>X,iA:()=>T,lL:()=>H});var O=w(5861),o=w(2014),Q=w(4459);const Y=new o.K({name:"_userDB",driverOrder:[o.N.IndexedDB,o.N.LocalStorage]}),T=function(){var L=(0,O.Z)(function*(m){yield Y.create();try{var P=(yield Y.get("user-local"))||{};return"function"==typeof(null==m?void 0:m.callback)&&m.callback(Object.assign({},P||{})),P}catch(R){"function"==typeof(null==m?void 0:m.callback)&&m.callback(),console.error(R)}return{}});return function(P){return L.apply(this,arguments)}}(),A=function(){var L=(0,O.Z)(function*(m){yield Y.create(),m.params=m.params||{};try{var P=Object.assign({},m.params);yield Y.set("user-local",P),"function"==typeof m.callback&&m.callback(Object.assign({},P||{}))}catch(R){"function"==typeof m.callback&&m.callback(),console.error(R)}});return function(P){return L.apply(this,arguments)}}(),H=function(){var L=(0,O.Z)(function*(m){return m&&(m.params={}),A(null!=m?m:{})});return function(P){return L.apply(this,arguments)}}(),X=function(){var L=(0,O.Z)(function*(m,P){let R=yield(0,Q.H0)();if(P){let j=[];m.params.profilephoto&&j.push(new Promise((N,q)=>{let K=new Image;K.onload=()=>{m.params.url_profilephoto=K.src,N(1)},K.onerror=()=>{m.params.url_profilephoto="assets/image/user-avatar-default.png",N(0)},K.src=R.readfileuploadurl+m.params.profilephoto})),m.params.banner&&j.push(new Promise((N,q)=>{let K=new Image;K.onload=()=>{m.params.url_banner=K.src,N(1)},K.onerror=()=>{m.params.url_banner="assets/image/user-banner-default.png",N(0)},K.src=R.readfileuploadurl+m.params.banner})),j.length>0?Promise.all(j).then(()=>{A(m)}):A(m)}else T({callback:j=>{if(j){let N=[];m.params.profilephoto&&N.push(new Promise((q,K)=>{let z=new Image;z.onload=()=>{m.params.url_profilephoto=z.src,q(1)},z.onerror=()=>{m.params.url_profilephoto="assets/image/user-avatar-default.png",q(0)},z.src=R.readfileuploadurl+m.params.profilephoto})),m.params.banner&&N.push(new Promise((q,K)=>{let z=new Image;z.onload=()=>{m.params.url_banner=z.src,q(1)},z.onerror=()=>{m.params.url_banner="assets/image/user-banner-default.png",q(0)},z.src=R.readfileuploadurl+m.params.banner})),N.length>0?Promise.all(N).then(()=>{A({params:Object.assign({},j,m.params),callback:m.callback})}):A({params:Object.assign({},j,m.params),callback:m.callback})}else"function"==typeof m.callback&&m.callback()}})});return function(P,R){return L.apply(this,arguments)}}()},9074:(It,it,w)=>{w.d(it,{V:()=>tt});var O=w(6814),o=w(6223),Q=w(1773),Y=w(5470),T=w(2630),A=w(9515),H=w(953),X=w(2948);let tt=(()=>{var et;class L{}return(et=L).\u0275fac=function(P){return new(P||et)},et.\u0275mod=X.oAB({type:et}),et.\u0275inj=X.cJS({imports:[O.ez,o.u5,Q.Pc,Y.Z,T.L,A.d,H.ap,Y.Z,T.L]}),L})()},8186:(It,it,w)=>{w.d(it,{B:()=>o});var O=w(5861);const o=function(){var Q=(0,O.Z)(function*(Y,T,A){var H,X,tt;A&&(T.message||(T.message=null!==(tt=null==A?void 0:A.returnmsg)&&void 0!==tt?tt:0==(null==A?void 0:A.returncode)?"Th\xe0nh c\xf4ng!":null!=A&&A.returncode?`L\u1ed7i: #${null==A?void 0:A.returncode}`:"H\u1ec7 th\u1ed1ng kh\xf4ng c\xf3 ph\u1ea3n h\u1ed3i!"),T.icon||(T.icon=0==(null==A?void 0:A.returncode)?"checkmark-circle-sharp":null!=A&&A.returncode?"alert-circle-outline":"close-circle-sharp"),T.color||(T.color=0==(null==A?void 0:A.returncode)?"success":null!=A&&A.returncode?"warning":"danger"));return T.position||(T.position="bottom"),T.icon||(T.icon="bulb-outline"),T.color||(T.color="secondary"),T.duration=null!==(H=T.duration)&&void 0!==H?H:3e3,T.animated=null===(X=T.animated)||void 0===X||X,T.buttons=[{icon:"close-outline",side:"end",role:"cancel"}],yield Y.create(T)});return function(T,A,H){return Q.apply(this,arguments)}}()},9515:(It,it,w)=>{w.d(it,{u:()=>Ps,d:()=>Ws});var O=w(5861),o=w(2948);function H(t,e=new Set){const i=[t],s=new Set;let d=0;for(;i.length>d;){const g=i[d++];if(!s.has(g)&&X(g)&&!e.has(g))if(s.add(g),Symbol.iterator in g)try{for(const _ of g)i.push(_)}catch{}else for(const _ in g)"defaultValue"!==_&&i.push(g[_])}return s}function X(t){const e=Object.prototype.toString.call(t),i=typeof t;return!("number"===i||"boolean"===i||"string"===i||"symbol"===i||"function"===i||"[object Date]"===e||"[object RegExp]"===e||"[object Module]"===e||null==t||t._watchdogExcluded||t instanceof EventTarget||t instanceof Event)}Symbol("MainQueueId");class m{constructor(e){if(this.crashes=[],this.state="initializing",this._now=Date.now,this.crashes=[],this._crashNumberLimit="number"==typeof e.crashNumberLimit?e.crashNumberLimit:3,this._minimumNonErrorTimePeriod="number"==typeof e.minimumNonErrorTimePeriod?e.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=i=>{const s="error"in i?i.error:i.reason;s instanceof Error&&this._handleError(s,i)},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.")}destroy(){this._stopErrorHandling(),this._listeners={}}on(e,i){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(i)}off(e,i){this._listeners[e]=this._listeners[e].filter(s=>s!==i)}_fire(e,...i){const s=this._listeners[e]||[];for(const d of s)d.apply(this,[null,...i])}_startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler)}_stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler)}_handleError(e,i){if(this._shouldReactToError(e)){this.crashes.push({message:e.message,stack:e.stack,filename:i instanceof ErrorEvent?i.filename:void 0,lineno:i instanceof ErrorEvent?i.lineno:void 0,colno:i instanceof ErrorEvent?i.colno:void 0,date:this._now()});const s=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:e,causesRestart:s}),s?this._restart():(this.state="crashedPermanently",this._fire("stateChange"))}}_shouldReactToError(e){return e.is&&e.is("CKEditorError")&&null!=e.context&&"ready"===this.state&&this._isErrorComingFromThisItem(e)}_shouldRestart(){return this.crashes.length<=this._crashNumberLimit||(this.crashes[this.crashes.length-1].date-this.crashes[this.crashes.length-1-this._crashNumberLimit].date)/this._crashNumberLimit>this._minimumNonErrorTimePeriod}}const R=function P(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},N="object"==typeof global&&global&&global.Object===Object&&global;var q="object"==typeof self&&self&&self.Object===Object&&self;const z=N||q||Function("return this")(),vt=function(){return z.Date.now()};var Kt=/\s/;var Zt=/^\s+/;const Yt=function Vt(t){return t&&t.slice(0,function Gt(t){for(var e=t.length;e--&&Kt.test(t.charAt(e)););return e}(t)+1).replace(Zt,"")},ht=z.Symbol;var p=Object.prototype,y=p.hasOwnProperty,u=p.toString,r=ht?ht.toStringTag:void 0;var c=Object.prototype.toString;var E=ht?ht.toStringTag:void 0;const D=function U(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":E&&E in Object(t)?function n(t){var e=y.call(t,r),i=t[r];try{t[r]=void 0;var s=!0}catch{}var d=u.call(t);return s&&(e?t[r]=i:delete t[r]),d}(t):function l(t){return c.call(t)}(t)},G=function Z(t){return null!=t&&"object"==typeof t};var Rt=/^[-+]0x[0-9a-f]+$/i,jt=/^0b[01]+$/i,zt=/^0o[0-7]+$/i,Dt=parseInt;const Pt=function Jt(t){if("number"==typeof t)return t;if(function B(t){return"symbol"==typeof t||G(t)&&"[object Symbol]"==D(t)}(t))return NaN;if(R(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=R(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Yt(t);var i=jt.test(t);return i||zt.test(t)?Dt(t.slice(2),i?2:8):Rt.test(t)?NaN:+t};var Mt=Math.max,gt=Math.min;const Wt=function pt(t,e,i){var s=!0,d=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return R(i)&&(s="leading"in i?!!i.leading:s,d="trailing"in i?!!i.trailing:d),function Bt(t,e,i){var s,d,g,_,f,v,b=0,F=!1,V=!1,st=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function bt(W){var ct=s,St=d;return s=d=void 0,b=W,_=t.apply(St,ct)}function $(W){var ct=W-v;return void 0===v||ct>=e||ct<0||V&&W-b>=g}function J(){var W=vt();if($(W))return cr(W);f=setTimeout(J,function Nt(W){var hr=e-(W-v);return V?gt(hr,g-(W-b)):hr}(W))}function cr(W){return f=void 0,st&&s?bt(W):(s=d=void 0,_)}function me(){var W=vt(),ct=$(W);if(s=arguments,d=this,v=W,ct){if(void 0===f)return function fe(W){return b=W,f=setTimeout(J,e),F?bt(W):_}(v);if(V)return clearTimeout(f),f=setTimeout(J,e),bt(v)}return void 0===f&&(f=setTimeout(J,e)),_}return e=Pt(e)||0,R(i)&&(F=!!i.leading,g=(V="maxWait"in i)?Mt(Pt(i.maxWait)||0,e):g,st="trailing"in i?!!i.trailing:st),me.cancel=function Us(){void 0!==f&&clearTimeout(f),b=0,s=v=d=f=void 0},me.flush=function Fs(){return void 0===f?_:cr(vt())},me}(t,e,{leading:s,maxWait:e,trailing:d})},at=function ot(t,e){return function(i){return t(e(i))}},te=at(Object.getPrototypeOf,Object);var ye=Function.prototype.toString,pr=Object.prototype.hasOwnProperty,_r=ye.call(Object);const xe=function yr(t){return G(t)&&1===t.nodeType&&!function fr(t){if(!G(t)||"[object Object]"!=D(t))return!1;var e=te(t);if(null===e)return!0;var i=pr.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&ye.call(i)==_r}(t)},be=function vr(t,e){return t===e||t!=t&&e!=e},Ut=function Cr(t,e){for(var i=t.length;i--;)if(be(t[i][0],e))return i;return-1};var Mr=Array.prototype.splice;function _t(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var s=t[e];this.set(s[0],s[1])}}_t.prototype.clear=function xr(){this.__data__=[],this.size=0},_t.prototype.delete=function wr(t){var e=this.__data__,i=Ut(e,t);return!(i<0||(i==e.length-1?e.pop():Mr.call(e,i,1),--this.size,0))},_t.prototype.get=function Er(t){var e=this.__data__,i=Ut(e,t);return i<0?void 0:e[i][1]},_t.prototype.has=function Ir(t){return Ut(this.__data__,t)>-1},_t.prototype.set=function Rr(t,e){var i=this.__data__,s=Ut(i,t);return s<0?(++this.size,i.push([t,e])):i[s][1]=e,this};const Ft=_t,ve=function Gr(t){if(!R(t))return!1;var e=D(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e};var t,Qr=z["__core-js_shared__"],Ce=(t=/[^.]+$/.exec(Qr&&Qr.keys&&Qr.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"";var Xr=Function.prototype.toString;const lt=function Jr(t){if(null!=t){try{return Xr.call(t)}catch{}try{return t+""}catch{}}return""};var $r=/^\[object .+?Constructor\]$/,ni=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const oi=function ai(t){return!(!R(t)||function Zr(t){return!!Ce&&Ce in t}(t))&&(ve(t)?ni:$r).test(lt(t))},dt=function hi(t,e){var i=function si(t,e){return null==t?void 0:t[e]}(t,e);return oi(i)?i:void 0},wt=dt(z,"Map"),Tt=dt(Object,"create");var yi=Object.prototype.hasOwnProperty;var Ci=Object.prototype.hasOwnProperty;function ft(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var s=t[e];this.set(s[0],s[1])}}ft.prototype.clear=function ui(){this.__data__=Tt?Tt(null):{},this.size=0},ft.prototype.delete=function pi(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},ft.prototype.get=function xi(t){var e=this.__data__;if(Tt){var i=e[t];return"__lodash_hash_undefined__"===i?void 0:i}return yi.call(e,t)?e[t]:void 0},ft.prototype.has=function Ai(t){var e=this.__data__;return Tt?void 0!==e[t]:Ci.call(e,t)},ft.prototype.set=function Ti(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=Tt&&void 0===e?"__lodash_hash_undefined__":e,this};const Ae=ft,Ht=function ji(t,e){var i=t.__data__;return function Oi(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?i["string"==typeof e?"string":"hash"]:i.map};function mt(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var s=t[e];this.set(s[0],s[1])}}mt.prototype.clear=function Si(){this.size=0,this.__data__={hash:new Ae,map:new(wt||Ft),string:new Ae}},mt.prototype.delete=function zi(t){var e=Ht(this,t).delete(t);return this.size-=e?1:0,e},mt.prototype.get=function Pi(t){return Ht(this,t).get(t)},mt.prototype.has=function Wi(t){return Ht(this,t).has(t)},mt.prototype.set=function Fi(t,e){var i=Ht(this,t),s=i.size;return i.set(t,e),this.size+=i.size==s?0:1,this};const Li=mt;function yt(t){var e=this.__data__=new Ft(t);this.size=e.size}yt.prototype.clear=function zr(){this.__data__=new Ft,this.size=0},yt.prototype.delete=function Pr(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i},yt.prototype.get=function Wr(t){return this.__data__.get(t)},yt.prototype.has=function Fr(t){return this.__data__.has(t)},yt.prototype.set=function Ni(t,e){var i=this.__data__;if(i instanceof Ft){var s=i.__data__;if(!wt||s.length<199)return s.push([t,e]),this.size=++i.size,this;i=this.__data__=new Li(s)}return i.set(t,e),this.size=i.size,this};const Gi=yt;var Vi=function(){try{var t=dt(Object,"defineProperty");return t({},"",{}),t}catch{}}();const Me=Vi,we=function Yi(t,e,i){"__proto__"==e&&Me?Me(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i};var Ji=Object.prototype.hasOwnProperty;const Te=function qi(t,e,i){var s=t[e];(!Ji.call(t,e)||!be(s,i)||void 0===i&&!(e in t))&&we(t,e,i)},Lt=function $i(t,e,i,s){var d=!i;i||(i={});for(var g=-1,_=e.length;++g<_;){var f=e[g],v=s?s(i[f],t[f],f,i,t):void 0;void 0===v&&(v=t[f]),d?we(i,f,v):Te(i,f,v)}return i},Ee=function nn(t){return G(t)&&"[object Arguments]"==D(t)};var Se=Object.prototype,an=Se.hasOwnProperty,on=Se.propertyIsEnumerable,sn=Ee(function(){return arguments}())?Ee:function(t){return G(t)&&an.call(t,"callee")&&!on.call(t,"callee")};const cn=sn,re=Array.isArray;var Ie="object"==typeof exports&&exports&&!exports.nodeType&&exports,Oe=Ie&&"object"==typeof module&&module&&!module.nodeType&&module,Re=Oe&&Oe.exports===Ie?z.Buffer:void 0;const je=(Re?Re.isBuffer:void 0)||function ln(){return!1};var fn=/^(?:0|[1-9]\d*)$/;const yn=function mn(t,e){var i=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==i||"symbol"!=i&&fn.test(t))&&t>-1&&t%1==0&&t<e},ze=function bn(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var I={};I["[object Float32Array]"]=I["[object Float64Array]"]=I["[object Int8Array]"]=I["[object Int16Array]"]=I["[object Int32Array]"]=I["[object Uint8Array]"]=I["[object Uint8ClampedArray]"]=I["[object Uint16Array]"]=I["[object Uint32Array]"]=!0,I["[object Arguments]"]=I["[object Array]"]=I["[object ArrayBuffer]"]=I["[object Boolean]"]=I["[object DataView]"]=I["[object Date]"]=I["[object Error]"]=I["[object Function]"]=I["[object Map]"]=I["[object Number]"]=I["[object Object]"]=I["[object RegExp]"]=I["[object Set]"]=I["[object String]"]=I["[object WeakMap]"]=!1;const ie=function Zn(t){return function(e){return t(e)}};var De="object"==typeof exports&&exports&&!exports.nodeType&&exports,Et=De&&"object"==typeof module&&module&&!module.nodeType&&module,ne=Et&&Et.exports===De&&N.process;const xt=function(){try{return Et&&Et.require&&Et.require("util").types||ne&&ne.binding&&ne.binding("util")}catch{}}();var Pe=xt&&xt.isTypedArray;const Jn=Pe?ie(Pe):function Gn(t){return G(t)&&ze(t.length)&&!!I[D(t)]};var $n=Object.prototype.hasOwnProperty;const Be=function ta(t,e){var i=re(t),s=!i&&cn(t),d=!i&&!s&&je(t),g=!i&&!s&&!d&&Jn(t),_=i||s||d||g,f=_?function tn(t,e){for(var i=-1,s=Array(t);++i<t;)s[i]=e(i);return s}(t.length,String):[],v=f.length;for(var b in t)(e||$n.call(t,b))&&(!_||!("length"==b||d&&("offset"==b||"parent"==b)||g&&("buffer"==b||"byteLength"==b||"byteOffset"==b)||yn(b,v)))&&f.push(b);return f};var ea=Object.prototype;const ae=function ra(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||ea)},na=at(Object.keys,Object);var oa=Object.prototype.hasOwnProperty;const We=function ha(t){return null!=t&&ze(t.length)&&!ve(t)},oe=function la(t){return We(t)?Be(t):function sa(t){if(!ae(t))return na(t);var e=[];for(var i in Object(t))oa.call(t,i)&&"constructor"!=i&&e.push(i);return e}(t)};var fa=Object.prototype.hasOwnProperty;const ya=function ma(t){if(!R(t))return function ga(t){var e=[];if(null!=t)for(var i in Object(t))e.push(i);return e}(t);var e=ae(t),i=[];for(var s in t)"constructor"==s&&(e||!fa.call(t,s))||i.push(s);return i},se=function xa(t){return We(t)?Be(t,!0):ya(t)};var Ue="object"==typeof exports&&exports&&!exports.nodeType&&exports,Fe=Ue&&"object"==typeof module&&module&&!module.nodeType&&module,He=Fe&&Fe.exports===Ue?z.Buffer:void 0,Le=He?He.allocUnsafe:void 0;const ke=function Ia(){return[]};var Ra=Object.prototype.propertyIsEnumerable,Ne=Object.getOwnPropertySymbols,ja=Ne?function(t){return null==t?[]:(t=Object(t),function Ea(t,e){for(var i=-1,s=null==t?0:t.length,d=0,g=[];++i<s;){var _=t[i];e(_,i,t)&&(g[d++]=_)}return g}(Ne(t),function(e){return Ra.call(t,e)}))}:ke;const ce=ja,Ke=function Pa(t,e){for(var i=-1,s=e.length,d=t.length;++i<s;)t[d+i]=e[i];return t};var Wa=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Ke(e,ce(t)),t=te(t);return e}:ke;const Ge=Wa,Qe=function Ha(t,e,i){var s=e(t);return re(t)?s:Ke(s,i(t))},ka=function La(t){return Qe(t,oe,ce)},Ka=function Na(t){return Qe(t,se,Ge)},he=dt(z,"DataView"),le=dt(z,"Promise"),de=dt(z,"Set"),ue=dt(z,"WeakMap");var Ze="[object Map]",Ve="[object Promise]",Ye="[object Set]",Xe="[object WeakMap]",Je="[object DataView]",Xa=lt(he),Ja=lt(wt),qa=lt(le),$a=lt(de),to=lt(ue),ut=D;(he&&ut(new he(new ArrayBuffer(1)))!=Je||wt&&ut(new wt)!=Ze||le&&ut(le.resolve())!=Ve||de&&ut(new de)!=Ye||ue&&ut(new ue)!=Xe)&&(ut=function(t){var e=D(t),i="[object Object]"==e?t.constructor:void 0,s=i?lt(i):"";if(s)switch(s){case Xa:return Je;case Ja:return Ze;case qa:return Ve;case $a:return Ye;case to:return Xe}return e});const ge=ut;var ro=Object.prototype.hasOwnProperty;const qe=z.Uint8Array,pe=function oo(t){var e=new t.constructor(t.byteLength);return new qe(e).set(new qe(t)),e};var ho=/\w*$/;var $e=ht?ht.prototype:void 0,tr=$e?$e.valueOf:void 0;const Wo=function Bo(t,e,i){var s=t.constructor;switch(e){case"[object ArrayBuffer]":return pe(t);case"[object Boolean]":case"[object Date]":return new s(+t);case"[object DataView]":return function so(t,e){var i=e?pe(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}(t,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function _o(t,e){var i=e?pe(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}(t,i);case"[object Map]":case"[object Set]":return new s;case"[object Number]":case"[object String]":return new s(t);case"[object RegExp]":return function lo(t){var e=new t.constructor(t.source,ho.exec(t));return e.lastIndex=t.lastIndex,e}(t);case"[object Symbol]":return function go(t){return tr?Object(tr.call(t)):{}}(t)}};var er=Object.create,Uo=function(){function t(){}return function(e){if(!R(e))return{};if(er)return er(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}();const Fo=Uo;var rr=xt&&xt.isMap;const Qo=rr?ie(rr):function No(t){return G(t)&&"[object Map]"==ge(t)};var ir=xt&&xt.isSet;const Jo=ir?ie(ir):function Vo(t){return G(t)&&"[object Set]"==ge(t)};var nr="[object Arguments]",ar="[object Function]",or="[object Object]",S={};S[nr]=S["[object Array]"]=S["[object ArrayBuffer]"]=S["[object DataView]"]=S["[object Boolean]"]=S["[object Date]"]=S["[object Float32Array]"]=S["[object Float64Array]"]=S["[object Int8Array]"]=S["[object Int16Array]"]=S["[object Int32Array]"]=S["[object Map]"]=S["[object Number]"]=S[or]=S["[object RegExp]"]=S["[object Set]"]=S["[object String]"]=S["[object Symbol]"]=S["[object Uint8Array]"]=S["[object Uint8ClampedArray]"]=S["[object Uint16Array]"]=S["[object Uint32Array]"]=!0,S["[object Error]"]=S[ar]=S["[object WeakMap]"]=!1;const Ms=function kt(t,e,i,s,d,g){var _,f=1&e,v=2&e,b=4&e;if(i&&(_=d?i(t,s,d,g):i(t)),void 0!==_)return _;if(!R(t))return t;var F=re(t);if(F){if(_=function io(t){var e=t.length,i=new t.constructor(e);return e&&"string"==typeof t[0]&&ro.call(t,"index")&&(i.index=t.index,i.input=t.input),i}(t),!f)return function wa(t,e){var i=-1,s=t.length;for(e||(e=Array(s));++i<s;)e[i]=t[i];return e}(t,_)}else{var V=ge(t),st=V==ar||"[object GeneratorFunction]"==V;if(je(t))return function Aa(t,e){if(e)return t.slice();var i=t.length,s=Le?Le(i):new t.constructor(i);return t.copy(s),s}(t,f);if(V==or||V==nr||st&&!d){if(_=v||st?{}:function Ho(t){return"function"!=typeof t.constructor||ae(t)?{}:Fo(te(t))}(t),!f)return v?function Ua(t,e){return Lt(t,Ge(t),e)}(t,function ba(t,e){return t&&Lt(e,se(e),t)}(_,t)):function za(t,e){return Lt(t,ce(t),e)}(t,function da(t,e){return t&&Lt(e,oe(e),t)}(_,t))}else{if(!S[V])return d?t:{};_=Wo(t,V,f)}}g||(g=new Gi);var bt=g.get(t);if(bt)return bt;g.set(t,_),Jo(t)?t.forEach(function($){_.add(kt($,e,i,$,t,g))}):Qo(t)&&t.forEach(function($,J){_.set(J,kt($,e,i,J,t,g))});var Nt=F?void 0:(b?v?Ka:ka:v?se:oe)(t);return function Qi(t,e){for(var i=-1,s=null==t?0:t.length;++i<s&&!1!==e(t[i],i,t););}(Nt||t,function($,J){Nt&&($=t[J=$]),Te(_,J,kt($,e,i,J,t,g))}),_};class Is extends m{constructor(e,i={}){super(i),this._editor=null,this._lifecyclePromise=null,this._initUsingData=!0,this._editables={},this._throttledSave=Wt(this._save.bind(this),"number"==typeof i.saveInterval?i.saveInterval:5e3),e&&(this._creator=(s,d)=>e.create(s,d)),this._destructor=s=>s.destroy()}get editor(){return this._editor}get _item(){return this._editor}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}_restart(){return Promise.resolve().then(()=>(this.state="initializing",this._fire("stateChange"),this._destroy())).catch(e=>{console.error("An error happened during the editor destroying.",e)}).then(()=>{const e={},i=[],s=this._config.rootsAttributes||{},d={};for(const[_,f]of Object.entries(this._data.roots))f.isLoaded?(e[_]="",d[_]=s[_]||{}):i.push(_);const g={...this._config,extraPlugins:this._config.extraPlugins||[],lazyRoots:i,rootsAttributes:d,_watchdogInitialData:this._data};return delete g.initialData,g.extraPlugins.push(Os),this._initUsingData?this.create(e,g,g.context):xe(this._elementOrData)?this.create(this._elementOrData,g,g.context):this.create(this._editables,g,g.context)}).then(()=>{this._fire("restart")})}create(e=this._elementOrData,i=this._config,s){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(super._startErrorHandling(),this._elementOrData=e,this._initUsingData="string"==typeof e||Object.keys(e).length>0&&"string"==typeof Object.values(e)[0],this._config=this._cloneEditorConfiguration(i)||{},this._config.context=s,this._creator(e,this._config))).then(d=>{this._editor=d,d.model.document.on("change:data",this._throttledSave),this._lastDocumentVersion=d.model.document.version,this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this.state="ready",this._fire("stateChange")}).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}destroy(){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy())).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling(),this._throttledSave.cancel();const e=this._editor;return this._editor=null,e.model.document.off("change:data",this._throttledSave),this._destructor(e)})}_save(){const e=this._editor.model.document.version;try{this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this._lastDocumentVersion=e}catch(i){console.error(i,"An error happened during restoring editor data. Editor will be restored from the previously saved data.")}}_setExcludedProperties(e){this._excludedProps=e}_getData(){const e=this._editor,i=e.model.document.roots.filter(f=>f.isAttached()&&"$graveyard"!=f.rootName),{plugins:s}=e,d=s.has("CommentsRepository")&&s.get("CommentsRepository"),g=s.has("TrackChanges")&&s.get("TrackChanges"),_={roots:{},markers:{},commentThreads:JSON.stringify([]),suggestions:JSON.stringify([])};i.forEach(f=>{_.roots[f.rootName]={content:JSON.stringify(Array.from(f.getChildren())),attributes:JSON.stringify(Array.from(f.getAttributes())),isLoaded:f._isLoaded}});for(const f of e.model.markers)f._affectsData&&(_.markers[f.name]={rangeJSON:f.getRange().toJSON(),usingOperation:f._managedUsingOperations,affectsData:f._affectsData});return d&&(_.commentThreads=JSON.stringify(d.getCommentThreads({toJSON:!0,skipNotAttached:!0}))),g&&(_.suggestions=JSON.stringify(g.getSuggestions({toJSON:!0,skipNotAttached:!0}))),_}_getEditables(){const e={};for(const i of this.editor.model.document.getRootNames()){const s=this.editor.ui.getEditableElement(i);s&&(e[i]=s)}return e}_isErrorComingFromThisItem(e){return function tt(t,e,i=new Set){if(t===e&&function L(t){return"object"==typeof t&&null!==t}(t))return!0;const s=H(t,i),d=H(e,i);for(const g of s)if(d.has(g))return!0;return!1}(this._editor,e.context,this._excludedProps)}_cloneEditorConfiguration(e){return function Es(t,e){return Ms(t,5,e="function"==typeof e?e:void 0)}(e,(i,s)=>{if(xe(i)||"context"===s)return i})}}class Os{constructor(e){this.editor=e,this._data=e.config.get("_watchdogInitialData")}init(){this.editor.data.on("init",e=>{e.stop(),this.editor.model.enqueueChange({isUndoable:!1},i=>{this._restoreCollaborationData(),this._restoreEditorData(i)}),this.editor.data.fire("ready")},{priority:999})}_createNode(e,i){if("name"in i){const s=e.createElement(i.name,i.attributes);if(i.children)for(const d of i.children)s._appendChild(this._createNode(e,d));return s}return e.createText(i.data,i.attributes)}_restoreEditorData(e){const i=this.editor;Object.entries(this._data.roots).forEach(([s,{content:d,attributes:g}])=>{const _=JSON.parse(d),f=JSON.parse(g),v=i.model.document.getRoot(s);for(const[b,F]of f)e.setAttribute(b,F,v);for(const b of _){const F=this._createNode(e,b);e.insert(F,v,"end")}}),Object.entries(this._data.markers).forEach(([s,d])=>{const{document:g}=i.model,{rangeJSON:{start:_,end:f},...v}=d,b=g.getRoot(_.root),F=e.createPositionFromPath(b,_.path,_.stickiness),V=e.createPositionFromPath(b,f.path,f.stickiness),st=e.createRange(F,V);e.addMarker(s,{range:st,...v})})}_restoreCollaborationData(){const e=JSON.parse(this._data.commentThreads),i=JSON.parse(this._data.suggestions);e.forEach(s=>{const d=this.editor.config.get("collaboration.channelId"),g=this.editor.plugins.get("CommentsRepository");g.hasCommentThread(s.threadId)&&g.getCommentThread(s.threadId).remove(),g.addCommentThread({channelId:d,...s})}),i.forEach(s=>{const d=this.editor.plugins.get("TrackChangesEditing");d.hasSuggestion(s.id)?d.getSuggestion(s.id).attributes=s.attributes:d.addSuggestionData(s)})}}var Rs=w(8419),sr=w(6223),js=w(6814);function zs(t,e){}const k=new Array(256).fill(0).map((t,e)=>("0"+e.toString(16)).slice(-2)),_e="Lock from Angular integration (@ckeditor/ckeditor5-angular)";let Ps=(()=>{class t{constructor(i,s){this.config={},this.data="",this.tagName="div",this.disableTwoWayDataBinding=!1,this.ready=new o.vpe,this.change=new o.vpe,this.blur=new o.vpe,this.focus=new o.vpe,this.error=new o.vpe,this.initiallyDisabled=!1,this.isEditorSettingData=!1,this.id=function Ds(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0,s=4294967296*Math.random()>>>0;return"e"+k[t>>0&255]+k[t>>8&255]+k[t>>16&255]+k[t>>24&255]+k[e>>0&255]+k[e>>8&255]+k[e>>16&255]+k[e>>24&255]+k[i>>0&255]+k[i>>8&255]+k[i>>16&255]+k[i>>24&255]+k[s>>0&255]+k[s>>8&255]+k[s>>16&255]+k[s>>24&255]}(),this.ngZone=s,this.elementRef=i;const{CKEDITOR_VERSION:d}=window;if(d){const[g]=d.split(".").map(Number);g<37&&console.warn("The <CKEditor> component requires using CKEditor 5 in version 37 or higher.")}else console.warn('Cannot find the "CKEDITOR_VERSION" in the "window" scope.')}set disabled(i){this.setDisabledState(i)}get disabled(){return this.editorInstance?this.editorInstance.isReadOnly:this.initiallyDisabled}get editorInstance(){let i=this.editorWatchdog;return this.watchdog&&(i=this.watchdog._watchdogs.get(this.id)),i?i.editor:null}getId(){return this.id}ngOnChanges(i){Object.prototype.hasOwnProperty.call(i,"data")&&i.data&&!i.data.isFirstChange()&&this.writeValue(i.data.currentValue)}ngAfterViewInit(){this.attachToWatchdog()}ngOnDestroy(){var i=this;return(0,O.Z)(function*(){i.watchdog?yield i.watchdog.remove(i.id):i.editorWatchdog&&i.editorWatchdog.editor&&(yield i.editorWatchdog.destroy(),i.editorWatchdog=void 0)})()}writeValue(i){null===i&&(i=""),this.editorInstance?(this.isEditorSettingData=!0,this.editorInstance.data.set(i),this.isEditorSettingData=!1):(this.data=i,this.ready.pipe((0,Rs.P)()).subscribe(s=>{s.data.set(this.data)}))}registerOnChange(i){this.cvaOnChange=i}registerOnTouched(i){this.cvaOnTouched=i}setDisabledState(i){this.editorInstance&&(i?this.editorInstance.enableReadOnlyMode(_e):this.editorInstance.disableReadOnlyMode(_e)),this.initiallyDisabled=i}attachToWatchdog(){var i=this;const s=(v,b)=>this.ngZone.runOutsideAngular((0,O.Z)(function*(){i.elementRef.nativeElement.appendChild(v);const F=yield i.editor.create(v,b);return i.initiallyDisabled&&F.enableReadOnlyMode(_e),i.ngZone.run(()=>{i.ready.emit(F)}),i.setUpEditorEvents(F),F})),d=function(){var v=(0,O.Z)(function*(b){yield b.destroy(),i.elementRef.nativeElement.removeChild(i.editorElement)});return function(F){return v.apply(this,arguments)}}(),g=v=>{(function Bs(t){return t.observed||t.observers.length>0})(this.error)&&this.ngZone.run(()=>this.error.emit(v))},_=document.createElement(this.tagName),f=this.getConfig();if(this.editorElement=_,this.watchdog)this.watchdog.add({id:this.id,type:"editor",creator:s,destructor:d,sourceElementOrData:_,config:f}).catch(v=>{g(v)}),this.watchdog.on("itemError",(v,{itemId:b})=>{b===this.id&&g()});else{const v=new Is(this.editor,this.editorWatchdogConfig);v.setCreator(s),v.setDestructor(d),v.on("error",g),this.editorWatchdog=v,this.ngZone.runOutsideAngular(()=>{v.create(_,f).catch(b=>{g(b)})})}}getConfig(){if(this.data&&this.config.initialData)throw new Error("Editor data should be provided either using `config.initialData` or `data` properties.");const i={...this.config},s=this.config.initialData||this.data;return s&&(i.initialData=s),i}setUpEditorEvents(i){const d=i.editing.view.document;i.model.document.on("change:data",g=>{this.ngZone.run(()=>{if(!this.disableTwoWayDataBinding){if(this.cvaOnChange&&!this.isEditorSettingData){const _=i.data.get();this.cvaOnChange(_)}this.change.emit({event:g,editor:i})}})}),d.on("focus",g=>{this.ngZone.run(()=>{this.focus.emit({event:g,editor:i})})}),d.on("blur",g=>{this.ngZone.run(()=>{this.cvaOnTouched&&this.cvaOnTouched(),this.blur.emit({event:g,editor:i})})})}}return t.\u0275fac=function(i){return new(i||t)(o.Y36(o.SBq),o.Y36(o.R0b))},t.\u0275cmp=o.Xpm({type:t,selectors:[["ckeditor"]],inputs:{editor:"editor",config:"config",data:"data",tagName:"tagName",watchdog:"watchdog",editorWatchdogConfig:"editorWatchdogConfig",disableTwoWayDataBinding:"disableTwoWayDataBinding",disabled:"disabled"},outputs:{ready:"ready",change:"change",blur:"blur",focus:"focus",error:"error"},features:[o._Bn([{provide:sr.JU,useExisting:(0,o.Gpc)(()=>t),multi:!0}]),o.TTD],decls:1,vars:0,template:function(i,s){1&i&&o.YNc(0,zs,0,0,"ng-template")},encapsulation:2}),t})(),Ws=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[sr.u5,js.ez]]}),t})()},953:(It,it,w)=>{w.d(it,{ap:()=>Xt});var O=w(5861),o=w(2948),Q=w(6593),Y=w(9352),T=w(8419),A=w(7354),H=w(9016),X=w(6814);const tt=["wrapper"],et=["sourceImage"];function L(p,y){if(1&p){const u=o.EpF();o.TgZ(0,"img",4,5),o.NdJ("load",function(){o.CHM(u);const n=o.oxw();return o.KtG(n.imageLoadedInView())})("mousedown",function(n){o.CHM(u);const a=o.oxw();return o.KtG(a.startMove(n,a.moveTypes.Drag))})("touchstart",function(n){o.CHM(u);const a=o.oxw();return o.KtG(a.startMove(n,a.moveTypes.Drag))})("error",function(n){o.CHM(u);const a=o.oxw();return o.KtG(a.loadImageError(n))}),o.qZA()}if(2&p){const u=o.oxw();o.Udp("visibility",u.imageVisible?"visible":"hidden")("transform",u.safeTransformStyle),o.ekj("ngx-ic-draggable",!u.disabled&&u.allowMoveImage),o.Q6J("src",u.safeImgDataUrl,o.LSH),o.uIk("alt",u.imageAltText)}}function m(p,y){if(1&p){const u=o.EpF();o.ynx(0),o.TgZ(1,"span",9),o.NdJ("mousedown",function(n){o.CHM(u);const a=o.oxw(2);return o.KtG(a.startMove(n,a.moveTypes.Resize,"topleft"))})("touchstart",function(n){o.CHM(u);const a=o.oxw(2);return o.KtG(a.startMove(n,a.moveTypes.Resize,"topleft"))}),o._UZ(2,"span",10),o.qZA(),o.TgZ(3,"span",11),o._UZ(4,"span",10),o.qZA(),o.TgZ(5,"span",12),o.NdJ("mousedown",function(n){o.CHM(u);const a=o.oxw(2);return o.KtG(a.startMove(n,a.moveTypes.Resize,"topright"))})("touchstart",function(n){o.CHM(u);const a=o.oxw(2);return o.KtG(a.startMove(n,a.moveTypes.Resize,"topright"))}),o._UZ(6,"span",10),o.qZA(),o.TgZ(7,"span",13),o._UZ(8,"span",10),o.qZA(),o.TgZ(9,"span",14),o.NdJ("mousedown",function(n){o.CHM(u);const a=o.oxw(2);return o.KtG(a.startMove(n,a.moveTypes.Resize,"bottomright"))})("touchstart",function(n){o.CHM(u);const a=o.oxw(2);return o.KtG(a.startMove(n,a.moveTypes.Resize,"bottomright"))}),o._UZ(10,"span",10),o.qZA(),o.TgZ(11,"span",15),o._UZ(12,"span",10),o.qZA(),o.TgZ(13,"span",16),o.NdJ("mousedown",function(n){o.CHM(u);const a=o.oxw(2);return o.KtG(a.startMove(n,a.moveTypes.Resize,"bottomleft"))})("touchstart",function(n){o.CHM(u);const a=o.oxw(2);return o.KtG(a.startMove(n,a.moveTypes.Resize,"bottomleft"))}),o._UZ(14,"span",10),o.qZA(),o.TgZ(15,"span",17),o._UZ(16,"span",10),o.qZA(),o.TgZ(17,"span",18),o.NdJ("mousedown",function(n){o.CHM(u);const a=o.oxw(2);return o.KtG(a.startMove(n,a.moveTypes.Resize,"top"))})("touchstart",function(n){o.CHM(u);const a=o.oxw(2);return o.KtG(a.startMove(n,a.moveTypes.Resize,"top"))}),o.qZA(),o.TgZ(18,"span",19),o.NdJ("mousedown",function(n){o.CHM(u);const a=o.oxw(2);return o.KtG(a.startMove(n,a.moveTypes.Resize,"right"))})("touchstart",function(n){o.CHM(u);const a=o.oxw(2);return o.KtG(a.startMove(n,a.moveTypes.Resize,"right"))}),o.qZA(),o.TgZ(19,"span",20),o.NdJ("mousedown",function(n){o.CHM(u);const a=o.oxw(2);return o.KtG(a.startMove(n,a.moveTypes.Resize,"bottom"))})("touchstart",function(n){o.CHM(u);const a=o.oxw(2);return o.KtG(a.startMove(n,a.moveTypes.Resize,"bottom"))}),o.qZA(),o.TgZ(20,"span",21),o.NdJ("mousedown",function(n){o.CHM(u);const a=o.oxw(2);return o.KtG(a.startMove(n,a.moveTypes.Resize,"left"))})("touchstart",function(n){o.CHM(u);const a=o.oxw(2);return o.KtG(a.startMove(n,a.moveTypes.Resize,"left"))}),o.qZA(),o.BQk()}}function P(p,y){if(1&p){const u=o.EpF();o.TgZ(0,"div",6),o.NdJ("keydown",function(n){o.CHM(u);const a=o.oxw();return o.KtG(a.keyboardAccess(n))}),o.TgZ(1,"div",7),o.NdJ("mousedown",function(n){o.CHM(u);const a=o.oxw();return o.KtG(a.startMove(n,a.moveTypes.Move))})("touchstart",function(n){o.CHM(u);const a=o.oxw();return o.KtG(a.startMove(n,a.moveTypes.Move))}),o.qZA(),o.YNc(2,m,21,0,"ng-container",8),o.qZA()}if(2&p){const u=o.oxw();o.Udp("top",u.cropper.y1,"px")("left",u.cropper.x1,"px")("width",u.cropper.x2-u.cropper.x1,"px")("height",u.cropper.y2-u.cropper.y1,"px")("margin-left","center"===u.alignImage?u.marginLeft:null)("visibility",u.imageVisible?"visible":"hidden"),o.ekj("ngx-ic-round",u.roundCropper),o.uIk("aria-label",u.cropperFrameAriaLabel),o.xp6(2),o.Q6J("ngIf",!u.hideResizeSquares)}}class R{constructor(){this.format="png",this.output="blob",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperFrameAriaLabel="Crop photo",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(y){Object.keys(y).filter(u=>u in this).forEach(u=>this[u]=y[u]),this.validateOptions()}setOptionsFromChanges(y){Object.keys(y).filter(u=>u in this).forEach(u=>this[u]=y[u].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}var j=function(p){return p.Drag="drag",p.Move="move",p.Resize="resize",p.Pinch="pinch",p}(j||{});function Ot(p,y){return p/100*y}let vt=(()=>{var p;class y{crop(r,n,a,h,c){const l=this.getImagePosition(r,n,a,c),x=l.x2-l.x1,M=l.y2-l.y1,C=document.createElement("canvas");C.width=x,C.height=M;const E=C.getContext("2d");if(!E)return null;null!=a.backgroundColor&&(E.fillStyle=a.backgroundColor,E.fillRect(0,0,x,M));const U=(a.transform.scale||1)*(a.transform.flipH?-1:1),D=(a.transform.scale||1)*(a.transform.flipV?-1:1),{translateH:Z,translateV:G}=this.getCanvasTranslate(r,a,c),nt=r.transformed;E.setTransform(U,0,0,D,nt.size.width/2+Z,nt.size.height/2+G),E.translate(-l.x1/U,-l.y1/D),E.rotate((a.transform.rotate||0)*Math.PI/180),E.drawImage(nt.image,-nt.size.width/2,-nt.size.height/2);const B={width:x,height:M,imagePosition:l,cropperPosition:{...n}};a.containWithinAspectRatio&&(B.offsetImagePosition=this.getOffsetImagePosition(r,n,a,c));const rt=this.getResizeRatio(x,M,a);return 1!==rt&&(B.width=Math.round(x*rt),B.height=a.maintainAspectRatio?Math.round(B.width/a.aspectRatio):Math.round(M*rt),function z(p,y,u){const r=p.width,n=p.height,a=r/(y=Math.round(y)),h=n/(u=Math.round(u)),c=Math.ceil(a/2),l=Math.ceil(h/2),x=p.getContext("2d");if(x){const M=x.getImageData(0,0,r,n),C=x.createImageData(y,u),E=M.data,U=C.data;for(let D=0;D<u;D++)for(let Z=0;Z<y;Z++){const G=4*(Z+D*y),nt=D*h;let B=0,rt=0,Ct=0,Rt=0,jt=0,zt=0,Dt=0;const Jt=Math.floor(Z*a),Pt=Math.floor(D*h);let At=Math.ceil((Z+1)*a),Mt=Math.ceil((D+1)*h);At=Math.min(At,r),Mt=Math.min(Mt,n);for(let gt=Pt;gt<Mt;gt++){const Bt=Math.abs(nt-gt)/l,qt=Z*a,$t=Bt*Bt;for(let pt=Jt;pt<At;pt++){const Wt=Math.abs(qt-pt)/c,ot=Math.sqrt($t+Wt*Wt);if(ot>=1)continue;B=2*ot*ot*ot-3*ot*ot+1;const at=4*(pt+gt*r);Dt+=B*E[at+3],Ct+=B,E[at+3]<255&&(B=B*E[at+3]/250),Rt+=B*E[at],jt+=B*E[at+1],zt+=B*E[at+2],rt+=B}}U[G]=Rt/rt,U[G+1]=jt/rt,U[G+2]=zt/rt,U[G+3]=Dt/Ct}p.width=y,p.height=u,x.putImageData(C,0,0)}}(C,B.width,B.height)),"blob"===h?this.cropToBlob(B,C,a):(B.base64=C.toDataURL("image/"+a.format,this.getQuality(a)),B)}cropToBlob(r,n,a){var h=this;return(0,O.Z)(function*(){return r.blob=yield new Promise(c=>n.toBlob(c,"image/"+a.format,h.getQuality(a))),r.blob&&(r.objectUrl=URL.createObjectURL(r.blob)),r})()}getCanvasTranslate(r,n,a){if("px"===n.transform.translateUnit){const h=this.getRatio(r,a);return{translateH:(n.transform.translateH||0)*h,translateV:(n.transform.translateV||0)*h}}return{translateH:n.transform.translateH?Ot(n.transform.translateH,r.transformed.size.width):0,translateV:n.transform.translateV?Ot(n.transform.translateV,r.transformed.size.height):0}}getRatio(r,n){return r.transformed.size.width/n.width}getImagePosition(r,n,a,h){const c=this.getRatio(r,h),l={x1:Math.round(n.x1*c),y1:Math.round(n.y1*c),x2:Math.round(n.x2*c),y2:Math.round(n.y2*c)};return a.containWithinAspectRatio||(l.x1=Math.max(l.x1,0),l.y1=Math.max(l.y1,0),l.x2=Math.min(l.x2,r.transformed.size.width),l.y2=Math.min(l.y2,r.transformed.size.height)),l}getOffsetImagePosition(r,n,a,h){const c=a.canvasRotation+r.exifTransform.rotate,l=this.getRatio(r,h);let x,M;c%2?(x=(r.transformed.size.width-r.original.size.height)/2,M=(r.transformed.size.height-r.original.size.width)/2):(x=(r.transformed.size.width-r.original.size.width)/2,M=(r.transformed.size.height-r.original.size.height)/2);const C={x1:Math.round(n.x1*l)-x,y1:Math.round(n.y1*l)-M,x2:Math.round(n.x2*l)-x,y2:Math.round(n.y2*l)-M};return a.containWithinAspectRatio||(C.x1=Math.max(C.x1,0),C.y1=Math.max(C.y1,0),C.x2=Math.min(C.x2,r.transformed.size.width),C.y2=Math.min(C.y2,r.transformed.size.height)),C}getResizeRatio(r,n,a){const h=a.resizeToWidth/r,c=a.resizeToHeight/n,l=new Array;a.resizeToWidth>0&&l.push(h),a.resizeToHeight>0&&l.push(c);const x=0===l.length?1:Math.min(...l);return x>1&&!a.onlyScaleDown?x:Math.min(x,1)}getQuality(r){return Math.min(1,Math.max(0,r.imageQuality/100))}}return(p=y).\u0275fac=function(r){return new(r||p)},p.\u0275prov=o.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),y})(),Kt=(()=>{var p;class y{resetCropperPosition(r,n,a,h){if(null!=r&&r.nativeElement)if(a.cropperStaticHeight&&a.cropperStaticWidth)n.x1=0,n.x2=h.width>a.cropperStaticWidth?a.cropperStaticWidth:h.width,n.y1=0,n.y2=h.height>a.cropperStaticHeight?a.cropperStaticHeight:h.height;else{const c=Math.min(a.cropperScaledMaxWidth,h.width),l=Math.min(a.cropperScaledMaxHeight,h.height);if(a.maintainAspectRatio)if(h.width/a.aspectRatio<h.height){n.x1=0,n.x2=c;const x=c/a.aspectRatio;n.y1=(h.height-x)/2,n.y2=n.y1+x}else{n.y1=0,n.y2=l;const x=l*a.aspectRatio;n.x1=(h.width-x)/2,n.x2=n.x1+x}else n.x1=0,n.x2=c,n.y1=0,n.y2=l}}move(r,n,a){const h=this.getClientX(r)-n.clientX,c=this.getClientY(r)-n.clientY;a.x1=n.x1+h,a.y1=n.y1+c,a.x2=n.x2+h,a.y2=n.y2+c}resize(r,n,a,h,c){const l=this.getClientX(r)-n.clientX,x=this.getClientY(r)-n.clientY;switch(n.position){case"left":a.x1=Math.min(Math.max(n.x1+l,a.x2-c.cropperScaledMaxWidth),a.x2-c.cropperScaledMinWidth);break;case"topleft":a.x1=Math.min(Math.max(n.x1+l,a.x2-c.cropperScaledMaxWidth),a.x2-c.cropperScaledMinWidth),a.y1=Math.min(Math.max(n.y1+x,a.y2-c.cropperScaledMaxHeight),a.y2-c.cropperScaledMinHeight);break;case"top":a.y1=Math.min(Math.max(n.y1+x,a.y2-c.cropperScaledMaxHeight),a.y2-c.cropperScaledMinHeight);break;case"topright":a.x2=Math.max(Math.min(n.x2+l,a.x1+c.cropperScaledMaxWidth),a.x1+c.cropperScaledMinWidth),a.y1=Math.min(Math.max(n.y1+x,a.y2-c.cropperScaledMaxHeight),a.y2-c.cropperScaledMinHeight);break;case"right":a.x2=Math.max(Math.min(n.x2+l,a.x1+c.cropperScaledMaxWidth),a.x1+c.cropperScaledMinWidth);break;case"bottomright":a.x2=Math.max(Math.min(n.x2+l,a.x1+c.cropperScaledMaxWidth),a.x1+c.cropperScaledMinWidth),a.y2=Math.max(Math.min(n.y2+x,a.y1+c.cropperScaledMaxHeight),a.y1+c.cropperScaledMinHeight);break;case"bottom":a.y2=Math.max(Math.min(n.y2+x,a.y1+c.cropperScaledMaxHeight),a.y1+c.cropperScaledMinHeight);break;case"bottomleft":a.x1=Math.min(Math.max(n.x1+l,a.x2-c.cropperScaledMaxWidth),a.x2-c.cropperScaledMinWidth),a.y2=Math.max(Math.min(n.y2+x,a.y1+c.cropperScaledMaxHeight),a.y1+c.cropperScaledMinHeight);break;case"center":const M=r.scale,C=Math.min(Math.max(c.cropperScaledMinWidth,Math.abs(n.x2-n.x1)*M),c.cropperScaledMaxWidth),E=Math.min(Math.max(c.cropperScaledMinHeight,Math.abs(n.y2-n.y1)*M),c.cropperScaledMaxHeight);a.x1=n.clientX-C/2,a.x2=n.clientX+C/2,a.y1=n.clientY-E/2,a.y2=n.clientY+E/2,a.x1<0?(a.x2-=a.x1,a.x1=0):a.x2>h.width&&(a.x1-=a.x2-h.width,a.x2=h.width),a.y1<0?(a.y2-=a.y1,a.y1=0):a.y2>h.height&&(a.y1-=a.y2-h.height,a.y2=h.height)}c.maintainAspectRatio&&this.checkAspectRatio(n.position,a,h,c)}checkAspectRatio(r,n,a,h){let c=0,l=0;switch(r){case"top":n.x2=n.x1+(n.y2-n.y1)*h.aspectRatio,c=Math.max(n.x2-a.width,0),l=Math.max(0-n.y1,0),(c>0||l>0)&&(n.x2-=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y1+=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"bottom":n.x2=n.x1+(n.y2-n.y1)*h.aspectRatio,c=Math.max(n.x2-a.width,0),l=Math.max(n.y2-a.height,0),(c>0||l>0)&&(n.x2-=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y2-=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"topleft":n.y1=n.y2-(n.x2-n.x1)/h.aspectRatio,c=Math.max(0-n.x1,0),l=Math.max(0-n.y1,0),(c>0||l>0)&&(n.x1+=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y1+=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"topright":n.y1=n.y2-(n.x2-n.x1)/h.aspectRatio,c=Math.max(n.x2-a.width,0),l=Math.max(0-n.y1,0),(c>0||l>0)&&(n.x2-=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y1+=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"right":case"bottomright":n.y2=n.y1+(n.x2-n.x1)/h.aspectRatio,c=Math.max(n.x2-a.width,0),l=Math.max(n.y2-a.height,0),(c>0||l>0)&&(n.x2-=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y2-=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"left":case"bottomleft":n.y2=n.y1+(n.x2-n.x1)/h.aspectRatio,c=Math.max(0-n.x1,0),l=Math.max(n.y2-a.height,0),(c>0||l>0)&&(n.x1+=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y2-=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"center":n.x2=n.x1+(n.y2-n.y1)*h.aspectRatio,n.y2=n.y1+(n.x2-n.x1)/h.aspectRatio;const x=Math.max(0-n.x1,0),M=Math.max(n.x2-a.width,0),C=Math.max(n.y2-a.height,0),E=Math.max(0-n.y1,0);(x>0||M>0||C>0||E>0)&&(n.x1+=C*h.aspectRatio>x?C*h.aspectRatio:x,n.x2-=E*h.aspectRatio>M?E*h.aspectRatio:M,n.y1+=E*h.aspectRatio>M?E:M/h.aspectRatio,n.y2-=C*h.aspectRatio>x?C:x/h.aspectRatio)}}getClientX(r){return"touches"in r&&r.touches[0]?r.touches[0].clientX:"clientX"in r?r.clientX:0}getClientY(r){return"touches"in r&&r.touches[0]?r.touches[0].clientY:"clientX"in r?r.clientY:0}}return(p=y).\u0275fac=function(r){return new(r||p)},p.\u0275prov=o.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),y})();let Yt=(()=>{var p;class y{constructor(){this.autoRotateSupported=function Qt(){return new Promise(p=>{const y=new Image;y.onload=()=>{p(1===y.width&&2===y.height)},y.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(r,n){var a=this;return(0,O.Z)(function*(){const h=yield r.arrayBuffer();return yield a.checkImageTypeAndLoadImageFromArrayBuffer(h,r.type,n)})()}checkImageTypeAndLoadImageFromArrayBuffer(r,n,a){return this.isValidImageType(n)?this.loadImageFromArrayBuffer(r,a,n):Promise.reject(new Error("Invalid image type"))}isValidImageType(r){return/image\/(png|jpg|jpeg|bmp|gif|tiff|svg|webp|x-icon|vnd.microsoft.icon)/.test(r)}loadImageFromURL(r,n){var a=this;return(0,O.Z)(function*(){const c=yield(yield fetch(r)).blob(),l=yield c.arrayBuffer();return yield a.loadImageFromArrayBuffer(l,n,c.type)})()}loadBase64Image(r,n){const a=this.base64ToArrayBuffer(r);return this.loadImageFromArrayBuffer(a,n)}base64ToArrayBuffer(r){r=r.replace(/^data:([^;]+);base64,/gim,"");const n=atob(r),a=n.length,h=new Uint8Array(a);for(let c=0;c<a;c++)h[c]=n.charCodeAt(c);return h.buffer}loadImageFromArrayBuffer(r,n,a){var h=this;return(0,O.Z)(function*(){const c=yield new Promise(function(){var l=(0,O.Z)(function*(x,M){try{const C=new Blob([r],a?{type:a}:void 0),E=URL.createObjectURL(C),U=new Image,Z="image/svg+xml"===a?yield h.getSvgImageSize(C):void 0;U.onload=()=>x({originalImage:U,originalImageSize:Z,originalObjectUrl:E,originalArrayBuffer:r}),U.onerror=M,U.src=E}catch(C){M(C)}});return function(x,M){return l.apply(this,arguments)}}());return yield h.transformImageFromArrayBuffer(c,n,null!=c.originalImageSize)})()}getSvgImageSize(r){return(0,O.Z)(function*(){const h=(new DOMParser).parseFromString(yield r.text(),"image/svg+xml").querySelector("svg");if(!h)throw Error("Failed to parse SVG image");const c=h.getAttribute("width"),l=h.getAttribute("height");if(c&&l)return null;const x=h.getAttribute("viewBox")||h.getAttribute("viewbox");if(x){const M=x.split(" ");return{width:+M[2],height:+M[3]}}throw Error("Failed to load SVG image. SVG must have width + height or viewBox definition.")})()}transformImageFromArrayBuffer(r,n,a=!1){var h=this;return(0,O.Z)(function*(){var c;const x=function Zt(p){switch("object"==typeof p&&(p=function Vt(p){const y=new DataView(p);if(65496!==y.getUint16(0,!1))return-2;const u=y.byteLength;let r=2;for(;r<u;){if(y.getUint16(r+2,!1)<=8)return-1;const n=y.getUint16(r,!1);if(r+=2,65505==n){if(1165519206!==y.getUint32(r+=2,!1))return-1;const a=18761==y.getUint16(r+=6,!1);r+=y.getUint32(r+4,a);const h=y.getUint16(r,a);r+=2;for(let c=0;c<h;c++)if(274==y.getUint16(r+12*c,a))return y.getUint16(r+12*c+8,a)}else{if(65280!=(65280&n))break;r+=y.getUint16(r,!1)}}return-1}(p)),p){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}((yield h.autoRotateSupported)?-1:r.originalArrayBuffer);if(!r.originalImage||!r.originalImage.complete)return Promise.reject(new Error("No image loaded"));const M={original:{objectUrl:r.originalObjectUrl,image:r.originalImage,size:null!==(c=r.originalImageSize)&&void 0!==c?c:{width:r.originalImage.naturalWidth,height:r.originalImage.naturalHeight}},exifTransform:x};return h.transformLoadedImage(M,n,a)})()}transformLoadedImage(r,n,a=!1){var h=this;return(0,O.Z)(function*(){const c=n.canvasRotation+r.exifTransform.rotate,l=r.original.size;if(!a&&0===c&&!r.exifTransform.flip&&!n.containWithinAspectRatio)return{original:{objectUrl:r.original.objectUrl,image:r.original.image,size:{...l}},transformed:{objectUrl:r.original.objectUrl,image:r.original.image,size:{...l}},exifTransform:r.exifTransform};const x=h.getTransformedSize(l,r.exifTransform,n),M=document.createElement("canvas");M.width=x.width,M.height=x.height;const C=M.getContext("2d");null==C||C.setTransform(r.exifTransform.flip?-1:1,0,0,1,M.width/2,M.height/2),null==C||C.rotate(Math.PI*(c/2)),null==C||C.drawImage(r.original.image,-l.width/2,-l.height/2);const E=yield new Promise(Z=>M.toBlob(Z,n.format));if(!E)throw new Error("Failed to get Blob for transformed image.");const U=URL.createObjectURL(E),D=yield h.loadImageFromObjectUrl(U);return{original:{objectUrl:r.original.objectUrl,image:r.original.image,size:{...l}},transformed:{objectUrl:U,image:D,size:{width:D.width,height:D.height}},exifTransform:r.exifTransform}})()}loadImageFromObjectUrl(r){return new Promise((n,a)=>{const h=new Image;h.onload=()=>n(h),h.onerror=a,h.src=r})}getTransformedSize(r,n,a){const h=a.canvasRotation+n.rotate;if(a.containWithinAspectRatio){if(h%2){const l=r.height/a.aspectRatio;return{width:Math.max(r.height,r.width*a.aspectRatio),height:Math.max(r.width,l)}}{const l=r.width/a.aspectRatio;return{width:Math.max(r.width,r.height*a.aspectRatio),height:Math.max(r.height,l)}}}return h%2?{height:r.width,width:r.height}:{width:r.width,height:r.height}}}return(p=y).\u0275fac=function(r){return new(r||p)},p.\u0275prov=o.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),y})(),Xt=(()=>{var p;class y{constructor(r,n,a,h,c,l,x){this.cropService=r,this.cropperPositionService=n,this.loadImageService=a,this.sanitizer=h,this.cd=c,this.zone=l,this.hammerLoader=x,this.settings=new R,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.marginLeft="0px",this.maxSize={width:0,height:0},this.moveTypes=j,this.imageVisible=!1,this.cropperFrameAriaLabel=this.settings.cropperFrameAriaLabel,this.output=this.settings.output,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resetCropOnAspectRatioChange=this.settings.resetCropOnAspectRatioChange,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.allowMoveImage=!1,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.hidden=!1,this.imageCropped=new o.vpe,this.startCropImage=new o.vpe,this.imageLoaded=new o.vpe,this.cropperReady=new o.vpe,this.loadImageFailed=new o.vpe,this.transformChange=new o.vpe,this.reset()}ngOnChanges(r){var n;this.onChangesUpdateSettings(r),this.onChangesInputImage(r),null!==(n=this.loadedImage)&&void 0!==n&&n.original.image.complete&&(r.containWithinAspectRatio||r.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(a=>this.setLoadedImage(a)).catch(a=>this.loadImageError(a)),(r.cropper||r.maintainAspectRatio||r.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),!this.maintainAspectRatio||!this.resetCropOnAspectRatioChange&&this.aspectRatioIsCorrect()||!r.maintainAspectRatio&&!r.aspectRatio?r.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()):this.resetCropperPosition()),r.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop()),r.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesUpdateSettings(r){this.settings.setOptionsFromChanges(r),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&(this.hideResizeSquares=!0,this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1}))}onChangesInputImage(r){(r.imageChangedEvent||r.imageURL||r.imageBase64||r.imageFile)&&this.reset(),r.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),r.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),r.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),r.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){var r;const n=null===(r=this.imageChangedEvent)||void 0===r||null===(r=r.target)||void 0===r?void 0:r.files;return n instanceof FileList&&n.length>0}setCssTransform(){var r;const n=(null===(r=this.transform)||void 0===r?void 0:r.translateUnit)||"%";this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle(`translate(${this.transform.translateH||0}${n}, ${this.transform.translateV||0}${n}) scaleX(`+(this.transform.scale||1)*(this.transform.flipH?-1:1)+") scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+") rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=void 0,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(r){this.loadImageService.loadImageFile(r,this.settings).then(n=>this.setLoadedImage(n)).catch(n=>this.loadImageError(n))}loadBase64Image(r){this.loadImageService.loadBase64Image(r,this.settings).then(n=>this.setLoadedImage(n)).catch(n=>this.loadImageError(n))}loadImageFromURL(r){this.loadImageService.loadImageFromURL(r,this.settings).then(n=>this.setLoadedImage(n)).catch(n=>this.loadImageError(n))}setLoadedImage(r){this.loadedImage=r,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(r.transformed.objectUrl),this.cd.markForCheck()}loadImageError(r){console.error(r),this.loadImageFailed.emit()}imageLoadedInView(){null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit({...this.maxSize}),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){var r;return(null===(r=this.sourceImage)||void 0===r||null===(r=r.nativeElement)||void 0===r?void 0:r.offsetWidth)>0}onResize(){if(this.loadedImage)if(this.hidden)this.resizedWhileHidden=!0;else{const r={...this.maxSize};this.setMaxSize(),this.resizeCropperPosition(r),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()}}activatePinchGesture(){var r=this;return(0,O.Z)(function*(){var n,a;yield null===(n=r.hammerLoader)||void 0===n?void 0:n.call(r);const h=(null===(a=window)||void 0===a?void 0:a.Hammer)||null;if(h){const c=new h(r.wrapper.nativeElement);c.get("pinch").set({enable:!0}),c.on("pinchmove",r.onPinch.bind(r)),c.on("pinchend",r.pinchStop.bind(r)),c.on("pinchstart",r.startPinch.bind(r))}else(0,o.X6Q)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")})()}resizeCropperPosition(r){(r.width!==this.maxSize.width||r.height!==this.maxSize.height)&&(this.cropper.x1=this.cropper.x1*this.maxSize.width/r.width,this.cropper.x2=this.cropper.x2*this.maxSize.width/r.width,this.cropper.y1=this.cropper.y1*this.maxSize.height/r.height,this.cropper.y2=this.cropper.y2*this.maxSize.height/r.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings,this.maxSize),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(r){this.changeKeyboardStepSize(r),this.keyboardMoveCropper(r)}changeKeyboardStepSize(r){const n=+r.key;n>=1&&n<=9&&(this.settings.stepSize=n)}keyboardMoveCropper(r){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(r.key))return;const a=r.shiftKey?j.Resize:j.Move,h=r.altKey?function q(p){switch(p){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";default:return"right"}}(r.key):function N(p){switch(p){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";default:return"left"}}(r.key),c=function K(p,y){switch(p){case"ArrowUp":return{clientX:0,clientY:-1*y};case"ArrowRight":return{clientX:y,clientY:0};case"ArrowDown":return{clientX:0,clientY:y};default:return{clientX:-1*y,clientY:0}}}(r.key,this.settings.stepSize);r.preventDefault(),r.stopPropagation(),this.startMove({clientX:0,clientY:0},a,h),this.handleMouseMove(c),this.handleMouseUp()}startMove(r,n,a=null){var h,c;this.disabled||null!==(h=this.moveStart)&&void 0!==h&&h.active&&(null===(c=this.moveStart)||void 0===c?void 0:c.type)===j.Pinch||n===j.Drag&&!this.allowMoveImage||("preventDefault"in r&&r.preventDefault(),this.moveStart={active:!0,type:n,position:a,transform:{...this.transform},clientX:this.cropperPositionService.getClientX(r),clientY:this.cropperPositionService.getClientY(r),...this.cropper},this.initMouseMove())}initMouseMove(){(0,A.T)((0,H.R)(document,"mousemove"),(0,H.R)(document,"touchmove")).pipe((0,Y.R)((0,A.T)((0,H.R)(document,"mouseup"),(0,H.R)(document,"touchend")).pipe((0,T.P)()))).subscribe({next:r=>this.zone.run(()=>{this.handleMouseMove(r),this.cd.markForCheck()}),complete:()=>this.zone.run(()=>{this.handleMouseUp(),this.cd.markForCheck()})})}startPinch(r){this.safeImgDataUrl&&(r.preventDefault&&r.preventDefault(),this.moveStart={active:!0,type:j.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2,...this.cropper})}handleMouseMove(r){if(this.moveStart.active)if("stopPropagation"in r&&r.stopPropagation(),"preventDefault"in r&&r.preventDefault(),this.moveStart.type===j.Move)this.cropperPositionService.move(r,this.moveStart,this.cropper),this.checkCropperPosition(!0);else if(this.moveStart.type===j.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(r,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1);else if(this.moveStart.type===j.Drag){var n,a;const h=this.cropperPositionService.getClientX(r)-this.moveStart.clientX,c=this.cropperPositionService.getClientY(r)-this.moveStart.clientY;this.transform={...this.transform,translateH:((null===(n=this.moveStart.transform)||void 0===n?void 0:n.translateH)||0)+h,translateV:((null===(a=this.moveStart.transform)||void 0===a?void 0:a.translateV)||0)+c},this.setCssTransform()}}onPinch(r){this.moveStart.active&&(r.stopPropagation&&r.stopPropagation(),r.preventDefault&&r.preventDefault(),this.moveStart.type===j.Pinch&&(this.cropperPositionService.resize(r,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.markForCheck())}setMaxSize(){if(this.sourceImage){const r=getComputedStyle(this.sourceImage.nativeElement);this.maxSize.width=parseFloat(r.width),this.maxSize.height=parseFloat(r.height),this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){var r;null!==(r=this.loadedImage)&&void 0!==r&&null!==(r=r.transformed)&&void 0!==r&&r.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}setCropperScaledMaxSize(){var r;if(null!==(r=this.loadedImage)&&void 0!==r&&null!==(r=r.transformed)&&void 0!==r&&r.image){const n=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/n:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/n:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(r=!1){this.cropper.x1<0&&(this.cropper.x2-=r?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=r?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=r?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=r?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}handleMouseUp(){var r;this.moveStart.active&&(this.moveStart.active=!1,(null===(r=this.moveStart)||void 0===r?void 0:r.type)===j.Drag?this.transformChange.emit(this.transform):this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(r=this.settings.output){var n;if(null!=(null===(n=this.loadedImage)||void 0===n||null===(n=n.transformed)||void 0===n?void 0:n.image)){if(this.startCropImage.emit(),"blob"===r)return this.cropToBlob();if("base64"===r)return this.cropToBase64()}return null}cropToBlob(){var r=this;return new Promise((n,a)=>this.zone.run((0,O.Z)(function*(){const h=yield r.cropService.crop(r.loadedImage,r.cropper,r.settings,"blob",r.maxSize);h?(r.imageCropped.emit(h),n(h)):a("Crop image failed")})))}cropToBase64(){const r=this.cropService.crop(this.loadedImage,this.cropper,this.settings,"base64",this.maxSize);return r?(this.imageCropped.emit(r),r):null}aspectRatioIsCorrect(){return(this.cropper.x2-this.cropper.x1)/(this.cropper.y2-this.cropper.y1)===this.aspectRatio}}return(p=y).\u0275fac=function(r){return new(r||p)(o.Y36(vt),o.Y36(Kt),o.Y36(Yt),o.Y36(Q.H7),o.Y36(o.sBO),o.Y36(o.R0b),o.Y36(Q.vm,8))},p.\u0275cmp=o.Xpm({type:p,selectors:[["image-cropper"]],viewQuery:function(r,n){if(1&r&&(o.Gf(tt,7),o.Gf(et,5)),2&r){let a;o.iGM(a=o.CRH())&&(n.wrapper=a.first),o.iGM(a=o.CRH())&&(n.sourceImage=a.first)}},hostVars:6,hostBindings:function(r,n){1&r&&o.NdJ("resize",function(){return n.onResize()},!1,o.Jf7),2&r&&(o.Udp("text-align",n.alignImage),o.ekj("disabled",n.disabled)("ngx-ix-hidden",n.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",cropperFrameAriaLabel:"cropperFrameAriaLabel",output:"output",format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange"},standalone:!0,features:[o.TTD,o.jDz],decls:5,vars:10,consts:[["wrapper",""],["class","ngx-ic-source-image","role","presentation",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart","error",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],["role","presentation",1,"ngx-ic-source-image",3,"src","load","mousedown","touchstart","error"],["sourceImage",""],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],["role","presentation",1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(r,n){1&r&&(o.TgZ(0,"div",null,0),o.YNc(2,L,2,8,"img",1),o._UZ(3,"div",2),o.YNc(4,P,3,16,"div",3),o.qZA()),2&r&&(o.Udp("background",n.imageVisible&&n.backgroundColor),o.xp6(2),o.Q6J("ngIf",n.safeImgDataUrl),o.xp6(1),o.Udp("width",n.maxSize.width,"px")("height",n.maxSize.height,"px")("margin-left","center"===n.alignImage?n.marginLeft:null),o.xp6(1),o.Q6J("ngIf",n.imageVisible))},dependencies:[X.O5],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535c;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ix-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0}),y})()}}]);