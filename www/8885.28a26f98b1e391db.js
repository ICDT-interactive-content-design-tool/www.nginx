"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8885],{8885:(Wi,N,d)=>{d.r(N),d.d(N,{MediaViewerPageModule:()=>zi});var B=d(177),K=d(9417),s=d(6637),E=d(3658),b=d(467),Q=d(4569),Z=d(1632),q=d(7331),P=d(5312),ii=d(8408),ei=d(5178),ti=d(2527),S=d.n(ti),ni=d(5972),oi=d(5781),U=d(7868),ai=d(1174),li=d(6539),Y=d(1312),j=d(8833),ri=d(4552),H=d(1951),J=d(5414),R=d(1400),h=d(1607),i=d(4438),z=d(345),di=d(7704),si=d(2706),ci=d(31);const mi=["canvas"];function gi(t,l){if(1&t){const n=i.RV6();i.j41(0,"ion-button",11),i.nI1(1,"translate"),i.bIt("click",function(o){i.eBV(n);const a=i.XpG(2);return i.Njj(a.presentModalAiImage(o))}),i.nrm(2,"ion-icon",12),i.k0s()}2&t&&i.Y8G("title",i.bMT(1,1,"CreatedWithAI"))}function pi(t,l){if(1&t){const n=i.RV6();i.j41(0,"ion-button",11),i.nI1(1,"translate"),i.bIt("click",function(){i.eBV(n);const o=i.XpG(2);return i.Njj(o.AI_recommend(o.v_functionlimit.GenAITaoHinhAnh))}),i.nrm(2,"ion-icon",12),i.k0s()}2&t&&i.Y8G("title",i.bMT(1,1,"CreatedWithAI"))}function ui(t,l){if(1&t&&i.DNE(0,gi,3,3,"ion-button",10)(1,pi,3,3),2&t){const n=i.XpG();i.vxM(0,n.membership.GenAITaoHinhAnh?0:1)}}function _i(t,l){if(1&t){const n=i.RV6();i.j41(0,"li",15)(1,"ion-card",16),i.bIt("click",function(){const o=i.eBV(n).$implicit,a=i.XpG(2);return i.Njj(a.switchMedia(o.media_id))}),i.nrm(2,"ion-img",17),i.j41(3,"ion-card-content")(4,"div",18),i.EFF(5),i.k0s()()(),i.j41(6,"div",19),i.EFF(7),i.k0s()()}if(2&t){let n;const e=l.$implicit,o=i.XpG(2);i.R7$(),i.Y8G("title",e.media_title),i.R7$(),i.Y8G("src",e.cover?o.readfileuploadurl+e.cover:"assets/image/media/image.svg")("alt",e.media_title)("title",e.media_title),i.R7$(2),i.Y8G("title",e.media_title),i.R7$(),i.JRh(null!==(n=null!==(n=null!==(n=e.media_title)&&void 0!==n?n:e.v_osstype_title)&&void 0!==n?n:e.v_mediatype_title)&&void 0!==n?n:""),i.R7$(2),i.JRh(e.v_mediatype_title)}}function hi(t,l){if(1&t&&(i.j41(0,"div",8)(1,"div",13),i.EFF(2,"T\xecm th\u1ea5y "),i.j41(3,"b"),i.EFF(4),i.k0s(),i.EFF(5,' m\u1ee5c v\u1edbi t\u1eeb kh\xf3a "'),i.j41(6,"b"),i.EFF(7),i.k0s(),i.EFF(8,'"'),i.k0s(),i.j41(9,"ul",14),i.Z7z(10,_i,8,7,"li",15,i.fX1),i.k0s()()),2&t){let n;const e=i.XpG();i.R7$(4),i.JRh((null!==(n=e.medias[0].total)&&void 0!==n?n:0)<=99?e.medias[0].total:"99+"),i.R7$(3),i.JRh(e.filter.search),i.R7$(3),i.Dyx(e.medias)}}function fi(t,l){if(1&t&&i.nrm(0,"img",43),2&t){const n=i.XpG(3);i.Y8G("src",n.viewOptions.url,i.B4B)("alt",n.media.media_title)}}function vi(t,l){if(1&t&&(i.j41(0,"div",41),i.DNE(1,fi,1,2,"img",42),i.k0s()),2&t){const n=i.XpG(2);i.BMQ("style",n.media.bigcover?"--bg-img:url("+n.readfileuploadurl+n.media.bigcover+")":"",i.$dS),i.R7$(),i.Y8G("ngIf",n.viewOptions.url)}}function bi(t,l){if(1&t&&(i.j41(0,"div",41),i.nrm(1,"canvas",null,0),i.k0s()),2&t){const n=i.XpG(2);i.BMQ("style",n.media.bigcover?"--bg-img:url("+n.readfileuploadurl+n.media.bigcover+")":"",i.$dS)}}function Ci(t,l){if(1&t){const n=i.RV6();i.j41(0,"iframe",46),i.nI1(1,"safe"),i.bIt("load",function(o){i.eBV(n);const a=i.XpG(3);return i.Njj(a.loadIframe(o))}),i.k0s()}if(2&t){const n=i.XpG(3);i.Y8G("src",i.i5U(1,1,n.viewOptions.url,"resourceUrl"),i.f$h)}}function Mi(t,l){if(1&t&&(i.j41(0,"div",44),i.DNE(1,Ci,2,4,"iframe",45),i.k0s()),2&t){const n=i.XpG(2);i.BMQ("style",n.media.bigcover?"--bg-img:url("+n.readfileuploadurl+n.media.bigcover+")":"",i.$dS),i.R7$(),i.Y8G("ngIf",n.viewOptions.url)}}function xi(t,l){1&t&&(i.j41(0,"div",47),i.nrm(1,"ion-spinner",48),i.k0s())}function Pi(t,l){if(1&t){const n=i.RV6();i.j41(0,"ion-button",52),i.nI1(1,"translate"),i.bIt("click",function(){i.eBV(n);const o=i.XpG(3);return i.Njj(o.downloadMedia())}),i.nrm(2,"ion-icon",53),i.j41(3,"ion-label"),i.EFF(4),i.nI1(5,"translate"),i.k0s()()}2&t&&(i.Y8G("title",i.bMT(1,2,"Download")),i.R7$(4),i.JRh(i.bMT(5,4,"Download")))}function wi(t,l){1&t&&(i.j41(0,"ion-button",54),i.nrm(1,"ion-icon",55),i.j41(2,"ion-label"),i.EFF(3),i.nI1(4,"translate"),i.k0s()()),2&t&&(i.Y8G("disabled",!0),i.R7$(3),i.JRh(i.bMT(4,2,"Download")))}function yi(t,l){if(1&t){const n=i.RV6();i.DNE(0,Pi,6,6,"ion-button",49)(1,wi,5,4),i.j41(2,"ion-button",50),i.nI1(3,"translate"),i.bIt("click",function(o){i.eBV(n);const a=i.XpG(2);return i.Njj(a.presentModalMediaShare(o))}),i.nrm(4,"ion-icon",51),i.k0s()}if(2&t){const n=i.XpG(2);i.vxM(0,n.media.isdownload?0:1),i.R7$(2),i.Y8G("title",i.bMT(3,2,"Share"))}}function Oi(t,l){if(1&t){const n=i.RV6();i.j41(0,"ion-button",52),i.nI1(1,"translate"),i.bIt("click",function(){i.eBV(n);const o=i.XpG(3);return i.Njj(o.downloadMedia())}),i.nrm(2,"ion-icon",53),i.j41(3,"ion-label"),i.EFF(4),i.nI1(5,"translate"),i.k0s()()}2&t&&(i.Y8G("title",i.bMT(1,2,"Download")),i.R7$(4),i.JRh(i.bMT(5,4,"Download")))}function ji(t,l){if(1&t){const n=i.RV6();i.j41(0,"div",57)(1,"div",58),i.nrm(2,"ion-icon",59),i.j41(3,"b",60),i.EFF(4,"Tabca Pro"),i.k0s()(),i.j41(5,"div",61),i.EFF(6,"N\xe2ng c\u1ea5p t\xe0i kho\u1ea3n Pro \u0111\u1ec3 t\u1ea3i v\u1ec1 v\xe0 t\u1ea1o h\xecnh \u1ea3nh b\u1eb1ng AI."),i.k0s(),i.j41(7,"ion-button",62),i.nI1(8,"translate"),i.bIt("click",function(){i.eBV(n);const o=i.XpG(3);return i.Njj(o.AI_recommend(o.v_functionlimit.TaiVeCacHocLieuHeThongCungCap))}),i.j41(9,"ion-label"),i.EFF(10),i.nI1(11,"translate"),i.k0s()()()}2&t&&(i.R7$(7),i.Y8G("title",i.bMT(8,2,"UpgradeTabcaProNow")),i.R7$(3),i.JRh(i.bMT(11,4,"Upgrade")))}function Ri(t,l){1&t&&(i.j41(0,"ion-button",54),i.nrm(1,"ion-icon",55),i.j41(2,"ion-label"),i.EFF(3),i.nI1(4,"translate"),i.k0s()()),2&t&&(i.Y8G("disabled",!0),i.R7$(3),i.JRh(i.bMT(4,2,"Download")))}function Ti(t,l){if(1&t&&(i.DNE(0,Oi,6,6,"ion-button",49)(1,ji,12,6)(2,Ri,5,4),i.j41(3,"ion-button",56),i.nI1(4,"translate"),i.nrm(5,"ion-icon",51),i.k0s()),2&t){const n=i.XpG(2);i.vxM(0,n.media.isdownload&&n.media.ispublic&&n.membership.TaiVeCacHocLieuHeThongCungCap?0:n.media.isdownload&&n.media.ispublic&&!n.membership.TaiVeCacHocLieuHeThongCungCap?1:2),i.R7$(3),i.Y8G("title",i.bMT(4,3,"Share"))("disabled",!0)}}function ki(t,l){if(1&t&&(i.j41(0,"p"),i.EFF(1),i.nI1(2,"translate"),i.k0s()),2&t){const n=i.XpG(2);i.R7$(),i.E5c("",i.bMT(2,3,"Size"),": ",n.media.width," x ",n.media.height," px")}}function Ei(t,l){if(1&t&&(i.j41(0,"p"),i.EFF(1),i.nI1(2,"translate"),i.k0s()),2&t){const n=i.XpG(2);i.R7$(),i.Lme("",i.bMT(2,2,"MediaType"),": ",n.media.ext,"")}}function Ii(t,l){if(1&t&&(i.j41(0,"div",37),i.nrm(1,"ion-icon",63),i.j41(2,"span",64),i.EFF(3),i.k0s()()),2&t){const n=i.XpG(2);i.Y8G("title",n.media.topic_titles),i.R7$(3),i.JRh(n.media.topic_titles.split(";").reverse().join(" / "))}}function Vi(t,l){if(1&t&&(i.j41(0,"div",37),i.nrm(1,"ion-icon",65),i.j41(2,"span",64),i.EFF(3),i.k0s()()),2&t){const n=i.XpG(2);i.Y8G("title",n.media.category_titles),i.R7$(3),i.JRh(n.media.category_titles.split(";").reverse().join(" / "))}}function Fi(t,l){if(1&t&&(i.j41(0,"div",37),i.nrm(1,"ion-icon",66),i.j41(2,"span",64),i.EFF(3),i.k0s()()),2&t){const n=i.XpG(2);i.Y8G("title",n.media.directory_titles),i.R7$(3),i.JRh(n.media.directory_titles.split(";").reverse().join(" / "))}}function Gi(t,l){if(1&t&&(i.j41(0,"ion-button",69),i.nrm(1,"ion-icon",70),i.j41(2,"ion-label",71),i.EFF(3),i.k0s()()),2&t){const n=l.$implicit;i.Y8G("title",n),i.R7$(3),i.JRh(n)}}function $i(t,l){if(1&t&&(i.j41(0,"ion-button",69),i.nrm(1,"ion-icon",72),i.j41(2,"ion-label",71),i.EFF(3),i.k0s()()),2&t){const n=l.$implicit;i.Y8G("title",n),i.R7$(3),i.JRh(n)}}function Ai(t,l){if(1&t&&(i.j41(0,"ion-button",69),i.nrm(1,"ion-icon",73),i.j41(2,"ion-label",71),i.EFF(3),i.k0s()()),2&t){const n=l.$implicit;i.Y8G("title",n),i.R7$(3),i.JRh(n)}}function Di(t,l){if(1&t&&(i.j41(0,"ion-button",69),i.nrm(1,"ion-icon",74),i.j41(2,"ion-label",71),i.EFF(3),i.k0s()()),2&t){const n=l.$implicit;i.Y8G("title",n),i.R7$(3),i.JRh(n)}}function Xi(t,l){if(1&t&&(i.j41(0,"div",39)(1,"h5",67),i.EFF(2),i.nI1(3,"translate"),i.k0s(),i.j41(4,"div",30)(5,"div",31)(6,"div",68),i.Z7z(7,Gi,4,2,"ion-button",69,i.fX1),i.Z7z(9,$i,4,2,"ion-button",69,i.fX1),i.Z7z(11,Ai,4,2,"ion-button",69,i.fX1),i.Z7z(13,Di,4,2,"ion-button",69,i.fX1),i.k0s()()()()),2&t){let n,e,o;const a=i.XpG(2);i.R7$(2),i.JRh(i.bMT(3,1,"Tag")),i.R7$(5),i.Dyx(null==a.media.tags?null:a.media.tags.split(";")),i.R7$(2),i.Dyx(null==a.media.topic_titles||null==(n=a.media.topic_titles.split(";"))?null:n.reverse()),i.R7$(2),i.Dyx(null==a.media.category_titles||null==(e=a.media.category_titles.split(";"))?null:e.reverse()),i.R7$(2),i.Dyx(null==a.media.directory_titles||null==(o=a.media.directory_titles.split(";"))?null:o.reverse())}}function Ni(t,l){if(1&t){const n=i.RV6();i.j41(0,"div",75)(1,"a",76),i.EFF(2),i.k0s(),i.j41(3,"ion-item",77),i.bIt("click",function(){const o=i.eBV(n).$implicit,a=i.XpG(3);return i.Njj(a.switchMedia(o.media_id))}),i.j41(4,"ion-thumbnail"),i.nrm(5,"img",43),i.k0s()()()}if(2&t){let n;const e=l.$implicit,o=i.XpG(3);i.R7$(),i.Y8G("href",o.siteurl+"/"+o.APP_ROUTE.VIEWER_ID.replace(":id",null!==(n=null==o.media.media_id?null:o.media.media_id.toString())&&void 0!==n?n:""),i.B4B)("title",e.media_title),i.R7$(),i.JRh(e.media_title),i.R7$(),i.Y8G("title",e.media_title),i.R7$(2),i.Y8G("src",e.cover?o.readfileuploadurl+e.cover:"assets/image/media/image.svg",i.B4B)("alt",e.media_title)}}function Bi(t,l){if(1&t&&(i.j41(0,"div",40)(1,"h5",67),i.EFF(2),i.nI1(3,"translate"),i.k0s(),i.j41(4,"div",68),i.Z7z(5,Ni,6,6,"div",75,i.fX1),i.k0s()()),2&t){const n=i.XpG(2);i.R7$(2),i.JRh(i.bMT(3,1,"MediaRelated")),i.R7$(3),i.Dyx(n.medias_related)}}function Si(t,l){if(1&t&&(i.j41(0,"div",20)(1,"div",21)(2,"div",22)(3,"div",23)(4,"div",24),i.DNE(5,vi,2,2)(6,bi,3,1)(7,Mi,2,2)(8,xi,2,0),i.k0s()()(),i.j41(9,"div",25)(10,"div",26),i.DNE(11,yi,5,4,"ion-button",27)(12,Ti,6,5),i.k0s(),i.j41(13,"div",28),i.DNE(14,ki,3,5,"p")(15,Ei,3,4,"p"),i.j41(16,"p"),i.EFF(17),i.nI1(18,"translate"),i.nI1(19,"translate"),i.k0s()()()()(),i.j41(20,"div",29)(21,"div",30)(22,"div",31)(23,"div",32)(24,"div",33)(25,"ion-chip")(26,"ion-avatar",34),i.nrm(27,"img",35),i.k0s(),i.j41(28,"ion-label"),i.EFF(29),i.k0s()()(),i.j41(30,"div",36),i.DNE(31,Ii,4,2,"div",37)(32,Vi,4,2)(33,Fi,4,2),i.k0s()(),i.j41(34,"h2",38),i.EFF(35),i.k0s()()()(),i.DNE(36,Xi,15,3,"div",39)(37,Bi,7,3,"div",40)),2&t){let n;const e=i.XpG();i.R7$(3),i.BMQ("style","padding-bottom:"+e.viewOptions.ratio+"%",i.$dS),i.R7$(2),i.vxM(5,"img"===(n=e.viewOptions.type)?5:"canvas"===n?6:"iframe"===n?7:8),i.R7$(6),i.vxM(11,e.media.isowner?11:12),i.R7$(3),i.vxM(14,e.media.width&&e.media.height?14:-1),i.R7$(),i.vxM(15,e.media.ext?15:-1),i.R7$(2),i.Lme("",i.bMT(18,13,"Use"),": ",e.media.ispublic?"Tabca Pro":i.bMT(19,15,"Private"),""),i.R7$(10),i.Y8G("src",e.media.createdby_avatar?e.readfileuploadurl+e.media.createdby_avatar:"assets/image/user-avatar-default.png",i.B4B),i.R7$(2),i.JRh(e.media.createdby_name),i.R7$(2),i.vxM(31,e.media.topic_titles?31:e.media.category_titles?32:e.media.directory_titles?33:-1),i.R7$(4),i.JRh(e.media.media_title),i.R7$(),i.vxM(36,e.media.tags||e.media.topic_titles||e.media.category_titles||e.media.directory_titles?36:-1),i.R7$(),i.vxM(37,e.medias_related.length?37:-1)}}function Ui(t,l){if(1&t){const n=i.RV6();i.j41(0,"ion-infinite-scroll",78),i.bIt("ionInfinite",function(o){i.eBV(n);const a=i.XpG();return i.Njj(a.onIonInfinite(o))}),i.nrm(1,"ion-infinite-scroll-content"),i.k0s()}}const Yi=[{path:"",component:(()=>{var t;class l{constructor(e,o,a,r,m,c,g,_){var u,p,f=this;this.activatedRoute=e,this.titleService=o,this.metaService=a,this.router=r,this.toastController=m,this.modalController=c,this.popoverController=g,this.loadingController=_,this.APP_ROUTE=j._,this.APP_FUNC_FormatDate=Y.Rv,this.v_functionlimit=R.r,this.envUI_Config=P.c.ui_config,this.appsettings=null!==(u=P.c.donvis.find(T=>T.madonvi==P.c.default_donvi))&&void 0!==u?u:{},this.siteurl=P.c.url,this.readfileuploadurl=null!==(p=this.appsettings.readfileuploadurl)&&void 0!==p?p:"",this.membership={},this.medias_related=[],this.filter={},this.paging={page:1,limit:50,active:!0},this.medias=[],this.viewOptions={ratio:66.67};let v=e.snapshot.params.id;if(!v)return void this.router.navigateByUrl(j._.LANDING_PAGE);let w=e.snapshot.queryParamMap.get("auth");"1"==w||"true"==w?(0,b.A)(function*(){yield f.loadUser(),f.media_id=v,f.loadMedia(v)})():(this.loadUser(),this.media_id=v,this.loadMedia(v,!1))}ngOnInit(){}onIonRefresher(e){this.closeSearch(),this.loadMedia(void 0,!0,()=>{e.target.complete()})}onIonInfinite(e){this.loadMore(()=>{e.target.complete()})}searchChange(e){var o;this.filter.search=null===(o=e.target.value)||void 0===o?void 0:o.replace(/[\`\~\!\@\#\$\%\^\&\*\(\)\-\_\=\+\[\{\]\}\\\|\;\:\'\,\<\.\>\/\?]+/g," ").replace(/\s+/g," ").trim(),this.refreshData()}filterChange(){this.refreshData()}refreshData(e){this.filter.search?(this.paging.page=1,this.paging.active=!0,this.loadData_Paging(e)):this.closeSearch()}loadMore(e){this.paging.page+=1,this.loadData_Paging(e)}pushData(e){return 1==this.paging.page&&(this.medias.length=0),this.medias=this.medias.concat(e),this.medias}loadData_Paging(e){var o;(0,oi.br)({loadingController:1==this.paging.page?this.loadingController:void 0,params:{userid:null===(o=this.user)||void 0===o?void 0:o.userid,getfrom:1,media_title:this.filter.search,v_mediatypes:[h.S.IMAGE,h.S.IMAGE_ANIMATION,h.S.PHET,h.S.HTML,h.S.SCORM].join(","),topic_id:this.filter.topic_id,sortfield:this.paging.sortfield,sorttype:this.paging.sorttype,page:this.paging.page,limit:this.paging.limit},callback:a=>{this.pushData(a||[]).length<this.paging.limit*this.paging.page&&(this.paging.active=!1),e&&e()}})}loadUser(){var e=this;return(0,b.A)(function*(){var o,a,r;e.appsettings=yield(0,ni.AC)(),e.appsettings.madonvi&&(e.user=yield(0,li.sx)(),e.readfileuploadurl=null!==(o=e.appsettings.readfileuploadurl)&&void 0!==o?o:"",e.user.userid)&&((0,U.EW)({params:{userid:null===(a=e.user)||void 0===a?void 0:a.userid,v_functionlimit:R.r.GenAITaoHinhAnh},callback:m=>{var c;e.membership.GenAITaoHinhAnh=(0,H.j)(null==m||null===(c=m.contents)||void 0===c?void 0:c.find(g=>g.v_functionlimit==R.r.GenAITaoHinhAnh))}}),(0,U.EW)({params:{userid:null===(r=e.user)||void 0===r?void 0:r.userid,v_functionlimit:R.r.TaiVeCacHocLieuHeThongCungCap},callback:m=>{var c;e.membership.TaiVeCacHocLieuHeThongCungCap=(0,H.j)(null==m||null===(c=m.contents)||void 0===c?void 0:c.find(g=>g.v_functionlimit==R.r.TaiVeCacHocLieuHeThongCungCap))}}))})()}loadMedia(e,o,a){var r;$.ajax({async:o,cache:!0,url:`${this.appsettings.apiurl}api/Media/Detail`,method:"GET",contentType:"application/json",data:{getby:null===(r=this.user)||void 0===r?void 0:r.userid,media_id:null!=e?e:this.media_id},dataType:"json",success:m=>{var c,g,_,u,p,f,v,w,T,V,F,G,A,D;m&&m.media_id?(this.media=m||{},(0,Y.Kd)(this.titleService,this.metaService,{title:this.media.media_title,description:(0,ri.YW)(this.media.media_description),keywords:null===(c=this.media.tags)||void 0===c?void 0:c.replace(/\;/g,", "),image:{url:`${this.appsettings.readfileuploadurl}${this.media.bigcover}`,type:"image/jpge",width:800,height:800,alt:this.media.media_title},url:`${P.c.url}/${j._.MEDIA_VIEWER_ID.replace(":id",null!==(g=null===(_=this.media.media_id)||void 0===_?void 0:_.toString())&&void 0!==g?g:"")}`,author:{name:this.media.createdby_name,email:P.c.author.email},updated:null!==(u=this.media.modifieddate)&&void 0!==u?u:this.media.createddate}),this.media.isdownload=!(this.media.v_mediatype==h.S.LINK||!this.media.filepath),null!==(p=this.media)&&void 0!==p&&null!==(p=p.filepath)&&void 0!==p&&p.match(/.lvm$/)?(0,ei.Q)(`${this.appsettings.readfileuploadurl}${null===(f=this.media)||void 0===f?void 0:f.filepath}`).then(Li=>{let{ext:L,file:I}=Li;switch(L){case"gif":case"apng":this.viewOptions.type="img",this.viewOptions.file=I,this.viewOptions.url=URL.createObjectURL(I);break;case"avif":case"jpg":case"jpe":case"jpeg":case"jif":case"jfif":case"pjp":case"pjpeg":case"png":case"ico":case"cur":case"tif":case"tiff":case"bmp":case"webp":case"svg":{this.viewOptions.type="canvas",this.viewOptions.file=I;let X=new FileReader;X.onload=W=>{let C=new Image;C.onload=()=>{var k;let M=C.width||1,x=C.height||1;if("svg"==L){let O=M/x;O>=1?(M=Math.max(M,800),x=M/O):(x=Math.max(x,800),M=x*O)}let y=null===(k=this.canvas)||void 0===k?void 0:k.nativeElement;if(y){y.width=M,y.height=x,y.style.maxWidth="100%",y.style.maxHeight="100%";let O=y.getContext("2d");O&&O.drawImage(C,0,0,M,x)}},C.onerror=()=>{(0,J.c)(this.toastController,{color:"danger",message:"Kh\xf4ng t\u1ea3i \u0111\u01b0\u1ee3c th\xf4ng tin \u1ea3nh!"}).then(k=>k.present())},C.src=W.target.result},X.onerror=W=>{(0,J.c)(this.toastController,{color:"danger",message:"Kh\xf4ng t\u1ea3i \u0111\u01b0\u1ee3c t\u1eadp tin!"}).then(C=>C.present())},X.readAsDataURL(I);break}}}):(this.viewOptions.type="iframe",this.viewOptions.url=(0,ii._KM)({readfileuploadurl:this.appsettings.readfileuploadurl,type:null===(v=this.media)||void 0===v?void 0:v.v_mediatype,oss:null===(w=this.media)||void 0===w?void 0:w.v_osstype,path:null!==(T=null===(V=this.media)||void 0===V?void 0:V.filepath_extract)&&void 0!==T?T:null===(F=this.media)||void 0===F?void 0:F.filepath,url:null!==(G=null===(A=this.media)||void 0===A?void 0:A.link_file)&&void 0!==G?G:null===(D=this.media)||void 0===D?void 0:D.link_share})),this.media&&this.loadMedia_Related(o),a&&a()):this.router.navigateByUrl(j._.LANDING_PAGE)}})}loadMedia_Related(e){var o,a,r,m;this.medias_related=[];let c=[];null!==(o=this.media)&&void 0!==o&&o.tags&&c.push({type:"tags",tags:this.media.tags}),null!==(a=this.media)&&void 0!==a&&a.directory_id&&c.push({type:"directory",directory_id:this.media.directory_id}),null!==(r=this.media)&&void 0!==r&&r.topic_id&&c.push({type:"topic",topic_id:this.media.topic_id}),null!==(m=this.media)&&void 0!==m&&m.category_id&&c.push({type:"category",category_id:this.media.category_id});let g=()=>{var _;let u=c.shift();u&&$.ajax({async:e,cache:!0,url:`${this.appsettings.apiurl}api/Media/Search`,method:"GET",contentType:"application/json",data:Object.assign({getby:null===(_=this.user)||void 0===_?void 0:_.userid,getfrom:1,v_mediatypes:[h.S.IMAGE,h.S.IMAGE_ANIMATION,h.S.PHET,h.S.HTML,h.S.SCORM].join(","),sortfield:this.paging.sortfield,sorttype:this.paging.sorttype,posstart:1,numofrow:18},u),dataType:"json",success:p=>{this.medias_related=this.medias_related.concat(p||[]),this.medias_related.length<18&&g()}})};g()}closeSearch(){this.filter={},this.medias.length=0}navigateByUrl(e){e&&this.router.navigateByUrl(e)}switchMedia(e){var o=this;return(0,b.A)(function*(){e&&o.router.navigate(["/",j._.VIEWER],{relativeTo:o.activatedRoute,queryParams:{m:e},queryParamsHandling:"merge",replaceUrl:!0})})()}downloadMedia(){var e=this;return(0,b.A)(function*(){var o,a,r;null!==(o=e.media)&&void 0!==o&&o.isdownload&&(["img","canvas"].includes(null!==(a=e.viewOptions.type)&&void 0!==a?a:"")&&e.viewOptions.file?S()(e.viewOptions.file,e.media.media_title+"."+e.viewOptions.file.name.split(".").pop(),e.viewOptions.file.type):null!==(r=e.media)&&void 0!==r&&r.filepath&&S()(`${e.appsettings.readfileuploadurl}${e.media.filepath}`))})()}AI_recommend(e){var o=this;return(0,b.A)(function*(){(0,ai.QB)(o.modalController,e)})()}loadIframe(e){this.iframe=e.target}presentModalAiImage(e){var o=this;return(0,b.A)(function*(){const a=yield o.modalController.create({component:Q.K,mode:"md",cssClass:"ion-modal-lg modal-vip",backdropDismiss:!1,keyboardClose:!1});a.onDidDismiss().then(r=>{"confirm"==r.role&&o.switchMedia(r.data)}),a.present()})()}presentModalMediaShare(e){var o=this;return(0,b.A)(function*(){var a;(yield o.modalController.create({component:Z.U,componentProps:{media_id:null===(a=o.media)||void 0===a?void 0:a.media_id},mode:"md",cssClass:"ion-modal",backdropDismiss:!0,keyboardClose:!0})).present()})()}presentPopoverTopic(e){var o=this;return(0,b.A)(function*(){const a=yield o.popoverController.create({component:q.E,componentProps:{selectedId:o.filter.topic_id},event:e,dismissOnSelect:!1,animated:!1,side:"right"});a.onDidDismiss().then(r=>{var m,c,g,_,u,p,f;"confirm"==r.role&&(Object.assign(o.filter,{topic_id:null===(m=r.data)||void 0===m?void 0:m.topic_id,topic_title:null===(c=r.data)||void 0===c?void 0:c.topic_title,topic_titles:null===(g=r.data)||void 0===g?void 0:g.topic_titles}),null!==(_=r.data)&&void 0!==_&&_.category_id&&Object.assign(o.filter,{category_id:null===(u=r.data)||void 0===u?void 0:u.category_id,category_title:null===(p=r.data)||void 0===p?void 0:p.category_title,category_titles:null===(f=r.data)||void 0===f?void 0:f.category_titles}))}),a.present()})()}}return(t=l).\u0275fac=function(e){return new(e||t)(i.rXU(E.nX),i.rXU(z.hE),i.rXU(z.W8),i.rXU(E.Ix),i.rXU(s.K_),i.rXU(s.W3),i.rXU(s.IE),i.rXU(s.Xi))},t.\u0275cmp=i.VBU({type:t,selectors:[["app-media-viewer"]],viewQuery:function(e,o){if(1&e&&i.GBs(mi,5),2&e){let a;i.mGM(a=i.lsd())&&(o.canvas=a.first)}},decls:15,vars:5,consts:[["canvas",""],["slot","fixed",3,"ionRefresh"],[1,"container","pt-2","mt-4","mb-5","max-w-800"],[1,"mt-0","mb-3","fw-500","text-center"],[1,"d-flex","align-items-center","searchbox"],["name","search-outline",1,"fs-24","ml-3"],[1,"flex-grow-1"],["mode","ios","placeholder","Nh\u1eadp n\u1ed9i dung c\u1ea7n t\xecm","search-icon"," ",2,"padding","0",3,"ionChange","debounce","value"],[1,"container","mb-4","list-media"],[3,"ionInfinite",4,"ngIf"],["mode","ios","color","tabca-pro",1,"m-1","btn-ai-image",3,"title"],["mode","ios","color","tabca-pro",1,"m-1","btn-ai-image",3,"click","title"],["src","../../../assets/icon-svg/magic-ai-2.svg",1,"fs-24"],[1,"mb-2","fs-14"],[1,"d-flex","flex-wrap","p-2","m-0"],[1,"position-relative","d-block","p-0","m-2"],[3,"click","title"],[3,"src","alt","title"],[1,"text-center","text-ellipsis",3,"title"],[1,"position-absolute","top-2","left-2","media-type"],[1,"container"],[1,"row","align-items-stretch"],[1,"col-12","col-lg-8","mb-4","media-view"],[1,"position-relative","w-0","h-0"],[1,"position-absolute","top-0","left-0","right-0","bottom-0"],[1,"col-12","col-lg-4","mb-4","media-info"],[1,"d-flex"],["mode","ios","color","dark","fill","outline",1,"btn-share","ml-3",3,"title"],[1,"mt-4"],[1,"container","mb-4","media-introduce"],[1,"row"],[1,"col-12","col-lg-8"],[1,"d-flex","align-items-center","justify-content-between"],[1,"flex-grow-1","text-nowrap"],[1,"min-w-24"],["onerror","errorAvatar(this)",3,"src"],[1,"d-block","d-md-flex","flex-nowrap","align-items-center","text-ellipsis"],[1,"text-ellipsis","d-flex","align-items-center","ml-3",3,"title"],[1,"mt-2","mb-0","fw-400"],[1,"container","mb-4","media-tag"],[1,"container","mb-4","media-related"],["oncontextmenu","return false",1,"view-box","img-box"],[3,"src","alt",4,"ngIf"],[3,"src","alt"],["oncontextmenu","return false",1,"view-box","iframe-box"],["frameborder","0","allowfullscreen","","webkitallowfullscreen","","allowtransparency","true","allow","autoplay; fullscreen","oncontextmenu","return false",3,"src","load",4,"ngIf"],["frameborder","0","allowfullscreen","","webkitallowfullscreen","","allowtransparency","true","allow","autoplay; fullscreen","oncontextmenu","return false",3,"load","src"],[1,"d-flex","w-100","h-100","align-items-center","justify-content-center","line-height-0"],["color","tertiary","name","bubbles"],["mode","ios","color","linear","expand","block",1,"flex-grow-1","btn-download",3,"title"],["mode","ios","color","dark","fill","outline",1,"btn-share","ml-3",3,"click","title"],["name","share-social-outline"],["mode","ios","color","linear","expand","block",1,"flex-grow-1","btn-download",3,"click","title"],["slot","start","src","../../../assets/icon/viewer/download.svg"],["mode","ios","expand","block",1,"flex-grow-1","btn-download",3,"disabled"],["slot","start","name","download-outline"],["mode","ios","color","dark","fill","outline",1,"btn-share","ml-3",3,"title","disabled"],[1,"rounded","border","p-4"],[1,"d-flex","align-items-center"],["src","../../../assets/image/tabca-pro-2.svg",1,"fs-22","icon-tabca-pro"],[1,"fw-700","fs-16","ml-3"],[1,"my-3"],["mode","ios","color","linear","expand","block",3,"click","title"],["src","../../../assets/icon-svg/dashboard/topic.svg",1,"fs-20"],[1,"fs-12","text-ellipsis"],["src","../../../assets/icon-svg/dashboard/category.svg",1,"fs-20"],["src","../../../assets/icon-svg/dashboard/template.svg",1,"fs-20"],[1,"mt-0","mb-2"],[1,"d-flex","flex-wrap"],["mode","ios","size","small","color","dark","fill","outline",1,"mt-0","ml-0","mr-2","mb-2",3,"title"],["slot","start","src","../../../assets/icon/viewer/tag.svg",1,"fs-20"],[1,"fs-14"],["slot","start","src","../../../assets/icon/viewer/topic.svg",1,"fs-20"],["slot","start","src","../../../assets/icon/viewer/category.svg",1,"fs-20"],["slot","start","src","../../../assets/icon/viewer/directory.svg",1,"fs-20"],[1,"mr-2","mb-2","media-related-item"],[3,"href","title"],["lines","none","detail","false","button","true",3,"click","title"],[3,"ionInfinite"]],template:function(e,o){1&e&&(i.nrm(0,"app-header"),i.j41(1,"ion-content")(2,"ion-refresher",1),i.bIt("ionRefresh",function(r){return o.onIonRefresher(r)}),i.nrm(3,"ion-refresher-content"),i.k0s(),i.j41(4,"div",2)(5,"h4",3),i.EFF(6,"T\xe0i nguy\xean h\u1ecdc t\u1eadp trong t\u1ea7m tay"),i.k0s(),i.j41(7,"div",4),i.nrm(8,"ion-icon",5),i.j41(9,"div",6)(10,"ion-searchbar",7),i.bIt("ionChange",function(r){return o.searchChange(r)}),i.k0s()(),i.DNE(11,ui,2,1),i.k0s()(),i.DNE(12,hi,12,2,"div",8)(13,Si,38,17)(14,Ui,2,0,"ion-infinite-scroll",9),i.k0s()),2&e&&(i.R7$(10),i.Y8G("debounce",1e3)("value",o.filter.search),i.R7$(),i.vxM(11,o.envUI_Config.is_ai_image?11:-1),i.R7$(),i.vxM(12,o.medias.length?12:o.media?13:-1),i.R7$(2),i.Y8G("ngIf",o.paging.active&&o.medias.length))},dependencies:[B.bT,s.mC,s.Jm,s.b_,s.I9,s.ZB,s.W9,s.iq,s.KW,s.Ax,s.Hp,s.uz,s.he,s.To,s.Ki,s.S1,s.w2,s.Zx,s.Gw,di.l,si.m,ci.D9],styles:['.searchbox[_ngcontent-%COMP%]{overflow:hidden;border-radius:.75rem;border:1px solid #8F9BB3;background:#fff}.searchbox[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{width:100%;height:40px;--background: transparent;--box-shadow: none}.searchbox[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:2.5rem}.searchbox[_ngcontent-%COMP%]   ion-button.btn-ai-image[_ngcontent-%COMP%]{width:2.5rem;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0}.searchbox[_ngcontent-%COMP%]   ion-button.btn-search[_ngcontent-%COMP%]{width:2.5rem;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0}.media-view[_ngcontent-%COMP%]   .view-box[style][_ngcontent-%COMP%]:not([style=""]){border-radius:.75rem;background:var(--ion-background-color);box-shadow:4px 4px 12px #0101011a}.media-view[_ngcontent-%COMP%]   .view-box[style][_ngcontent-%COMP%]:not([style=""]):before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;z-index:1;opacity:.16;background-image:var(--bg-img);background-repeat:no-repeat;background-position:center center;background-size:cover}.media-view[_ngcontent-%COMP%]   .view-box[style][_ngcontent-%COMP%]:not([style=""]) > *[_ngcontent-%COMP%]{position:relative;z-index:2}.media-view[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;line-height:0;overflow:hidden;border-radius:.75rem;box-shadow:0 0 0 1px #fff;display:flex;align-items:center;justify-content:center}.media-view[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .media-view[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{border-radius:.25rem;overflow:hidden;box-shadow:0 0 12px #0101011a}.media-view[_ngcontent-%COMP%]   .img-box[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;z-index:2147483647;background:transparent;-webkit-user-select:none;user-select:none}.media-view[_ngcontent-%COMP%]   .iframe-box[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;line-height:0;overflow:hidden;border-radius:.75rem;background:var(--ion-background-color);box-shadow:4px 4px 12px #01010133}.media-view[_ngcontent-%COMP%]   .iframe-box[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{display:block;width:100%;height:100%;padding:0;margin:0;border:0;outline:none;background-color:#fff}.media-info[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0}.media-info[_ngcontent-%COMP%]   ion-button[color=dark][_ngcontent-%COMP%]::part(native){border-color:var(--ion-color-medium-tint)}.media-info[_ngcontent-%COMP%]   .btn-download[_ngcontent-%COMP%]{min-width:3rem;height:3rem;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0}.media-info[_ngcontent-%COMP%]   .btn-share[_ngcontent-%COMP%]{min-width:3rem;width:3rem;height:3rem;--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0}.media-introduce[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{margin:0;--background: transparent}.media-introduce[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0}.media-tag[_ngcontent-%COMP%]   ion-button[color=dark][_ngcontent-%COMP%]::part(native){border-color:var(--ion-color-medium-tint)}.media-related[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-top: 0;--padding-bottom: 0;--padding-start: 0;--padding-end: 0;--inner-padding-top: 0;--inner-padding-bottom: 0;--inner-padding-start: 0;--inner-padding-end: 0;--border-width: 1px;--border-color: var(--ion-color-medium-tint);--border-radius: .5rem}.media-related[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{--size: 9rem;--border-radius: .375rem;margin:0}.media-related[_ngcontent-%COMP%]   .media-related-item[_ngcontent-%COMP%]{position:relative}.media-related[_ngcontent-%COMP%]   .media-related-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:absolute;top:0;left:0;display:inline-block;max-width:100%;line-height:20px;padding:0 5px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:14px;color:#fff}.list-media[_ngcontent-%COMP%]{min-height:200px}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{width:156px;margin:0;box-shadow:none}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:156px;height:156px;padding:5px;border-radius:6px;object-fit:contain;overflow:hidden;border:1px solid #E7F0EF;background:#fff;cursor:pointer;transition:padding .3s ease-in-out}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-img.svgedit[_ngcontent-%COMP%]{padding:45px}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{position:relative}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-img.audio[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;width:42px;height:42px;top:50%;left:50%;transform:translate(-50%,-50%);background-image:url(video-2.54e0cad43aa51646.svg);background-repeat:no-repeat;background-position:center center;background-size:cover}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-img.video[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;width:42px;height:42px;top:50%;left:50%;transform:translate(-50%,-50%);background-image:url(video-2.54e0cad43aa51646.svg);background-repeat:no-repeat;background-position:center center;background-size:cover}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-img.animation[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;width:42px;height:42px;top:50%;left:50%;transform:translate(-50%,-50%);background-image:url(video-2.54e0cad43aa51646.svg);background-repeat:no-repeat;background-position:center center;background-size:cover}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]:hover   ion-img[_ngcontent-%COMP%]{padding:0}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:0;color:#333}.list-media[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{height:24px;line-height:24px}.list-media[_ngcontent-%COMP%]   .media-type[_ngcontent-%COMP%]{display:none;padding:2px 4px;border-radius:6px;background:#33333380;color:#fff;text-align:center;font-size:13px;font-style:normal;text-transform:uppercase;font-weight:700;line-height:22px}.list-media[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style:none}.list-media[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover   .media-type[_ngcontent-%COMP%]{display:block}']}),l})()}];let Hi=(()=>{var t;class l{}return(t=l).\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.$C({type:t}),t.\u0275inj=i.G2t({imports:[E.iI.forChild(Yi),E.iI]}),l})();var Ji=d(3890);let zi=(()=>{var t;class l{}return(t=l).\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.$C({type:t}),t.\u0275inj=i.G2t({imports:[B.MD,K.YN,s.bv,Hi,Ji.x]}),l})()}}]);