"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4981],{1814:(ue,jt,p)=>{p.d(jt,{In:()=>ot,MA:()=>v,Mo:()=>j,NV:()=>E,S3:()=>k,dt:()=>yt,h8:()=>b,k0:()=>R});const k={fill:"transparent",stroke:"#129bff",strokeWidth:1},E={stroke:"#5F6CE1",strokeWidth:1,strokeLinecap:"round",strokeDasharrays:[4,2,1,2]},ot={fill:"#FFFFFF",stroke:"#5F6CE1",strokeWidth:1,width:7,height:7},j={fill:"transparent",stroke:"transparent",strokeWidth:1},yt={fill:"none",stroke:"#5F6CE1",strokeWidth:1},b={stroke:"#129bff",strokeWidth:1,strokeLinecap:"round",strokeDasharray:8},v={fill:"transparent"},R={fill:"none",stroke:"#999",strokeWidth:1,strokeDasharray:2}},7851:(ue,jt,p)=>{p.d(jt,{BG:()=>b,IX:()=>yt,Q8:()=>h,RZ:()=>R,SS:()=>v,T1:()=>S,Ug:()=>M,n2:()=>E,yo:()=>j});var k=p(5811);const E=_=>{var P;return null===(P=_.split(/(?=[MLCSQTAHVZmlcsqtahvz])/))||void 0===P?void 0:P.map(u=>{let K={type:u.substring(0,1)},B=(V=u.replace(/\s?\-?[0-9\.]+e-[0-9]+/g," 0").replace(/\,/g," ").replace(/\s?\-/g," -").replace(/(\.[0-9]+)(\.[0-9]+)/g,"$1 0$2").replace(/\-\./g,"-0.").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim())?V.split(/\s/).map(tt=>(0,k.q)(parseFloat(tt),1e6)):[];var V;return B.length&&(K.points=B),K})},j=_=>{let P=[],u=[],K=[],B=[];return _.forEach(V=>{switch(["M","L","C","S","Q","T"].includes(V.type)&&V.points&&V.points.forEach((Lt,st)=>{st%2==0?P.push(Lt):u.push(Lt)}),V.type){case"A":var tt;7==(null===(tt=V.points)||void 0===tt?void 0:tt.length)&&(K.push(V.points[5]),B.push(V.points[6]));break;case"H":var J;null!==(J=V.points)&&void 0!==J&&J.length&&(P.push(V.points[0]),K.push(V.points[0]));break;case"V":var I;null!==(I=V.points)&&void 0!==I&&I.length&&(u.push(V.points[0]),B.push(V.points[0]));break;case"a":var vt;if(7==(null===(vt=V.points)||void 0===vt?void 0:vt.length)){let Lt=P[P.length-1];P.push(Lt+V.points[5]),K.push(Lt+V.points[5]);let st=u[u.length-1];u.push(st+V.points[6]),B.push(st+V.points[6])}break;case"h":var Mt;if(null!==(Mt=V.points)&&void 0!==Mt&&Mt.length){let Lt=P[P.length-1];P.push(Lt+V.points[0]),K.push(Lt+V.points[0])}break;case"v":var Kt;if(null!==(Kt=V.points)&&void 0!==Kt&&Kt.length){let Lt=u[u.length-1];u.push(Lt+V.points[0]),B.push(Lt+V.points[0])}break;case"M":case"L":case"C":case"S":case"Q":case"T":var $t;null===($t=V.points)||void 0===$t||$t.forEach((Lt,st)=>{st%2==0?K.push(Lt):B.push(Lt)});break;case"m":case"l":case"c":case"s":case"q":case"t":var Ft;null===(Ft=V.points)||void 0===Ft||Ft.forEach((Lt,st)=>{if(st%2==0){let W=P[P.length-1];P.push(W+Lt),K.push(W+Lt)}else{let W=u[u.length-1];u.push(W+Lt),B.push(W+Lt)}})}}),{minX:Math.min.apply(null,K),minY:Math.min.apply(null,B),maxX:Math.max.apply(null,K),maxY:Math.max.apply(null,B)}},yt=(_,P)=>P.map(u=>{let K=[];switch(u.type){case"a":var B;7==(null===(B=u.points)||void 0===B?void 0:B.length)&&K.push([(0,k.q)(u.points[0]/_.width,1e6),(0,k.q)(u.points[1]/_.height,1e6),u.points[2],u.points[3],u.points[4],(0,k.q)(u.points[5]/_.width,1e6),(0,k.q)(u.points[6]/_.height,1e6)]);break;case"A":var V;7==(null===(V=u.points)||void 0===V?void 0:V.length)&&K.push([(0,k.q)(u.points[0]/_.width,1e6),(0,k.q)(u.points[1]/_.height,1e6),u.points[2],u.points[3],u.points[4],(0,k.q)((u.points[5]-_.x)/_.width,1e6),(0,k.q)((u.points[6]-_.y)/_.height,1e6)]);break;case"h":var tt;null!==(tt=u.points)&&void 0!==tt&&tt.length&&K.push([(0,k.q)(u.points[0]/_.width,1e6)]);break;case"H":var J;null!==(J=u.points)&&void 0!==J&&J.length&&K.push([(0,k.q)((u.points[0]-_.x)/_.width,1e6)]);break;case"v":var I;null!==(I=u.points)&&void 0!==I&&I.length&&K.push([(0,k.q)(u.points[0]/_.height,1e6)]);break;case"V":var vt;null!==(vt=u.points)&&void 0!==vt&&vt.length&&K.push([(0,k.q)((u.points[0]-_.y)/_.height,1e6)]);break;case"z":case"Z":break;case"M":case"L":case"C":case"S":case"Q":case"T":var Mt;if(null!==(Mt=u.points)&&void 0!==Mt&&Mt.length)for(let $t=0,Ft=u.points.length-1;$t<Ft;$t+=2)K.push([(0,k.q)((u.points[$t]-_.x)/_.width,1e6),(0,k.q)((u.points[$t+1]-_.y)/_.height,1e6)]);break;case"m":case"l":case"c":case"s":case"q":case"t":var Kt;if(null!==(Kt=u.points)&&void 0!==Kt&&Kt.length)for(let $t=0,Ft=u.points.length-1;$t<Ft;$t+=2)K.push([(0,k.q)(u.points[$t]/_.width,1e6),(0,k.q)(u.points[$t+1]/_.height,1e6)])}return K.length?{type:u.type,ratios:K}:{type:u.type}}),b=(_,P)=>P.map(u=>{switch(u.type){case"a":var K,B;return`${u.type}${null!==(K=null===(B=u.ratios)||void 0===B||null===(B=B.map(St=>{var it,qt,X,F,d,at,mt;return[(0,k.q)(_.width*(null!==(it=St[0])&&void 0!==it?it:0),1e6),(0,k.q)(_.height*(null!==(qt=St[1])&&void 0!==qt?qt:0),1e6),null!==(X=St[2])&&void 0!==X?X:0,null!==(F=St[3])&&void 0!==F?F:0,null!==(d=St[4])&&void 0!==d?d:0,(0,k.q)(_.width*(null!==(at=St[5])&&void 0!==at?at:0),1e6),(0,k.q)(_.height*(null!==(mt=St[6])&&void 0!==mt?mt:0),1e6)]}))||void 0===B||null===(B=B.map(St=>St.join(" ")))||void 0===B?void 0:B.join(" "))&&void 0!==K?K:""}`;case"A":var V,tt;return`${u.type}${null!==(V=null===(tt=u.ratios)||void 0===tt||null===(tt=tt.map(St=>{var it,qt,X,F,d,at,mt;return[(0,k.q)(_.width*(null!==(it=St[0])&&void 0!==it?it:0),1e6),(0,k.q)(_.height*(null!==(qt=St[1])&&void 0!==qt?qt:0),1e6),null!==(X=St[2])&&void 0!==X?X:0,null!==(F=St[3])&&void 0!==F?F:0,null!==(d=St[4])&&void 0!==d?d:0,(0,k.q)(_.x+_.width*(null!==(at=St[5])&&void 0!==at?at:0),1e6),(0,k.q)(_.y+_.height*(null!==(mt=St[6])&&void 0!==mt?mt:0),1e6)]}))||void 0===tt||null===(tt=tt.map(St=>St.join(" ")))||void 0===tt?void 0:tt.join(" "))&&void 0!==V?V:""}`;case"h":var J,I;return`${u.type}${null!==(J=null===(I=u.ratios)||void 0===I||null===(I=I.map(St=>{var it;return(0,k.q)(_.width*(null!==(it=St[0])&&void 0!==it?it:0),1e6)}))||void 0===I?void 0:I.join(" "))&&void 0!==J?J:""}`;case"H":var vt,Mt;return`${u.type}${null!==(vt=null===(Mt=u.ratios)||void 0===Mt||null===(Mt=Mt.map(St=>{var it;return(0,k.q)(_.x+_.width*(null!==(it=St[0])&&void 0!==it?it:0),1e6)}))||void 0===Mt?void 0:Mt.join(" "))&&void 0!==vt?vt:""}`;case"v":var Kt,$t;return`${u.type}${null!==(Kt=null===($t=u.ratios)||void 0===$t||null===($t=$t.map(St=>{var it;return(0,k.q)(_.height*(null!==(it=St[0])&&void 0!==it?it:0),1e6)}))||void 0===$t?void 0:$t.join(" "))&&void 0!==Kt?Kt:""}`;case"V":var Ft,Lt;return`${u.type}${null!==(Ft=null===(Lt=u.ratios)||void 0===Lt||null===(Lt=Lt.map(St=>{var it;return(0,k.q)(_.y+_.height*(null!==(it=St[0])&&void 0!==it?it:0),1e6)}))||void 0===Lt?void 0:Lt.join(" "))&&void 0!==Ft?Ft:""}`;case"z":case"Z":return u.type;case"M":case"L":case"C":case"S":case"Q":case"T":var st,W;return`${u.type}${null!==(st=null===(W=u.ratios)||void 0===W||null===(W=W.map(St=>{var it,qt;return[(0,k.q)(_.x+_.width*(null!==(it=St[0])&&void 0!==it?it:0),1e6),(0,k.q)(_.y+_.height*(null!==(qt=St[1])&&void 0!==qt?qt:0),1e6)]}))||void 0===W||null===(W=W.map(St=>St.join(" ")))||void 0===W?void 0:W.join(" "))&&void 0!==st?st:""}`;case"m":case"l":case"c":case"s":case"q":case"t":var _t,Ot;return`${u.type}${null!==(_t=null===(Ot=u.ratios)||void 0===Ot||null===(Ot=Ot.map(St=>{var it,qt;return[(0,k.q)(_.width*(null!==(it=St[0])&&void 0!==it?it:0),1e6),(0,k.q)(_.height*(null!==(qt=St[1])&&void 0!==qt?qt:0),1e6)]}))||void 0===Ot||null===(Ot=Ot.map(St=>St.join(" ")))||void 0===Ot?void 0:Ot.join(" "))&&void 0!==_t?_t:""}`;default:return""}}).join(""),v=_=>{return(P=_.replace(/\,/g," ").replace(/\-/g," -").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim())?P.split(/\s/).map(u=>parseFloat(u)):[];var P},R=_=>{let P=[],u=[];return _.forEach((K,B)=>{B%2==0?P.push(K):u.push(K)}),{minX:Math.min.apply(null,P),minY:Math.min.apply(null,u),maxX:Math.max.apply(null,P),maxY:Math.max.apply(null,u)}},M=(_,P)=>{let u=[];for(let K=0,B=P.length-1;K<B;K+=2)u.push([(P[K]-_.x)/_.width,(P[K+1]-_.y)/_.height]);return u},h=(_,P)=>P.map(u=>[(0,k.q)(_.x+_.width*u[0],1e6),(0,k.q)(_.y+_.height*u[1],1e6)]).map(u=>u.join(" ")).join(" "),S=(_,P)=>{let u=(_=>{let P=_.replace(/\s?\-?[0-9\.]+e-[0-9]+/g," 0").replace(/\,/g," ").replace(/\s?\-/g," -").replace(/(\.[0-9]+)(\.[0-9]+)/g,"$1 0$2").replace(/\-\./g,"-0.").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim().split(" ").map(u=>(0,k.q)(parseFloat(u),1e6));if(6==P.length)return{a:P[0],b:P[1],c:P[2],d:P[3],e:P[4],f:P[5]}})(P);return u?window.Snap.path.map(_,new window.Snap.Matrix(u.a,u.b,u.c,u.d,u.e,u.f)).toString():_}},9942:(ue,jt,p)=>{p.d(jt,{w:()=>A,I:()=>C});var k=p(4981),E=p(9054),ot=p(5811),j=/^#[a-fA-F0-9]+$/i,yt=/^rgba\((\d+),(\d+),(\d+),(\d+)\)$/i,b=/^rgb\((\d+),(\d+),(\d+)\)$/i;const v=Z=>{let _=null,P=null;if(Z)if("transparent"==Z)_="#000000",P=0;else if(Z.match(j))_=Z;else{let u=(Z=Z.replace(/\s+/g,"")).match(yt);if(u)_="#"+(256|u[1]).toString(16).slice(1)+(256|u[2]).toString(16).slice(1)+(256|u[3]).toString(16).slice(1),P=(0,ot.q)(parseFloat(u[4]),100);else{let K=Z.match(b);K&&(_="#"+(256|K[1]).toString(16).slice(1)+(256|K[2]).toString(16).slice(1)+(256|K[3]).toString(16).slice(1))}}return{hex:_,alpha:P}},C=Z=>S(null==Z?void 0:Z.url,null==Z?void 0:Z.path,null==Z?void 0:Z.src);var S=(Z,_,P)=>{var u,K;let B,V,tt,J;var I,vt;return Z&&(B=Z.replace(/\\/g,"/")),_&&(V=_.replace(/\\/g,"/")),P&&(tt=P.replace(/\\/g,"/")),V&&!B&&(B=(null===(I=k.icdt.config)||void 0===I?void 0:I.readfileuploadurl)+V),!tt||V||B||(V=tt.replace(/^[a-zA-Z0-9\-\_\/\\\:\.]+(upload|FileUpload|files|readfileupload|filereader|readfile)\//g,""),B=(null===(vt=k.icdt.config)||void 0===vt?void 0:vt.readfileuploadurl)+V),J=(null!==(u=B)&&void 0!==u?u:"").split("/").pop()||(null!==(K=V)&&void 0!==K?K:"").split("/").pop()||"",{url:B,path:V,name:J}};const A=Z=>{let _={x:0,y:0,width:Z.screen.w,height:Z.screen.h},P=[];return Z.data.forEach((u,K)=>{var B,V;let tt={id:"number"==typeof u.id?u.id:k.icdt.data.newSlideId,code:null===(B=u.id)||void 0===B?void 0:B.toString(),name:"string"==typeof u.id?u.id:`Trang ${K+1}`,svg:{viewBox:_,nodes:[]},test:(J=u.test2,J?(J.audiotrue&&(J.audiotrue=C({path:J.audiotrue.path})),J.audiofalse&&(J.audiofalse=C({path:J.audiofalse.path})),J.effecttrue&&(J.effecttrue=C({path:J.effecttrue.path})),J.effectfalse&&(J.effectfalse=C({path:J.effectfalse.path})),J.icontrue&&(J.icontrue=C({path:J.icontrue.path})),J.iconfalse&&(J.iconfalse=C({path:J.iconfalse.path})),J):{})};var J;u.background&&tt.svg&&(tt.svg.background=function(Z){return Z&&(null!==Z.match(/#([a-zA-Z0-9]+)/)||null!==Z.match(/rgb\([0-9]+,[0-9]+,[0-9]+\)/)||null!==Z.match(/rgba\([0-9]+,[0-9]+,[0-9]+,[0-9]+\)/))}(u.background)?{color:u.background}:function(Z){return Z&&null!==Z.match(/data:[^;]+;base64,/)}(u.background)?{base64:u.background}:function(Z){return Z&&null!==Z.match(/http(s)?:\/\//)}(u.background)?S(u.background):S(void 0,u.background)),jQuery(null!==(V=u.svg)&&void 0!==V?V:"").find(".svg-node").each((J,I)=>{var vt,Mt;let Kt=jQuery(I).parents(".indexs"),$t=Kt.attr("data-index"),Ft=Kt.attr("data-time"),Lt=null!==(vt=I.getAttribute("id"))&&void 0!==vt?vt:"0",st={id:parseInt(Lt),code:`${I.nodeName}-${I.getAttribute("id")}`,name:I.nodeName,idx:$t?parseInt($t):0,time:Ft?parseFloat(Ft):0,type:(()=>{switch(I.nodeName){case"polygon":return E.$.POLYGON;case"circle":return E.$.CIRCLE;case"ellipse":return E.$.ELLIPSE;case"line":return E.$.LINE;case"rect":return E.$.RECT;case"foreignObject":return E.$.FOREIGNOBJECT}return 0})(),size:(W=>{let _t=0,Ot=0,St=0,it=0,qt=null,X=null,F=parseFloat((null===(W=I.getAttribute("transform"))||void 0===W?void 0:W.replace("rotate(","").replace(")",""))||"0")||null;switch(I.nodeName){case"polygon":{var d,at;let mt=[],Pt=[],zt=999999999,Jt=999999999,Qt=0,At=0;qt=JSON.parse(I.getAttribute("ratios")||"[]"),X=null!==(d=null===(at=I.getAttribute("points"))||void 0===at?void 0:at.split(",").map(function(pt){return pt.split(" ").map(function(te){return parseFloat(te)})}))&&void 0!==d?d:[],X.forEach(function(pt){mt.push(pt[0]),Pt.push(pt[1])}),zt=Math.min.apply(null,mt),Jt=Math.min.apply(null,Pt),Qt=Math.max.apply(null,mt),At=Math.max.apply(null,Pt),_t=zt,Ot=Jt,St=Qt-_t,it=At-Ot;break}case"circle":{let mt=parseFloat(I.getAttribute("cx")||"0"),Pt=parseFloat(I.getAttribute("cy")||"0"),zt=parseFloat(I.getAttribute("r")||"0");_t=mt-zt,Ot=Pt-zt,St=2*zt,it=2*zt;break}case"ellipse":{let mt=parseFloat(I.getAttribute("cx")||"0"),Pt=parseFloat(I.getAttribute("cy")||"0"),zt=parseFloat(I.getAttribute("rx")||"0"),Jt=parseFloat(I.getAttribute("ry")||"0");_t=mt-zt,Ot=Pt-Jt,St=2*zt,it=2*Jt;break}case"line":{let mt=parseFloat(I.getAttribute("x1")||"0"),Pt=parseFloat(I.getAttribute("y1")||"0"),zt=parseFloat(I.getAttribute("x2")||"0"),Jt=parseFloat(I.getAttribute("y2")||"0"),Qt=999999999,At=999999999,pt=0,te=0;Qt=Math.min(mt,zt),At=Math.min(Pt,Jt),pt=Math.max(mt,zt),te=Math.max(Pt,Jt),_t=Qt,Ot=At,St=pt-_t,it=te-Ot,qt=[[(mt-_t)/(St||1),(Pt-Ot)/(it||1)],[(zt-_t)/(St||1),(Jt-Ot)/(it||1)]];break}case"rect":case"foreignObject":_t=parseFloat(I.getAttribute("x")||"0"),Ot=parseFloat(I.getAttribute("y")||"0"),St=parseFloat(I.getAttribute("width")||"0"),it=parseFloat(I.getAttribute("height")||"0")}return Object.assign({},{x:_t,y:Ot,width:St,height:it,ratios:qt,points:X,rotate:F})})(),attribute:(()=>{let W={};switch(I.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":{var _t,Ot,St,it,qt,X;let F=null!==(_t=I.getAttribute("fill"))&&void 0!==_t?_t:null,d=null!==(Ot=I.getAttribute("stroke"))&&void 0!==Ot?Ot:null,at=null!==(St=parseFloat(I.getAttribute("stroke-width")||"0"))&&void 0!==St?St:null,mt=null!==(it=I.getAttribute("stroke-linecap"))&&void 0!==it?it:null,Pt=null!==(qt=I.getAttribute("stroke-linejoin"))&&void 0!==qt?qt:null,zt=null!==(X=parseFloat(I.getAttribute("stroke-dasharray")||"0"))&&void 0!==X?X:null;Object.assign(W,{fill:F,stroke:d,strokeWidth:at,strokeLinecap:mt,strokeLinejoin:Pt,strokeDasharray:zt});break}}return W})(),style:(()=>{let W={};switch(I.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":{let St=jQuery(I).find(".svg-container");if(St.length){let qt=parseFloat(St.css("border-width")||"0")||null,X=St.css("border-style")||null,F=St.css("border-color")||null,d=null,at=St.css("background-color")||null,mt=null;(()=>{let{hex:Pt,alpha:zt}=v(F);F=Pt,d=zt})(),(()=>{let{hex:Pt,alpha:zt}=v(at);at=Pt,mt=zt})(),Object.assign(W,{borderWidth:qt,borderStyle:X,borderColor:F,borderOpacity:d,backgroundColor:at,backgroundOpacity:mt})}let it=jQuery(I).find(".svg-editor-content");if(it.length){var _t,Ot;let qt=JSON.parse((it.attr("data-style")||"{}").replace(/\&quot\;/gm,'"')),{hex:X,alpha:F}=v(qt.TextColor);Object.assign(W,{fontFamily:null!==(_t=qt.FontFamily)&&void 0!==_t?_t:null,fontSize:null!==(Ot=qt.FontSize)&&void 0!==Ot?Ot:null,color:X,opacity:F})}break}}return W})(),source:(()=>{let W={};switch(I.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":if(Kt.hasClass("editors")){let At=jQuery(I).find(".svg-editor-content");if(At.length){var _t;let pt=At.html(),te=null!==(_t=(null!=pt?pt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==_t?_t:[];Object.assign(W,{type:"html",html:{htmlContent:pt,variableKeywords:te}})}}else if(Kt.hasClass("inputs")||Kt.hasClass("textareas"))Object.assign(W,{type:"input",input:{input:!!jQuery(I).find("input").length,textarea:!!jQuery(I).find("textarea").length}});else if(Kt.hasClass("tests")){let At=jQuery(I).find(".svg-test");if(Kt.hasClass("tests-truefalse")){var Ot,St;let pt=At.find(".svg-editor-content").html(),te=null!==(Ot=(null!=pt?pt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==Ot?Ot:[];Object.assign(W,{type:"test",test:{type:"truefalse",truefalse:{iscorrect:null===(St=u.test2.truefalse)||void 0===St?void 0:St.includes(Lt)}},html:{htmlContent:pt,variableKeywords:te}})}else if(Kt.hasClass("tests-singlechoice")){var it,qt;let pt=At.find(".svg-editor-content").html(),te=null!==(it=(null!=pt?pt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==it?it:[];Object.assign(W,{type:"test",test:{type:"singlechoice",singlechoice:{iscorrect:null===(qt=u.test2.singlechoice)||void 0===qt?void 0:qt.includes(Lt)}},html:{htmlContent:pt,variableKeywords:te}})}else if(Kt.hasClass("tests-multichoice")){var X,F;let pt=At.find(".svg-editor-content").html(),te=null!==(X=(null!=pt?pt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==X?X:[];Object.assign(W,{type:"test",test:{type:"multichoice",multichoice:{iscorrect:null===(F=u.test2.multichoice)||void 0===F?void 0:F.includes(Lt)}},html:{htmlContent:pt,variableKeywords:te}})}else if(Kt.hasClass("tests-fill")){var d,at;let pt=At.find(".svg-editor-content").html(),te=null!==(d=(null!=pt?pt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==d?d:[],Y=null!==(at=(null!=pt?pt:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==at?at:[];Y=Y.filter((c,Q,gt)=>gt.indexOf(c)==Q),Object.assign(W,{type:"test",test:{type:"fill",fill:Y.map(c=>{var Q;return{key:c,value:null===(Q=u.test2.fill)||void 0===Q||null===(Q=Q.find(gt=>gt.id==Lt))||void 0===Q||null===(Q=Q.vals)||void 0===Q?void 0:Q.map(gt=>gt.text).filter(gt=>!["",null,void 0,NaN].includes(gt))}})},html:{htmlContent:pt,variableKeywords:te,fillKeywords:Y}})}else if(Kt.hasClass("tests-matching")){if(At.hasClass("svg-test-empty"))Object.assign(W,{type:"test",test:{type:"matching-empty",matching:{key:At.attr("data-name")||null}}});else if(At.hasClass("svg-test-content")){var mt;let pt=At.find(".svg-editor-content").html(),te=null!==(mt=(null!=pt?pt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==mt?mt:[];Object.assign(W,{type:"test",test:{type:"matching-content",matching:{key:At.attr("data-name")||null}},html:{htmlContent:pt,variableKeywords:te}})}}else if(Kt.hasClass("tests-speech")){var Pt;Object.assign(W,{type:"speech",speech:{value:null===(Pt=u.test2.speech)||void 0===Pt||null===(Pt=Pt.find(pt=>pt.id==Lt))||void 0===Pt||null===(Pt=Pt.vals)||void 0===Pt?void 0:Pt.map(pt=>pt.text).filter(pt=>!["",null,void 0,NaN].includes(pt))}})}else if(Kt.hasClass("tests-submit")){let pt=jQuery(I).find(".svg-container img");Object.assign(W,{type:"test",test:{type:"submit"},image:S(pt.attr("url"),pt.attr("path"),pt.attr("src"))})}}else if(Kt.hasClass("images")){let At=jQuery(I).find(".svg-editor-content img");if(At.length)Object.assign(W,{type:"image",image:S(At.attr("url"),At.attr("path"),At.attr("src"))});else{let pt=jQuery(I).find("iframe");Object.assign(W,{type:"iframe",iframe:S(pt.attr("url"),pt.attr("path"),pt.attr("src"))})}}else if(Kt.hasClass("sounds")){let At=jQuery(I).find(".svg-editor-content img");At.length&&Object.assign(W,{type:"image",image:S(At.attr("url"),At.attr("path"),At.attr("src"))})}else if(Kt.hasClass("htmls")){let At=jQuery(I).find("iframe");At.length&&Object.assign(W,{type:"iframe",iframe:S(At.attr("url"),At.attr("path"),At.attr("src"))})}else if(Kt.hasClass("svgs")){let At=jQuery(I).find("svg");var zt,Jt;At.length&&Object.assign(W,{type:"svg",svg:Object.assign(S(At.attr("url"),At.attr("path"),At.attr("src")),{svgContent:null!==(zt=null===(Jt=At.get(0))||void 0===Jt?void 0:Jt.outerHTML)&&void 0!==zt?zt:null})})}else if(Kt.hasClass("medias")){let At=jQuery(I).find(".media-item");if(At.length)switch(At.attr("type")){case"audio":Object.assign(W,{type:"audio",audio:S(At.attr("url"),At.attr("path"),At.attr("src"))});break;case"video":Object.assign(W,{type:"video",video:S(At.attr("url"),At.attr("path"),At.attr("src"))});break;case"file":Object.assign(W,{type:"file",file:S(At.attr("url"),At.attr("path"),At.attr("src"))});break;default:var Qt;Object.assign(W,{type:"link",link:{url:null!==(Qt=At.attr("url"))&&void 0!==Qt?Qt:null}})}let pt=jQuery(I).find("img");pt.length&&(Object.assign(W,{image:S(pt.attr("url"),pt.attr("path"),pt.attr("src"))}),W.type||Object.assign(W,{type:"image"}))}}return W})(),animate:(W=>{let _t={},Ot=null===(W=u.animates)||void 0===W?void 0:W.find(St=>St.elementId==Lt);return Ot&&Object.assign(_t,{value:Ot.value}),_t})(),interactive:(()=>{let W={},_t=u.actions.show.filter(St=>St.elementId==Lt&&St.active);_t.length&&(W.show={},_t.forEach(St=>{let{source:it}=St;switch(null==it?void 0:it.type){case"work":var qt,X,F,d,at;W.show.action={},Object.assign(W.show.action,{value:null!==(qt=it.value)&&void 0!==qt?qt:null,iteration:null!==(X=it.iteration)&&void 0!==X?X:null,finish:null!==(F=it.end)&&void 0!==F?F:null,time:null!==(d=it.time)&&void 0!==d?d:null,points:null!==(at=it.points)&&void 0!==at?at:null});break;case"audio":var mt,Pt,zt;W.show.audio={},Object.assign(W.show.audio,{source:S(null,null,it.url),iteration:null!==(mt=it.iteration)&&void 0!==mt?mt:null,finish:null!==(Pt=it.end)&&void 0!==Pt?Pt:null,time:null!==(zt=it.time)&&void 0!==zt?zt:null,async:-1==it.iteration?"change-slide":"change-node"});break;case"node":case"node2":var Jt,Qt,At,pt,te,Y,c,Q,gt,dt,q,H,rt,L,et;it.options.includes("show")&&(W.show.triggershow={},Object.assign(W.show.triggershow,{id:null!==(Jt=parseInt(null!==(Qt=it.id)&&void 0!==Qt?Qt:"0"))&&void 0!==Jt?Jt:null,ids:null===(At=it.ids)||void 0===At?void 0:At.map(Et=>parseInt(Et)),async:null!==(pt=it.async)&&void 0!==pt?pt:null,time:null!==(te=it.time)&&void 0!==te?te:null})),it.options.includes("run")&&(W.show.triggerrun={},Object.assign(W.show.triggerrun,{id:null!==(Y=parseInt(null!==(c=it.id)&&void 0!==c?c:"0"))&&void 0!==Y?Y:null,ids:null===(Q=it.ids)||void 0===Q?void 0:Q.map(Et=>parseInt(Et)),async:null!==(gt=it.async)&&void 0!==gt?gt:null,time:null!==(dt=it.time)&&void 0!==dt?dt:null})),it.options.includes("hide")&&(W.show.triggerhide={},Object.assign(W.show.triggerhide,{id:null!==(q=parseInt(null!==(H=it.id)&&void 0!==H?H:"0"))&&void 0!==q?q:null,ids:null===(rt=it.ids)||void 0===rt?void 0:rt.map(Et=>parseInt(Et)),async:null!==(L=it.async)&&void 0!==L?L:null,time:null!==(et=it.time)&&void 0!==et?et:null}))}}));let Ot=u.actions.click.filter(St=>St.elementId==Lt&&St.active);return Ot&&(W.click={},Ot.forEach(St=>{let{source:it}=St;switch(null==it?void 0:it.type){case"work":var qt,X,F,d,at;W.click.action={},Object.assign(W.click.action,{value:null!==(qt=it.value)&&void 0!==qt?qt:null,iteration:null!==(X=it.iteration)&&void 0!==X?X:null,finish:null!==(F=it.end)&&void 0!==F?F:null,time:null!==(d=it.time)&&void 0!==d?d:null,points:null!==(at=it.points)&&void 0!==at?at:null});break;case"audio":var mt,Pt,zt;W.click.audio={},Object.assign(W.click.audio,{source:S(null,null,it.url),iteration:null!==(mt=it.iteration)&&void 0!==mt?mt:null,finish:null!==(Pt=it.end)&&void 0!==Pt?Pt:null,time:null!==(zt=it.time)&&void 0!==zt?zt:null,async:-1==it.iteration?"change-slide":"change-node"});break;case"node":case"node2":var Jt,Qt,At,pt,te,Y,c,Q,gt,dt,q,H,rt,L,et;it.options.includes("show")&&(W.click.triggershow={},Object.assign(W.click.triggershow,{id:null!==(Jt=parseInt(null!==(Qt=it.id)&&void 0!==Qt?Qt:"0"))&&void 0!==Jt?Jt:null,ids:null===(At=it.ids)||void 0===At?void 0:At.map(Rt=>parseInt(Rt)),async:null!==(pt=it.async)&&void 0!==pt?pt:null,time:null!==(te=it.time)&&void 0!==te?te:null})),it.options.includes("run")&&(W.click.triggerrun={},Object.assign(W.click.triggerrun,{id:null!==(Y=parseInt(null!==(c=it.id)&&void 0!==c?c:"0"))&&void 0!==Y?Y:null,ids:null===(Q=it.ids)||void 0===Q?void 0:Q.map(Rt=>parseInt(Rt)),async:null!==(gt=it.async)&&void 0!==gt?gt:null,time:null!==(dt=it.time)&&void 0!==dt?dt:null})),it.options.includes("hide")&&(W.click.triggerhide={},Object.assign(W.click.triggerhide,{id:null!==(q=parseInt(null!==(H=it.id)&&void 0!==H?H:"0"))&&void 0!==q?q:null,ids:null===(rt=it.ids)||void 0===rt?void 0:rt.map(Rt=>parseInt(Rt)),async:null!==(L=it.async)&&void 0!==L?L:null,time:null!==(et=it.time)&&void 0!==et?et:null}));break;case"slide":var Et;W.click.slide={},Object.assign(W.click.slide,{id:parseInt(null!==(Et=it.id)&&void 0!==Et?Et:"0")||it.num||null,code:it.id})}})),W})(),variable:(W=>{let _t={};var Ot;I.getAttribute("data-variable")&&(_t.input={},Object.assign(_t.input,{variable:null!==(Ot=I.getAttribute("data-variable"))&&void 0!==Ot?Ot:null}));let St=null===(W=u.nodes)||void 0===W||null===(W=W.find(d=>d.id==Lt))||void 0===W?void 0:W.variable;var it,qt,X,F;return St&&(_t.click={},Object.assign(_t.click,{variable:null!==(it=St.variable)&&void 0!==it?it:null,operator:null!==(qt=St.operator)&&void 0!==qt?qt:null,valuetype:null!==(X=St.valuetype)&&void 0!==X?X:null,value:null!==(F=St.value)&&void 0!==F?F:null})),_t})()};null===(Mt=tt.svg)||void 0===Mt||Mt.nodes.push(st)}),P.push(tt)}),{screen:{width:Z.screen.w,height:Z.screen.h},data:{slides:P},variable:Z.variable}}},644:(ue,jt,p)=>{p.d(jt,{Dx:()=>b,aY:()=>M,qp:()=>R,qz:()=>yt,sV:()=>v,yR:()=>h});var k=p(5861),E=p(9422);E.config({driver:[E.INDEXEDDB,E.LOCALSTORAGE,E.WEBSQL],name:"_localDataDB",version:1});const j={create:(C=(0,k.Z)(function*(){return E}),function(){return C.apply(this,arguments)}),get:function(){var C=(0,k.Z)(function*(S){return E.getItem(S)});return function(A){return C.apply(this,arguments)}}(),set:function(){var C=(0,k.Z)(function*(S,A){return E.setItem(S,A)});return function(A,Z){return C.apply(this,arguments)}}()},yt=function(){var C=(0,k.Z)(function*(S){yield j.create();var A=(yield j.get("icdt-data"))||[];"function"==typeof S.callback&&S.callback(A)});return function(A){return C.apply(this,arguments)}}(),b=function(){var C=(0,k.Z)(function*(S){yield j.create(),S.params=S.params||{};try{yield j.set("icdt-data",S.params),"function"==typeof S.callback&&S.callback(S.params)}catch(A){"function"==typeof S.callback&&S.callback(null),console.error(A)}});return function(A){return C.apply(this,arguments)}}(),v=function(){var C=(0,k.Z)(function*(S){yield j.create();try{var A=(yield j.get("icdt-config"))||{};"function"==typeof S.callback&&S.callback(A)}catch(Z){"function"==typeof S.callback&&S.callback(null),console.error(Z)}});return function(A){return C.apply(this,arguments)}}(),R=function(){var C=(0,k.Z)(function*(S){yield j.create(),S.params=S.params||{};try{yield j.set("icdt-config",S.params),"function"==typeof S.callback&&S.callback(S.params)}catch(A){"function"==typeof S.callback&&S.callback(null),console.error(A)}});return function(A){return C.apply(this,arguments)}}(),M=function(){var C=(0,k.Z)(function*(S){yield j.create();try{var A=(yield j.get("icdt-clipboard"))||{};"function"==typeof S.callback&&S.callback(A)}catch(Z){"function"==typeof S.callback&&S.callback(null),console.error(Z)}});return function(A){return C.apply(this,arguments)}}(),h=function(){var C=(0,k.Z)(function*(S){yield j.create(),S.params=S.params||{};try{yield j.set("icdt-clipboard",S.params),"function"==typeof S.callback&&S.callback(S.params)}catch(A){"function"==typeof S.callback&&S.callback(null),console.error(A)}});return function(A){return C.apply(this,arguments)}}();var C},9359:(ue,jt,p)=>{p.d(jt,{E:()=>k});const k=(E,ot)=>{if(!E)return"";let j=E.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i),yt=(j&&j[4]||"").trim(),b=j?(256|j[1]).toString(16).slice(1)+(256|j[2]).toString(16).slice(1)+(256|j[3]).toString(16).slice(1):E;if("0"==yt)return"transparent";if(ot){let v;v=""!==yt?yt:"01",v=(255*v|256).toString(16).slice(1),b+=v}return console.log(`lib_rgba2hex: ${E} -> ${b}`),`#${b}`}},1687:(ue,jt,p)=>{p.d(jt,{O:()=>k});const k={RESIZE_GROUP:"icdt-resize-g",SELECT_GROUP:"icdt-select-g",SCAN_GROUP:"icdt-scan-g",CREATE_GROUP:"icdt-create-g",INTERACTIVE_GROUP:"icdt-interactive-g",INDEX_GROUP:"icdt-index-g",BACKGROUND_GROUP:"icdt-background-g",TEST_GROUP:"icdt-test-g"}},9125:(ue,jt,p)=>{p.d(jt,{D:()=>k});const k={DRAW:1,HIGHTLIGH:2,INTERACTIVE:3}},968:(ue,jt,p)=>{p.d(jt,{_:()=>k});const k={POINTER:0,HAND:1,PEN:2,SHAPE:3,FOREIGNOBJECT:6,IMAGE:7,TEXT:4,ERASER:5,INDEX:8}},4714:(ue,jt,p)=>{p.d(jt,{D:()=>k});const k={TRIANGLE_ISOSCELES:3,TRIANGLE_EQUILATERAL:31,RECTANGLE:4,PENTAGON:5,HEXAGON:6,BOOKMARK:101,COMMENT:102,CROSS:104,ARROW_ONEWAY:201,ARROW_TWOWAY:202,STAR_FOUR:304,STAR_FIVE:305,STAR_SIX:306}},9054:(ue,jt,p)=>{p.d(jt,{$:()=>k});const k={GROUP:0,CIRCLE:1,ELLIPSE:2,LINE:5,RECT:3,POLYGON:4,FOREIGNOBJECT:6,IMAGE:9,TEXT:7,PATH:8}},5818:(ue,jt,p)=>{p.d(jt,{t:()=>k});const k={TEXT:900,IMAGE:901,AUDIO:902,VIDEO:903,LINK:904,ZIP:905,HTML:906,TRACK:907,OFFICE:908,PDF:909,PHET:910,IMAGE_ANIMATION:911,SCORM:912}},4981:(ue,jt,p)=>{p.d(jt,{icdt:()=>bt});var k=p(968),E=p(7492),ot=p(1687),j=p(4318),yt=p(6816),b=p(666),v=p(3171);const h=D=>{var i,n,r,o,a,m,y;let g=(null===(i=D.mouseEvent)||void 0===i?void 0:i.target)||(null===(n=D.touchEvent)||void 0===n?void 0:n.target),T=(null===(r=g)||void 0===r?void 0:r.getAttribute("id"))||"",w=null===(o=g)||void 0===o?void 0:o.nodeName;bt.dataSelect.nodeName.includes(w)||(g=jQuery(g).parents("foreignObject").get(0),g&&(T=g.getAttribute("id")||"",w=g.nodeName));let z=(null===(a=g)||void 0===a||null===(a=a.parentNode)||void 0===a?void 0:a.getAttribute("id"))||"";var N,ht;if([ot.O.RESIZE_GROUP,ot.O.SELECT_GROUP].includes(z))return null===(N=D.mouseEvent)||void 0===N||N.stopPropagation(),void(null===(ht=D.mouseEvent)||void 0===ht||ht.preventDefault());if(null!==(m=D.mouseEvent)&&void 0!==m&&m.altKey||null!==(y=D.touchEvent)&&void 0!==y&&y.altKey||!T||T.match(/[^0-9]/)||!bt.dataSelect.nodeName.includes(w)){var ft;bt.dataSelect.ids.length&&(bt.dataSelect.ids=[]),(0==(null===(ft=D.mouseEvent)||void 0===ft?void 0:ft.button)||D.touchEvent)&&(D=>{let a=(0,E.g1)(ot.O.SCAN_GROUP,"g"),m=(0,j.bH)(0,0,1,1);(0,E.vl)(a,m),((D,i,n)=>{(0,yt.A)(D,{start:a=>{},move:(a,m)=>{((a,m,y,g)=>{i=(0,j.bH)(a,m,y,g),(0,E.vl)(n,i)})(m[0][0],m[0][1],a.x,a.y)},end:(a,m)=>{null==n||n.remove(),bt.dataSelect.ids=bt.data.getNodeInArea(Math.min(m[0][0],a.x),Math.min(m[0][1],a.y),Math.max(m[0][0],a.x),Math.max(m[0][1],a.y));let y=bt.dataSelect.nodes;1==y.length?(0,b.y)(y[0]):y.length>1&&(0,v.Q)(y)}})})(D,m,a)})(D)}else{var xt,Nt;let Zt=parseFloat(T||"0");bt.dataSelect.ids=null!==(xt=D.mouseEvent)&&void 0!==xt&&xt.shiftKey||null!==(Nt=D.touchEvent)&&void 0!==Nt&&Nt.shiftKey?[Zt].concat(bt.dataSelect.ids).filter((ve,me,pe)=>pe.indexOf(ve)==me):[Zt];let ye=bt.dataSelect.nodes;ye.length>1?(0,v.Q)(ye):1==ye.length&&(0,b.y)(ye[0])}};class S{constructor(){let{x:i,y:n}=bt.screen.dislocation;var r=(o,a,m,y)=>{bt.screen.move({x:i,y:n},{x:m-o,y:y-a})};return{start:o=>{},move:(o,a)=>{r(a[0][0],a[0][1],o.x,o.y)},end:(o,a)=>{r(a[0][0],a[0][1],o.x,o.y)}}}}var A=p(9054),Z=p(4714);const _=[{name:"tam gi\xe1c vu\xf4ng",type:Z.D.TRIANGLE_ISOSCELES,ratios:[[0,0],[1,1],[0,1]]},{name:"tam gi\xe1c c\xe2n",type:Z.D.TRIANGLE_EQUILATERAL,ratios:[[.5,0],[0,1],[1,1]]},{name:"h\xecnh ch\u1eef nh\u1eadt",type:Z.D.RECTANGLE,ratios:[[0,0],[1,0],[1,1],[0,1]]},{name:"h\xecnh ng\u0169 gi\xe1c \u0111\u1ec1u",type:Z.D.PENTAGON,ratios:[[.5,0],[1,.4],[.8,1],[.2,1],[0,.4]]},{name:"h\xecnh l\u1ee5c gi\xe1c \u0111\u1ec1u",type:Z.D.HEXAGON,ratios:[[.5,0],[1,.25],[1,.75],[.5,1],[0,.75],[0,.25]]},{name:"khung \u0111\xe1nh d\u1ea5u v\u1ecb tr\xed",type:Z.D.BOOKMARK,ratios:[[0,0],[1,0],[1,.8],[.5,1],[0,.8]]},{name:"khung \u0111\xe1nh tr\xf2 chuy\u1ec7n",type:Z.D.COMMENT,ratios:[[0,0],[1,0],[1,.9],[.3,.9],[.2,1],[.1,.9],[0,.9]]},{name:"h\xecnh ch\u1eef th\u1eadp",type:Z.D.CROSS,ratios:[[0,.3],[.3,.3],[.3,0],[.7,0],[.7,.3],[1,.3],[1,.7],[.7,.7],[.7,1],[.3,1],[.3,.7],[0,.7]]},{name:"h\xecnh m\u0169i t\xean 1 chi\u1ec1u",type:Z.D.ARROW_ONEWAY,ratios:[[0,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[0,.8]]},{name:"h\xecnh m\u0169i t\xean 2 chi\u1ec1u",type:Z.D.ARROW_TWOWAY,ratios:[[.2,0],[.2,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[.2,.8],[.2,1],[0,.5]]},{name:"h\xecnh ng\xf4i sao 4 c\xe1nh",type:Z.D.STAR_FOUR,ratios:[[.5,0],[.65,.35],[1,.5],[.65,.65],[.5,1],[.35,.65],[0,.5],[.35,.35]]},{name:"h\xecnh ng\xf4i sao 5 c\xe1nh",type:Z.D.STAR_FIVE,ratios:[[.5,0],[.625,.4],[1,.4],[.675,.625],[.8,1],[.5,.775],[.2,1],[.325,.625],[0,.4],[.375,.4]]},{name:"h\xecnh ng\xf4i sao 6 c\xe1nh",type:Z.D.STAR_SIX,ratios:[[.5,0],[.667,.25],[1,.25],[.5+.334,.5],[1,.75],[.667,.75],[.5,1],[.334,.75],[0,.75],[.167,.5],[0,.25],[.334,.25]]}];var P=p(8619),u=p(5811);class K{constructor(){let i=(0,E.g1)(ot.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:o,size:a}=(0,P._)(Math.ceil(1e9*Math.random())),m=(y,g,T,w)=>{a=(0,j.bH)(y,g,T,w,{ratio:1}),a.x=(0,u.q)(a.x),a.y=(0,u.q)(a.y),a.width=(0,u.q)(a.width),a.height=(0,u.q)(a.height),Object.assign(o,(0,j.sg)(A.$.CIRCLE,a,o)),(0,E.__)(r,o),(0,E.g$)(i,a)};return{start:y=>{m(y.x,y.y,y.x+a.width,y.y+a.height)},move:(y,g)=>{m(g[0][0],g[0][1],y.x,y.y)},end:(y,g)=>{(a.width<=16||a.height<=16)&&(a.width=80,a.height=80,a.x=a.x-a.width/2,a.y=a.y-a.height/2,Object.assign(o,(0,j.sg)(A.$.CIRCLE,a,o)),(0,E.__)(r,o)),bt.data.node=Object.assign({id:n,type:A.$.CIRCLE,name:"Circle"},{size:a,attribute:o}),null==i||i.remove()}}}}var B=p(8785);class V{constructor(){let i=(0,E.g1)(ot.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:o,size:a}=(0,B.r)(Math.ceil(1e9*Math.random()));var m=(y,g,T,w)=>{a=(0,j.bH)(y,g,T,w),a.x=(0,u.q)(a.x),a.y=(0,u.q)(a.y),a.width=(0,u.q)(a.width),a.height=(0,u.q)(a.height),Object.assign(o,(0,j.sg)(A.$.ELLIPSE,a,o)),(0,E.__)(r,o),(0,E.g$)(i,a)};return{start:y=>{m(y.x,y.y,y.x+a.width,y.y+a.height)},move:(y,g)=>{m(g[0][0],g[0][1],y.x,y.y)},end:(y,g)=>{(a.width<=16||a.height<=16)&&(a.width=90,a.height=60,a.x=a.x-a.width/2,a.y=a.y-a.height/2,Object.assign(o,(0,j.sg)(A.$.ELLIPSE,a,o)),(0,E.__)(r,o)),bt.data.node=Object.assign({id:n,type:A.$.ELLIPSE,name:"Ellipse"},{size:a,attribute:o}),null==i||i.remove()}}}}var tt=p(8054);class J{constructor(){let i=(0,E.g1)(ot.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:o,size:a}=(0,tt.f)(Math.ceil(1e9*Math.random()));var m=(y,g,T,w)=>{a=(0,j.bH)(y,g,T,w),a.x=(0,u.q)(a.x),a.y=(0,u.q)(a.y),a.width=(0,u.q)(a.width),a.height=(0,u.q)(a.height),Object.assign(o,(0,j.sg)(A.$.RECT,a,o)),(0,E.__)(r,o),(0,E.g$)(i,a)};return{start:y=>{m(y.x,y.y,y.x+a.width,y.y+a.height)},move:(y,g)=>{m(g[0][0],g[0][1],y.x,y.y)},end:(y,g)=>{(a.width<=16||a.height<=16)&&(a.width=80,a.height=80,a.x=a.x-a.width/2,a.y=a.y-a.height/2,Object.assign(o,(0,j.sg)(A.$.RECT,a,o)),(0,E.__)(r,o)),bt.data.node=Object.assign({id:n,type:A.$.RECT,name:"Rect"},{size:a,attribute:o}),null==i||i.remove()}}}}var I=p(2282);class vt{constructor(i){let n=(0,E.g1)(ot.O.CREATE_GROUP,"g"),r=i||[[0,0],[1,1],[0,1]],{nodeId:o,element:a,attribute:m,size:y}=(0,I.l)(Math.ceil(1e9*Math.random()));y.ratios=r;var g=(T,w,z,N)=>{y=(0,j.bH)(T,w,z,N,{ratios:r}),y.x=(0,u.q)(y.x),y.y=(0,u.q)(y.y),y.width=(0,u.q)(y.width),y.height=(0,u.q)(y.height),Object.assign(m,(0,j.sg)(A.$.POLYGON,y,m)),(0,E.__)(a,m),(0,E.g$)(n,y)};return{start:T=>{g(T.x,T.y,T.x+y.width,T.y+y.height)},move:(T,w)=>{g(w[0][0],w[0][1],T.x,T.y)},end:(T,w)=>{(y.width<=16||y.height<=16)&&(y.width=80,y.height=80,y.x=y.x-y.width/2,y.y=y.y-y.height/2,Object.assign(m,(0,j.sg)(A.$.POLYGON,y,m)),(0,E.__)(a,m)),bt.data.node=Object.assign({id:o,type:A.$.POLYGON,name:"Polygon"},{size:y,attribute:m}),null==n||n.remove()}}}}var Mt=p(4921);class Kt{constructor(){let i=(0,E.g1)(ot.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:o,size:a}=(0,Mt.W)(Math.ceil(1e9*Math.random()));return{start:y=>{},move:(y,g)=>{((y,g,T,w)=>{a=(0,j.bH)(y,g,T,w),a.x=(0,u.q)(a.x),a.y=(0,u.q)(a.y),a.width=(0,u.q)(a.width),a.height=(0,u.q)(a.height),Object.assign(o,(0,j.sg)(A.$.LINE,a,o)),(0,E.__)(r,o),(0,E.g$)(i,a)})(g[0][0],g[0][1],y.x,y.y)},end:(y,g)=>{g.length>=2?((a.width<=16||a.height<=16)&&(a.width=80,a.height=80,a.x=a.x-a.width/2,a.y=a.y-a.height/2,Object.assign(o,(0,j.sg)(A.$.LINE,a,o)),(0,E.__)(r,o)),bt.data.node=Object.assign({id:n,type:A.$.LINE,name:"Line"},{size:a,attribute:o})):null==r||r.remove(),null==i||i.remove()}}}}var $t=p(7851),Ft=p(9322);class Lt{constructor(){let{nodeId:i,element:n,attribute:r,size:o}=(0,Ft.G)(Math.ceil(1e9*Math.random())),m="";return{start:g=>{m=`M ${g.x} ${g.y} L ${g.x} ${g.y}`},move:(g,T)=>{((g,T)=>{m+=` ${g} ${T}`,n.setAttribute("d",m)})(g.x,g.y)},end:(g,T)=>{let w=(0,$t.n2)(m),{minX:z,minY:N,maxX:ht,maxY:ft}=(0,$t.yo)(w);o.x=z,o.y=N,o.width=ht-z||1,o.height=ft-N||1,o.ratioMaps=(0,$t.IX)(o,w),bt.data.node=Object.assign({id:i,type:A.$.PATH,name:"Path"},{size:o,attribute:r})}}}}var st=p(2875);class W{constructor(){let i=(0,E.g1)(ot.O.CREATE_GROUP,"g"),{nodeId:n,element:r,size:o,attribute:a,style:m,source:y}=(0,st.e)(Math.ceil(1e9*Math.random()));var g=(T,w,z,N)=>{o=(0,j.bH)(T,w,z,N),o.x=(0,u.q)(o.x),o.y=(0,u.q)(o.y),o.width=(0,u.q)(o.width),o.height=(0,u.q)(o.height),Object.assign(a,(0,j.sg)(A.$.FOREIGNOBJECT,o,a)),(0,E.__)(r,a),(0,E.g$)(i,o)};return{start:T=>{g(T.x,T.y,T.x+o.width,T.y+o.height)},move:(T,w)=>{g(w[0][0],w[0][1],T.x,T.y)},end:(T,w)=>{(o.width<=16||o.height<=16)&&(o.width=90,o.height=60,o.x=o.x-o.width/2,o.y=o.y-o.height/2,Object.assign(a,(0,j.sg)(A.$.FOREIGNOBJECT,o,a)),(0,E.__)(r,a)),bt.data.node=Object.assign({id:n,type:A.$.FOREIGNOBJECT,name:"ForeignObject"},{size:o,attribute:a,style:m,source:y}),null==i||i.remove()}}}}var _t=p(7210);class Ot{constructor(){var i,n;let r=(0,E.g1)(ot.O.CREATE_GROUP,"g"),{nodeId:o,element:a,size:m,attribute:y,source:g}=(0,_t.G)(Math.ceil(1e9*Math.random())),T=1;(z=>{if(!z)return;let N=new Image;N.onload=()=>{T=(0,u.q)(N.naturalWidth/N.naturalHeight,100)},N.onerror=ht=>{console.error(`ImgSrc load failed -> ${z}`,ht)},N.src=z})(null!==(i=null===(n=g.image)||void 0===n?void 0:n.url)&&void 0!==i?i:"");var w=(z,N,ht,ft)=>{m=(0,j.bH)(z,N,ht,ft,{ratio:T}),m.x=(0,u.q)(m.x),m.y=(0,u.q)(m.y),m.width=(0,u.q)(m.width),m.height=(0,u.q)(m.height),Object.assign(y,(0,j.sg)(A.$.IMAGE,m,y)),(0,E.__)(a,y),(0,E.g$)(r,m)};return{start:z=>{w(z.x,z.y,z.x+m.width,z.y+m.height)},move:(z,N)=>{w(N[0][0],N[0][1],z.x,z.y)},end:(z,N)=>{(m.width<=16||m.height<=16)&&(m.width=80,m.height=80,m.x=m.x-m.width/2,m.y=m.y-m.height/2,Object.assign(y,(0,j.sg)(A.$.IMAGE,m,y)),(0,E.__)(a,y)),bt.data.node=Object.assign({id:o,type:A.$.IMAGE,name:"Image"},{size:m,attribute:y,source:g}),null==r||r.remove()}}}}var it=p(4578),qt=p(9623);function d(D,i,n,r){return Math.sqrt(Math.pow(n-D,2)+Math.pow(r-i,2))}function at(D,i,n,r,o){return d(D,i,n,r)<o?1:0}function Pt(D,i,n,r,o,a,m){var y=[];return y.push(at(D,i,n,r,m)),y.push(at(D,i,o,a,m)),y.push(function mt(D,i,n,r,o,a,m){var y=[o-n,a-r],g=[D-n,i-r],T=[-y[1],y[0]],w=Math.sqrt(Math.pow(T[0],2)+Math.pow(T[1],2)),z=[T[0]/w,T[1]/w],N=Math.sqrt(Math.pow(y[0],2)+Math.pow(y[1],2)),ht=[y[0]/N,y[1]/N],ft=g[0]*ht[0]+g[1]*ht[1];if(ft<=0||ft>=N)return 0;var xt=g[0]*z[0]+g[1]*z[1];return xt>=m||xt<=-m?0:1}(D,i,n,r,o,a,m)),y}function zt(D,i,n,r,o){var a=[n-D,r-i],m=[-a[1],a[0]],y=Math.sqrt(Math.pow(m[0],2)+Math.pow(m[1],2)),g=[m[0]/y,m[1]/y];return[[D+o*g[0],i+o*g[1]],[D-o*g[0],i-o*g[1]],[n-o*g[0],r-o*g[1]],[n+o*g[0],r+o*g[1]]]}function Jt(D,i,n,r,o,a,m){var ft,y=[o-D,a-i],g=[n-D,r-i],T=Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2)),w=[g[0]/T,g[1]/T],z=y[0]*w[0]+y[1]*w[1],N=[D+z*w[0],i+z*w[1]],ht=Math.sqrt(Math.pow(o-N[0],2)+Math.pow(a-N[1],2));ft=0===ht?m:Math.sqrt(Math.pow(m,2)-Math.pow(ht,2));var xt=[D+z*w[0]+ft*w[0],i+z*w[1]+ft*w[1]];return xt[0]===D&&xt[1]===i?null:xt}function Qt(D,i,n,r,o,a,m){var y=[o-D,a-i],g=[n-D,r-i],T=[-g[1],g[0]],w=Math.sqrt(Math.pow(T[0],2)+Math.pow(T[1],2)),z=[T[0]/w,T[1]/w],N=y[0]*z[0]+y[1]*z[1],ht=Q([D,i],[n,r],[o,a]);if(Y([ht[0]-o,ht[1]-a])>=m)return null;var xt=Math.sqrt(Math.pow(m,2)-Math.pow(N,2)),Nt=[o-N*z[0],a-N*z[1]],Zt=Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2)),ye=[g[0]/Zt,g[1]/Zt],ve=[[Nt[0]-ye[0]*xt,Nt[1]-ye[1]*xt],[Nt[0]+ye[0]*xt,Nt[1]+ye[1]*xt]];return ve[0][0]===D&&ve[0][1]===i?null:ve}function At(D,i,n,r,o,a,m,y){var g,T,w,z,N,ht;return-(w=m-o)*(T=r-i)+(g=n-D)*(z=y-a)==0?null:(ht=(w*(i-a)-z*(D-o))/(-w*T+g*z),(N=(-T*(D-o)+g*(i-a))/(-w*T+g*z))>=0&&N<=1&&ht>=0&&ht<=1?[D+ht*g,i+ht*T]:null)}function pt(D,i,n,r,o,a,m,y,g,T){var w=zt(a,m,y,g,T),z=[];if(n[0]&&!n[1])z.push(Jt(D,i,r,o,a,m,T)),z.push(At(D,i,r,o,w[0][0],w[0][1],w[3][0],w[3][1])),z.push(At(D,i,r,o,w[1][0],w[1][1],w[2][0],w[2][1])),(N=Qt(D,i,r,o,y,g,T))&&z.push(N[0],N[1]);else if(!n[0]&&n[1])z.push(Jt(D,i,r,o,y,g,T)),z.push(At(D,i,r,o,w[0][0],w[0][1],w[3][0],w[3][1])),z.push(At(D,i,r,o,w[1][0],w[1][1],w[2][0],w[2][1])),(N=Qt(D,i,r,o,a,m,T))&&z.push(N[0],N[1]);else if(n[0]&&n[1])z.push(Jt(D,i,r,o,a,m,T)),z.push(At(D,i,r,o,w[0][0],w[0][1],w[3][0],w[3][1])),z.push(At(D,i,r,o,w[1][0],w[1][1],w[2][0],w[2][1])),z.push(Jt(D,i,r,o,y,g,T));else{var N=Qt(D,i,r,o,y,g,T),ht=Qt(D,i,r,o,a,m,T);N&&z.push(N[0],N[1]),ht&&z.push(ht[0],ht[1]),z.push(At(D,i,r,o,w[0][0],w[0][1],w[3][0],w[3][1])),z.push(At(D,i,r,o,w[1][0],w[1][1],w[2][0],w[2][1]))}for(var ft=[D,i],xt=0;xt<z.length;xt++)z[xt]&&d(z[xt][0],z[xt][1],r,o)<d(ft[0],ft[1],r,o)&&(ft=z[xt]);return ft[0]===D&&ft[1]===i?null:ft}function te(D,i,n,r,o,a,m,y,g){var T=zt(o,a,m,y,g),w=[],z=Qt(D,i,n,r,o,a,g);z&&w.push(z[0],z[1]),(z=Qt(D,i,n,r,m,y,g))&&w.push(z[0],z[1]),w.push(At(D,i,n,r,T[0][0],T[0][1],T[3][0],T[3][1])),w.push(At(D,i,n,r,T[1][0],T[1][1],T[2][0],T[2][1]));for(var N=[n,r],ht=[D,i],ft=0;ft<w.length;ft++)w[ft]&&d(w[ft][0],w[ft][1],D,i)<d(N[0],N[1],D,i)&&(N=w[ft]);for(var xt=0;xt<w.length;xt++)w[xt]&&d(w[xt][0],w[xt][1],n,r)<d(ht[0],ht[1],n,r)&&(ht=w[xt]);return N[0]===n&&N[1]===r||ht[0]===D&&ht[1]===i?null:[N,ht]}var Y=function(D){return Math.sqrt(D[0]*D[0]+D[1]*D[1])},Q=function(D,i,n){var r=[i[0]-D[0],i[1]-D[1]],o=Y(r);if(o<1e-6)return D;var a=[n[0]-D[0],n[1]-D[1]],m=(r[0]*a[0]+r[1]*a[1])/o;return m<0?D:m>o?i:[D[0]+r[0]*m/o,D[1]+r[1]*m/o]};class gt{constructor(){let{element:r,size:a}=(0,Ft.G)(Math.ceil(1e9*Math.random()));(0,E.__)(r,{stroke:"#ddd",strokeWidth:10,strokeLinecap:"round",strokeLinejoin:"round"});let m="";return{start:T=>{m=`M ${T.x} ${T.y} L ${T.x} ${T.y}`},move:(T,w)=>{((T,w)=>{m+=` ${T} ${w}`,r.setAttribute("d",m)})(T.x,T.y)},end:(T,w)=>{r.remove(),(T=>{let w=9999,z=9999,N=-9999,ht=-9999;T.forEach(xt=>{w=Math.min(w,xt[0]),z=Math.min(z,xt[1]),N=Math.max(N,xt[0]),ht=Math.max(ht,xt[1])}),a=(0,j.bH)(w,z,N,ht,{points:T}),bt.data.getNodeInArea(0,0,1920,1920,A.$.PATH).forEach(xt=>{let Zt=((D,i,n)=>{n=n||20;var r=[],o=function(w){var z=i[0][0],N=i[0][1],ht=0,ft=0;if(1!==w.length||at(w[0][0],w[0][1],z,N,n)){for(var xt;ht<w.length-1;){var Nt=w[ht],Zt=w[ht+1],ye=at(Nt[0],Nt[1],z,N,n),ve=at(Zt[0],Zt[1],z,N,n);if(ye&&ve)ft=++ht;else if(ye&&!ve)(me=Jt(Nt[0],Nt[1],Zt[0],Zt[1],z,N,n))?(w[ht]=me,ft=ht):ht++;else if(!ye&&ve){var me;(me=Jt(Zt[0],Zt[1],Nt[0],Nt[1],z,N,n))&&((xt=w.slice(ft,ht+1)).push(me),r.push(xt)),ft=++ht}else{var pe=Qt(Nt[0],Nt[1],Zt[0],Zt[1],z,N,n);pe?(((xt=w.slice(ft,ht+1))[xt.length-1][0]!==pe[0][0]||xt[xt.length-1][1]!==pe[0][1])&&xt.push(pe[0]),xt.length>1&&r.push(xt),w[ht]=pe[1],w[ht+1]&&w[ht+1][0]==pe[1][0]&&w[ht+1][1]==pe[1][1]&&ht++,ft=ht):ht++}}ft!==ht&&(xt=w.slice(ft,w.length))&&r.push(xt)}else r.push(w)},a=function(w,z){var Zt,N=i[z],ht=i[z+1],ft=0,xt=0;if(1!==w.length||-1!==(Nt=Pt(w[0][0],w[0][1],N[0],N[1],ht[0],ht[1],n)).indexOf(1)){for(;ft<w.length-1;){var ye=w[ft],ve=w[ft+1],Nt=Pt(ye[0],ye[1],N[0],N[1],ht[0],ht[1],n),me=Pt(ve[0],ve[1],N[0],N[1],ht[0],ht[1],n);if(-1!==Nt.indexOf(1)&&-1!==me.indexOf(1))xt=++ft;else if(-1!==Nt.indexOf(1)&&-1===me.indexOf(1))(pe=pt(ye[0],ye[1],Nt,ve[0],ve[1],N[0],N[1],ht[0],ht[1],n))?(w[ft]=pe,xt=ft):ft++;else if(-1===Nt.indexOf(1)&&-1!==me.indexOf(1)){var pe;(pe=pt(ve[0],ve[1],me,ye[0],ye[1],N[0],N[1],ht[0],ht[1],n))?((Zt=w.slice(xt,ft+1)).push(pe),r.push(Zt),xt=++ft):ft++}else{var xe=te(ye[0],ye[1],ve[0],ve[1],N[0],N[1],ht[0],ht[1],n);xe?(((Zt=w.slice(xt,ft+1))[Zt.length-1][0]!==xe[0][0]||Zt[Zt.length-1][1]!==xe[0][1])&&Zt.push(xe[0]),Zt.length>1&&r.push(Zt),w[ft]=xe[1],w[ft+1]&&w[ft+1][0]==xe[1][0]&&w[ft+1][1]==xe[1][1]&&ft++,xt=ft):ft++}}xt!==ft&&(Zt=w.slice(xt,w.length))&&r.push(Zt)}else r.push(w)};if(i=function F(D){var i=[];if(1===D.length)i=D;else{for(var n=0;n<D.length-1;)(D[n][0]!==D[n+1][0]||D[n][1]!==D[n+1][1])&&i.push(D[n]),n++;0!==D.length&&0===i.length&&i.push(D[0]),(D[D.length-1][0]!==D[i.length-1][0]||D[D.length-1][1]!==D[i.length-1][1])&&i.push(D[n])}return i}(i),1===i.length){for(var m=0;m<D.length;m++)o(D[m]);D=r}else for(var y=0;y<i.length-1;y++){for(m=0;m<D.length;m++)a(D[m],y);D=r,r=[]}for(var g=0;g<D.length;g++)for(var T=0;T<D[g].length;T++)D[g][T][0]=Math.round(D[g][T][0]),D[g][T][1]=Math.round(D[g][T][1]);return D})(bt.data.getNode(xt).size.points,T,2);console.log(Zt)})})(w)}}}}var q=p(1105);class H{constructor(){let i=(0,E.g1)(ot.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:o,size:a,source:m}=(0,q.$)(Math.ceil(1e9*Math.random())),y=(g,T,w,z)=>{a=(0,j.bH)(g,T,w,z),a.x=(0,u.q)(a.x),a.y=(0,u.q)(a.y),a.width=(0,u.q)(a.width),a.height=(0,u.q)(a.height),Object.assign(o,(0,j.sg)(A.$.TEXT,a,o)),(0,E.__)(r,o),(0,E.g$)(i,a)};return{start:g=>{y(g.x,g.y,g.x+a.width,g.y+a.height)},move:(g,T)=>{y(T[0][0],T[0][1],g.x,g.y)},end:(g,T)=>{(a.width<=16||a.height<=16)&&(a.width=80,a.height=80,a.x=a.x-a.width/2,a.y=a.y-a.height/2,Object.assign(o,(0,j.sg)(A.$.TEXT,a,o)),(0,E.__)(r,o)),bt.data.node=Object.assign({id:n,type:A.$.TEXT,name:"Text"},{size:a,attribute:o,source:m}),null==i||i.remove()}}}}var Et=p(4531),Rt=p(9125),wt=p(7797);var Ct=p(6358);class kt{constructor(){this._nodeName=["circle","ellipse","line","polygon","rect","text","path","image","foreignObject"],this._selected_Ids=[],this._fnChanges=[]}get nodeName(){return this._nodeName}get ids(){return this._selected_Ids}set ids(i){this._selected_Ids=i,this.change(this.ids)}get nodes(){return this._selected_Ids.map(i=>bt.data.getNode(i)).filter(i=>!i.isfake)}set onchange(i){this._fnChanges.push(i)}change(i){var n,r,o,a,m;null===(n=window.document.getElementById(ot.O.RESIZE_GROUP))||void 0===n||n.remove(),null===(r=window.document.getElementById(ot.O.SELECT_GROUP))||void 0===r||r.remove(),null===(o=window.document.getElementById(ot.O.SCAN_GROUP))||void 0===o||o.remove(),null===(a=window.document.getElementById(ot.O.CREATE_GROUP))||void 0===a||a.remove(),null===(m=window.document.getElementById(ot.O.INTERACTIVE_GROUP))||void 0===m||m.remove(),jQuery('[id^="icdt-temp-"]').remove(),this._fnChanges.forEach(y=>y(i))}deleteNode(){for(let i of this._selected_Ids){let n=bt.data.deleteNode(i);bt.history.push([{type:"delete",from:{id:n},to:{id:n}}])}bt.dataSelect.ids=[]}groupNode(){let i=[];if(bt.dataSelect.ids.length>=2){let n=bt.data.getNode(bt.dataSelect.ids[0]),{nodeId:r,attribute:o,size:a}=(0,Ct.m)(Math.ceil(1e9*Math.random()),void 0,n.pid?window.document.getElementById(n.pid):null);bt.data.node=Object.assign({id:r,type:A.$.GROUP,name:"G"},{size:a,attribute:o});for(let m of bt.dataSelect.ids)i.push(bt.data.addGroup(m,r))}if(i.length){bt.dataSelect.ids=i;let n=bt.dataSelect.nodes;1==n.length?(0,b.y)(n[0]):n.length>1&&(0,v.Q)(n)}}ungroupNode(){let i=[];for(let n of bt.dataSelect.ids)i.push(bt.data.unGroup(n));if(i.length){bt.dataSelect.ids=i;let n=bt.dataSelect.nodes;1==n.length?(0,b.y)(n[0]):n.length>1&&(0,v.Q)(n)}}}var ut=p(9942),Gt=p(5818);class ee{createNodeImage(i,n){var r,o,a,m;let{nodeId:g,element:T,size:w,attribute:z,source:N}=(0,_t.G)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(o=null==n?void 0:n.y)&&void 0!==o?o:50)-50,width:100,height:100},source:{type:"image",image:(0,ut.I)(i)}});(ht=>{if(!ht)return;let ft=new Image;ft.onload=()=>{let xt=(0,u.q)(ft.naturalWidth/ft.naturalHeight,100);xt>=1?(w.width=Math.min(ft.naturalWidth,512),w.height=(0,u.q)(w.width/xt,100)):(w.height=Math.min(ft.naturalHeight,512),w.width=(0,u.q)(w.height*xt,100)),w.x=(0,u.q)(w.x+50-w.width/2,100),w.y=(0,u.q)(w.y+50-w.height/2,100),Object.assign(z,(0,j.sg)(A.$.IMAGE,w,z)),(0,E.__)(T,z),bt.data.node=Object.assign({id:g,type:A.$.IMAGE,name:"Image"},{size:w,attribute:z,source:N})},ft.onerror=xt=>{console.error(`ImgSrc load failed -> ${ht}`,xt),null==T||T.remove()},ft.src=ht})(null!==(a=null===(m=N.image)||void 0===m?void 0:m.url)&&void 0!==a?a:"")}createNodeIframe(i,n){var r,o;let{nodeId:m,element:y,size:g,attribute:T,style:w,source:z}=(0,st.e)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(o=null==n?void 0:n.y)&&void 0!==o?o:50)-50,width:100,height:100},style:{},source:{type:"iframe",iframe:(0,ut.I)(i)}});(N=>{let ht=(null===(N=bt.data.slide)||void 0===N||null===(N=N.svg)||void 0===N?void 0:N.viewBox)||{x:0,y:0,width:100,height:100},ft=(0,u.q)(ht.width/ht.height,100);ft>=1?(g.width=Math.min(ht.width,512),g.height=(0,u.q)(g.width/ft,100)):(g.height=Math.min(ht.height,512),g.width=(0,u.q)(g.height*ft,100)),g.x=(0,u.q)(g.x+50-g.width/2,100),g.y=(0,u.q)(g.y+50-g.height/2,100),Object.assign(T,(0,j.sg)(A.$.IMAGE,g,T)),(0,E.__)(y,T),bt.data.node=Object.assign({id:m,type:A.$.FOREIGNOBJECT,name:"ForeignObject"},{size:g,attribute:T,style:w,source:z})})()}createNodeEmbed(i,n){var r,o;let a={x:50,y:50,width:640,height:360};i.type==Gt.t.AUDIO&&(a.width=480,a.height=110);let{nodeId:m,element:y,size:g,attribute:T,style:w,source:z}=(0,st.e)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:a.x)-a.x,y:(null!==(o=null==n?void 0:n.y)&&void 0!==o?o:a.y)-a.y,width:a.width,height:a.height},style:{},source:{type:"embed",embed:Object.assign(i,(0,ut.I)(i))}});(()=>{let N=(0,u.q)(a.width/a.height,100);N>=1?(g.width=Math.min(g.width,a.width),g.height=(0,u.q)(g.width/N,1)):(g.height=Math.min(g.height,a.height),g.width=(0,u.q)(g.height*N,1)),g.x=(0,u.q)(g.x+a.x-g.width/2,1),g.y=(0,u.q)(g.y+a.y-g.height/2,1),Object.assign(T,(0,j.sg)(A.$.FOREIGNOBJECT,g,T)),(0,E.__)(y,T),bt.data.node=Object.assign({id:m,type:A.$.FOREIGNOBJECT,name:"ForeignObject"},{size:g,attribute:T,style:w,source:z})})()}createNodeMedia(i,n){var r,o,a,m;let{nodeId:g,element:T,size:w,attribute:z,source:N}=(0,_t.G)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(o=null==n?void 0:n.y)&&void 0!==o?o:50)-50,width:100,height:100},source:{type:"image",image:(0,ut.I)(i.cover)}}),ht={click:{media:i.media}};(ft=>{if(!ft)return;let xt=new Image;xt.onload=()=>{let Nt=(0,u.q)(xt.naturalWidth/xt.naturalHeight,100);Nt>=1?(w.width=Math.min(xt.naturalWidth,512),w.height=(0,u.q)(w.width/Nt,100)):(w.height=Math.min(xt.naturalHeight,512),w.width=(0,u.q)(w.height*Nt,100)),w.x=(0,u.q)(w.x+50-w.width/2,100),w.y=(0,u.q)(w.y+50-w.height/2,100),Object.assign(z,(0,j.sg)(A.$.IMAGE,w,z)),(0,E.__)(T,z),bt.data.node=Object.assign({id:g,type:A.$.IMAGE,name:"Image"},{size:w,attribute:z,source:N,interactive:ht})},xt.onerror=Nt=>{console.error(`ImgSrc load failed -> ${ft}`,Nt),null==T||T.remove()},xt.src=ft})(null!==(a=null===(m=N.image)||void 0===m?void 0:m.url)&&void 0!==a?a:"")}insert(i){var n;if(bt.data.insertSlide(bt.data.slideId,1),i.title){let{nodeId:r,size:o,attribute:a,style:m,source:y}=(0,st.e)(Math.ceil(1e9*Math.random()),{size:{x:100,y:100,width:800,height:150},source:{type:"html",html:{htmlContent:`<span style="font-size: 40px;">${i.title}</span>`}}});bt.data.node=Object.assign({id:r,type:A.$.FOREIGNOBJECT,name:"ForeignObject"},{size:o,attribute:a,style:m,source:y})}if(i.description){let{nodeId:r,size:o,attribute:a,style:m,source:y}=(0,st.e)(Math.ceil(1e9*Math.random()),{size:{x:100,y:300,width:600,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 24px;">${i.description.replace(/\n/g,"<br/>")}</span>`}}});bt.data.node=Object.assign({id:r,type:A.$.FOREIGNOBJECT,name:"ForeignObject"},{size:o,attribute:a,style:m,source:y})}null!==(n=i.media)&&void 0!==n&&n.prompt&&((()=>{let{nodeId:r,size:o,attribute:a}=(0,tt.f)(Math.ceil(1e9*Math.random()),{size:{x:775,y:275,width:350,height:350},attribute:{fill:"#FFFFFF",stroke:"#E6E6E6",strokeWidth:1,strokeDasharray:1,rx:4}});bt.data.node=Object.assign({id:r,type:A.$.RECT,name:"Rect"},{size:o,attribute:a})})(),(r=>{let{nodeId:o,size:a,attribute:m,style:y,source:g}=(0,st.e)(Math.ceil(1e9*Math.random()),{size:{x:800,y:300,width:300,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 18px; color: #6633cc"><i>${null===(r=i.media)||void 0===r?void 0:r.prompt}</i></span>`}}});bt.data.node=Object.assign({id:o,type:A.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:m,style:y,source:g})})())}}var oe=p(5226);class ne{get newSlideId(){return Math.ceil(1e9*Math.random())}get _defaultSlide(){return JSON.parse(JSON.stringify({id:this.newSlideId,name:"Trang m\u1edbi",svg:{viewBox:bt.screen.frameSize,nodes:[]}}))}constructor(){this._dataSource={slides:[],resources:[]},this._slideIdx=0,this._fnChangeSlides=[],this.getNodeAll=()=>{var i;let n=null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((a,m)=>m==this._slideIdx),r=null==n?void 0:n.svg,o=a=>{let m=[];return a.filter(y=>!y.isdeleted).forEach(y=>{y.type==A.$.GROUP?m=m.concat(o(y.nodes||[])):m.push(y.id)}),m};return o((null==r?void 0:r.nodes)||[])}}get get(){var i;let n=r=>{var o,a;return null===(o=r)||void 0===o||o.filter(m=>m.type==A.$.GROUP).forEach(m=>{var y;m.nodes=n(null===(y=m.nodes)||void 0===y?void 0:y.filter(g=>!g.isdeleted))}),(r=null===(a=r)||void 0===a?void 0:a.filter(m=>{var y,g;return m.type!=A.$.GROUP||(null!==(y=null===(g=m.nodes)||void 0===g?void 0:g.length)&&void 0!==y?y:0)>0}))||[]};return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var o;r.svg&&(r.svg.nodes=n(null===(o=r.svg)||void 0===o||null===(o=o.nodes)||void 0===o?void 0:o.filter(a=>!a.isdeleted)))}),this._dataSource}get getResource(){var i;let n=[];return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var o,a,m,y,g,T,w,z;n.push(null===(o=r.svg)||void 0===o||null===(o=o.background)||void 0===o?void 0:o.path),null===(a=r.svg)||void 0===a||a.nodes.forEach(N=>{var ht,ft,xt,Nt,Zt,ye,ve,me,pe,xe;n.push(null===(ht=N.source)||void 0===ht||null===(ht=ht.image)||void 0===ht?void 0:ht.path),n.push(null===(ft=N.source)||void 0===ft||null===(ft=ft.audio)||void 0===ft?void 0:ft.path),n.push(null===(xt=N.source)||void 0===xt||null===(xt=xt.video)||void 0===xt?void 0:xt.path),n.push(null===(Nt=N.source)||void 0===Nt||null===(Nt=Nt.file)||void 0===Nt?void 0:Nt.path),n.push(null===(Zt=N.source)||void 0===Zt||null===(Zt=Zt.iframe)||void 0===Zt?void 0:Zt.path),n.push(null===(ye=N.source)||void 0===ye||null===(ye=ye.track)||void 0===ye?void 0:ye.path),n.push(null===(ve=N.interactive)||void 0===ve||null===(ve=ve.show)||void 0===ve||null===(ve=ve.audio)||void 0===ve||null===(ve=ve.source)||void 0===ve?void 0:ve.path),n.push(null===(me=N.interactive)||void 0===me||null===(me=me.click)||void 0===me||null===(me=me.audio)||void 0===me||null===(me=me.source)||void 0===me?void 0:me.path),n.push(null===(pe=N.interactive)||void 0===pe||null===(pe=pe.click)||void 0===pe||null===(pe=pe.image)||void 0===pe||null===(pe=pe.source)||void 0===pe?void 0:pe.path),n.push(null===(xe=N.interactive)||void 0===xe||null===(xe=xe.click)||void 0===xe||null===(xe=xe.video)||void 0===xe||null===(xe=xe.source)||void 0===xe?void 0:xe.path)}),n.push(null===(m=r.test)||void 0===m||null===(m=m.audiotrue)||void 0===m?void 0:m.path),n.push(null===(y=r.test)||void 0===y||null===(y=y.audiofalse)||void 0===y?void 0:y.path),n.push(null===(g=r.test)||void 0===g||null===(g=g.effecttrue)||void 0===g?void 0:g.path),n.push(null===(T=r.test)||void 0===T||null===(T=T.effectfalse)||void 0===T?void 0:T.path),n.push(null===(w=r.test)||void 0===w||null===(w=w.icontrue)||void 0===w?void 0:w.path),n.push(null===(z=r.test)||void 0===z||null===(z=z.iconfalse)||void 0===z?void 0:z.path)}),n.filter(r=>r).map(r=>r.replace(/(\?|\#)[^\?\#]+/g,"").toLowerCase()).filter((r,o,a)=>a.indexOf(r)==o)}set set(i){this._dataSource=i,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),(0,E.wM)(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get dataSource(){var i;let n=r=>{var o,a;return null===(o=r)||void 0===o||o.filter(m=>m.type==A.$.GROUP).forEach(m=>{var y;m.nodes=n(null===(y=m.nodes)||void 0===y?void 0:y.filter(g=>!g.isdeleted))}),(r=null===(a=r)||void 0===a?void 0:a.filter(m=>{var y,g;return m.type!=A.$.GROUP||(null!==(y=null===(g=m.nodes)||void 0===g?void 0:g.length)&&void 0!==y?y:0)>0}))||[]};return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var o;r.svg&&(r.svg.nodes=n(null===(o=r.svg)||void 0===o||null===(o=o.nodes)||void 0===o?void 0:o.filter(a=>!a.isdeleted)))}),this._dataSource.resources=this.getResource,this._dataSource}set dataSource(i){this._dataSource=i,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),(0,E.wM)(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get slideId(){var i,n;return null!==(i=null===(n=this.slide)||void 0===n?void 0:n.id)&&void 0!==i?i:0}get slideIdx(){return this._slideIdx}get slide(){var i;return null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((n,r)=>r==this._slideIdx)}get slides(){return this._dataSource.slides||[]}backSlide(){this._slideIdx>0&&(this._slideIdx-=1,this.openSlide(void 0,this._slideIdx))}nextSlide(){var i,n;this._slideIdx<(null!==(i=null===(n=this._dataSource.slides)||void 0===n?void 0:n.length)&&void 0!==i?i:0)-1&&(this._slideIdx+=1,this.openSlide(void 0,this._slideIdx))}refreshSlide(){(0,E.wM)(),(0,oe.E)(this.slide)}openSlide(i,n){var r,o,a,m,y;if(i)for(let N=0,ht=null!==(g=null===(T=this._dataSource.slides)||void 0===T?void 0:T.length)&&void 0!==g?g:0;N<ht;N++){var g,T,w;if((null!==(w=this._dataSource.slides)&&void 0!==w?w:[])[N].id==i){this._slideIdx=N;break}}else if(n&&n>=0&&n<(null!==(r=null===(o=this._dataSource.slides)||void 0===o?void 0:o.length)&&void 0!==r?r:0))this._slideIdx=null!=n?n:0;else{var z;this._slideIdx=0,null!==(z=this._dataSource.slides)&&void 0!==z&&z.length||(this._dataSource.slides=[JSON.parse(JSON.stringify(this._defaultSlide))])}(0,E.wM)(),null!==(a=this.slide)&&void 0!==a&&null!==(a=a.svg)&&void 0!==a&&a.viewBox&&(bt.screen.frameSize=this.slide.svg.viewBox),(0,oe.E)(this.slide),this.changeSlide(this.slides,this.slideIdx,null!==(m=null===(y=this._dataSource.slides)||void 0===y?void 0:y.length)&&void 0!==m?m:0,this.slide)}addSlide(){var i,n,r;null===(i=this._dataSource.slides)||void 0===i||i.push(this._defaultSlide),this._slideIdx=(null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.length)&&void 0!==n?n:0)-1,this.openSlide(void 0,this._slideIdx)}tryReplaceSlide(i,n,r){var o,a,m,y,g;let T=null===(o=this._dataSource.slides)||void 0===o?void 0:o.find(z=>z.id==i);if(!r||!T||null!=T&&null!==(a=T.svg)&&void 0!==a&&a.nodes.filter(z=>!z.isdeleted).length)return this.insertSlide(i,n,r);let w=null!==(m=null===(y=this._dataSource.slides)||void 0===y?void 0:y.indexOf(T))&&void 0!==m?m:0;null===(g=this._dataSource.slides)||void 0===g||g.splice(w,1,r),this._slideIdx=w,this.openSlide(void 0,this._slideIdx)}insertSlide(i,n,r){var o,a,m,y,g;let T=null!==(o=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find(N=>N.id==i))&&void 0!==o?o:this._defaultSlide,w=(null!==(m=null===(y=this._dataSource.slides)||void 0===y?void 0:y.indexOf(T))&&void 0!==m?m:0)+n;var z;r?(r.id=this.newSlideId,r.code=void 0,r.name||(r.name="Trang m\u1edbi"),null!==(z=r.svg)&&void 0!==z&&z.viewBox||r.svg&&(r.svg.viewBox=bt.screen.frameSize)):r=this._defaultSlide,null===(g=this._dataSource.slides)||void 0===g||g.splice(w,0,r),this._slideIdx=w,this.openSlide(void 0,this._slideIdx)}copySlide(i){var n,r,o,a,m,y,g;let T=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(N=>N.id==i))&&void 0!==n?n:this._defaultSlide,w=(null!==(o=null===(a=this._dataSource.slides)||void 0===a?void 0:a.indexOf(T))&&void 0!==o?o:0)+1,z=Object.assign(JSON.parse(JSON.stringify(T)),{id:this.newSlideId,code:void 0,name:`${T.name} + (Copy)`});null===(m=this._dataSource.slides)||void 0===m||m.splice(w,0,z),this.changeSlide(this.slides,this.slideIdx,null!==(y=null===(g=this._dataSource.slides)||void 0===g?void 0:g.length)&&void 0!==y?y:0,this.slide)}moveSlide(i,n){var r,o,a,m,y,g;let T=null!==(r=null===(o=this._dataSource.slides)||void 0===o?void 0:o.find(z=>z.id==i))&&void 0!==r?r:this._defaultSlide,w=null!==(a=null===(m=this._dataSource.slides)||void 0===m?void 0:m.indexOf(T))&&void 0!==a?a:0;null===(y=this._dataSource.slides)||void 0===y||y.splice(w+n,0,null===(g=this._dataSource.slides)||void 0===g?void 0:g.splice(w,1)[0])}deleteSlide(i){var n,r,o,a,m,y;let g=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(N=>N.id==i))&&void 0!==n?n:this._defaultSlide,T=null!==(o=null===(a=this._dataSource.slides)||void 0===a?void 0:a.indexOf(g))&&void 0!==o?o:0;if(null===(m=this._dataSource.slides)||void 0===m||m.splice(T,1),null!==(y=this._dataSource.slides)&&void 0!==y&&y.length)if(T<this._slideIdx){var w,z;--this._slideIdx,this.changeSlide(this.slides,this.slideIdx,null!==(w=null===(z=this._dataSource.slides)||void 0===z?void 0:z.length)&&void 0!==w?w:0,this.slide)}else T==this._slideIdx&&(--this._slideIdx,this.openSlide(void 0,this._slideIdx));else this.addSlide()}deleteSlide1(i){var n,r,o,a,m;let y=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(T=>T.id==i))&&void 0!==n?n:this._defaultSlide,g=null!==(o=null===(a=this._dataSource.slides)||void 0===a?void 0:a.indexOf(y))&&void 0!==o?o:0;if(y.isdeleted=!0,null!==(m=this._dataSource.slides)&&void 0!==m&&null!==(m=m.filter(T=>!T.isdeleted))&&void 0!==m&&m.length){let T=!0;for(;y.isdeleted;)T?g++:g--,this._dataSource.slides[g]?y=this._dataSource.slides[g]:T=!T;this.openSlide(y.id)}else this.addSlide()}set onChangeSlide(i){this._fnChangeSlides.push(i)}changeSlide(i,n,r,o){this._fnChangeSlides.forEach(a=>a(i,n,r,o))}set node(i){var n,r;let o=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((m,y)=>y==this._slideIdx),a=null==o?void 0:o.svg;null!=a&&a.nodes&&(null==a||a.nodes.push(i)),bt.history.push([{type:"add",from:{id:i.id},to:{id:i.id}}]),(0,oe.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id)}findNode(i){var n;let r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((N,ht)=>ht==this._slideIdx),o=null==r?void 0:r.svg,a=(N,ht)=>{let ft=null==N?void 0:N.find(Zt=>Zt.id==i);if(ft)return ft.pid=ht,ft;let xt=0,Nt=N.length||0;for(;xt<Nt&&!ft&&(ft=a(N[xt].nodes||[],N[xt].id),!ft);)xt++;return ft},m=a((null==o?void 0:o.nodes)||[]);var y,g,T,w,z;return m?(m.style=null!==(y=m.style)&&void 0!==y?y:{},m.source=null!==(g=m.source)&&void 0!==g?g:{},m.animate=null!==(T=m.animate)&&void 0!==T?T:{},m.interactive=null!==(w=m.interactive)&&void 0!==w?w:{},m.variable=null!==(z=m.variable)&&void 0!==z?z:{},m):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}getNode(i){var n;let r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((y,g)=>g==this._slideIdx),o=null==r?void 0:r.svg,m=y=>{let g=(null==y?void 0:y.find(ft=>ft.id==i))||(y=>{let g=null,T=0,w=y.length||0;for(;T<w&&!g;){if(g=m(y[T].nodes),g){g.pid=y[T].id;break}T++}var z,N,ht,ft,xt;return g&&(g.style=null!==(z=g.style)&&void 0!==z?z:{},g.source=null!==(N=g.source)&&void 0!==N?N:{},g.animate=null!==(ht=g.animate)&&void 0!==ht?ht:{},g.interactive=null!==(ft=g.interactive)&&void 0!==ft?ft:{},g.variable=null!==(xt=g.variable)&&void 0!==xt?xt:{}),g})((null==y?void 0:y.filter(ft=>ft.type==A.$.GROUP))||[]);var T,w,z,N,ht;return g&&(g.style=null!==(T=g.style)&&void 0!==T?T:{},g.source=null!==(w=g.source)&&void 0!==w?w:{},g.animate=null!==(z=g.animate)&&void 0!==z?z:{},g.interactive=null!==(N=g.interactive)&&void 0!==N?N:{},g.variable=null!==(ht=g.variable)&&void 0!==ht?ht:{}),g};return m((null==o?void 0:o.nodes)||[])||{id:null,pid:null,type:null,element:document.createElement("div"),size:{x:0,y:0,width:0,height:0,points:[]},attribute:{},style:{},source:{},animate:{},interactive:{},variable:{},isfake:!0,isdeleted:!1,nodes:[]}}getNodeInArea(i,n,r,o,a){var m;let y=null===(m=this._dataSource.slides)||void 0===m?void 0:m.find((w,z)=>z==this._slideIdx),g=null==y?void 0:y.svg,T=w=>{let z=[];return w.filter(N=>!N.isdeleted).forEach(N=>{N.type==A.$.GROUP?z=z.concat(T(N.nodes||[])):i>N.size.x||n>N.size.y||r<N.size.x+N.size.width||o<N.size.y+N.size.height||(a?N.type==a&&z.push(N.id):z.push(N.id))}),z};return T((null==g?void 0:g.nodes)||[])}getNodeOnArea(i,n,r,o,a){var m;let y=null===(m=this._dataSource.slides)||void 0===m?void 0:m.find((w,z)=>z==this._slideIdx),g=null==y?void 0:y.svg,T=w=>{let z=[];return w.filter(N=>!N.isdeleted).forEach(N=>{N.type==A.$.GROUP?z=z.concat(T(N.nodes||[])):N.size.x+N.size.width<i||N.size.y+N.size.height<n||N.size.x>r||N.size.y>o||(a?N.type==a&&z.push(N.id):z.push(N.id))}),z};return T((null==g?void 0:g.nodes)||[])}deleteNode(i,n){var r;return this.getNode(i).isdeleted=null==n||n,(0,oe.E)(this.slide),(0,oe.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),i}unGroup(i){var n,r;let o=this.getNode(i),a=Math.ceil(1e9*Math.random());return null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.push(Object.assign(JSON.parse(JSON.stringify(o)),{id:a})),Object.assign(o,{isdeleted:!0}),(0,oe.E)(this.slide),(0,oe.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),a}addGroup(i,n){var r;let o=this.getNode(i),a=this.getNode(n);a.nodes=a.nodes||[];let m=Math.ceil(1e9*Math.random());return a.nodes.push(Object.assign(JSON.parse(JSON.stringify(o)),{id:m})),Object.assign(o,{isdeleted:!0}),(0,oe.E)(this.slide),(0,oe.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),m}setNodeP(i,n){var r;let o=null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r?void 0:r.nodes.find(a=>a.id==i);o&&(o.pid=n||null)}bringToFront(i){this.bringToFrontStep(i,0)}sendToBack(i){this.sendToBackStep(i,0)}bringToFrontStep(i,n){var r,o,a,m;null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.forEach((w,z)=>{w.index=z+1});let y=(null!==(o=null===(a=this.slide)||void 0===a||null===(a=a.svg)||void 0===a?void 0:a.nodes.length)&&void 0!==o?o:0)+1;var g,T;i.map(w=>{var z,N;return{id:w,index:null!==(z=null===(N=this.slide)||void 0===N||null===(N=N.svg)||void 0===N||null===(N=N.nodes.find(ht=>ht.id==w))||void 0===N?void 0:N.index)&&void 0!==z?z:0}}).sort((w,z)=>w.index-z.index).forEach(w=>{var N,z;n?null===(N=this.slide)||void 0===N||null===(N=N.svg)||void 0===N||N.nodes.filter((ht,ft)=>ht.id==w.id).forEach(ht=>{ht.index=n+w.index+w.index/1e3}):null===(z=this.slide)||void 0===z||null===(z=z.svg)||void 0===z||z.nodes.filter(ht=>ht.id==w.id).forEach(ht=>{ht.index=y+w.index})}),null===(m=this.slide)||void 0===m||null===(m=m.svg)||void 0===m||m.nodes.sort((w,z)=>{var N,ht;return(null!==(N=w.index)&&void 0!==N?N:0)-(null!==(ht=z.index)&&void 0!==ht?ht:0)}),(0,oe.T)(this.slide),i.length<=1?(null===(g=window.document.getElementById(ot.O.RESIZE_GROUP))||void 0===g||g.remove(),(0,b.y)(bt.dataSelect.nodes[0])):(null===(T=window.document.getElementById(ot.O.SELECT_GROUP))||void 0===T||T.remove(),(0,v.Q)(bt.dataSelect.nodes))}sendToBackStep(i,n){var r,o,a,m;null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.forEach((y,g)=>{y.index=g+1}),i.map(y=>{var g,T;return{id:y,index:null!==(g=null===(T=this.slide)||void 0===T||null===(T=T.svg)||void 0===T||null===(T=T.nodes.find(w=>w.id==y))||void 0===T?void 0:T.index)&&void 0!==g?g:0}}).sort((y,g)=>y.index-g.index).forEach(y=>{var T,g;n?null===(T=this.slide)||void 0===T||null===(T=T.svg)||void 0===T||T.nodes.filter(w=>w.id==y.id).forEach(w=>{w.index=n+y.index+y.index/1e3}):null===(g=this.slide)||void 0===g||null===(g=g.svg)||void 0===g||g.nodes.filter(w=>w.id==y.id).forEach(w=>{w.index=y.index/100-1})}),null===(o=this.slide)||void 0===o||null===(o=o.svg)||void 0===o||o.nodes.sort((y,g)=>{var T,w;return(null!==(T=y.index)&&void 0!==T?T:0)-(null!==(w=g.index)&&void 0!==w?w:0)}),(0,oe.T)(this.slide),i.length<=1?(null===(a=window.document.getElementById(ot.O.RESIZE_GROUP))||void 0===a||a.remove(),(0,b.y)(bt.dataSelect.nodes[0])):(null===(m=window.document.getElementById(ot.O.SELECT_GROUP))||void 0===m||m.remove(),(0,v.Q)(bt.dataSelect.nodes))}bringToFrontArea(i){var n,r;let o=i.map(ft=>bt.data.getNode(ft)).filter(ft=>!ft.isfake),{x1:a,y1:m,x2:y,y2:g}=re(o),T=this.getNodeOnArea(a,m,y,g);null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((ft,xt)=>{ft.index=xt+1});let w=T.map(ft=>{var xt,Nt;return null!==(xt=null===(Nt=this.slide)||void 0===Nt||null===(Nt=Nt.svg)||void 0===Nt||null===(Nt=Nt.nodes.find(Zt=>Zt.id==ft))||void 0===Nt?void 0:Nt.index)&&void 0!==xt?xt:0}),z=Math.max.apply(null,w);var N,ht;i.forEach((ft,xt)=>{var Nt;null===(Nt=this.slide)||void 0===Nt||null===(Nt=Nt.svg)||void 0===Nt||Nt.nodes.filter(Zt=>Zt.id==ft).forEach(Zt=>{Zt.index=z+(xt+1)/100})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((ft,xt)=>{var Nt,Zt;return(null!==(Nt=ft.index)&&void 0!==Nt?Nt:0)-(null!==(Zt=xt.index)&&void 0!==Zt?Zt:0)}),(0,oe.T)(this.slide),i.length<=1?(null===(N=window.document.getElementById(ot.O.RESIZE_GROUP))||void 0===N||N.remove(),(0,b.y)(bt.dataSelect.nodes[0])):(null===(ht=window.document.getElementById(ot.O.SELECT_GROUP))||void 0===ht||ht.remove(),(0,v.Q)(bt.dataSelect.nodes))}sendToBackArea(i){var n,r;let o=i.map(ft=>bt.data.getNode(ft)).filter(ft=>!ft.isfake),{x1:a,y1:m,x2:y,y2:g}=re(o),T=this.getNodeOnArea(a,m,y,g);null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((ft,xt)=>{ft.index=xt+1});let w=T.map(ft=>{var xt,Nt;return null!==(xt=null===(Nt=this.slide)||void 0===Nt||null===(Nt=Nt.svg)||void 0===Nt||null===(Nt=Nt.nodes.find(Zt=>Zt.id==ft))||void 0===Nt?void 0:Nt.index)&&void 0!==xt?xt:0}),z=Math.min.apply(null,w)-1;var N,ht;i.forEach((ft,xt)=>{var Nt;null===(Nt=this.slide)||void 0===Nt||null===(Nt=Nt.svg)||void 0===Nt||Nt.nodes.filter(Zt=>Zt.id==ft).forEach(Zt=>{Zt.index=z+(xt+1)/100})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((ft,xt)=>{var Nt,Zt;return(null!==(Nt=ft.index)&&void 0!==Nt?Nt:0)-(null!==(Zt=xt.index)&&void 0!==Zt?Zt:0)}),(0,oe.T)(this.slide),i.length<=1?(null===(N=window.document.getElementById(ot.O.RESIZE_GROUP))||void 0===N||N.remove(),(0,b.y)(bt.dataSelect.nodes[0])):(null===(ht=window.document.getElementById(ot.O.SELECT_GROUP))||void 0===ht||ht.remove(),(0,v.Q)(bt.dataSelect.nodes))}}const re=D=>{let i=999999,n=999999,r=-999999,o=-999999;return D.forEach(a=>{i=Math.min(i,a.size.x),n=Math.min(n,a.size.y),r=Math.max(r,a.size.x+a.size.width),o=Math.max(o,a.size.y+a.size.height)}),{x1:i,y1:n,x2:r,y2:o}};class we{constructor(){this._index=-1,this._dataSource=[],this.undoExecute=i=>{i.forEach(function(n){switch(n.type){case"add":bt.data.deleteNode(n.from.id);break;case"edit":break;case"delete":bt.data.deleteNode(n.from.id,!1);break;case"size":{let{id:r,type:o,size:a,attribute:m}=bt.data.getNode(n.from.id);Object.assign(a,n.from.size),Object.assign(m,(0,j.sg)(o,a,m)),(0,E.__)(window.document.getElementById(r),m);break}case"attribute":{let{id:r,attribute:o}=bt.data.getNode(n.from.id);Object.assign(o,n.from.attribute),(0,E.__)(window.document.getElementById(r),o);break}case"style":{let{id:r,style:o}=bt.data.getNode(n.from.id);Object.assign(null!=o?o:{},n.from.style),(0,E.DB)(window.document.getElementById(r),o);break}case"source":{let{id:r,type:o,source:a}=bt.data.getNode(n.from.id);Object.assign(null!=a?a:{},n.from.source),(0,E.QI)(window.document.getElementById(r),o,null!=a?a:{});break}case"animate":{let{animate:r}=bt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.animate);break}case"interactive":{let{interactive:r}=bt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.interactive);break}case"variable":{let{variable:r}=bt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.variable);break}}}),bt.dataSelect.ids=[]},this.redoExecute=i=>{i.forEach(function(n){switch(n.type){case"add":bt.data.deleteNode(n.to.id,!1);break;case"edit":break;case"delete":bt.data.deleteNode(n.to.id,!0);break;case"size":{let{id:r,type:o,size:a,attribute:m}=bt.data.getNode(n.to.id);Object.assign(a,n.to.size),Object.assign(m,(0,j.sg)(o,a,m)),(0,E.__)(window.document.getElementById(r),m);break}case"attribute":{let{id:r,attribute:o}=bt.data.getNode(n.to.id);Object.assign(o,n.to.attribute),(0,E.__)(window.document.getElementById(r),o);break}case"style":{let{id:r,style:o}=bt.data.getNode(n.to.id);Object.assign(null!=o?o:{},n.to.style),(0,E.DB)(window.document.getElementById(r),o);break}case"source":{let{id:r,type:o,source:a}=bt.data.getNode(n.to.id);Object.assign(null!=a?a:{},n.to.source),(0,E.QI)(window.document.getElementById(r),o,null!=a?a:{});break}case"animate":{let{animate:r}=bt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.animate);break}case"interactive":{let{interactive:r}=bt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.interactive);break}case"variable":{let{variable:r}=bt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.variable);break}}}),bt.dataSelect.ids=[]},this._fnChanges=[],this._index=-1,this._dataSource=[]}get index(){return this._index}get total(){return this._dataSource.length}get dataSource(){return this._dataSource}renew(){this._index=-1,this._dataSource=[],this.change()}push(i){this._index<0?(this._index=0,this._dataSource.length=0,this._dataSource[this._index]={data:i}):(this._index<this._dataSource.length-1&&this._dataSource.splice(this._index+1,this._dataSource.length-this._index-1),this._index++,this._dataSource.push({data:i})),this.change()}undo(){this._index<0||(this.undoExecute(this._dataSource[this._index].data),this._index--,this.change())}redo(){this._index>=this._dataSource.length-1||(this._index++,this.redoExecute(this._dataSource[this._index].data),this.change())}set onchange(i){this._fnChanges.push(i)}change(){this._fnChanges.forEach(i=>i(this.index,this.total))}}class Fe{constructor(){this._x=0,this._y=0,this._width=0,this._height=0,this._scale=1,this._dislocation={x:0,y:0},this._offset={x:0,y:0},this._svgSize={x:0,y:0,width:0,height:0},this._svgViewBox={x:0,y:0,width:0,height:0},this._frameSize={x:0,y:0,width:1280,height:720},this._actived=!1,this._fnZoomChanges=[]}get actived(){return this._actived}set actived(i){this._actived=i}get get(){return{x:this._frameSize.x,y:this._frameSize.y,w:this._frameSize.width,h:this._frameSize.height,width:this._frameSize.width,height:this._frameSize.height}}set set(i){var n,r;this._frameSize.width=null!==(n=null==i?void 0:i.width)&&void 0!==n?n:1080,this._frameSize.height=null!==(r=null==i?void 0:i.height)&&void 0!==r?r:1080,this.zoomTo="fit"}get width(){return this._width}get height(){return this._height}get scale(){return this._scale}get dislocation(){return this._dislocation}get offset(){return this._offset}get svgSize(){return this._svgSize}get svgViewBox(){return this._svgViewBox}set svgViewBox(i){this._svgViewBox=i}get frameSize(){return this._frameSize}set frameSize(i){this._frameSize.x=i.x,this._frameSize.y=i.y,this._frameSize.width=i.width,this._frameSize.height=i.height,this.reset()}set screen(i){this._offset=i.offset,this._width=i.width,this._height=i.height,this.reset()}reset(){this.scaleTo(this._scale,void 0,!0)}scaleTo(i,n,r){var o;if(!(i<.01||i>100)){if(n=null!==(o=n)&&void 0!==o?o:{x:this._width/2,y:this._height/2},r)this._dislocation.x=this._width/i/2-n.x,this._dislocation.y=this._height/i/2-n.y,this._dislocation.x+=(this._width-this._frameSize.width)/2,this._dislocation.y+=(this._height-this._frameSize.height)/2;else{var a={x:Math.max(0,Math.min((0,u.q)(n.x/this._width,1e3),1)),y:Math.max(0,Math.min((0,u.q)(n.y/this._height,1e3),1))},m={x:(this._width/i-this._width/this._scale)*a.x,y:(this._height/i-this._height/this._scale)*a.y};this._dislocation.x+=m.x,this._dislocation.y+=m.y}this._scale=i,this.change(),this.zoomChange(this.scale)}}set zoomTo(i){"fit"==i?this.scaleTo(Math.min((this._width-80)/this._frameSize.width,(this._height-80)/this._frameSize.height),void 0,!0):"number"==typeof i&&this.scaleTo(i/100,void 0,!0)}init(){return{svgViewBox:this.svgViewBox,svgSize:this.svgSize}}move(i,n){this._dislocation.x=i.x+n.x/this._scale,this._dislocation.y=i.y+n.y/this._scale,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this.refScreen()}change(){this._svgSize.x=this._x,this._svgSize.y=this._y,this._svgSize.width=this._width,this._svgSize.height=this._height,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this._svgViewBox.width=this._width/this._scale,this._svgViewBox.height=this._height/this._scale,this.refScreen()}refScreen(){(0,E.eb)()}set onZoomChange(i){this._fnZoomChanges.push(i)}zoomChange(i){this._fnZoomChanges.forEach(n=>n(i))}}var Qe=p(644);class He{constructor(){this._fill="#D9D9D9",this._stroke="#AAAAAA",this._strokeWidth=1,this._strokeLinecap="round",this._strokeLinejoin="round",this._fontFamily=void 0,this._fontSize=20,this._textLength=void 0,this._fnChangeFills=[],this._fnChangeStrokes=[],this._fnChangeStrokeWidths=[],this.loadConfig()}loadConfig(){(0,Qe.sV)({callback:i=>{this._fill=(null==i?void 0:i.fill)||this._fill,this._stroke=(null==i?void 0:i.stroke)||this._stroke,this._strokeWidth=(null==i?void 0:i.strokeWidth)||this._strokeWidth,this._strokeLinecap=(null==i?void 0:i.strokeLinecap)||this._strokeLinecap,this._strokeLinejoin=(null==i?void 0:i.strokeLinejoin)||this._strokeLinejoin,this.changeFill(this.fill),this.changeStroke(this.stroke),this.changeStrokeWidth(this.strokeWidth)}})}saveConfig(){(0,Qe.qp)({params:{fill:this._fill,stroke:this._stroke,strokeWidth:this._strokeWidth,strokeLinecap:this._strokeLinecap,strokeLinejoin:this._strokeLinejoin}})}get fill(){return this._fill}set fill(i){this._fill=i,this.changeFill(this.fill)}get stroke(){return this._stroke}set stroke(i){this._stroke=i,this.changeStroke(this.stroke)}get strokeWidth(){return this._strokeWidth}set strokeWidth(i){this._strokeWidth=i,this.changeStrokeWidth(this.strokeWidth)}get strokeLinecap(){return this._strokeLinecap}set strokeLinecap(i){this._strokeLinecap=i}get strokeLinejoin(){return this._strokeLinejoin}set strokeLinejoin(i){this._strokeLinejoin=i}get fontFamily(){return this._fontFamily}get fontSize(){return this._fontSize}get textLength(){return this._textLength}set onchangefill(i){this._fnChangeFills.push(i)}changeFill(i){this._fnChangeFills.forEach(n=>n(i)),this.saveConfig()}set onchangestroke(i){this._fnChangeStrokes.push(i)}changeStroke(i){this._fnChangeStrokes.forEach(n=>n(i)),this.saveConfig()}set onchangestrokewidth(i){this._fnChangeStrokeWidths.push(i)}changeStrokeWidth(i){this._fnChangeStrokeWidths.forEach(n=>n(i)),this.saveConfig()}}var Pe=p(70),Ze=p(5973),Xe=p(4787),Oe=function(D){return D&&JSON.parse(JSON.stringify(D))},De=[{key:"FinishedTest",type:"boolean",value:!1,note:"Ho\xe0n th\xe0nh BKT",system:!0,readonly:!1},{key:"TotalTest",type:"number",value:0,note:"T\u1ed5ng s\u1ed1 BKT",system:!0,readonly:!1},{key:"TotalTestDidNotPass",type:"number",value:0,note:"S\u1ed1 BKT kh\xf4ng v\u01b0\u1ee3t qua",system:!0,readonly:!1},{key:"TotalTestPassed",type:"number",value:0,note:"S\u1ed1 BKT \u0111\xe3 v\u01b0\u1ee3t qua",system:!0,readonly:!1}],Ge=[],qe={key:"BienSo",value:"0",type:"number",note:null,readonly:!1},Ve={if:[{type:"variable",variable:"BienSo",variables:null,slide:null,node:null,condition:">",operator:null,valuetype:"value",value:5}],then:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo > 5"}],else:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo <= 5"}],id:"57623302",idx:1,variables:["BienSo"]};class Je{constructor(){this._data_variables=Oe(De).concat(Oe(Ge)),this._data_conditions=[],this.GetActionExecutings=[],this.GetActionExecuteds=[],this.FuncGetExecuteds=i=>{"function"==typeof i&&this.GetActionExecuteds.push(i)},this.OnGetActionExecuted=i=>{this.GetActionExecuteds.forEach(n=>{n(i)})},this.SetActionExecutings=[],this.FuncSetExecutings=i=>{"function"==typeof i&&this.SetActionExecutings.push(i)},this.OnSetActionExecuting=i=>{this.SetActionExecutings.forEach(n=>{n(i)})},this.SetActionExecuteds=[],this.FuncSetExecuteds=i=>{"function"==typeof i&&this.SetActionExecuteds.push(i)},this.OnSetActionExecuted=i=>{for(var n of(this.SetActionExecuteds.forEach(r=>{r(i)}),this.getCondition(i.key)||[]))n.if&&n.if.length>0&&(this.checkValueConditions(n.if)?this.setValueOperators(n.then||[]):this.setValueOperators(n.else||[]))}}renew(){this._data_variables=Oe(De).concat(Oe(Ge)),this._data_conditions=[]}get totalVariable(){return this._data_variables.length}get totalCondition(){return this._data_conditions.length}get get(){return{variables:this._data_variables||[],conditions:this._data_conditions||[]}}set set(i){if(!i)return;let n={};"string"==typeof i?n=JSON.parse(i):"object"==typeof i&&(n=i),this._data_variables=n.variables||[],this._data_conditions=n.conditions||(r=>(this._data_variables.map(o=>o.change||[]).forEach(o=>{r=r.concat(o)}),r))([]),De.forEach(r=>{var o=this._data_variables.filter(a=>a.key==r.key);o.length?o.forEach(function(a,m,y){a.type=r.type,a.readonly=r.readonly,a.system=r.system}):this._data_variables.push(r)})}getVariableTemp(){return Oe(qe)}getConditionTemp(){return Oe(Ve)}getKeys(){return this._data_variables.map(function(i){return i.key}).sort(function(i,n){return i.localeCompare(n)})}getVariableAll(){return this._data_variables.length?Oe((D=this._data_variables,i="key",function(n){for(var r of D.map(function(o){return o[i]}).sort())D.filter(function(o){return o[i]==r}).forEach(function(o){n.push(o)}),D=D.filter(function(o){return o[i]!=r});return n}([]))):Oe(De).concat(Oe(Ge));var D,i}setVariableAll(i){i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==typeof i&&(this._data_variables=i),De.forEach(n=>{var r=this._data_variables.filter(o=>o.key==n.key);r.length?r.forEach((o,a,m)=>{o.type=n.type,o.readonly=n.readonly,o.system=n.system}):this._data_variables.push(n)}))}getVariable(i){return i?Oe(this._data_variables.filter(n=>n.key==i)[0]||{}):{}}setVariable(i,n,r){if(i){switch([null,void 0,NaN,1/0].indexOf(n)>=0&&(n=""),r||(r=(this._data_variables.filter(a=>a.key==i)[0]||{}).type||null),r){case"string":"string"!=typeof n&&(n=n.toString().trim());break;case"number":"number"!=typeof n&&(n=parseFloat(n)||0);break;case"boolean":"string"==typeof n&&(n=n.toLowerCase()),"boolean"!=typeof n&&(n="1"==n||"true"==n||"yes"==n||"dung"==n)}var o=this._data_variables.filter(a=>a.key==i);o.length?o.forEach(function(a,m,y){a.value=n,a.type=r}):this._data_variables.push({key:i,value:n,type:r})}}getValue(i,n){if(!i)return"";var r=this._data_variables.filter(function(m){return m.key==i});if(r.length){var a,o=r[0]||{};switch(this.OnGetActionExecuting(o),n||(n=o.type||null),n){case"string":a=[null,void 0,NaN,1/0].indexOf(o.value)>=0?"":"string"==typeof o.value?o.value||"":o.value.toString().trim();break;case"number":a=[null,void 0,NaN,1/0].indexOf(o.value)>=0?0:"number"==typeof o.value?o.value||0:parseFloat(o.value)||0;break;case"boolean":[null,void 0,NaN,1/0].indexOf(o.value)>=0?a=!1:"boolean"==typeof o.value?a=o.value:(a=(o.value+"").toLowerCase(),a="1"==o.value||"true"==o.value||"yes"==o.value||"dung"==o.value);break;case"audio-src":a=[null,void 0,NaN,1/0].indexOf(o.value)>=0?"":o.value?`<audio controls style="width:280px;vertical-align:middle;"><source src="${o.value}"></source></audio>`:"";break;case"video-src":a=[null,void 0,NaN,1/0].indexOf(o.value)>=0?"":o.value?`<video controls style="width:280px;vertical-align:middle;"><source src="${o.value}"></source></video>`:"";break;case"img-src":a=[null,void 0,NaN,1/0].indexOf(o.value)>=0?"":o.value?`<img style="width:100%;vertical-align:middle;" src="${o.value}"/>`:"";break;default:a=[null,void 0,NaN,1/0].indexOf(o.value)>=0?"":o.value}return this.OnGetActionExecuted(o),a}return null}setValue(i,n,r){if(i){switch([null,void 0,NaN,1/0].indexOf(n)>=0&&(n=""),r||(r=(this._data_variables.filter(function(m){return m.key==i})[0]||{}).type||null),r){case"string":"string"!=typeof n&&(n=n.toString().trim());break;case"number":"number"!=typeof n&&(n=parseFloat(n)||0);break;case"boolean":"string"==typeof n&&(n=n.toLowerCase()),"boolean"!=typeof n&&(n="1"==n||"true"==n||"yes"==n||"dung"==n)}var o=this._data_variables.filter(function(m){return m.key==i});if(o.length){var a=o[0];this.OnSetActionExecuting(a),a&&(a.value=n),this.OnSetActionExecuted(a)}}}getConditionAll(){return Oe(this._data_conditions.sort(function(i,n){return i.idx-n.idx}))}setConditionAll(i){i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==typeof i&&(this._data_conditions=i))}getCondition(i){return i?Oe(this._data_conditions.filter(n=>n.variable==i||(n.variables||[]).indexOf(i)>=0).sort(function(n,r){return n.idx-r.idx})):{}}switchCondition(i,n,r){switch(i){case"==":return"string"==typeof r?(r=r.toLowerCase().trim(),"string"==typeof n&&(n=n.toLowerCase().trim()),r.split(";").map(function(o){return n==o.trim()?1:0}).reduce(function(o,a){return o+a})>0):n==r;case"!=":return"string"==typeof r?(r=r.toLowerCase().trim(),"string"==typeof n&&(n=n.toLowerCase().trim()),0==r.split(";").map(function(o){return n==o.trim()?1:0}).reduce(function(o,a){return o+a})):n!=r;case">=":return n>=r;case"<=":return n<=r;case">":return n>r;case"<":return n<r;case"\u2208":return r=(r+"").toLowerCase().trim(),n=(n+"").toLowerCase().trim(),r.split(";").map(function(o){return n.indexOf(o.trim())>=0?1:0}).reduce(function(o,a){return o+a})>0;case"\u2209":return r=(r+"").toLowerCase().trim(),n=(n+"").toLowerCase().trim(),0==r.split(";").map(function(o){return n.indexOf(o.trim())>=0?1:0}).reduce(function(o,a){return o+a});default:return!1}}switchOperator(i,n,r){switch(i){case"+":return n+r;case"-":return n-r;case"*":return n*r;case"/":return n/r;case"=":return r;case"=!":return!r;case"==":return n==r;case"!=":return n!=r}}switchFormula(i,n){switch(i){case"sum":return n.reduce(function(o,a){return o+a});case"sub":return n.reduce(function(o,a){return o-a});case"pro":return n.reduce(function(o,a){return o*a});case"div":return n.reduce(function(o,a){return o/a});case"avg":var r=n.reduce(function(o,a){return o+a})/(n.length||1);return Math.round(1e4*(r+Number.EPSILON))/1e4;case"min":return Math.min.apply(null,n);case"max":return Math.max.apply(null,n);case"and":return n.reduce(function(o,a){return o&&a});case"or":return n.reduce(function(o,a){return o||a});default:return 0}}switchValueType_Condition(i){switch(i.valuetype){case"value":return this.switchCondition(i.condition,this.getValue(i.variable),i.value);case"variable":return this.switchCondition(i.condition,this.getValue(i.variable),this.getValue(i.value));default:return 0}}switchValueType_Operator(i){switch(i.valuetype){case"value":return this.switchOperator(i.operator,this.getValue(i.variable),i.value);case"variable":return this.switchOperator(i.operator,this.getValue(i.variable),this.getValue(i.value));case"variables":var n=this.switchFormula(i.valueformula,i.value.map(r=>this.getValue(r)));return this.switchOperator(i.operator,this.getValue(i.variable),n)}}checkValueCondition(i){return this.switchValueType_Condition(i)}getValueOperator(i){return this.switchValueType_Operator(i)}setValueOperator(i){null!=i&&i.variable&&this.setValue(i.variable,this.getValueOperator(i))}checkValueConditions(i){return 0==i.map(n=>{switch(n.type){case"variable":return this.switchValueType_Condition(n)?0:1;case"variables":return 0==n.variables.map(r=>this.switchValueType_Condition(Object.assign(Oe(n),{variable:r}))?0:1).reduce(function(r,o){return r+o})?0:1;default:return 0}}).reduce((n,r)=>(null!=n?n:0)+(null!=r?r:0))}setValueOperators(i){for(var n of i)switch(n.type){case"variable":this.setValue(n.variable,this.getValueOperator(n));break;case"variables":for(var r of n.variables)this.setValue(r,this.getValueOperator(Object.assign(Oe(n),{variable:r})));break;case"slide":Pe.$.runSlide(void 0,void 0,n.slide);break;case"node":{var o;(0,Xe.L5)({id:n.node,nodeStatus:Pe.$.nodeStatus,slideStatus:Pe.$.slideStatus});let a=Pe.$.findNode(n.node);null!=a&&null!==(o=a.interactive)&&void 0!==o&&o.click&&(0,Ze.F)(a,Pe.$.nodeStatus,Pe.$.slideStatus);break}}}FuncGetExecutings(i){"function"==typeof i&&this.GetActionExecutings.push(i)}OnGetActionExecuting(i){this.GetActionExecutings.forEach(n=>{n(i)})}}class $e{constructor(){this._fnChangePointerTypes=[],this._fnChangePointerTypeTemps=[],this._fnChangePenTypes=[],this._fnChangeShapeTypes=[],this._fnChangePolygonTypes=[],this._fnChanges=[],this._pointer_type=0,this._pointer_type_temp=0,this._pen_type=0,this._shape_type=0,this._polygon_type=0}setPointer_nochange(i,n,r){if(this._pointer_type=i,n)switch(i){case k._.PEN:this._pen_type=n;break;case k._.SHAPE:this._shape_type=n,r&&n===A.$.POLYGON&&(this._polygon_type=r)}}get pointer_type(){return this._pointer_type}set pointer_type(i){switch(this._pointer_type=i,i){case k._.PEN:this._pen_type||(this._pen_type=Rt.D.DRAW);break;case k._.SHAPE:this._shape_type||(this._shape_type=A.$.RECT)}this.changePointerType(this.pointer_type),this.change(this.pointer_type)}get pointer_type_temp(){return this._pointer_type_temp}set pointer_type_temp(i){this._pointer_type_temp=i,this.changePointerTypeTemp(this.pointer_type),this.change(this.pointer_type_temp)}get pen_type(){return this._pen_type}set pen_type(i){this._pen_type=i,this.changePenType(this.pointer_type,this.pen_type),this.change(this.pointer_type,this.pen_type)}get shape_type(){return this._shape_type}set shape_type(i){this._shape_type=i,this.changeShapeType(this.pointer_type,this.shape_type),this.change(this.pointer_type,this.shape_type)}get polygon_type(){return this._polygon_type}set polygon_type(i){this._polygon_type=i,this.changePolygonType(this.pointer_type,this.shape_type,this.polygon_type),this.change(this.pointer_type,this.shape_type,this.polygon_type)}set onchangePointerType(i){this._fnChangePointerTypes.push(i)}changePointerType(i,n,r){this._fnChangePointerTypes.forEach(o=>o(i,n,r))}set onchangePointerTypeTemp(i){this._fnChangePointerTypeTemps.push(i)}changePointerTypeTemp(i,n,r){this._fnChangePointerTypeTemps.forEach(o=>o(i,n,r))}set onchangePenType(i){this._fnChangePenTypes.push(i)}changePenType(i,n,r){this._fnChangePenTypes.forEach(o=>o(i,n,r))}set onchangeShapeType(i){this._fnChangeShapeTypes.push(i)}changeShapeType(i,n,r){this._fnChangeShapeTypes.forEach(o=>o(i,n,r))}set onchangePolygonType(i){this._fnChangePolygonTypes.push(i)}changePolygonType(i,n,r){this._fnChangePolygonTypes.forEach(o=>o(i,n,r))}set onchange(i){this._fnChanges.push(i)}change(i,n,r){this._fnChanges.forEach(o=>o(i,n,r))}}const bt=new class hi{constructor(){this._container="",this._svg="",this._screen=Fe.prototype,this._data=ne.prototype,this._dataSelect=kt.prototype,this._slide=ee.prototype,this._history=we.prototype,this._attribute=He.prototype,this._pointer=$e.prototype,this._variable=Je.prototype,this._data=new ne,this._dataSelect=new kt,this._slide=new ee,this._history=new we,this._attribute=new He,this._pointer=new $e,this._variable=new Je,this._pointer.onchangePointerType=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._pointer.onchangePointerTypeTemp=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._data.onChangeSlide=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])}}get config(){return this._config}set config(i){this._config=i}get dataSource(){return{modules:"icdtV2",screen:this._screen.get,data:this._data.get,resources:this._data.getResource,variable:this._variable.get,info:{}}}set dataSource(i){this._screen.set=i.screen||{width:1080,height:1080},this._data.set=i.data||{},this._variable.set=i.variable||{}}get container(){return this._container}set container(i){this._container=i}get svg(){return this._svg}set svg(i){this._svg=i}get target(){return window.document.querySelector(this._svg)}get screen(){return this._screen}get data(){return this._data}get dataSelect(){return this._dataSelect}get slide(){return this._slide}get history(){return this._history}get attribute(){return this._attribute}get pointer(){return this._pointer}get variable(){return this._variable}reloadView(){var i,n,r,o,a;this._screen.screen=(i=jQuery(this._container).offset(),n=jQuery(this._container).width(),r=jQuery(this._container).height(),console.log("reloadView",JSON.stringify({offset:i,width:n,height:r})),{offset:{x:null!==(o=null==i?void 0:i.left)&&void 0!==o?o:0,y:null!==(a=null==i?void 0:i.top)&&void 0!==a?a:0},width:null!=n?n:0,height:null!=r?r:0})}init(i){this._container=i.container,this._svg=i.target,this._screen=new Fe,(D=>{new E.Mh(D.container,D.target),bt.pointer.onchange=(r,o,a)=>{switch(r){case k._.POINTER:jQuery(D.target).css({cursor:"auto"});break;case k._.HAND:jQuery(D.target).css({cursor:"grab"});break;case k._.PEN:switch(o){case Rt.D.DRAW:jQuery(D.target).css({cursor:"url(assets/images/svg/icon/viet.png) 12 32,default"});break;case Rt.D.HIGHTLIGH:jQuery(D.target).css({cursor:"url(assets/images/svg/icon/highlight1.png) 12 32,default"})}break;case k._.ERASER:jQuery(D.target).css({cursor:"url(assets/images/svg/icon/gom.png) 22 22,default"});break;case k._.SHAPE:jQuery(D.target).css({cursor:"url(assets/images/svg/icon/point.png) 22 22,default"});break;case k._.TEXT:case k._.FOREIGNOBJECT:jQuery(D.target).css({cursor:"url(assets/images/svg/icon/textmouse.png) 22 22,default"})}},jQuery(D.container).off("mousedown.icdt-init-icon").on("mousedown.icdt-init-icon",r=>{bt.pointer.pointer_type==k._.HAND&&jQuery(D.target).css({cursor:"grabbing"})}).off("mouseup.icdt-init-icon").on("mouseup.icdt-init-icon",r=>{bt.pointer.pointer_type==k._.HAND&&jQuery(D.target).css({cursor:"grab"})}),document.addEventListener("wheel",r=>{r.ctrlKey&&r.preventDefault()},{passive:!1}),jQuery(D.container).off("wheel.icdt-init").on("wheel.icdt-init",r=>{var o;r.preventDefault();let a=null!==(o=r.originalEvent)&&void 0!==o?o:r;if(!a.deltaX&&a.deltaY!=Math.floor(a.deltaY)||a.ctrlKey){var m=bt.screen.scale;bt.screen.scaleTo(m-.04*m*(a.deltaY>0?1:-1),(0,wt.p)({x:r.clientX,y:r.clientY},1,{x:0,y:0},bt.screen.offset))}else bt.screen.move(bt.screen.dislocation,{x:-a.deltaX,y:-a.deltaY})}),jQuery(window).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{bt.screen.actived=!!jQuery(r.target).parents(bt.container).length}),jQuery(D.container).off("mouseenter.icdt-init").on("mouseenter.icdt-init",r=>{bt.screen.actived=!0}),jQuery(D.container).off("mouseleave.icdt-init").on("mouseleave.icdt-init",r=>{bt.screen.actived=!1,bt.pointer.pointer_type_temp==k._.HAND&&(bt.pointer.pointer_type_temp=k._.POINTER)}),jQuery(D.container).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{0==r.button&&(D.container.includes("#")&&D.container.includes(r.target.getAttribute("id"))||D.container.includes(".")&&D.container.includes(r.target.getAttribute("class"))||D.container.includes(r.target.nodeName))&&(bt.pointer.pointer_type_temp||bt.pointer.pointer_type)===k._.POINTER&&(bt.dataSelect.ids=[])}),jQuery(D.container).off("touchmove.icdt-init").on("touchmove.icdt-init",r=>{r.preventDefault()});const i=r=>{switch(bt.pointer.pointer_type_temp||bt.pointer.pointer_type){case k._.POINTER:h(r);break;case k._.HAND:(D=>{(0,yt.A)(D,new S,1,{x:0,y:0})})(r);break;case k._.PEN:(0,qt.i)(r);break;case k._.SHAPE:(D=>{var i=null;switch(bt.pointer.shape_type){case A.$.CIRCLE:i=new K;break;case A.$.ELLIPSE:i=new V;break;case A.$.LINE:i=new Kt;break;case A.$.RECT:i=new J;break;case A.$.POLYGON:var n;i=new vt(null===(n=_.find(r=>r.type==bt.pointer.polygon_type))||void 0===n?void 0:n.ratios);break;case A.$.FOREIGNOBJECT:i=new W;break;case A.$.IMAGE:i=new Ot;break;case A.$.TEXT:case A.$.PATH:i=new Lt}i&&(0,yt.A)(D,i)})(r);break;case k._.FOREIGNOBJECT:(D=>{(0,yt.A)(D,new W)})(r);break;case k._.IMAGE:(D=>{(0,yt.A)(D,new Ot)})(r);break;case k._.TEXT:(D=>{(0,yt.A)(D,new H)})(r);break;case k._.ERASER:(D=>{(0,yt.A)(D,new gt)})(r);break;case k._.INDEX:(0,Et.s)(r)}};let n=!1;jQuery(D.target).off("touchstart.icdt-init").on("touchstart.icdt-init",r=>{n=!0,i({touchEvent:r})}),jQuery(D.target).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{if(1!=r.button){if(n)return void(n=!1);i({mouseEvent:r})}}),D.iskeyboard&&(jQuery(window).off("keydown.icdt-init").on("keydown.icdt-init",r=>{bt.screen.actived&&((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),(0,it.t)(r))}),jQuery(window).off("keyup.icdt-init").on("keyup.icdt-init",r=>{bt.screen.actived&&((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),(0,it.t)(r))}))})({container:i.container,target:i.target,iskeyboard:i.iskeyboard})}}},4531:(ue,jt,p)=>{p.d(jt,{s:()=>R,Q:()=>h});var k=p(1687),E=p(4981),ot=p(4318),j=p(6816),yt=p(7492);const R=C=>{var S,A,Z,_;let P=(null===(S=C.mouseEvent)||void 0===S?void 0:S.target)||(null===(A=C.touchEvent)||void 0===A?void 0:A.target),u=(null==P?void 0:P.getAttribute("id"))||"",K=null==P?void 0:P.nodeName,B=jQuery(P).parents("g[id]").attr("id")||"";if(![k.O.INDEX_GROUP].includes(B))if(null!==(Z=C.mouseEvent)&&void 0!==Z&&Z.altKey||null!==(_=C.touchEvent)&&void 0!==_&&_.altKey||!u||u.match(/[^0-9]/)||!E.icdt.dataSelect.nodeName.includes(K)){var V;E.icdt.dataSelect.ids.length&&(E.icdt.dataSelect.ids=[]),(0==(null===(V=C.mouseEvent)||void 0===V?void 0:V.button)||C.touchEvent)&&((C,S)=>{let u=(0,yt.g1)(k.O.SCAN_GROUP,"g"),K=(0,ot.bH)(0,0,1,1);(0,yt.vl)(u,K),((C,S,A,Z)=>{(0,j.A)(C,{start:u=>{},move:(u,K)=>{((u,K,B,V)=>{S=(0,ot.bH)(u,K,B,V),(0,yt.vl)(A,S)})(K[0][0],K[0][1],u.x,u.y)},end:(u,K)=>{null==A||A.remove(),E.icdt.dataSelect.ids=E.icdt.data.getNodeInArea(Math.min(K[0][0],u.x),Math.min(K[0][1],u.y),Math.max(K[0][0],u.x),Math.max(K[0][1],u.y)),Z(E.icdt.dataSelect.nodes)}})})(C,K,u,S)})(C,M)}else{var tt,J;let I=parseFloat(u||"0");E.icdt.dataSelect.ids=null!==(tt=C.mouseEvent)&&void 0!==tt&&tt.shiftKey||null!==(J=C.touchEvent)&&void 0!==J&&J.shiftKey?[I].concat(E.icdt.dataSelect.ids).filter((Mt,Kt,$t)=>$t.indexOf(Mt)==Kt):[I],M(E.icdt.dataSelect.nodes)}},M=C=>{var S,A;let Z=1;var _,P;if(C.length&&(Z=Math.max.apply(null,null!==(_=null===(P=E.icdt.data.slide)||void 0===P||null===(P=P.svg)||void 0===P?void 0:P.nodes.map(K=>{var B;return null!==(B=K.idx)&&void 0!==B?B:0}))&&void 0!==_?_:[0])+1),1==C.length)C[0].idx||(C[0].idx=Z,C[0].time=0);else if(C.length>=0){let K=C.map(V=>{var tt;return null!==(tt=V.idx)&&void 0!==tt?tt:0}).filter(V=>V>0),B=K.length?Math.min.apply(null,K):Z;C.forEach(V=>{var tt;V.idx=B,V.time=null!==(tt=V.time)&&void 0!==tt?tt:0})}let u=(0,yt.g1)(k.O.INDEX_GROUP,"g");(0,yt.mo)(u,null!==(S=null===(A=E.icdt.data.slide)||void 0===A||null===(A=A.svg)||void 0===A?void 0:A.nodes)&&void 0!==S?S:[])},h=C=>{var S,A,Z;null!=C&&null!==(S=C.svg)&&void 0!==S&&S.nodes&&C.svg.nodes.forEach(P=>{P.idx=0,P.time=null});let _=(0,yt.g1)(k.O.INDEX_GROUP,"g");(0,yt.mo)(_,null!==(A=null===(Z=E.icdt.data.slide)||void 0===Z||null===(Z=Z.svg)||void 0===Z?void 0:Z.nodes)&&void 0!==A?A:[])}},4578:(ue,jt,p)=>{p.d(jt,{h:()=>S,t:()=>A});var k=p(644),E=p(9451),ot=p(968),j=p(4981),yt=p(666),b=p(3171),v=p(5226),R=p(3423),M=p(5811),h=p(3385);const S=new class C{constructor(){this._fnChanges=[],this.onchange={type:"keydown",key:E.s.Escape,fn:()=>{j.icdt.dataSelect.ids.length&&(j.icdt.dataSelect.ids=[])}},this.onchange={type:"keydown",key:E.s.Delete,fn:()=>{j.icdt.dataSelect.deleteNode()}},this.onchange={type:"keydown",key:E.s.Space,fn:()=>{j.icdt.pointer.pointer_type_temp=ot._.HAND}},this.onchange={type:"keyup",key:E.s.Space,fn:()=>{j.icdt.pointer.pointer_type_temp=ot._.POINTER}},this.onchange={type:"keydown",key:E.s.ArrowLeft,fn:()=>{j.icdt.dataSelect.ids.length||j.icdt.data.backSlide()}},this.onchange={type:"keydown",key:E.s.ArrowRight,fn:()=>{j.icdt.dataSelect.ids.length||j.icdt.data.nextSlide()}},this.onchange={type:"keydown",key:E.s.ArrowLeft,fn:()=>{j.icdt.dataSelect.ids.length&&(j.icdt.dataSelect.nodes.forEach(_=>{(0,h.k6)(_,(0,M.q)(_.size.x-(0,R.v)(1)))}),1==j.icdt.dataSelect.ids.length?(0,yt.y)(j.icdt.dataSelect.nodes[0]):(0,b.Q)(j.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:E.s.ArrowRight,fn:()=>{j.icdt.dataSelect.ids.length&&(j.icdt.dataSelect.nodes.forEach(_=>{(0,h.k6)(_,(0,M.q)(_.size.x+(0,R.v)(1)))}),1==j.icdt.dataSelect.ids.length?(0,yt.y)(j.icdt.dataSelect.nodes[0]):(0,b.Q)(j.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:E.s.ArrowUp,fn:()=>{j.icdt.dataSelect.ids.length&&(j.icdt.dataSelect.nodes.forEach(_=>{(0,h.co)(_,(0,M.q)(_.size.y-(0,R.v)(1)))}),1==j.icdt.dataSelect.ids.length?(0,yt.y)(j.icdt.dataSelect.nodes[0]):(0,b.Q)(j.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:E.s.ArrowDown,fn:()=>{j.icdt.dataSelect.ids.length&&(j.icdt.dataSelect.nodes.forEach(_=>{(0,h.co)(_,(0,M.q)(_.size.y+(0,R.v)(1)))}),1==j.icdt.dataSelect.ids.length?(0,yt.y)(j.icdt.dataSelect.nodes[0]):(0,b.Q)(j.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:E.s.Digit1,fn:_=>{_.shiftKey&&(j.icdt.reloadView(),j.icdt.screen.zoomTo="fit")}},this.onchange={type:"keydown",key:E.s.KeyA,fn:_=>{if(_.ctrlKey){j.icdt.dataSelect.ids=j.icdt.data.getNodeAll();let P=j.icdt.dataSelect.nodes;1==P.length?(0,yt.y)(P[0]):P.length>1&&(0,b.Q)(P)}}},this.onchange={type:"keydown",key:E.s.KeyC,fn:_=>{if(_.ctrlKey){let P=j.icdt.dataSelect.nodes;P&&(0,k.yR)({params:{type:"nodes",nodes:P}})}}},this.onchange={type:"keydown",key:E.s.KeyV,fn:_=>{_.ctrlKey&&(0,k.aY)({callback:P=>{var u,K;"nodes"==(null==P?void 0:P.type)&&null!=P&&null!==(u=P.nodes)&&void 0!==u&&u.length&&(null==P||null===(K=P.nodes)||void 0===K||K.forEach(B=>{B.id=Math.ceil(1e9*Math.random()),j.icdt.data.node=B}),(0,v.E)(j.icdt.data.slide))}})}},this.onchange={type:"keydown",key:E.s.KeyZ,fn:_=>{_.ctrlKey&&_.shiftKey?j.icdt.history.redo():_.ctrlKey&&j.icdt.history.undo()}},this.onchange={type:"keydown",key:E.s.BracketLeft,fn:_=>{_.ctrlKey&&_.shiftKey?j.icdt.data.sendToBack(j.icdt.dataSelect.ids):_.ctrlKey?j.icdt.data.sendToBackStep(j.icdt.dataSelect.ids,-2):j.icdt.data.sendToBackArea(j.icdt.dataSelect.ids)}},this.onchange={type:"keydown",key:E.s.BracketRight,fn:_=>{_.ctrlKey&&_.shiftKey?j.icdt.data.bringToFront(j.icdt.dataSelect.ids):_.ctrlKey?j.icdt.data.bringToFrontStep(j.icdt.dataSelect.ids,1):j.icdt.data.bringToFrontArea(j.icdt.dataSelect.ids)}}}set onchange(_){let P=this._fnChanges.find(u=>u.eventType==_.type&&u.eventKey==_.key);P?P.fns.push(_.fn):this._fnChanges.push({eventType:_.type,eventKey:_.key,fns:[_.fn]})}change(_,P,u){var K;null===(K=this._fnChanges.find(B=>B.eventType==_&&B.eventKey==P))||void 0===K||K.fns.forEach(B=>B(u))}},A=Z=>{S.change(Z.type,Z.keyCode||Z.which||Z.charCode||0,Z)}},410:(ue,jt,p)=>{p.d(jt,{a:()=>R});var k=p(9322),E=p(7492),ot=p(511),j=p(3423),yt=p(1687),b=p(4981),v=p(8619);class R{constructor(h,C){var S,A;let Z={stroke:"#FF0000",strokeWidth:(0,j.v)(2),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:(0,j.v)(8)},{element:_}=(0,k.G)(Math.ceil(1e9*Math.random()),{size:C});window.document.getElementById(yt.O.INTERACTIVE_GROUP).querySelectorAll("path").forEach(J=>null==J?void 0:J.remove()),window.document.getElementById(yt.O.INTERACTIVE_GROUP).querySelectorAll("circle").forEach(J=>null==J?void 0:J.remove()),null===(S=window.document.getElementById(yt.O.INTERACTIVE_GROUP))||void 0===S||S.appendChild(_);var K=J=>{if(!J.length)return;let I=[];if(1==J.length){var vt;let{size:Mt}=null!==(vt=null!=h?h:b.icdt.dataSelect.nodes[0])&&void 0!==vt?vt:{};if(!Mt)return;I=[[Mt.x+Mt.width/2,Mt.y+Mt.height/2],J[0]]}else I=[...J];V(I),B(I[0],"start"),B(I[I.length-1],"end")},B=(J,I)=>{J&&((vt=>{let{element:Mt}=(0,v._)(Math.ceil(1e9*Math.random()),{attribute:{fill:"start"==I?"#FF0000":"#00BA00",strokeWidth:(0,j.v)(1)},size:{x:J[0]-5,y:J[1]-5,width:10,height:10}});null===(vt=window.document.getElementById(yt.O.INTERACTIVE_GROUP))||void 0===vt||vt.prepend(Mt)})(),((vt,Mt)=>{let{size:Kt}=null!==(vt=null!=h?h:b.icdt.dataSelect.nodes[0])&&void 0!==vt?vt:{};if(!Kt)return;let $t=[[J[0]-Kt.width/2,J[1]-Kt.height/2],[J[0]+Kt.width/2,J[1]-Kt.height/2],[J[0]+Kt.width/2,J[1]+Kt.height/2],[J[0]-Kt.width/2,J[1]+Kt.height/2],[J[0]-Kt.width/2,J[1]-Kt.height/2]],{element:Ft}=(0,k.G)(Math.ceil(1e9*Math.random()),{attribute:{fill:"#FFFFFF",fillOpacity:.6,stroke:"#5f6ce1",strokeWidth:(0,j.v)(1),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:(0,j.v)(8)},size:{x:0,y:0,width:10,height:10,points:$t}});null===(Mt=window.document.getElementById(yt.O.INTERACTIVE_GROUP))||void 0===Mt||Mt.prepend(Ft)})())},V=J=>{let vt=ot.jvg().x(Mt=>Mt[0]).y(Mt=>Mt[1]).curve(ot.$0Z)(J);_.setAttribute("d",vt)};(0,E.__)(_,Z),K(null!==(A=null==C?void 0:C.points)&&void 0!==A?A:[]);let tt="";return{start:J=>{tt=`M ${J.x} ${J.y} L ${J.x} ${J.y}`},move:(J,I)=>{tt+=` ${J.x} ${J.y}`,_.setAttribute("d",tt)},end:(J,I)=>{K(I),I.length&&(window.interactivePoints=I)}}}}},9623:(ue,jt,p)=>{p.d(jt,{U:()=>Z,i:()=>A});var k=p(1687),E=p(9125),ot=p(4981),j=p(6816),yt=p(7492),b=p(511),v=p(9322),R=p(9054),M=p(7851);class h{constructor(){let P={stroke:ot.icdt.attribute.stroke,strokeWidth:ot.icdt.attribute.strokeWidth,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:u,element:K,attribute:B,size:V}=(0,v.G)(Math.ceil(1e9*Math.random()),{attribute:P});(0,yt.__)(K,B);let tt="",J="";return{start:vt=>{tt=`M ${vt.x} ${vt.y} L ${vt.x} ${vt.y}`},move:(vt,Mt)=>{((vt,Mt)=>{tt+=` ${vt} ${Mt}`,K.setAttribute("d",tt)})(vt.x,vt.y)},end:(vt,Mt)=>{var Kt;Mt.length>=3?(J=null!==(Kt=b.jvg().x(Ot=>Ot[0]).y(Ot=>Ot[1]).curve(b.$0Z)(Mt))&&void 0!==Kt?Kt:"",K.setAttribute("d",J)):K.setAttribute("d",tt);let $t=(0,M.n2)(J||tt),{minX:Ft,minY:Lt,maxX:st,maxY:W}=(0,M.yo)($t);V.x=Ft,V.y=Lt,V.width=st-Ft||1,V.height=W-Lt||1,V.ratioMaps=(0,M.IX)(V,$t),ot.icdt.data.node=Object.assign({id:u,type:R.$.PATH,name:"Path"},{size:V,attribute:B})}}}}class C{constructor(){let P={stroke:ot.icdt.attribute.stroke,strokeOpacity:.4,strokeWidth:ot.icdt.attribute.strokeWidth,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:u,element:K,attribute:B,size:V}=(0,v.G)(Math.ceil(1e9*Math.random()),{attribute:P});(0,yt.__)(K,B);let tt="";return{start:vt=>{tt=`M ${vt.x} ${vt.y} L ${vt.x} ${vt.y}`},move:(vt,Mt)=>{((vt,Mt)=>{tt+=` ${vt} ${Mt}`,K.setAttribute("d",tt)})(vt.x,vt.y)},end:(vt,Mt)=>{let Kt=(0,M.n2)(tt),{minX:$t,minY:Ft,maxX:Lt,maxY:st}=(0,M.yo)(Kt);V.x=$t,V.y=Ft,V.width=Lt-$t||1,V.height=st-Ft||1,V.ratioMaps=(0,M.IX)(V,Kt),ot.icdt.data.node=Object.assign({id:u,type:R.$.PATH,name:"Path"},{size:V,attribute:B})}}}}var S=p(410);const A=_=>{switch(ot.icdt.pointer.pen_type){case E.D.DRAW:(0,j.A)(_,new h);break;case E.D.HIGHTLIGH:(0,j.A)(_,new C);break;case E.D.INTERACTIVE:Z(_)}},Z=_=>{var P,u;let K=(0,yt.g1)(k.O.INTERACTIVE_GROUP,"g"),B=null!==(P=null===(u=ot.icdt.data.slide)||void 0===u||null===(u=u.svg)||void 0===u?void 0:u.viewBox)&&void 0!==P?P:(()=>{let{width:V,height:tt}=ot.icdt.screen.get;return{x:0,y:0,width:V,height:tt}})();(0,yt.XH)(K,B),_&&(0,j.A)(_,new S.a)}},666:(ue,jt,p)=>{p.d(jt,{y:()=>v});var k=p(1687),E=p(4981),ot=p(4318),j=p(6816),yt=p(7492),b=p(5811);const v=h=>{let C=(0,yt.g1)(k.O.RESIZE_GROUP,"g");(0,yt.hJ)(C,h).forEach(S=>{R(S.element,S.posType,h,C)})},R=(h,C,S,A)=>{let Z=!1;null==h||h.addEventListener("touchstart",_=>{Z=!0,M({touchEvent:_},C,S,A)}),null==h||h.addEventListener("mousedown",_=>{if(0==_.button){if(Z)return void(Z=!1);M({mouseEvent:_},C,S,A)}})},M=(h,C,S,A)=>{let I,{id:Z,type:_,size:P,attribute:u}=S,{x:K,y:B,width:V,height:tt}=P,J=(V||1)/(tt||1),Mt=null,Ft=!1;(0,j.A)(h,{start:st=>{Mt=JSON.parse(JSON.stringify({id:Z,size:P,attribute:u}))},move:(st,W)=>{((st,W,_t,Ot)=>{let St=_t-st,it=Ot-W;switch(C){case"rect-center":var qt,X;I=null!==(qt=h.mouseEvent)&&void 0!==qt&&qt.shiftKey||null!==(X=h.touchEvent)&&void 0!==X&&X.shiftKey?Math.abs(_t-st)>=Math.abs(Ot-W)?{x:K+_t-st,y:B,width:V,height:tt}:{x:K,y:B+Ot-W,width:V,height:tt}:{x:K+_t-st,y:B+Ot-W,width:V,height:tt};break;case"rect-top-left":var F,d,at,mt,Pt,zt,Jt,Qt;I=(null!==(F=h.mouseEvent)&&void 0!==F&&F.shiftKey||null!==(d=h.touchEvent)&&void 0!==d&&d.shiftKey)&&(null!==(at=h.mouseEvent)&&void 0!==at&&at.altKey||null!==(mt=h.touchEvent)&&void 0!==mt&&mt.altKey)?J>=1?{x:K+(_t-st),y:B+(_t-st)/J,width:V-2*(_t-st),height:tt-2*(_t-st)/J}:{x:K+(Ot-W)*J,y:B+(Ot-W),width:V-2*(Ot-W)*J,height:tt-2*(Ot-W)}:null!==(Pt=h.mouseEvent)&&void 0!==Pt&&Pt.shiftKey||null!==(zt=h.touchEvent)&&void 0!==zt&&zt.shiftKey?J>=1?{x:K+(_t-st),y:B+(_t-st)/J,width:V-(_t-st),height:tt-(_t-st)/J}:{x:K+(Ot-W)*J,y:B+(Ot-W),width:V-(Ot-W)*J,height:tt-(Ot-W)}:null!==(Jt=h.mouseEvent)&&void 0!==Jt&&Jt.altKey||null!==(Qt=h.touchEvent)&&void 0!==Qt&&Qt.altKey?{x:K+(_t-st),y:B+(Ot-W),width:V-2*(_t-st),height:tt-2*(Ot-W)}:{x:K+(_t-st),y:B+(Ot-W),width:V-(_t-st),height:tt-(Ot-W)};break;case"rect-top-right":var At,pt,te,Y,c,Q,gt,dt;I=(null!==(At=h.mouseEvent)&&void 0!==At&&At.shiftKey||null!==(pt=h.touchEvent)&&void 0!==pt&&pt.shiftKey)&&(null!==(te=h.mouseEvent)&&void 0!==te&&te.altKey||null!==(Y=h.touchEvent)&&void 0!==Y&&Y.altKey)?J>=1?{x:K-(_t-st),y:B-(_t-st)/J,width:V+2*(_t-st),height:tt+2*(_t-st)/J}:{x:K+(Ot-W)*J,y:B+(Ot-W),width:V-2*(Ot-W)*J,height:tt-2*(Ot-W)}:null!==(c=h.mouseEvent)&&void 0!==c&&c.shiftKey||null!==(Q=h.touchEvent)&&void 0!==Q&&Q.shiftKey?J>=1?{x:K,y:B-(_t-st)/J,width:V+(_t-st),height:tt+(_t-st)/J}:{x:K,y:B+(Ot-W),width:V-(Ot-W)*J,height:tt-(Ot-W)}:null!==(gt=h.mouseEvent)&&void 0!==gt&&gt.altKey||null!==(dt=h.touchEvent)&&void 0!==dt&&dt.altKey?{x:K-(_t-st),y:B+(Ot-W),width:V+2*(_t-st),height:tt-2*(Ot-W)}:{x:K,y:B+(Ot-W),width:V+(_t-st),height:tt-(Ot-W)};break;case"rect-bottom-left":var q,H,rt,L,et,Et,Rt,wt;I=(null!==(q=h.mouseEvent)&&void 0!==q&&q.shiftKey||null!==(H=h.touchEvent)&&void 0!==H&&H.shiftKey)&&(null!==(rt=h.mouseEvent)&&void 0!==rt&&rt.altKey||null!==(L=h.touchEvent)&&void 0!==L&&L.altKey)?J>=1?{x:K+(_t-st),y:B+(_t-st)/J,width:V-2*(_t-st),height:tt-2*(_t-st)/J}:{x:K-(Ot-W)*J,y:B-(Ot-W),width:V+2*(Ot-W)*J,height:tt+2*(Ot-W)}:null!==(et=h.mouseEvent)&&void 0!==et&&et.shiftKey||null!==(Et=h.touchEvent)&&void 0!==Et&&Et.shiftKey?J>=1?{x:K+(_t-st),y:B,width:V-(_t-st),height:tt-(_t-st)/J}:{x:K-(Ot-W)*J,y:B,width:V+(Ot-W)*J,height:tt+(Ot-W)}:null!==(Rt=h.mouseEvent)&&void 0!==Rt&&Rt.altKey||null!==(wt=h.touchEvent)&&void 0!==wt&&wt.altKey?{x:K+(_t-st),y:B-(Ot-W),width:V-2*(_t-st),height:tt+2*(Ot-W)}:{x:K+(_t-st),y:B,width:V-(_t-st),height:tt+(Ot-W)};break;case"rect-bottom-right":var It,Ct,kt,ut,Gt,ee,oe,ne;I=(null!==(It=h.mouseEvent)&&void 0!==It&&It.shiftKey||null!==(Ct=h.touchEvent)&&void 0!==Ct&&Ct.shiftKey)&&(null!==(kt=h.mouseEvent)&&void 0!==kt&&kt.altKey||null!==(ut=h.touchEvent)&&void 0!==ut&&ut.altKey)?J>=1?{x:K-(_t-st),y:B-(_t-st)/J,width:V+2*(_t-st),height:tt+2*(_t-st)/J}:{x:K-(Ot-W)*J,y:B-(Ot-W),width:V+2*(Ot-W)*J,height:tt+2*(Ot-W)}:null!==(Gt=h.mouseEvent)&&void 0!==Gt&&Gt.shiftKey||null!==(ee=h.touchEvent)&&void 0!==ee&&ee.shiftKey?J>=1?{x:K,y:B,width:V+(_t-st),height:tt+(_t-st)/J}:{x:K,y:B,width:V+(Ot-W)*J,height:tt+(Ot-W)}:null!==(oe=h.mouseEvent)&&void 0!==oe&&oe.altKey||null!==(ne=h.touchEvent)&&void 0!==ne&&ne.altKey?{x:K-(_t-st),y:B-(Ot-W),width:V+2*(_t-st),height:tt+2*(Ot-W)}:{x:K,y:B,width:V+(_t-st),height:tt+(Ot-W)};break;case"rect-top":var re,we,Fe,Qe;I=null!==(re=h.mouseEvent)&&void 0!==re&&re.shiftKey||null!==(we=h.touchEvent)&&void 0!==we&&we.shiftKey?{x:K+it/2*J,y:B+it,width:V-it*J,height:tt-it}:null!==(Fe=h.mouseEvent)&&void 0!==Fe&&Fe.altKey||null!==(Qe=h.touchEvent)&&void 0!==Qe&&Qe.altKey?{x:K,y:B+it,width:V,height:tt-2*it}:{x:K,y:B+it,width:V,height:tt-it};break;case"rect-bottom":var He,Pe,Ze,Xe;I=null!==(He=h.mouseEvent)&&void 0!==He&&He.shiftKey||null!==(Pe=h.touchEvent)&&void 0!==Pe&&Pe.shiftKey?{x:K-it/2*J,y:B,width:V+it*J,height:tt+it}:null!==(Ze=h.mouseEvent)&&void 0!==Ze&&Ze.altKey||null!==(Xe=h.touchEvent)&&void 0!==Xe&&Xe.altKey?{x:K,y:B-it,width:V,height:tt+2*it}:{x:K,y:B,width:V,height:tt+it};break;case"rect-left":var ii,Oe,Ye,De;I=null!==(ii=h.mouseEvent)&&void 0!==ii&&ii.shiftKey||null!==(Oe=h.touchEvent)&&void 0!==Oe&&Oe.shiftKey?{x:K+St,y:B+St/2/J,width:V-St,height:tt-St/J}:null!==(Ye=h.mouseEvent)&&void 0!==Ye&&Ye.altKey||null!==(De=h.touchEvent)&&void 0!==De&&De.altKey?{x:K+St,y:B,width:V-2*St,height:tt}:{x:K+St,y:B,width:V-St,height:tt};break;case"rect-right":var Ge,qe,Ve,Je;I=null!==(Ge=h.mouseEvent)&&void 0!==Ge&&Ge.shiftKey||null!==(qe=h.touchEvent)&&void 0!==qe&&qe.shiftKey?{x:K,y:B-St/2/J,width:V+St,height:tt+St/J}:null!==(Ve=h.mouseEvent)&&void 0!==Ve&&Ve.altKey||null!==(Je=h.touchEvent)&&void 0!==Je&&Je.altKey?{x:K-St,y:B,width:V+2*St,height:tt}:{x:K,y:B,width:V+St,height:tt};break;default:I={x:K+_t-st,y:B+Ot-W,width:V,height:tt}}I.width<0&&(I.width=0),I.height<0&&(I.height=0),I.x=(0,b.q)(I.x),I.y=(0,b.q)(I.y),I.width=(0,b.q)(I.width),I.height=(0,b.q)(I.height),Object.assign(P,I),Object.assign(u,(0,ot.sg)(_,P,u)),(0,yt.__)(window.document.getElementById(Z),u),(0,yt.hJ)(A,S)})(W[0][0],W[0][1],st.x,st.y),Ft=!0},end:(st,W)=>{Ft&&Mt&&E.icdt.history.push([{type:"size",from:Mt,to:JSON.parse(JSON.stringify({id:Z,size:P,attribute:u}))}])}})}},3171:(ue,jt,p)=>{p.d(jt,{Q:()=>v});var k=p(1687),E=p(4981),ot=p(4318),j=p(6816),yt=p(7492),b=p(5811);const v=h=>{let C=999999,S=999999,A=-999999,Z=-999999;null==h||h.forEach(u=>{C=Math.min(C,u.size.x),S=Math.min(S,u.size.y),A=Math.max(A,u.size.x+u.size.width),Z=Math.max(Z,u.size.y+u.size.height)});let _=(0,yt.g1)(k.O.SELECT_GROUP,"g"),P=(0,ot.bH)(C,S,A,Z);(0,yt.yD)(_,h,P).forEach(u=>{R(u.element,u.posType,P,h,_)})},R=(h,C,S,A,Z)=>{let _=!1;null==h||h.addEventListener("touchstart",P=>{_=!0,M({touchEvent:P},C,S,A,Z)}),null==h||h.addEventListener("mousedown",P=>{if(0==P.button){if(_)return void(_=!1);M({mouseEvent:P},C,S,A,Z)}})},M=(h,C,S,A,Z)=>{let{x:_,y:P,width:u,height:K}=S,B=A.map(Mt=>Object.assign({},Mt.size)),tt=[];(0,j.A)(h,{start:Mt=>{A.forEach((Mt,Kt)=>{let{id:$t,size:Lt,attribute:st}=Mt;tt.push(JSON.parse(JSON.stringify({id:$t,size:Lt,attribute:st})))})},move:(Mt,Kt)=>{((Mt,Kt,$t,Ft)=>{(()=>{let Lt;Lt="rect-center"===C?{x:_+$t-Mt,y:P+Ft-Kt,width:u,height:K}:{x:_,y:P,width:u,height:K},Lt.width<0&&(Lt.width=0),Lt.height<0&&(Lt.height=0),Object.assign(S,Lt),(0,yt.yD)(Z,A,S)})(),A.forEach((Lt,st)=>{let d,{x:W,y:_t,width:Ot,height:St}=B[st],{id:it,type:qt,size:X,attribute:F}=Lt;d="rect-center"===C?{x:W+$t-Mt,y:_t+Ft-Kt,width:Ot,height:St}:{x:W,y:_t,width:Ot,height:St},d.width<0&&(d.width=0),d.height<0&&(d.height=0),d.x=(0,b.q)(d.x),d.y=(0,b.q)(d.y),d.width=(0,b.q)(d.width),d.height=(0,b.q)(d.height),Object.assign(X,d),Object.assign(F,(0,ot.sg)(qt,X,F)),(0,yt.__)(window.document.getElementById(it),F)})})(Kt[0][0],Kt[0][1],Mt.x,Mt.y)},end:(Mt,Kt)=>{tt.length&&E.icdt.history.push(A.map((Mt,Kt)=>{let{id:$t,size:Lt,attribute:st}=Mt;return{type:"size",from:tt[Kt],to:JSON.parse(JSON.stringify({id:$t,size:Lt,attribute:st}))}}))}})}},5226:(ue,jt,p)=>{p.d(jt,{E:()=>_,T:()=>P});var k=p(1687),E=p(8619),ot=p(8785),j=p(2282),yt=p(8054),b=p(4921),v=p(6358),R=p(9054),M=p(9322),h=p(1105),C=p(2875),S=p(7210),A=p(4981),Z=p(7492);const _=(u,K,B)=>{var V;if(K&&!(null!=B?B:window).document.getElementById(K))return;if("localhost"==location.hostname&&console.log("\xe1\xe1\xe1\xe1\xe1\xe1 s\u1ee3 qu\xe1 \u0111iiiiiiiiiiiiiiiiiiiiiiiiiii!",K),K){let J=(null!=B?B:window).document.getElementById(K);jQuery(J).find("#"+k.O.BACKGROUND_GROUP).empty();let I=(0,Z.g1)(k.O.BACKGROUND_GROUP,"g",void 0,J);(0,Z.x0)(I,u)}else{jQuery(A.icdt.target).find("#"+k.O.BACKGROUND_GROUP).empty();let J=(0,Z.g1)(k.O.BACKGROUND_GROUP,"g",void 0,A.icdt.target);(0,Z.x0)(J,u)}let tt=(J,I)=>{I=K&&I?`${K}-${I}`:null!=K?K:I,null==J||J.forEach(vt=>{let Mt=K?`${K}-${vt.id}`:vt.id;var Kt;if(vt.isdeleted)null===(Kt=(null!=B?B:window).document.getElementById(Mt))||void 0===Kt||Kt.remove();else switch(vt.type){case R.$.GROUP:(0,v.m)(Mt,{},I?(null!=B?B:window).document.getElementById(I):null),tt(vt.nodes,vt.id);break;case R.$.CIRCLE:(0,E._)(Mt,{size:vt.size,attribute:vt.attribute},I?(null!=B?B:window).document.getElementById(I):null);break;case R.$.ELLIPSE:(0,ot.r)(Mt,{size:vt.size,attribute:vt.attribute},I?(null!=B?B:window).document.getElementById(I):null);break;case R.$.LINE:(0,b.W)(Mt,{size:vt.size,attribute:vt.attribute},I?(null!=B?B:window).document.getElementById(I):null);break;case R.$.RECT:(0,yt.f)(Mt,{size:vt.size,attribute:vt.attribute},I?(null!=B?B:window).document.getElementById(I):null);break;case R.$.POLYGON:(0,j.l)(Mt,{size:vt.size,attribute:vt.attribute},I?(null!=B?B:window).document.getElementById(I):null);break;case R.$.FOREIGNOBJECT:(0,C.e)(Mt,{size:vt.size,attribute:vt.attribute,style:vt.style,source:vt.source},I?(null!=B?B:window).document.getElementById(I):null);break;case R.$.IMAGE:(0,S.G)(Mt,{size:vt.size,attribute:vt.attribute,source:vt.source},I?(null!=B?B:window).document.getElementById(I):null);break;case R.$.TEXT:(0,h.$)(Mt,{size:vt.size,attribute:vt.attribute,source:vt.source},I?(null!=B?B:window).document.getElementById(I):null);break;case R.$.PATH:(0,M.G)(Mt,{size:vt.size,attribute:vt.attribute},I?(null!=B?B:window).document.getElementById(I):null)}})};tt(null==u||null===(V=u.svg)||void 0===V?void 0:V.nodes)},P=(u,K)=>{var B;if(K&&!window.document.getElementById(K))return;let V=(tt,J)=>{J=J?`${K}-${J}`:K,null==tt||tt.forEach(I=>{jQuery("#"+(K?`${K}-${I.id}`:I.id)).appendTo(J?window.document.getElementById(J):A.icdt.target),I.type==R.$.GROUP&&V(I.nodes,I.id)})};V(null==u||null===(B=u.svg)||void 0===B?void 0:B.nodes)}},8619:(ue,jt,p)=>{p.d(jt,{_:()=>yt});var k=p(9054),E=p(4981),ot=p(4318),j=p(7492);const yt=(b,v,R)=>{let M=(null==v?void 0:v.size)||{x:0,y:0,width:10,height:10},h=(null==v?void 0:v.attribute)||{fill:E.icdt.attribute.fill,stroke:E.icdt.attribute.stroke,strokeWidth:E.icdt.attribute.strokeWidth};return Object.assign(h,(0,ot.sg)(k.$.CIRCLE,M,h)),{nodeId:b,element:(0,j.it)(b,k.$.CIRCLE,"circle",{size:M,attribute:h},R),size:M,attribute:h}}},8785:(ue,jt,p)=>{p.d(jt,{r:()=>yt});var k=p(9054),E=p(4981),ot=p(4318),j=p(7492);const yt=(b,v,R)=>{let M=(null==v?void 0:v.size)||{x:0,y:0,width:10,height:10},h=(null==v?void 0:v.attribute)||{fill:E.icdt.attribute.fill,stroke:E.icdt.attribute.stroke,strokeWidth:E.icdt.attribute.strokeWidth};return Object.assign(h,(0,ot.sg)(k.$.ELLIPSE,M,h)),{nodeId:b,element:(0,j.it)(b,k.$.ELLIPSE,"ellipse",{size:M,attribute:h},R),size:M,attribute:h}}},2875:(ue,jt,p)=>{p.d(jt,{e:()=>j});var k=p(9054),E=p(4318),ot=p(7492);const j=(yt,b,v)=>{let R=(null==b?void 0:b.size)||{x:0,y:0,width:320,height:80},M=(null==b?void 0:b.attribute)||{};Object.assign(M,(0,E.sg)(k.$.FOREIGNOBJECT,R,M));let h=(null==b?void 0:b.source)||{type:"html",html:{htmlContent:'<span style="font-family: Roboto; font-size: 24px;">H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!</span>'}},C=(null==b?void 0:b.style)||{};return{nodeId:yt,element:(0,ot.it)(yt,k.$.FOREIGNOBJECT,"foreignObject",{size:R,attribute:M,style:C,source:h},v),size:R,attribute:M,style:C,source:h}}},6358:(ue,jt,p)=>{p.d(jt,{m:()=>j});var k=p(9054),E=p(4318),ot=p(7492);const j=(b,v,R)=>{let M=(null==v?void 0:v.size)||{x:0,y:0,width:10,height:10},h=(null==v?void 0:v.attribute)||{};return Object.assign(h,(0,E.sg)(k.$.GROUP,M,h)),{nodeId:b,element:(0,ot.it)(b,k.$.GROUP,"g",{size:M,attribute:h},R),size:M,attribute:h}}},7210:(ue,jt,p)=>{p.d(jt,{G:()=>j});var k=p(9054),E=p(4318),ot=p(7492);const j=(yt,b,v)=>{let R=(null==b?void 0:b.size)||{x:0,y:0,width:10,height:10},M=(null==b?void 0:b.attribute)||{preserveAspectRatio:"none"};Object.assign(M,(0,E.sg)(k.$.IMAGE,R,M));let h=(null==b?void 0:b.source)||{type:"image",image:{url:"../../assets/image-svg/logo.svg",path:"assets/image-svg/logo.svg",name:"logo.svg"}};return{nodeId:yt,element:(0,ot.it)(yt,k.$.IMAGE,"image",{size:R,attribute:M,source:h},v),size:R,attribute:M,source:h}}},4921:(ue,jt,p)=>{p.d(jt,{W:()=>yt});var k=p(9054),E=p(4981),ot=p(4318),j=p(7492);const yt=(b,v,R)=>{let M=(null==v?void 0:v.size)||{x:0,y:0,width:10,height:10},h=(null==v?void 0:v.attribute)||{stroke:E.icdt.attribute.stroke,strokeWidth:E.icdt.attribute.strokeWidth,strokeLinecap:E.icdt.attribute.strokeLinecap};return Object.assign(h,(0,ot.sg)(k.$.LINE,M,h)),{nodeId:b,element:(0,j.it)(b,k.$.LINE,"line",{size:M,attribute:h},R),size:M,attribute:h}}},9322:(ue,jt,p)=>{p.d(jt,{G:()=>yt});var k=p(9054),E=p(4981),ot=p(4318),j=p(7492);const yt=(b,v,R)=>{let M=(null==v?void 0:v.size)||{x:0,y:0,width:10,height:10},h=(null==v?void 0:v.attribute)||{stroke:E.icdt.attribute.stroke,strokeWidth:E.icdt.attribute.strokeWidth};return Object.assign(h,(0,ot.sg)(k.$.PATH,M,h)),{nodeId:b,element:(0,j.it)(b,k.$.PATH,"path",{size:M,attribute:h},R),size:M,attribute:h}}},2282:(ue,jt,p)=>{p.d(jt,{l:()=>yt});var k=p(9054),E=p(4981),ot=p(4318),j=p(7492);const yt=(b,v,R)=>{let M=(null==v?void 0:v.size)||{x:0,y:0,width:10,height:10},h=(null==v?void 0:v.attribute)||{fill:E.icdt.attribute.fill,stroke:E.icdt.attribute.stroke,strokeWidth:E.icdt.attribute.strokeWidth};return Object.assign(h,(0,ot.sg)(k.$.POLYGON,M,h)),{nodeId:b,element:(0,j.it)(b,k.$.POLYGON,"polygon",{size:M,attribute:h},R),size:M,attribute:h}}},8054:(ue,jt,p)=>{p.d(jt,{f:()=>yt});var k=p(9054),E=p(4981),ot=p(4318),j=p(7492);const yt=(b,v,R)=>{let M=(null==v?void 0:v.size)||{x:0,y:0,width:10,height:10},h=(null==v?void 0:v.attribute)||{fill:E.icdt.attribute.fill,stroke:E.icdt.attribute.stroke,strokeWidth:E.icdt.attribute.strokeWidth};return Object.assign(h,(0,ot.sg)(k.$.RECT,M,h)),{nodeId:b,element:(0,j.it)(b,k.$.RECT,"rect",{size:M,attribute:h},R),size:M,attribute:h}}},1105:(ue,jt,p)=>{p.d(jt,{$:()=>yt});var k=p(9054),E=p(4981),ot=p(4318),j=p(7492);const yt=(b,v,R)=>{let M=(null==v?void 0:v.size)||{x:0,y:0,width:320,height:80},h=(null==v?void 0:v.attribute)||{fill:E.icdt.attribute.stroke,fontFamily:E.icdt.attribute.fontFamily,fontSize:E.icdt.attribute.fontSize,textLength:E.icdt.attribute.textLength};Object.assign(h,(0,ot.sg)(k.$.TEXT,M,h));let C=(null==v?void 0:v.source)||{type:"text",text:{textContent:"H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!"}};return{nodeId:b,element:(0,j.it)(b,k.$.TEXT,"text",{size:M,attribute:h,source:C},R),size:M,attribute:h,source:C}}},4318:(ue,jt,p)=>{p.d(jt,{bH:()=>ot,sg:()=>j});var k=p(9054),E=p(7851);const ot=(b,v,R,M,h)=>{let C={x:Math.min(b,R),y:Math.min(v,M),width:Math.abs(R-b)||1,height:Math.abs(M-v)||1};return null!=h&&h.ratio&&(C.width<=C.height?C.height=C.width*(null==h?void 0:h.ratio):C.width=C.height/(null==h?void 0:h.ratio)),Object.assign(C,{ratios:(null==h?void 0:h.ratios)||[[(b-C.x)/(C.width||1),(v-C.y)/(C.height||1)],[(R-C.x)/(C.width||1),(M-C.y)/(C.height||1)]]}),null!=h&&h.points&&(C.points=null==h?void 0:h.points),C},j=(b,v,R)=>{var M,h=(()=>{switch(b){case k.$.CIRCLE:return{cx:v.x+v.width/2,cy:v.y+v.height/2,r:Math.min(v.width/2,v.height/2)};case k.$.ELLIPSE:return{cx:v.x+v.width/2,cy:v.y+v.height/2,rx:v.width/2,ry:v.height/2};case k.$.LINE:{var C;let P={};return null===(C=v.ratios)||void 0===C||C.forEach((u,K)=>{P[`x${K+1}`]=v.x+v.width*u[0],P[`y${K+1}`]=v.y+v.height*u[1]}),P}case k.$.RECT:case k.$.FOREIGNOBJECT:case k.$.IMAGE:return{x:v.x,y:v.y,width:v.width,height:v.height};case k.$.TEXT:var S;return{x:v.x,y:v.y+(null!==(S=R.fontSize)&&void 0!==S?S:16)};case k.$.POLYGON:var A;if(null!==(A=v.ratios)&&void 0!==A&&A.length)return{points:(0,E.Q8)(v,v.ratios)};break;case k.$.PATH:var Z,_;if(null!==(Z=v.ratioMaps)&&void 0!==Z&&Z.length)return{d:(0,E.BG)(v,v.ratioMaps)};if(null!==(_=v.points)&&void 0!==_&&_.length)return{d:`M ${(P=v.points)[0][0]} ${P[0][1]} L ${(P.map(u=>[u[0],u[1]])||[]).map(u=>u.join(" ")).join(" ")}`}}var P;return{}})();return v.rotate?(h.transform=`rotate(${v.rotate})`,h.transformOrigin=`${v.x+v.width/2} ${v.y+v.height/2}`):null!==(M=R.transform)&&void 0!==M&&M.match(/^rotate/)&&(R.transform=null,R.transformOrigin=null),h}},3423:(ue,jt,p)=>{p.d(jt,{v:()=>ot});var k=p(4981),E=p(5811);const ot=j=>(0,E.q)(j/k.icdt.screen.scale)},3385:(ue,jt,p)=>{p.d(jt,{Vs:()=>R,co:()=>b,k6:()=>yt,lO:()=>v,mr:()=>M});var k=p(4981),E=p(7492),ot=p(4318),j=p(5811);const yt=(h,C)=>{let{id:S,type:A,size:Z,attribute:_}=h,P=JSON.parse(JSON.stringify({id:S,size:Z,attribute:_}));Z.x=(0,j.q)(C),Object.assign(_,(0,ot.sg)(A,Z,_)),(0,E.__)(window.document.getElementById(S),_),k.icdt.history.push([{type:"size",from:P,to:JSON.parse(JSON.stringify({id:S,size:Z,attribute:_}))}])},b=(h,C)=>{let{id:S,type:A,size:Z,attribute:_}=h,P=JSON.parse(JSON.stringify({id:S,size:Z,attribute:_}));Z.y=(0,j.q)(C),Object.assign(_,(0,ot.sg)(A,Z,_)),(0,E.__)(window.document.getElementById(S),_),k.icdt.history.push([{type:"size",from:P,to:JSON.parse(JSON.stringify({id:S,size:Z,attribute:_}))}])},v=(h,C,S)=>{let{id:A,type:Z,size:_,attribute:P}=h,u=JSON.parse(JSON.stringify({id:A,size:_,attribute:P}));S&&(_.height=(0,j.q)(C*_.height/_.width)),_.width=(0,j.q)(C),Object.assign(P,(0,ot.sg)(Z,_,P)),(0,E.__)(window.document.getElementById(A),P),k.icdt.history.push([{type:"size",from:u,to:JSON.parse(JSON.stringify({id:A,size:_,attribute:P}))}])},R=(h,C,S)=>{let{id:A,type:Z,size:_,attribute:P}=h,u=JSON.parse(JSON.stringify({id:A,size:_,attribute:P}));S&&(_.width=(0,j.q)(C*_.width/_.height)),_.height=(0,j.q)(C),Object.assign(P,(0,ot.sg)(Z,_,P)),(0,E.__)(window.document.getElementById(A),P),k.icdt.history.push([{type:"size",from:u,to:JSON.parse(JSON.stringify({id:A,size:_,attribute:P}))}])},M=(h,C)=>{let{id:S,type:A,size:Z,attribute:_}=h,P=JSON.parse(JSON.stringify({id:S,size:Z,attribute:_}));Z.rotate="number"==typeof C?(0,j.q)(C,100):void 0,Object.assign(_,(0,ot.sg)(A,Z,_)),(0,E.__)(window.document.getElementById(S),_),k.icdt.history.push([{type:"size",from:P,to:JSON.parse(JSON.stringify({id:S,size:Z,attribute:_}))}])}},6816:(ue,jt,p)=>{p.d(jt,{A:()=>b});var k=p(968),E=p(4981);class ot{constructor(R){this._points=[],this._options=R}start(R){this._points.length=0,this._points.push([R.x,R.y]),this._options.start(R)}move(R){this._points.push([R.x,R.y]),this._options.move(R,this._points)}end(){this._options.end(this.offsetLast,this._points)}get offsetFirst(){return this._points.length>=1?{x:(R=this._points[0])[0],y:R[1]}:{x:0,y:0};var R}get offsetLast(){return this._points.length>=1?{x:(R=this._points[this._points.length-1])[0],y:R[1]}:{x:0,y:0};var R}}var j=p(7797);const b=(v,R,M,h,C)=>{var S,A,Z;let _=null,P=0,u=0;v.mouseEvent?(_=v.mouseEvent.target,P=v.mouseEvent.offsetX,u=v.mouseEvent.offsetY):v.touchEvent&&(_=v.touchEvent.target,v.touchEvent.touches.length&&(P=v.touchEvent.touches[0].clientX,u=v.touchEvent.touches[0].clientY));let K=null!=M?M:E.icdt.screen.scale,B=null!=h?h:E.icdt.screen.dislocation,V=null!=C?C:E.icdt.screen.offset,tt=()=>{};var J=new ot({start:null!==(S=null==R?void 0:R.start)&&void 0!==S?S:tt,move:null!==(A=null==R?void 0:R.move)&&void 0!==A?A:tt,end:null!==(Z=null==R?void 0:R.end)&&void 0!==Z?Z:tt});v.mouseEvent?J.start((0,j.p)({x:P,y:u},K,B,{x:0,y:0})):v.touchEvent&&J.start((0,j.p)({x:P,y:u},K,B,V));let I=st=>{J.move((0,j.p)({x:st.clientX,y:st.clientY},K,B,V))},vt=st=>{J.end(),[k._.SHAPE,k._.FOREIGNOBJECT,k._.IMAGE,k._.TEXT].includes(E.icdt.pointer.pointer_type)&&(st.shiftKey||(E.icdt.pointer.pointer_type=k._.POINTER))},Mt=st=>{st.touches.length&&I({clientX:st.touches[0].clientX,clientY:st.touches[0].clientY})},Kt=st=>{vt({shiftKey:st.shiftKey,ctrlKey:st.ctrlKey,altKey:st.altKey}),window.removeEventListener("touchmove",Mt,!1),window.removeEventListener("touchend",Kt,!1)},$t=st=>{0==st.button&&I({clientX:st.clientX,clientY:st.clientY})},Ft=st=>{0==st.button&&(vt({shiftKey:st.shiftKey,ctrlKey:st.ctrlKey,altKey:st.altKey}),window.removeEventListener("mousemove",$t,!1),window.removeEventListener("mouseup",Ft,!1))};if(v.mouseEvent)window.addEventListener("mousemove",$t,!1),window.addEventListener("mouseup",Ft,!1);else if(v.touchEvent){var Lt;window.addEventListener("touchmove",Mt,!1),window.addEventListener("touchend",Kt,!1),null===(Lt=_)||void 0===Lt||Lt.addEventListener("touchmove",function(st){st.preventDefault()})}}},7797:(ue,jt,p)=>{p.d(jt,{p:()=>E});var k=p(5811);const E=(ot,j,yt,b)=>(ot.x-=b.x,ot.y-=b.y,ot.x/=j,ot.y/=j,ot.x-=yt.x,ot.y-=yt.y,ot.x=(0,k.q)(ot.x),ot.y=(0,k.q)(ot.y),ot)},70:(ue,jt,p)=>{p.d(jt,{$:()=>pt,U:()=>te});var k=p(1687),E=p(4981),ot=p(9054),j=p(5973),yt=p(2336),b=p(861),v=p(157),R=p(4787),h=p(1105),C=p(6358);var P=p(7267),u=p(7210),K=p(5811);const B=(Y,c,Q)=>{var gt,dt,q,H;let rt=1,L=new Image;L.onload=()=>{var et,Et,Rt,wt;rt=(0,K.q)(L.naturalWidth/L.naturalHeight,100);let It=0,Ct=0,kt=0,ut=0;var Gt,ee,oe,ne;rt>=1?(kt=Math.min(L.naturalWidth,null!==(Gt=null===(ee=pt.slide.svg)||void 0===ee||null===(ee=ee.viewBox)||void 0===ee?void 0:ee.width)&&void 0!==Gt?Gt:0),ut=kt/rt):(ut=Math.min(L.naturalHeight,null!==(oe=null===(ne=pt.slide.svg)||void 0===ne||null===(ne=ne.viewBox)||void 0===ne?void 0:ne.height)&&void 0!==oe?oe:0),kt=ut/rt),It=((null!==(et=null===(Et=pt.slide.svg)||void 0===Et||null===(Et=Et.viewBox)||void 0===Et?void 0:Et.width)&&void 0!==et?et:0)-kt)/2,Ct=((null!==(Rt=null===(wt=pt.slide.svg)||void 0===wt||null===(wt=wt.viewBox)||void 0===wt?void 0:wt.height)&&void 0!==Rt?Rt:0)-ut)/2,c.size={x:It,y:Ct,width:kt,height:ut},V(c,Q)},L.onerror=et=>{console.error(`ImgSrc load failed -> ${JSON.stringify(c.source)}`,et)},L.src=(null!==(gt=c.source)&&void 0!==gt&&gt.path?(null===(dt=E.icdt.config)||void 0===dt?void 0:dt.readfileuploadurl)+(null===(q=c.source)||void 0===q?void 0:q.path):null===(H=c.source)||void 0===H?void 0:H.url)||""},V=(Y,c)=>{if(Y.slideStatus!=pt.slideStatus)return void c();let{element:Q}=(0,u.G)(Math.ceil(1e9*Math.random()),{size:Y.size,source:{type:"image",image:null==Y?void 0:Y.source}});setTimeout(()=>{null==Q||Q.remove(),c()},3e3)};var tt=p(7492);const J=(Y,c,Q)=>{var gt,dt,q,H;let rt=new Image;rt.onload=()=>{I(Y,{width:rt.naturalWidth,height:rt.naturalHeight},c,Q)},rt.onerror=L=>{console.error(`ImgSrc load failed -> ${JSON.stringify(c.source)}`,L),Q()},rt.src=(null!==(gt=c.source)&&void 0!==gt&&gt.path?(null===(dt=E.icdt.config)||void 0===dt?void 0:dt.readfileuploadurl)+(null===(q=c.source)||void 0===q?void 0:q.path):null===(H=c.source)||void 0===H?void 0:H.url)||""},I=(Y,c,Q,gt)=>{if(Q.slideStatus!=pt.slideStatus)return void gt();let dt=(0,K.q)(c.width/c.height,100),q=0,H=0,rt=0,L=0;dt>=1?(rt=c.width,rt=Math.max(rt,40),rt=Math.min(rt,40),L=rt/dt):(L=c.height,L=Math.max(L,40),L=Math.min(L,40),rt=L/dt);let{size:Rt}=Y;q=Rt.x+Rt.width-rt/2,H=Rt.y-L/2;let wt=(0,tt.g1)(k.O.TEST_GROUP,"g",void 0,E.icdt.target);(0,u.G)(`icon-${Y.id}`,{size:{x:q,y:H,width:rt,height:L},source:{type:"image",image:null==Q?void 0:Q.source}},wt),setTimeout(()=>{gt()},3e3)},vt=(Y,c,Q)=>{var gt,dt,q,H,rt,L,et;if(c.slideStatus!=pt.slideStatus)return void Q();if(!(null!==(gt=c.source)&&void 0!==gt&&gt.path||null!==(dt=c.source)&&void 0!==dt&&dt.url))return console.warn(`${Y.id} -> audio no source!`),void Q();var Et=jQuery("#"+Y.id);let Rt=null!==(q=c.iteration)&&void 0!==q?q:0;if(Rt<0&&(Q(),Q=function(){}),!(Et.data("audio-running")&&Rt<0)){Et.data("audio-running",!0);var wt=new Audio;return wt.autoplay=!0,wt.loop=0!=Rt,wt.preload="auto",wt.controls=!0,wt.setAttributeNode(document.createAttribute("playsinline")),wt.addEventListener("canplay",function(){var It=wt.play();It&&It.then(function(Ct){Et.data("audio-running",!0)}).catch(function(Ct){Et.data("audio-running",!1),c.slideStatus===pt.slideStatus&&Q()})}),wt.addEventListener("timeupdate",function(){var Ct;c.slideStatus!==pt.slideStatus&&((Ct=this).pause(),Ct.remove(),Et.data("audio-running",!1))}),wt.addEventListener("canplaythrough",function(){this.loop&&(Rt>0?Rt--:0==Rt&&(this.loop=!1))}),wt.addEventListener("play",function(){}),wt.addEventListener("pause",function(){}),wt.addEventListener("ended",function(){this.remove(),Et.data("audio-running",!1),c.slideStatus===pt.slideStatus&&Q()}),wt.onerror=function(){this.remove(),Et.data("audio-running",!1),c.slideStatus===pt.slideStatus&&Q()},wt.src=(null!==(H=c.source)&&void 0!==H&&H.path?(null===(rt=E.icdt.config)||void 0===rt?void 0:rt.readfileuploadurl)+(null===(L=c.source)||void 0===L?void 0:L.path):null===(et=c.source)||void 0===et?void 0:et.url)||"",wt}};var Mt=p(9942);const _t=(Y,c)=>{var Q;null===(Q=c.test)||void 0===Q||null===(Q=Q.answer)||void 0===Q||null===(Q=Q.matching)||void 0===Q||Q.filter(gt=>gt.id==Y.id).forEach(gt=>gt.value=""),jQuery(`#node-${Y.id}`).remove()},St=(Y,c,Q,gt,dt,q)=>{var H,rt,L,et,Et,Rt,wt,It,Ct,kt,ut,Gt;dt.iscorrect?(null!==(H=c.test)&&void 0!==H&&null!==(H=H.audiotrue)&&void 0!==H&&H.path&&vt(Y,{source:(0,Mt.I)(null===(et=c.test)||void 0===et?void 0:et.audiotrue),iteration:0,nodeStatus:Q,slideStatus:gt},q),null!==(rt=c.test)&&void 0!==rt&&null!==(rt=rt.icontrue)&&void 0!==rt&&rt.path&&J(Y,{source:(0,Mt.I)(null===(Et=c.test)||void 0===Et?void 0:Et.icontrue),iteration:0,nodeStatus:Q,slideStatus:gt},q),null!==(L=c.test)&&void 0!==L&&null!==(L=L.effecttrue)&&void 0!==L&&L.path&&B(0,{source:(0,Mt.I)(null===(Rt=c.test)||void 0===Rt?void 0:Rt.effecttrue),iteration:0,nodeStatus:Q,slideStatus:gt},q)):(null!==(wt=c.test)&&void 0!==wt&&null!==(wt=wt.audiofalse)&&void 0!==wt&&wt.path&&vt(Y,{source:(0,Mt.I)(null===(kt=c.test)||void 0===kt?void 0:kt.audiofalse),iteration:0,nodeStatus:Q,slideStatus:gt},q),null!==(It=c.test)&&void 0!==It&&null!==(It=It.iconfalse)&&void 0!==It&&It.path&&J(Y,{source:(0,Mt.I)(null===(ut=c.test)||void 0===ut?void 0:ut.iconfalse),iteration:0,nodeStatus:Q,slideStatus:gt},q),null!==(Ct=c.test)&&void 0!==Ct&&null!==(Ct=Ct.effectfalse)&&void 0!==Ct&&Ct.path&&B(0,{source:(0,Mt.I)(null===(Gt=c.test)||void 0===Gt?void 0:Gt.effectfalse),iteration:0,nodeStatus:Q,slideStatus:gt},q))},it=(Y,c,Q,gt)=>{var dt,q,H,rt,L,et,Rt,It,wt;null!==(dt=c.animate)&&void 0!==dt&&dt.value&&(0,P.Z)(c,Q.nodeStatus,Q.slideStatus),null!==(q=c.interactive)&&void 0!==q&&q.show?(console.log(`node(${c.id}) | nodeStatus(${Q.nodeStatus}) | slideStatus(${Q.slideStatus}) | show`),((Y,c,Q,gt)=>{var dt,q,H;let rt={total:0,counter:0},{triggershow:L,triggerrun:et,triggerhide:Et,action:Rt,audio:wt}=null!==(dt=null===(q=Y.interactive)||void 0===q?void 0:q.show)&&void 0!==dt?dt:{};if(console.log(`node(${Y.id}) | nodeStatus(${c}) | slideStatus(${Q}) | show`),L){let{id:Ct,ids:kt,time:ut,async:Gt}=L;"asynctrue"==Gt?setTimeout(()=>{(0,R.L5)({id:Ct,ids:kt,nodeStatus:c,slideStatus:Q})}):"time"==Gt&&setTimeout(()=>{(0,R.L5)({id:Ct,ids:kt,nodeStatus:c,slideStatus:Q})},1e3*(null!=ut?ut:0))}if(et){let{id:Ct,ids:kt,time:ut,async:Gt}=et;"asynctrue"==Gt?setTimeout(()=>{(0,R.Ar)({id:Ct,ids:kt,nodeStatus:c,slideStatus:Q})}):"time"==Gt&&setTimeout(()=>{(0,R.Ar)({id:Ct,ids:kt,nodeStatus:c,slideStatus:Q})},1e3*(null!=ut?ut:0))}if(Et){let{id:Ct,ids:kt,time:ut,async:Gt}=Et;"asynctrue"==Gt?setTimeout(()=>{(0,R.WT)({id:Ct,ids:kt,nodeStatus:c,slideStatus:Q})}):"time"==Gt&&setTimeout(()=>{(0,R.WT)({id:Ct,ids:kt,nodeStatus:c,slideStatus:Q})},1e3*(null!=ut?ut:0))}let It=()=>{setTimeout(()=>{if(rt.counter>=rt.total){if(gt&&gt(),L){let{id:Ct,ids:kt,async:ut}=L;(!ut||"asyncfalse"==ut)&&(0,R.L5)({id:Ct,ids:kt,nodeStatus:c,slideStatus:Q})}if(et){let{id:Ct,ids:kt,async:ut}=et;(!ut||"asyncfalse"==ut)&&(0,R.Ar)({id:Ct,ids:kt,nodeStatus:c,slideStatus:Q})}if(Et){let{id:Ct,ids:kt,async:ut}=Et;(!ut||"asyncfalse"==ut)&&(0,R.WT)({id:Ct,ids:kt,nodeStatus:c,slideStatus:Q})}}})};if(null!=Rt&&Rt.value){rt.total+=1;let Ct=()=>{rt.counter+=1,It()};switch(null==Rt?void 0:Rt.value){case"hide":jQuery("#"+Y.id).addClass("hide"),Ct();break;case"points":{let{points:kt,time:ut,iteration:Gt,finish:ee}=Rt;(0,b.G)(Y.id,{node:Y,points:kt,time:ut,iteration:Gt,finish:ee,nodeStatus:c,slideStatus:Q},Ct);break}default:{let{value:kt,time:ut,iteration:Gt,finish:ee}=Rt;(0,yt.Q)(Y.id,{node:Y,value:kt,time:ut,iteration:Gt,finish:ee,nodeStatus:c,slideStatus:Q},Ct);break}}}if(null!=wt&&null!==(H=wt.source)&&void 0!==H&&H.path){rt.total+=1;let Ct=()=>{rt.counter+=1,It()},kt=(0,v.R)(Y.id,wt,rt,{nodeStatus:c,slideStatus:Q},Ct);-1==(null==wt?void 0:wt.iteration)&&jQuery("#"+Y.id).click(ut=>{ut.preventDefault(),kt&&(kt.volume=kt.volume>=1?0:kt.volume+.25),console.log(null==kt?void 0:kt.volume)})}rt.total||It()})(c,Q.nodeStatus,Q.slideStatus,gt)):gt&&gt(),null!==(H=c.interactive)&&void 0!==H&&H.click&&(It=null===(Rt=c.interactive)||void 0===Rt?void 0:Rt.click,Object.keys(null!=It?It:{}).map(kt=>It[kt]?1:0).includes(1)&&jQuery("#"+c.id).addClass("interactive-click"),jQuery("#"+c.id).click(It=>{It.preventDefault(),Q.nodeStatus=pt.refreshNodeStatus(),console.log(`node(${c.id}) | nodeStatus(${Q.nodeStatus}) | slideStatus(${Q.slideStatus}) | click`),(0,j.F)(c,Q.nodeStatus,Q.slideStatus)})),null!==(rt=c.variable)&&void 0!==rt&&rt.input&&jQuery("#"+c.id).on("change","input,textarea",It=>{It.preventDefault(),((Y,c,Q)=>{var gt,dt;E.icdt.variable.setValue(null!==(gt=null===(dt=c.variable)||void 0===dt||null===(dt=dt.input)||void 0===dt?void 0:dt.variable)&&void 0!==gt?gt:"",Y),(Y=>{var c;let Q=(gt,dt)=>{null==gt||gt.forEach(q=>{switch(q.type){case ot.$.GROUP:(0,C.m)(q.id,{},dt?window.document.getElementById(dt):null),Q(q.nodes,q.id);break;case ot.$.POLYGON:break;case ot.$.TEXT:(0,h.$)(q.id,{size:q.size,attribute:q.attribute,source:q.source},dt?window.document.getElementById(dt):null)}})};Q(null===(c=Y.svg)||void 0===c?void 0:c.nodes)})(Q)})(It.target.value,c,Y)}),null!==(L=c.variable)&&void 0!==L&&L.click&&(null!==(wt=c.variable)&&void 0!==wt&&null!==(wt=wt.click)&&void 0!==wt&&wt.variable&&jQuery("#"+c.id).addClass("variable-click"),jQuery("#"+c.id).click(It=>{It.preventDefault(),((Y,c)=>{var Q;E.icdt.variable.setValueOperator(null===(Q=Y.variable)||void 0===Q?void 0:Q.click),(Y=>{var c;let Q=(gt,dt)=>{null==gt||gt.forEach(q=>{switch(q.type){case ot.$.GROUP:(0,C.m)(q.id,{},dt?window.document.getElementById(dt):null),Q(q.nodes,q.id);break;case ot.$.POLYGON:break;case ot.$.TEXT:(0,h.$)(q.id,{size:q.size,attribute:q.attribute,source:q.source},dt?window.document.getElementById(dt):null)}})};Q(null===(c=Y.svg)||void 0===c?void 0:c.nodes)})(c)})(c,Y)})),"test"==(null===(et=c.source)||void 0===et?void 0:et.type)&&((Y,c)=>{var Q;let gt=()=>{};switch(null===(Q=Y.source)||void 0===Q||null===(Q=Q.test)||void 0===Q?void 0:Q.type){case"truefalse":var dt;if(jQuery("#"+Y.id).click(L=>{L.preventDefault(),((Y,c,Q,gt,dt)=>{var q,H;let rt=null===(q=Y.source)||void 0===q||null===(q=q.test)||void 0===q||null===(q=q.truefalse)||void 0===q?void 0:q.iscorrect;if(c.test?c.test.answer?c.test.answer.truefalse={value:Y.id,iscorrect:rt}:c.test.answer={truefalse:{value:Y.id,iscorrect:rt}}:c.test={answer:{truefalse:{value:Y.id,iscorrect:rt}}},null!==(H=c.svg)&&void 0!==H&&H.nodes.find(L=>{var et;return"submit"==(null===(et=L.source)||void 0===et||null===(et=et.test)||void 0===et?void 0:et.type)})){if(c.test.showselection){let L=(0,tt.g1)(k.O.TEST_GROUP,"g",void 0,E.icdt.target);(0,tt.Yw)(L,c,Y)}}else St(Y,c,Q,gt,{iscorrect:rt},dt)})(Y,c,pt.nodeStatus,pt.slideStatus,gt)}),null!==(dt=c.test)&&void 0!==dt&&dt.showselection){let L=(0,tt.g1)(k.O.TEST_GROUP,"g",void 0,E.icdt.target);(0,tt.Yw)(L,c,Y)}break;case"singlechoice":var q;if(jQuery("#"+Y.id).click(L=>{L.preventDefault(),((Y,c,Q,gt,dt)=>{var q,H;let rt=null===(q=Y.source)||void 0===q||null===(q=q.test)||void 0===q||null===(q=q.singlechoice)||void 0===q?void 0:q.iscorrect;if(c.test?c.test.answer?c.test.answer.singlechoice={value:Y.id,iscorrect:rt}:c.test.answer={singlechoice:{value:Y.id,iscorrect:rt}}:c.test={answer:{singlechoice:{value:Y.id,iscorrect:rt}}},null!==(H=c.svg)&&void 0!==H&&H.nodes.find(L=>{var et;return"submit"==(null===(et=L.source)||void 0===et||null===(et=et.test)||void 0===et?void 0:et.type)})){if(c.test.showselection){let L=(0,tt.g1)(k.O.TEST_GROUP,"g",void 0,E.icdt.target);(0,tt.Yw)(L,c,Y)}}else St(Y,c,Q,gt,{iscorrect:rt},dt)})(Y,c,pt.nodeStatus,pt.slideStatus,gt)}),null!==(q=c.test)&&void 0!==q&&q.showselection){let L=(0,tt.g1)(k.O.TEST_GROUP,"g",void 0,E.icdt.target);(0,tt.Yw)(L,c,Y)}break;case"multichoice":var H;if(jQuery("#"+Y.id).click(L=>{L.preventDefault(),((Y,c,Q,gt,dt)=>{var q,H;let L,rt=null===(q=Y.source)||void 0===q||null===(q=q.test)||void 0===q||null===(q=q.multichoice)||void 0===q?void 0:q.iscorrect;if(c.test?c.test.answer?c.test.answer.multichoice?c.test.answer.multichoice.find(et=>et.value==Y.id)?(c.test.answer.multichoice=c.test.answer.multichoice.filter(et=>et.value!=Y.id),L=!0):c.test.answer.multichoice.push({value:Y.id,iscorrect:rt}):c.test.answer.multichoice=[{value:Y.id,iscorrect:rt}]:c.test.answer={multichoice:[{value:Y.id,iscorrect:rt}]}:c.test={answer:{multichoice:[{value:Y.id,iscorrect:rt}]}},null!==(H=c.svg)&&void 0!==H&&H.nodes.find(et=>{var Et;return"submit"==(null===(Et=et.source)||void 0===Et||null===(Et=Et.test)||void 0===Et?void 0:Et.type)})){if(c.test.showselection){let et=(0,tt.g1)(k.O.TEST_GROUP,"g",void 0,E.icdt.target);(0,tt.Yw)(et,c,Y)}}else St(Y,c,Q,gt,{iscorrect:rt},dt)})(Y,c,pt.nodeStatus,pt.slideStatus,gt)}),null!==(H=c.test)&&void 0!==H&&H.showselection){let L=(0,tt.g1)(k.O.TEST_GROUP,"g",void 0,E.icdt.target);(0,tt.Yw)(L,c,Y)}break;case"fill":var rt;jQuery("#"+Y.id).on("keyup",'input[type="text"]',L=>{var et;let Et=jQuery("<div/>").css({"font-size":jQuery(L.target).css("font-size"),visibility:"hidden",float:"left"}).text(L.target.value).appendTo(window.document.body);jQuery(L.target).css({width:(null!==(et=Et.width())&&void 0!==et?et:0)+30})}).on("keypress",'input[type="text"]',L=>{13===(L.keyCode||L.charCode||L.which)&&(L.preventDefault(),L.stopPropagation(),jQuery(L.target).blur())}).on("change",'input[type="text"]',L=>{var et,Et;let Rt=pt.nodeStatus,wt=pt.slideStatus,It=null===(et=L.target)||void 0===et?void 0:et.getAttribute("data-key"),Ct=null===(Et=L.target)||void 0===Et||null===(Et=Et.value)||void 0===Et?void 0:Et.trim();((Y,c,Q,gt,dt,q)=>{var H,rt,L,et;let{value:Et}=null!==(H=null===(rt=Y.source)||void 0===rt||null===(rt=rt.test)||void 0===rt||null===(rt=rt.fill)||void 0===rt?void 0:rt.find(wt=>wt.key==`[[${dt.key}]]`))&&void 0!==H?H:{},Rt=Et&&Et.map(wt=>null==wt?void 0:wt.toLocaleLowerCase()).includes(null===(L=dt.value)||void 0===L?void 0:L.toLocaleLowerCase());null!==(et=c.svg)&&void 0!==et&&et.nodes.find(wt=>{var It;return"submit"==(null===(It=wt.source)||void 0===It||null===(It=It.test)||void 0===It?void 0:It.type)})||St(Y,c,Q,gt,{iscorrect:Rt},q),dt.iscorrect=Rt,c.test?c.test.answer?c.test.answer.fill?c.test.answer.fill.find(wt=>wt.key==dt.key)?c.test.answer.fill.filter(wt=>wt.key==dt.key).forEach(wt=>{wt.value=dt.value,wt.iscorrect=dt.iscorrect}):c.test.answer.fill.push(dt):c.test.answer.fill=[dt]:c.test.answer={fill:[dt]}:c.test={answer:{fill:[dt]}}})(Y,c,Rt,wt,{key:It,value:Ct},gt),jQuery("#"+Y.id).find(`input[type="text"][data-key="${It}"]`).val(Ct)}),null!==(rt=c.test)&&void 0!==rt&&rt.showselection||jQuery("#"+Y.id).addClass("hide-selection"),(()=>{let L=(0,tt.g1)(k.O.TEST_GROUP,"g",void 0,E.icdt.target);(0,tt.Yw)(L,c,Y)})();break;case"matching-empty":jQuery("#"+Y.id).on("touchmove",".ondrag-item",function(L){L.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(L){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${Y.size.height/Y.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${L.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(L){var et;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(et=c.test)&&void 0!==et&&et.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection"),_t(Y,c)},drag:function(L){},dragend:function(L){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${Y.id} .ondrop-here`).kendoDropTarget({dragenter:function(L){L.dropTarget.hasClass("actived")&&L.dropTarget.addClass("focused")},dragleave:function(L){L.dropTarget.hasClass("actived")&&L.dropTarget.removeClass("focused")},drop:function(L){if(!L.dropTarget.hasClass("actived"))return;L.dropTarget.removeClass("focused");let et=L.dropTarget,Et=L.draggable.currentTarget;et.is(":empty")||et.find(".ondrag-item").appendTo($('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').first()),Et.appendTo(et),((Y,c,Q,gt,dt,q)=>{var H,rt,L;let{key:et}=null!==(H=null===(rt=Y.source)||void 0===rt||null===(rt=rt.test)||void 0===rt?void 0:rt.matching)&&void 0!==H?H:{key:"KIEN"},Et=dt.key==et;null!==(L=c.svg)&&void 0!==L&&L.nodes.find(wt=>{var It;return"submit"==(null===(It=wt.source)||void 0===It||null===(It=It.test)||void 0===It?void 0:It.type)})||St(Y,c,Q,gt,{iscorrect:Et},q),_t(Y,c);let Rt={id:Y.id,key:null!=et?et:"",value:dt.key};c.test?c.test.answer?c.test.answer.matching?c.test.answer.matching.find(wt=>wt.id==Rt.id)?c.test.answer.matching.filter(wt=>wt.id==Rt.id).forEach(wt=>{wt.key=Rt.key,wt.value=Rt.value}):c.test.answer.matching.push(Rt):c.test.answer.matching=[Rt]:c.test.answer={matching:[Rt]}:c.test={answer:{matching:[Rt]}}})(Y,c,pt.nodeStatus,pt.slideStatus,{key:Et.data("key")},gt)}}),(()=>{let L=(0,tt.g1)(k.O.TEST_GROUP,"g",void 0,E.icdt.target);(0,tt.Yw)(L,c,Y)})();break;case"matching-content":jQuery("#"+Y.id).on("touchmove",".ondrag-item",function(L){L.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(L){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${Y.size.height/Y.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${L.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(L){var et;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(et=c.test)&&void 0!==et&&et.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(L){},dragend:function(L){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${Y.id} .ondrop-here`).kendoDropTarget({dragenter:function(L){L.dropTarget.hasClass("actived")&&L.dropTarget.addClass("focused")},dragleave:function(L){L.dropTarget.hasClass("actived")&&L.dropTarget.removeClass("focused")},drop:function(L){L.dropTarget.hasClass("actived")&&(L.dropTarget.removeClass("focused"),L.draggable.currentTarget.appendTo(L.dropTarget))}}),(()=>{let L=(0,tt.g1)(k.O.TEST_GROUP,"g",void 0,E.icdt.target);(0,tt.Yw)(L,c,Y)})();break;case"speech":break;case"submit":jQuery("#"+Y.id).click(L=>{L.preventDefault(),((Y,c,Q,gt,dt)=>{var q,H,rt,L,et;let Et;var Rt;if(null!=c&&null!==(q=c.test)&&void 0!==q&&null!==(q=q.answer)&&void 0!==q&&q.truefalse)Et=null==c||null===(Rt=c.test)||void 0===Rt||null===(Rt=Rt.answer)||void 0===Rt||null===(Rt=Rt.truefalse)||void 0===Rt?void 0:Rt.iscorrect;else if(null!=c&&null!==(H=c.test)&&void 0!==H&&null!==(H=H.answer)&&void 0!==H&&H.singlechoice){var wt;Et=null==c||null===(wt=c.test)||void 0===wt||null===(wt=wt.answer)||void 0===wt||null===(wt=wt.singlechoice)||void 0===wt?void 0:wt.iscorrect}else if(null!=c&&null!==(rt=c.test)&&void 0!==rt&&null!==(rt=rt.answer)&&void 0!==rt&&rt.multichoice){var It,Ct,kt;Et=1==[null==c||null===(It=c.test)||void 0===It||null===(It=It.answer)||void 0===It||null===(It=It.multichoice)||void 0===It?void 0:It.length,null==c||null===(Ct=c.test)||void 0===Ct||null===(Ct=Ct.answer)||void 0===Ct||null===(Ct=Ct.multichoice)||void 0===Ct||null===(Ct=Ct.map(ne=>ne.iscorrect?1:0))||void 0===Ct?void 0:Ct.reduce((ne,re)=>ne+re),null==c||null===(kt=c.svg)||void 0===kt||null===(kt=kt.nodes)||void 0===kt||null===(kt=kt.filter(ne=>{var re,we;return"multichoice"==(null===(re=ne.source)||void 0===re||null===(re=re.test)||void 0===re?void 0:re.type)&&(null===(we=ne.source)||void 0===we||null===(we=we.test)||void 0===we||null===(we=we.multichoice)||void 0===we?void 0:we.iscorrect)}))||void 0===kt?void 0:kt.length].filter((ne,re,we)=>we.indexOf(ne)==re).length}else if(null!=c&&null!==(L=c.test)&&void 0!==L&&null!==(L=L.answer)&&void 0!==L&&L.fill){var ut,Gt;Et=(null==c||null===(ut=c.test)||void 0===ut||null===(ut=ut.answer)||void 0===ut||null===(ut=ut.fill)||void 0===ut||null===(ut=ut.map(ne=>ne.iscorrect?1:0))||void 0===ut?void 0:ut.reduce((ne,re)=>ne+re))==(null===(Gt=c.svg)||void 0===Gt||null===(Gt=Gt.nodes)||void 0===Gt||null===(Gt=Gt.filter(ne=>{var re;return"fill"==(null===(re=ne.source)||void 0===re||null===(re=re.test)||void 0===re?void 0:re.type)}))||void 0===Gt?void 0:Gt.length)}else if(null!=c&&null!==(et=c.test)&&void 0!==et&&null!==(et=et.answer)&&void 0!==et&&et.matching){var ee,oe;Et=(null===(ee=c.svg)||void 0===ee||null===(ee=ee.nodes)||void 0===ee||null===(ee=ee.filter(ne=>{var re;return"matching-empty"==(null===(re=ne.source)||void 0===re||null===(re=re.test)||void 0===re?void 0:re.type)}))||void 0===ee?void 0:ee.length)==((null==c||null===(oe=c.test)||void 0===oe||null===(oe=oe.answer)||void 0===oe?void 0:oe.matching)||[]).map(ne=>ne.key==ne.value?1:0).reduce((ne,re)=>ne+re)}St(Y,c,Q,gt,{iscorrect:Et},dt)})(Y,c,pt.nodeStatus,pt.slideStatus,gt)})}})(c,Y)};var qt=p(8619),X=p(8785),F=p(4921),d=p(8054),at=p(2282),mt=p(2875),Pt=p(9322);const Jt=(Y,c,Q)=>{if(Q.slideStatus!=pt.slideStatus||!c.length)return;let gt=c.shift(),dt=Y.filter(L=>{var et;return(null!==(et=L.idx)&&void 0!==et?et:0)==gt});if(!dt.length)return;let q=Math.max.apply(null,dt.map(L=>{var et;return null!==(et=L.time)&&void 0!==et?et:0})),H=!1,rt=q<.5?0:setTimeout(()=>{H||(H=!0,Jt(Y,c,Q))},1e3*q);Qt(Y,c,dt,0,Q,{idx:gt,total:dt.length,counter:0,isRecursive:H,timeoutRecursive:rt,maxTimeCoundown:q,uid:Math.floor(1e9*Math.random())})},Qt=(Y,c,Q,gt,dt,q)=>{if(dt.slideStatus!=pt.slideStatus)return;let H=Q[gt];if(H){switch(H.type){case ot.$.GROUP:break;case ot.$.CIRCLE:(0,qt._)(H.id,{size:H.size,attribute:H.attribute},H.pid?window.document.getElementById(H.pid):null);break;case ot.$.ELLIPSE:(0,X.r)(H.id,{size:H.size,attribute:H.attribute},H.pid?window.document.getElementById(H.pid):null);break;case ot.$.LINE:(0,F.W)(H.id,{size:H.size,attribute:H.attribute},H.pid?window.document.getElementById(H.pid):null);break;case ot.$.RECT:(0,d.f)(H.id,{size:H.size,attribute:H.attribute},H.pid?window.document.getElementById(H.pid):null);break;case ot.$.POLYGON:(0,at.l)(H.id,{size:H.size,attribute:H.attribute},H.pid?window.document.getElementById(H.pid):null);break;case ot.$.FOREIGNOBJECT:(0,mt.e)(H.id,{size:H.size,attribute:H.attribute,style:H.style,source:H.source},H.pid?window.document.getElementById(H.pid):null);break;case ot.$.IMAGE:(0,u.G)(H.id,{size:H.size,attribute:H.attribute,source:H.source},H.pid?window.document.getElementById(H.pid):null);break;case ot.$.TEXT:(0,h.$)(H.id,{size:H.size,attribute:H.attribute,source:H.source},H.pid?window.document.getElementById(H.pid):null);break;case ot.$.PATH:(0,Pt.G)(H.id,{size:H.size,attribute:H.attribute},H.pid?window.document.getElementById(H.pid):null)}it(dt.slide,H,dt,()=>{q.counter+=1,q.maxTimeCoundown<.5&&q.counter>=q.total&&(q.total=q.counter=0,q.isRecursive||(clearTimeout(q.timeoutRecursive),q.isRecursive=!0,setTimeout(()=>{Jt(Y,c,dt)},250)))}),Qt(Y,c,Q,++gt,dt,q)}},pt=new class At{constructor(){this._nodeStatus=0,this._slideStatus=0,this._slideIdx=0,this._fnChangeSlides=[]}set data(c){this._dataSource=c.data||{},E.icdt.variable.set=c.variable||{}}get nodeStatus(){return this._nodeStatus}refreshNodeStatus(){return this._nodeStatus=Math.floor(999999999*Math.random()),this._nodeStatus}get slideStatus(){return this._slideStatus}refreshSlideStatus(){return this._slideStatus=Math.floor(999999999*Math.random()),this._slideStatus}get slideIdx(){return this._slideIdx}get slideTotal(){var c,Q;return null!==(c=null===(Q=this._dataSource)||void 0===Q||null===(Q=Q.slides)||void 0===Q?void 0:Q.length)&&void 0!==c?c:0}get slides(){var c;return(null===(c=this._dataSource)||void 0===c?void 0:c.slides)||[]}get slide(){var c;return((null===(c=this._dataSource)||void 0===c?void 0:c.slides)||[])[this._slideIdx]||{}}findNode(c){var Q;let gt=null===(Q=this._dataSource)||void 0===Q||null===(Q=Q.slides)||void 0===Q?void 0:Q.find((wt,It)=>It==this._slideIdx),dt=null==gt?void 0:gt.svg,q=(wt,It)=>{let Ct=null==wt?void 0:wt.find(Gt=>Gt.id==c);if(Ct)return Ct.pid=It,Ct;let kt=0,ut=wt.length||0;for(;kt<ut&&!Ct&&(Ct=q(wt[kt].nodes||[],wt[kt].id),!Ct);)kt++;return Ct},H=q((null==dt?void 0:dt.nodes)||[]);var rt,L,et,Et,Rt;return H?(H.style=null!==(rt=H.style)&&void 0!==rt?rt:{},H.source=null!==(L=H.source)&&void 0!==L?L:{},H.animate=null!==(et=H.animate)&&void 0!==et?et:{},H.interactive=null!==(Et=H.interactive)&&void 0!==Et?Et:{},H.variable=null!==(Rt=H.variable)&&void 0!==Rt?Rt:{},H):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}runSlide(c,Q,gt){var dt;let q;var H,rt;if(this.refreshNodeStatus(),this.refreshSlideStatus(),gt)q=null===(H=this._dataSource)||void 0===H||null===(H=H.slides)||void 0===H?void 0:H.find(Rt=>Rt.code==gt||Rt.id==gt),q&&(this._slideIdx=(null===(rt=this._dataSource)||void 0===rt||null===(rt=rt.slides)||void 0===rt?void 0:rt.indexOf(q))||0);else if(Q){var L,et;q=null===(L=this._dataSource)||void 0===L||null===(L=L.slides)||void 0===L?void 0:L.find(Rt=>Rt.id==Q),q&&(this._slideIdx=(null===(et=this._dataSource)||void 0===et||null===(et=et.slides)||void 0===et?void 0:et.indexOf(q))||0)}else this._slideIdx=Math.min(Math.max(c||0,0),this.slideTotal-1),q=this.slide;if(q){var Et;te(E.icdt.container,E.icdt.svg,q,!0),null===(Et=jQuery(E.icdt.svg).find("#"+k.O.BACKGROUND_GROUP))||void 0===Et||Et.empty();let Rt=(0,tt.g1)(k.O.BACKGROUND_GROUP,"g",void 0,E.icdt.svg);(0,tt.x0)(Rt,q),(Y=>{var c,Q,gt,dt;let q=pt.nodeStatus,H=pt.slideStatus;null===(c=Y.svg)||void 0===c||c.nodes.forEach(L=>{L.pid=Math.ceil(1e9*Math.random()),(0,C.m)(L.pid)});let rt=null===(Q=Y.svg)||void 0===Q||null===(Q=Q.nodes)||void 0===Q?void 0:Q.map(L=>{var et;return null!==(et=L.idx)&&void 0!==et?et:0}).filter((L,et,Et)=>Et.indexOf(L)==et).sort((L,et)=>(null!=L?L:0)-(null!=et?et:0));Jt(null!==(gt=null===(dt=Y.svg)||void 0===dt?void 0:dt.nodes)&&void 0!==gt?gt:[],null!=rt?rt:[],{slide:Y,nodeStatus:q,slideStatus:H})})(q)}this.changeSlide(this.slides,null===(dt=this.slide)||void 0===dt?void 0:dt.id,this.slideIdx,this.slides.length,q)}set onChangeSlide(c){this._fnChangeSlides.push(c)}changeSlide(c,Q,gt,dt,q){this._fnChangeSlides.forEach(H=>H(c,Q,gt,dt,q))}},te=(Y,c,Q,gt)=>{var dt,q,H,rt;let L=window.document.querySelector(c);var et;L||(L=document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(et=window.document.querySelector(Y))||void 0===et||et.appendChild(L)),gt&&(L.textContent=null);let{x:Et,y:Rt,width:wt,height:It}=null!==(dt=null==Q||null===(q=Q.svg)||void 0===q?void 0:q.viewBox)&&void 0!==dt?dt:E.icdt.screen.frameSize;L.setAttributeNS(null,"viewBox",Et+" "+Rt+" "+wt+" "+It),L.setAttribute("id",c.replace("#",""));var ee,oe,Ct=null!==(H=jQuery(Y).width())&&void 0!==H?H:1080,kt=null!==(rt=jQuery(Y).height())&&void 0!==rt?rt:1080,Gt=wt/It;Gt>=Ct/kt?oe=(ee=Ct)/Gt:ee=(oe=kt)*Gt,L.setAttributeNS(null,"width",ee.toString()),L.setAttributeNS(null,"height",oe.toString())}},7267:(ue,jt,p)=>{p.d(jt,{E:()=>ot,Z:()=>E});var k=p(70);const E=(yt,b,v)=>{var R;let{value:h}=null!==(R=yt.animate)&&void 0!==R?R:{};ot(yt.id,{node:yt,value:h,nodeStatus:b,slideStatus:v},()=>{})},ot=(yt,b,v)=>{var R;if(!b.value)return void v();let M=jQuery("#"+yt).parents("g");if(!M.length)return void v();let{size:h}=b.node;M.css("transform-origin",`${h.x+h.width/2}px ${h.y+h.height/2}px`);let C="",S=null!==(R=b.iteration)&&void 0!==R?R:0,A=[];(b.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?A.push(b.value):b.value?["top-left","top","top-right","left","right","bottom-left","bottom","bottom-right"].includes(b.value)?(A.push("animation"),A.push(`animation-${b.value}`)):(A.push("animate__animated"),A.push(`animate__${b.value}`)):(A.push("animation"),A.push("animation-fadein")),S<0?(A.push("animation-iteration-infinite"),v(),v=function(){}):S>0&&A.push("animation-iteration-"+(S+1)),C=A.join(" "),function(_){let P=function(){M.data("animate-running")?M.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){M.data("animate-running",!1),setTimeout(function(){_()},100)}):_()};M.hasClass("animation")?setTimeout(function(){P()}):P()}(function(){var _;j(yt),(S>0||S<0)&&M.one("animationiteration",function(){b.slideStatus===k.$.slideStatus||(M.data("animate-running",!1),j(yt),b.slideStatus===k.$.slideStatus&&v())}),M.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(M.data("animate-running",!1),j(yt),b.finish){default:case 0:case 1:break;case 2:var P;ot(yt,{node:b.node,value:null===(P=b.node.animate)||void 0===P?void 0:P.out,nodeStatus:b.nodeStatus,slideStatus:b.slideStatus},()=>{M.addClass("hide")})}b.slideStatus===k.$.slideStatus&&v()}),M.attr("data-class",null!==(_=M.attr("class"))&&void 0!==_?_:""),M.addClass(C),M.data("animate-running",!0)})},j=function(yt){var b,v,R=jQuery("#"+yt).parents("g"),M=null===(b=R.attr("class"))||void 0===b?void 0:b.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm),h=null===(v=R.attr("class"))||void 0===v?void 0:v.match(/animate((__[a-zA-Z0-9]+)+)?(\s+||\")/gm);M&&M.forEach(function(S){jQuery(R).removeClass(S)}),h&&h.forEach(function(S){jQuery(R).removeClass(S)});let C=R.attr("data-class");C&&(R.attr("class",C),R.removeAttr("data-class")),jQuery(R).data("animation-running",!1)}},2336:(ue,jt,p)=>{p.d(jt,{Q:()=>ot});var k=p(70),E=p(7267);const ot=(yt,b,v)=>{var R;if(!b.value)return void v();let M=jQuery("#"+yt).parents("g");if(!M.length)return void v();let{size:h}=b.node;M.css("transform-origin",`${h.x+h.width/2}px ${h.y+h.height/2}px`);let C="",S=null!==(R=b.iteration)&&void 0!==R?R:0,A=[];(b.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?A.push(b.value):(A.push("animation"),A.push(b.value?"animation-"+b.value:"animation-fadein")),S<0?(A.push("animation-iteration-infinite"),v(),v=function(){}):S>0&&A.push("animation-iteration-"+(S+1)),C=A.join(" "),function(_){let P=function(){M.data("animate-running")?M.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){M.data("animate-running",!1),setTimeout(function(){_()},100)}):_()};M.hasClass("animation")?setTimeout(function(){P()}):P()}(function(){var _;j(yt),(S>0||S<0)&&M.one("animationiteration",function(){b.slideStatus===k.$.slideStatus||(M.data("animate-running",!1),j(yt),b.slideStatus===k.$.slideStatus&&v())}),M.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(M.data("animate-running",!1),j(yt),b.finish){default:case 0:case 1:break;case 2:var P;(0,E.E)(yt,{node:b.node,value:null===(P=b.node.animate)||void 0===P?void 0:P.out,nodeStatus:b.nodeStatus,slideStatus:b.slideStatus},()=>{M.addClass("hide")})}b.slideStatus===k.$.slideStatus&&v()}),M.attr("data-class",null!==(_=M.attr("class"))&&void 0!==_?_:""),M.addClass(C),M.data("animate-running",!0)})},j=function(yt){var b,v=jQuery("#"+yt).parents("g"),R=null===(b=v.attr("class"))||void 0===b?void 0:b.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm);R&&R.forEach(function(h){jQuery(v).removeClass(h)});let M=v.attr("data-class");M&&(v.attr("class",M),v.removeAttr("data-class")),jQuery(v).data("animation-running",!1)}},861:(ue,jt,p)=>{p.d(jt,{G:()=>yt});var k=p(4318),E=p(70),ot=p(7492),j=p(7267);const yt=(v,R,M)=>{var h;if(!R.points||!R.points.length)return void M();let C=jQuery("#"+v),A=function b(v){let R=[];2===v.length&&v.splice(1,0,[(v[0][0]+v[1][0])/2,(v[0][1]+v[1][1])/2]);let A,Z,_,M=1,h=v.length;for(;M<h;){if(A=v[M-1],Z=v[M],_=v[M+1],(Math.abs(A[0]-Z[0])>=15||Math.abs(A[1]-Z[1])>=15)&&Math.pow(A[0]-Z[0],2)+Math.pow(A[1]-Z[1],2)>=Math.pow(15,2)&&_&&(Math.abs(A[0]-_[0])<=20||Math.abs(A[1]-_[1])<=20)&&Math.pow(A[0]-_[0],2)+Math.pow(A[1]-_[1],2)<=Math.pow(20,2))R.push(Z);else{let u=Z[0]-A[0],K=Z[1]-A[1],B=Math.max(Math.abs(u),Math.abs(K));for(var P=0;P<B;P+=15)R.push([A[0]+u*P/B,A[1]+K*P/B])}M++}return h>0&&(R.splice(0,0,v[0]),R.push(v[h-1])),R}((I=>{if(1==I.length){let{size:vt}=R.node;return[[vt.x+vt.width/2,vt.y+vt.height/2],...I]}return[...I]})(R.points||[])),Z=null!==(h=R.iteration)&&void 0!==h?h:0;if(Z<0&&(M(),M=function(){}),C.data("work-running")&&Z<0)return;C.data("work-running",!0);let tt,_=A.length,P=Math.max(20,1e3*(R.time||3)/_),{id:u,type:K,size:B,attribute:V}=E.$.findNode(v),J=function(I){if(R.slideStatus!==E.$.slideStatus)return C.data("work-running",!1),void(R.slideStatus===E.$.slideStatus&&M());if(I<_){let Mt=A[I];Mt&&(tt=Object.assign({},B,{x:Mt[0]-B.width/2,y:Mt[1]-B.height/2}),Object.assign(V,(0,k.sg)(K,tt,V)),(0,ot.__)(window.document.getElementById(u),V),setTimeout(function(){J(++I)},P))}else if(Z>0)Z--,J(1);else if(Z<0)J(1);else switch(C.data("work-running",!1),R.slideStatus===E.$.slideStatus&&M(),R.finish){default:case 0:break;case 1:Object.assign(V,(0,k.sg)(K,B,V)),(0,ot.__)(window.document.getElementById(u),V);break;case 2:var vt;(0,j.E)(R.node.id,{node:R.node,value:null===(vt=R.node.animate)||void 0===vt?void 0:vt.out,nodeStatus:R.nodeStatus,slideStatus:R.slideStatus},()=>{C.addClass("hide")})}};J(1)}},157:(ue,jt,p)=>{p.d(jt,{R:()=>ot});var k=p(4981),E=p(70);const ot=(yt,b,v,R,M)=>{var h,C,S,A,Z,_,P;if(R.slideStatus!=E.$.slideStatus)return b.async&&"change-slide"!=b.async?void 0:void M();if(R.nodeStatus!=E.$.nodeStatus&&(!b.async||"change-node"==b.async))return void M();if(!(null!==(h=b.source)&&void 0!==h&&h.path||null!==(C=b.source)&&void 0!==C&&C.url))return console.warn(`${yt} -> audio no source!`),M(),void(M=()=>{});var u=jQuery("#"+yt);let K=null!==(S=b.iteration)&&void 0!==S?S:0;if(K<0&&(M(),M=function(){}),!(u.data("audio-running")&&K<0)){u.data("audio-running",!0);var B=function(tt){tt.pause(),tt.remove(),u.data("audio-running",!1)},V=new Audio;return V.autoplay=!0,V.loop=0!=K,V.preload="auto",V.controls=!0,V.setAttributeNode(document.createAttribute("playsinline")),V.addEventListener("canplay",function(){var tt=V.play();tt&&tt.then(function(J){var I;u.data("audio-running",!0),"time"==b.async?setTimeout(()=>{B(V),M(),M=()=>{}},1e3*(null!==(I=b.time)&&void 0!==I?I:1)):"non-stop"==b.async&&(M(),M=()=>{})}).catch(function(J){u.data("audio-running",!1),R.slideStatus===E.$.slideStatus&&(M(),M=()=>{})})}),V.addEventListener("timeupdate",function(){switch(b.async){case"time":case"non-stop":break;case"finish-action":v.total>=2&&v.total-v.counter==1&&(B(this),M(),M=()=>{});break;default:case"change-node":R.nodeStatus!==E.$.nodeStatus&&(B(this),M(),M=()=>{});break;case"change-slide":R.slideStatus!==E.$.slideStatus&&(B(this),M(),M=()=>{})}}),V.addEventListener("canplaythrough",function(){this.loop&&(K>0?K--:0==K&&(this.loop=!1))}),V.addEventListener("play",function(){}),V.addEventListener("pause",function(){}),V.addEventListener("ended",function(){this.remove(),u.data("audio-running",!1),R.slideStatus===E.$.slideStatus&&(M(),M=()=>{})}),V.onerror=function(){this.remove(),u.data("audio-running",!1),R.slideStatus===E.$.slideStatus&&(M(),M=()=>{})},V.src=(null!==(A=b.source)&&void 0!==A&&A.path?(null===(Z=k.icdt.config)||void 0===Z?void 0:Z.readfileuploadurl)+(null===(_=b.source)||void 0===_?void 0:_.path):null===(P=b.source)||void 0===P?void 0:P.url)||"",V}}},5973:(ue,jt,p)=>{p.d(jt,{F:()=>M});var k=p(4981),E=p(70),ot=p(2336),j=p(861),yt=p(157),b=p(4787),v=p(8918),R=p(7267);const M=(h,C,S,A)=>{var Z,_,P;let u={total:0,counter:0},{triggershow:K,triggerrun:B,triggerhide:V,action:tt,audio:J,slide:I,media:vt}=null!==(Z=null===(_=h.interactive)||void 0===_?void 0:_.click)&&void 0!==Z?Z:{};if(console.log(`node(${h.id}) | nodeStatus(${C}) | slideStatus(${S}) | click`),K){let{id:Lt,ids:st,time:W,async:_t}=K;"asynctrue"==_t?(0,b.L5)({id:Lt,ids:st,nodeStatus:C,slideStatus:S}):"time"==_t&&setTimeout(()=>{(0,b.L5)({id:Lt,ids:st,nodeStatus:C,slideStatus:S})},1e3*(null!=W?W:0))}if(B){let{id:Lt,ids:st,time:W,async:_t}=B;"asynctrue"==_t?(0,b.Ar)({id:Lt,ids:st,nodeStatus:C,slideStatus:S}):"time"==_t&&setTimeout(()=>{(0,b.Ar)({id:Lt,ids:st,nodeStatus:C,slideStatus:S})},1e3*(null!=W?W:0))}if(V){let{id:Lt,ids:st,time:W,async:_t}=V;"asynctrue"==_t?(0,b.WT)({id:Lt,ids:st,nodeStatus:C,slideStatus:S}):"time"==_t&&setTimeout(()=>{(0,b.WT)({id:Lt,ids:st,nodeStatus:C,slideStatus:S})},1e3*(null!=W?W:0))}let Mt=()=>{setTimeout(()=>{if(u.counter>=u.total){if(A&&A(),K){let{id:Lt,ids:st,async:W}=K;(!W||"asyncfalse"==W)&&(0,b.L5)({id:Lt,ids:st,nodeStatus:C,slideStatus:S})}if(B){let{id:Lt,ids:st,async:W}=B;(!W||"asyncfalse"==W)&&(0,b.Ar)({id:Lt,ids:st,nodeStatus:C,slideStatus:S})}if(V){let{id:Lt,ids:st,async:W}=V;(!W||"asyncfalse"==W)&&(0,b.WT)({id:Lt,ids:st,nodeStatus:C,slideStatus:S})}}})};if(null!=tt&&tt.value){u.total+=1;let Lt=()=>{u.counter+=1,Mt()};switch(null==tt?void 0:tt.value){case"hide":var Kt;(0,R.E)(h.id,{node:h,value:null===(Kt=h.animate)||void 0===Kt?void 0:Kt.out,nodeStatus:C,slideStatus:S},()=>{jQuery("#"+h.id).addClass("hide"),Lt()});break;case"points":{let{points:st,time:W,iteration:_t,finish:Ot}=tt;st&&(0,j.G)(h.id,{node:h,points:st,time:W,iteration:_t,finish:Ot,nodeStatus:C,slideStatus:S},Lt);break}default:{let{value:st,time:W,iteration:_t,finish:Ot}=tt;(0,ot.Q)(h.id,{node:h,value:st,time:W,iteration:_t,finish:Ot,nodeStatus:C,slideStatus:S},Lt);break}}}if(null!=J&&null!==(P=J.source)&&void 0!==P&&P.path){u.total+=1;let Lt=()=>{u.counter+=1,Mt()};(0,yt.R)(h.id,J,u,{nodeStatus:C,slideStatus:S},Lt)}if(u.total||Mt(),null!=I&&I.id)switch(I.id){case-1:E.$.runSlide(E.$.slideIdx-1);break;case-2:E.$.runSlide(E.$.slideIdx+1);break;default:var $t;E.$.runSlide(void 0,I.id,null===($t=I.code)||void 0===$t?void 0:$t.toString())}if(null!=vt&&vt.type){var Ft;let st=`<div class="popup-media-viewer"><iframe src="${(0,v.e)({readfileuploadurl:null===(Ft=k.icdt.config)||void 0===Ft?void 0:Ft.readfileuploadurl,type:null==vt?void 0:vt.type,oss:null==vt?void 0:vt.oss,path:null==vt?void 0:vt.path,url:null==vt?void 0:vt.url})}" frameborder="0" allowfullscreen\n        webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen"></iframe><div class="btn-close"><img src="assets/icon-svg/close-outline.svg"/></div></div>`,W=jQuery(st).appendTo(window.document.body);W.find(".btn-close").click(function(_t){_t.preventDefault(),W.remove()})}}},4787:(ue,jt,p)=>{p.d(jt,{Ar:()=>yt,L5:()=>j,WT:()=>b});var k=p(70),E=p(5973),ot=p(7267);const j=v=>{v.id?jQuery("#"+v.id).removeClass("hide"):v.ids&&v.ids.forEach(R=>{jQuery("#"+R).removeClass("hide")})},yt=v=>{v.id?(jQuery("#"+v.id).removeClass("hide"),(0,E.F)(k.$.findNode(v.id),v.nodeStatus,v.slideStatus)):v.ids&&v.ids.forEach(R=>{jQuery("#"+R).removeClass("hide"),(0,E.F)(k.$.findNode(R),v.nodeStatus,v.slideStatus)})},b=v=>{if(v.id){var R;let M=k.$.findNode(v.id);(0,ot.E)(v.id,{node:M,value:null===(R=M.animate)||void 0===R?void 0:R.out,nodeStatus:v.nodeStatus,slideStatus:v.slideStatus},()=>{jQuery("#"+v.id).addClass("hide")})}else v.ids&&v.ids.forEach(M=>{var h;let C=k.$.findNode(M);(0,ot.E)(M,{node:C,value:null===(h=C.animate)||void 0===h?void 0:h.out,nodeStatus:v.nodeStatus,slideStatus:v.slideStatus},()=>{jQuery("#"+M).addClass("hide")})})}},7492:(ue,jt,p)=>{p.d(jt,{Mh:()=>B,wM:()=>J,xo:()=>V,it:()=>I,g1:()=>Ft,__:()=>vt,QI:()=>Kt,DB:()=>Mt,eb:()=>tt,x0:()=>it,g$:()=>Lt,mo:()=>St,XH:()=>Ot,hJ:()=>st,vl:()=>_t,yD:()=>W,Yw:()=>qt});var k=p(9054),E=p(1687),ot=p(9359),yt=/^#?[a-fA-F0-9]+$/;const R=(X,F)=>{var d;if("none"==(X=null!==(d=X)&&void 0!==d?d:""))return"none";if("transparent"==X)return"rgba(0,0,0,0)";if(X.includes("rgba("))return X;if(X.includes("rgb(")&&(X=(0,ot.E)(X)),!(X=X.replace(/[^0-9a-fA-F]/g,"")))return"";if(!yt.test(X))return console.error(`hex2rgba -> ${X}: first argument has invalid hexadecimal characters`),"";if("#"===X[0]&&(X=X.slice(1)),3===X.length){let mt=X.split("");mt.splice(2,0,X[2]),mt.splice(1,0,X[1]),mt.splice(0,0,X[0]),X=mt.join("")}if(6!==X.length)return console.error("hex2rgba: first argument has invalid hexadecimal length"),"";var at=[parseInt(X.slice(0,2),16),parseInt(X.slice(2,4),16),parseInt(X.slice(4,6),16)];return F="number"==typeof F?F:parseFloat(F),at.push(F>=0&&F<=1?F:1),"rgba("+at.join(",")+")"};var M=p(8918),h=p(1814),C=p(4981),S=p(3423),A=p(8054),Z=p(7210),_=p(8619),P=p(70),u=p(2875),K=p(1105);class B{constructor(F,d){let at=window.document.querySelector(d);var mt;at||(at=window.document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(mt=window.document.querySelector(F))||void 0===mt||mt.appendChild(at));let{svgViewBox:Pt,svgSize:zt}=C.icdt.screen.init();at.setAttributeNS(null,"viewBox",`${Pt.x} ${Pt.y} ${Pt.width} ${Pt.height}`),at.setAttribute("id",d.replace("#","")),at.style.display="block",at.style.width=`${zt.width}px`,at.style.height=`${zt.height}px`,at.style.backgroundColor="#fafafa",at.style.cursor="default"}}const V=X=>{jQuery(C.icdt.target).find("#"+E.O.BACKGROUND_GROUP).empty();let F=Ft(E.O.BACKGROUND_GROUP,"g",void 0,C.icdt.target);it(F,X),(()=>{let d=window.document.getElementById(null==X?void 0:X.id);jQuery(d).find("#"+E.O.BACKGROUND_GROUP).empty();let at=Ft(E.O.BACKGROUND_GROUP,"g",void 0,d);it(at,X)})()},tt=()=>{let X=C.icdt.screen.svgViewBox,F=C.icdt.screen.svgSize;C.icdt.target&&(C.icdt.target.setAttributeNS(null,"viewBox",`${X.x} ${X.y} ${X.width} ${X.height}`),C.icdt.target.style.left=`${F.x}px`,C.icdt.target.style.top=`${F.y}px`,C.icdt.target.style.width=`${F.width}px`,C.icdt.target.style.height=`${F.height}px`)},J=()=>{jQuery(C.icdt.target).find(">*:not(defs)").remove()},I=(X,F,d,at,mt)=>{let Pt;return X?(Pt=jQuery(mt||C.icdt.target).find("#"+X).get(0),Pt||(Pt=window.document.createElementNS("http://www.w3.org/2000/svg",d),Pt.setAttribute("id",X),F==k.$.FOREIGNOBJECT&&Pt.setAttribute("xmlns:html","http://www.w3.org/1999/xhtml"),jQuery(Pt).appendTo(mt||C.icdt.target))):(Pt=window.document.createElementNS("http://www.w3.org/2000/svg",d),jQuery(Pt).appendTo(mt||C.icdt.target)),null!=at&&at.attribute&&vt(Pt,null==at?void 0:at.attribute),null!=at&&at.style&&Mt(Pt,null==at?void 0:at.style),null!=at&&at.source&&Kt(Pt,F,null==at?void 0:at.source),Pt},vt=(X,F)=>{return jQuery(X).attr((d=Object.assign({},F||{}),null===(at=Object.keys(d))||void 0===at||at.forEach(zt=>{switch(zt){case"fill":break;case"fillRule":var Jt;Object.assign(d,{"fill-rule":null!==(Jt=d.fillRule)&&void 0!==Jt?Jt:null,fillRule:null});break;case"stroke":var Qt;Object.assign(d,{"stroke-width":null!==(Qt=d.strokeWidth)&&void 0!==Qt?Qt:null,strokeWidth:null});break;case"strokeLinecap":var At;Object.assign(d,{"stroke-linecap":null!==(At=d.strokeLinecap)&&void 0!==At?At:null,strokeLinecap:null});break;case"strokeLinejoin":var pt;Object.assign(d,{"stroke-linejoin":null!==(pt=d.strokeLinejoin)&&void 0!==pt?pt:null,strokeLinejoin:null});break;case"strokeMiterlimit":var te;Object.assign(d,{"stroke-miterlimit":null!==(te=d.strokeMiterlimit)&&void 0!==te?te:null,strokeMiterlimit:null});break;case"strokeDasharray":var Y;Object.assign(d,{"stroke-dasharray":null!==(Y=d.strokeDasharray)&&void 0!==Y?Y:null,strokeDasharray:null});break;case"strokeDasharrays":var c,Q;Object.assign(d,{"stroke-dasharray":null!==(c=null===(Q=d.strokeDasharrays)||void 0===Q?void 0:Q.join(" "))&&void 0!==c?c:null,strokeDasharrays:null});break;case"fontFamily":var gt;Object.assign(d,{"font-family":null!==(gt=d.fontFamily)&&void 0!==gt?gt:null,fontFamily:null});break;case"fontWeight":var dt;Object.assign(d,{"font-weight":null!==(dt=d.fontWeight)&&void 0!==dt?dt:null,fontWeight:null});break;case"fontSize":var q;Object.assign(d,{"font-size":null!==(q=d.fontSize)&&void 0!==q?q:null,fontSize:null});break;case"textLength":Object.assign(d,{textLength:d.textLength?`${d.textLength}px`:null});break;case"transformOrigin":var H;Object.assign(d,{"transform-origin":null!==(H=d.transformOrigin)&&void 0!==H?H:null,transformOrigin:null})}}),Object.assign({},null!=d?d:{},{fill:null!=d&&d.fill?R(d.fill,null!==(mt=null==d?void 0:d.fillOpacity)&&void 0!==mt?mt:1):"rgba(0,0,0,0)",fillOpacity:null,stroke:null!=d&&d.stroke?R(d.stroke,null!==(Pt=null==d?void 0:d.strokeOpacity)&&void 0!==Pt?Pt:1):"rgba(0,0,0,0)",strokeOpacity:null}))),X;var d,at,mt,Pt},Mt=(X,F)=>{return jQuery(X).css((d=Object.assign({},F||{}),null===(at=Object.keys(d))||void 0===at||at.forEach(mt=>{switch(mt){case"padding":Object.assign(d,{padding:d.padding?`${d.padding}px`:null});break;case"borderWidth":var Pt;Object.assign(d,d.borderWidth&&d.borderColor?{"border-width":`${d.borderWidth}px`,"border-style":d.borderStyle||"solid","border-color":R(d.borderColor,null!==(Pt=d.borderOpacity)&&void 0!==Pt?Pt:1)}:{"border-width":"","border-style":"","border-color":""}),Object.assign(d,{borderWidth:null,borderStyle:null,borderColor:null,borderOpacity:null});break;case"borderRadius":Object.assign(d,{"border-radius":d.borderRadius?`${d.borderRadius}px`:null,borderRadius:null});break;case"backgroundColor":var zt;Object.assign(d,d.backgroundColor?{"background-color":R(d.backgroundColor,null!==(zt=d.backgroundOpacity)&&void 0!==zt?zt:1)}:{"background-color":""}),Object.assign(d,{backgroundColor:null,backgroundOpacity:null})}}),d)),X;var d,at},Kt=(X,F,d)=>{switch(F){case k.$.TEXT:var at,mt;jQuery(X).text(null!==(at=null==d||null===(mt=d.text)||void 0===mt?void 0:mt.textContent)&&void 0!==at?at:"");break;case k.$.IMAGE:var Pt,zt,Jt,Qt,At;jQuery(X).attr("href",(null==d||null===(Pt=d.image)||void 0===Pt?void 0:Pt.base64)||(null!=d&&null!==(zt=d.image)&&void 0!==zt&&zt.path?(null===(Jt=C.icdt.config)||void 0===Jt?void 0:Jt.readfileuploadurl)+(null==d||null===(Qt=d.image)||void 0===Qt?void 0:Qt.path):null==d||null===(At=d.image)||void 0===At?void 0:At.url)||"");break;case k.$.FOREIGNOBJECT:switch(null==d?void 0:d.type){case"text":var pt,te;if(null!==(pt=d.text)&&void 0!==pt&&pt.variableKeywords&&null!==(te=d.text)&&void 0!==te&&te.variableKeywords.length){var Y;let o=C.icdt.variable.getKeys(),a=(null===(Y=d.text)||void 0===Y?void 0:Y.textContent)||"";d.text.variableKeywords.forEach(m=>{var y=m.replace(/[^a-zA-Z0-9_]/gm,"");if(o.indexOf(y)>=0){var g=C.icdt.variable.getValue(y);a=a.replace(m,g)}}),jQuery(X).text(a)}else{var c;jQuery(X).text((null===(c=d.text)||void 0===c?void 0:c.textContent)||"")}break;case"html":{var Q,gt,dt;let o=(null==d||null===(Q=d.html)||void 0===Q?void 0:Q.htmlContent)||"";if(null!==(gt=d.html)&&void 0!==gt&&gt.variableKeywords&&null!==(dt=d.html)&&void 0!==dt&&dt.variableKeywords.length){let a=C.icdt.variable.getKeys();d.html.variableKeywords.forEach(m=>{var y=m.replace(/[^a-zA-Z0-9_]/gm,"");if(a.indexOf(y)>=0){var g=C.icdt.variable.getValue(y);o=o.replace(m,g)}})}jQuery(X).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${o}</div>`).find("img[path],video[path],iframe[path]").each((a,m)=>{var y,g;m.setAttribute("src",(null!==(y=null===(g=C.icdt.config)||void 0===g?void 0:g.readfileuploadurl)&&void 0!==y?y:"")+m.getAttribute("path")),m.removeAttribute("path")});break}case"input":var q,H,rt,L;if(null!==(q=d.input)&&void 0!==q&&q.input)jQuery(X).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><input type="text" placeholder="${null!==(rt=null===(L=d.input)||void 0===L?void 0:L.placeholder)&&void 0!==rt?rt:""}" maxlength="100" /></div>`);else if(null!==(H=d.input)&&void 0!==H&&H.textarea){var et,Et;jQuery(X).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><textarea placeholder="${null!==(et=null===(Et=d.input)||void 0===Et?void 0:Et.placeholder)&&void 0!==et?et:""}" maxlength="1000"></textarea></div>`)}break;case"image":var Rt,wt,It,Ct,kt;jQuery(X).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><img src="${(null===(Rt=d.image)||void 0===Rt?void 0:Rt.base64)||(null!==(wt=d.image)&&void 0!==wt&&wt.path?(null===(It=C.icdt.config)||void 0===It?void 0:It.readfileuploadurl)+(null===(Ct=d.image)||void 0===Ct?void 0:Ct.path):null===(kt=d.image)||void 0===kt?void 0:kt.url)||""}" style="width:100%;height:100%;display:block;"/></div>`);break;case"iframe":var ut,Gt,ee,oe;jQuery(X).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${(null!==(ut=d.iframe)&&void 0!==ut&&ut.path?(null===(Gt=C.icdt.config)||void 0===Gt?void 0:Gt.readfileuploadurl)+(null===(ee=d.iframe)||void 0===ee?void 0:ee.path):null===(oe=d.iframe)||void 0===oe?void 0:oe.url)||""}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break;case"embed":{var ne,re,we,Fe,Qe;let o=(0,M.e)({readfileuploadurl:null===(ne=C.icdt.config)||void 0===ne?void 0:ne.readfileuploadurl,type:null===(re=d.embed)||void 0===re?void 0:re.type,oss:null===(we=d.embed)||void 0===we?void 0:we.oss,path:null===(Fe=d.embed)||void 0===Fe?void 0:Fe.path,url:null===(Qe=d.embed)||void 0===Qe?void 0:Qe.url});jQuery(X).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${o}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break}case"svg":var He,Pe;jQuery(X).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${null!==(He=null===(Pe=d.svg)||void 0===Pe?void 0:Pe.svgContent)&&void 0!==He?He:""}</div>`);break;case"test":{var Ze,Xe,ii,Oe;let o=(null==d||null===(Ze=d.html)||void 0===Ze?void 0:Ze.htmlContent)||"";if(null!==(Xe=d.html)&&void 0!==Xe&&Xe.variableKeywords&&null!==(ii=d.html)&&void 0!==ii&&ii.variableKeywords.length){let a=C.icdt.variable.getKeys();d.html.variableKeywords.forEach(m=>{var y=m.replace(/[^a-zA-Z0-9_]/gm,"");if(a.indexOf(y)>=0){var g=C.icdt.variable.getValue(y);o=o.replace(m,g)}})}switch(null==d||null===(Oe=d.test)||void 0===Oe?void 0:Oe.type){case"truefalse":var Ye;jQuery(X).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(Ye=d.test.truefalse)&&void 0!==Ye&&Ye.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${o}</div></div></div>`);break;case"singlechoice":var De;jQuery(X).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(De=d.test.singlechoice)&&void 0!==De&&De.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${o}</div></div></div>`);break;case"multichoice":var Ge;jQuery(X).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(Ge=d.test.multichoice)&&void 0!==Ge&&Ge.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${o}</div></div></div>`);break;case"matching-empty":var qe;jQuery(X).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-empty" data-key="${null==d||null===(qe=d.test.matching)||void 0===qe?void 0:qe.key}"></div>`);break;case"matching-content":var Ve,Je,$e;jQuery(X).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-content" data-key="${null==d||null===(Ve=d.test.matching)||void 0===Ve?void 0:Ve.key}"><div class="ondrag-item" data-key="${null!==(Je=null==d||null===($e=d.test)||void 0===$e||null===($e=$e.matching)||void 0===$e?void 0:$e.key)&&void 0!==Je?Je:"KIEN"}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${o}</div></div></div></div>`);break;case"fill":var hi;((null===(hi=d.html)||void 0===hi?void 0:hi.fillKeywords)||[]).forEach(a=>{var m=`<input type="text" maxlength="128" style="display:inline-block;width:100px;min-width:100px;max-width:100%;padding:0px 10px;margin:0px;box-sizing:border-box;outline:none;box-shadow:none;border-width:0px 0px 1px;border-top-style:initial;border-right-style:initial;border-left-style:initial;border-top-color:initial;border-right-color:initial;border-left-color:initial;border-image:initial;border-bottom-style:dashed;border-bottom-color:rgb(123,146,254);background:transparent;animation:0.3s ease-in-out 0s 1 normal none running width;text-align:inherit;" data-key="${a.replace(/[^a-zA-Z0-9]+/gm,"")}"/>`;o=o.replace(new RegExp(a.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),"g"),m)}),jQuery(X).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${o}</div></div></div>`);break;case"speech":jQuery(X).html('<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><img src="images/svg/component/microphone4.svg" width="60" height="60"/></div></div>');break;case"submit":var bt,D,i,n,r;jQuery(X).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><img src="${null!==(bt=null!==(D=d.image)&&void 0!==D&&D.path?(null===(i=C.icdt.config)||void 0===i?void 0:i.readfileuploadurl)+(null===(n=d.image)||void 0===n?void 0:n.path):null===(r=d.image)||void 0===r?void 0:r.url)&&void 0!==bt?bt:""}" style="width:100%;height:100%;display:block;"/></div>`)}jQuery(X).find("img[path],video[path],iframe[path]").each((a,m)=>{var y,g;m.setAttribute("src",(null!==(y=null===(g=C.icdt.config)||void 0===g?void 0:g.readfileuploadurl)&&void 0!==y?y:"")+m.getAttribute("path")),m.removeAttribute("path")})}}}},Ft=(X,F,d,at)=>{let mt=jQuery(at||C.icdt.target).find("#"+X).get(0);return mt||(mt=window.document.createElementNS("http://www.w3.org/2000/svg",F),mt.setAttribute("id",X),jQuery(mt).appendTo(at||C.icdt.target)),jQuery(mt).attr((null==d?void 0:d.attribute)||{}),jQuery(mt).css((null==d?void 0:d.style)||{}),mt},Lt=(X,F)=>{let d=(0,S.v)(2),at={fill:h.S3.fill,stroke:h.S3.stroke,"stroke-width":(0,S.v)(h.S3.strokeWidth)};return[{element:Ft("icdt-temp-create-rect-center","rect",{attribute:Object.assign({x:F.x-d,y:F.y-d,width:F.width+2*d,height:F.height+2*d},at)},X),posType:"rect-center"}]},st=(X,F)=>{let{size:d}=F,at=(0,S.v)(1),mt=(0,S.v)(2),Pt=(0,S.v)(5),zt={stroke:h.NV.stroke,"stroke-width":(0,S.v)(h.NV.strokeWidth),"stroke-linecap":h.NV.strokeLinecap},Jt={fill:h.Mo.fill,stroke:h.Mo.stroke,"stroke-width":(0,S.v)(h.Mo.strokeWidth)},Qt={fill:h.In.fill,stroke:h.In.stroke,"stroke-width":(0,S.v)(h.In.strokeWidth),width:(0,S.v)(h.In.width),height:(0,S.v)(h.In.height)};return Ft("icdt-temp-resize-line-left","line",{attribute:Object.assign({x1:d.x-at,y1:d.y,x2:d.x-at,y2:d.y+d.height},zt)},X),Ft("icdt-temp-resize-line-top","line",{attribute:Object.assign({x1:d.x,y1:d.y-at,x2:d.x+d.width,y2:d.y-at},zt)},X),Ft("icdt-temp-resize-line-right","line",{attribute:Object.assign({x1:d.x+d.width+at,y1:d.y,x2:d.x+d.width+at,y2:d.y+d.height},zt)},X),Ft("icdt-temp-resize-line-bottom","line",{attribute:Object.assign({x1:d.x,y1:d.y+d.height+at,x2:d.x+d.width,y2:d.y+d.height+at},zt)},X),[{element:Ft("icdt-temp-resize-rect-center","rect",{attribute:Object.assign({x:d.x,y:d.y,width:d.width,height:d.height},Jt),style:{cursor:"move"}},X),posType:"rect-center"},{element:Ft("icdt-temp-resize-rect-top-left","rect",{attribute:Object.assign({x:d.x-Pt,y:d.y-Pt},Qt),style:{cursor:"nw-resize"}},X),posType:"rect-top-left"},{element:Ft("icdt-temp-resize-rect-top-right","rect",{attribute:Object.assign({x:d.x+d.width-mt,y:d.y-Pt},Qt),style:{cursor:"ne-resize"}},X),posType:"rect-top-right"},{element:Ft("icdt-temp-resize-rect-bottom-left","rect",{attribute:Object.assign({x:d.x-Pt,y:d.y+d.height-mt},Qt),style:{cursor:"sw-resize"}},X),posType:"rect-bottom-left"},{element:Ft("icdt-temp-resize-rect-bottom-right","rect",{attribute:Object.assign({x:d.x+d.width-mt,y:d.y+d.height-mt},Qt),style:{cursor:"se-resize"}},X),posType:"rect-bottom-right"},{element:Ft("icdt-temp-resize-rect-top","rect",{attribute:Object.assign({x:d.x+d.width/2-mt-at,y:d.y-Pt},Qt),style:{cursor:"n-resize"}},X),posType:"rect-top"},{element:Ft("icdt-temp-resize-rect-right","rect",{attribute:Object.assign({x:d.x+d.width-mt,y:d.y+d.height/2-mt-at},Qt),style:{cursor:"e-resize"}},X),posType:"rect-right"},{element:Ft("icdt-temp-resize-rect-bottom","rect",{attribute:Object.assign({x:d.x+d.width/2-mt-at,y:d.y+d.height-mt},Qt),style:{cursor:"s-resize"}},X),posType:"rect-bottom"},{element:Ft("icdt-temp-resize-rect-left","rect",{attribute:Object.assign({x:d.x-Pt,y:d.y+d.height/2-mt-at},Qt),style:{cursor:"w-resize"}},X),posType:"rect-left"}]},W=(X,F,d)=>{let at=(0,S.v)(1),mt={stroke:h.NV.stroke,"stroke-width":(0,S.v)(h.NV.strokeWidth),"stroke-linecap":h.NV.strokeLinecap},Pt={fill:h.Mo.fill,stroke:h.Mo.stroke,"stroke-width":(0,S.v)(h.Mo.strokeWidth)},zt={fill:h.dt.fill,stroke:h.dt.stroke,"stroke-width":(0,S.v)(h.dt.strokeWidth)},te=(Ft("icdt-temp-select-line-left","line",{attribute:Object.assign({x1:d.x-at,y1:d.y,x2:d.x-at,y2:d.y+d.height},mt)},X),Ft("icdt-temp-select-line-top","line",{attribute:Object.assign({x1:d.x,y1:d.y-at,x2:d.x+d.width,y2:d.y-at},mt)},X),Ft("icdt-temp-select-line-right","line",{attribute:Object.assign({x1:d.x+d.width+at,y1:d.y,x2:d.x+d.width+at,y2:d.y+d.height},mt)},X),Ft("icdt-temp-select-line-bottom","line",{attribute:Object.assign({x1:d.x,y1:d.y+d.height+at,x2:d.x+d.width,y2:d.y+d.height+at},mt)},X),Ft("icdt-temp-select-rect-center","rect",{attribute:Object.assign({x:d.x,y:d.y,width:d.width,height:d.height},Pt)},X));return F.forEach(Y=>{let{size:c}=Y;Ft("icdt-temp-select-rect-node-"+Y.id,"rect",{attribute:Object.assign({x:c.x,y:c.y,width:c.width,height:c.height},zt)},X)}),[{element:te,posType:"rect-center"}]},_t=(X,F)=>{let d=(0,S.v)(1),at={stroke:h.NV.stroke,"stroke-width":(0,S.v)(h.NV.strokeWidth),"stroke-linecap":h.NV.strokeLinecap},mt={fill:h.Mo.fill,stroke:h.Mo.stroke,"stroke-width":(0,S.v)(h.Mo.strokeWidth)};return Ft("icdt-temp-scan-line-left","line",{attribute:Object.assign({x1:F.x-d,y1:F.y,x2:F.x-d,y2:F.y+F.height},at)},X),Ft("icdt-temp-scan-line-top","line",{attribute:Object.assign({x1:F.x,y1:F.y-d,x2:F.x+F.width,y2:F.y-d},at)},X),Ft("icdt-temp-scan-line-right","line",{attribute:Object.assign({x1:F.x+F.width+d,y1:F.y,x2:F.x+F.width+d,y2:F.y+F.height},at)},X),Ft("icdt-temp-scan-line-bottom","line",{attribute:Object.assign({x1:F.x,y1:F.y+F.height+d,x2:F.x+F.width,y2:F.y+F.height+d},at)},X),[{element:Ft("icdt-temp-scan-rect-center","rect",{attribute:Object.assign({x:F.x,y:F.y,width:F.width,height:F.height},mt)},X),posType:"rect-center"}]},Ot=(X,F)=>((0,S.v)(-1),(0,S.v)(h.h8.strokeWidth),(0,S.v)(h.h8.strokeDasharray),Ft("icdt-temp-interactive-rect-center","rect",{attribute:Object.assign({x:F.x,y:F.y,width:F.width,height:F.height,class:"cursor-draw"},{fill:h.MA.fill})},X),[]),St=(X,F)=>{let d={fill:h.k0.fill,stroke:h.k0.stroke,"stroke-width":(0,S.v)(h.k0.strokeWidth),"stroke-dasharray":(0,S.v)(h.k0.strokeDasharray)};jQuery(X).empty(),F.forEach(at=>{var mt,Pt;let{size:zt}=at;if(!at.idx)return;Ft("icdt-temp-index-rect-node-"+at.id,"rect",{attribute:Object.assign({x:zt.x-5,y:zt.y-5,width:zt.width+10,height:zt.height+10},d)},X);let{element:Jt}=(0,u.e)(Math.ceil(1e9*Math.random()),{size:{x:zt.x-76,y:zt.y-6,width:70,height:80},attribute:{},style:{},source:{type:"html",html:{htmlContent:`<div class="position-slide" style="position:relative;width:100%;height:100%;">\n                  <div style="position:absolute;top:0;right:0;line-height:22px;">\n                    <div title="Th\u1ee9 t\u1ef1 xu\u1ea5t hi\u1ec7n">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-play" style="margin:6px 0;color:#7da7d9;font-size:12px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="idx" value="${null!==(mt=at.idx)&&void 0!==mt?mt:0}" min="0" max="999" step="1" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="Th\u1eddi gian \u0111\u1ee3i(s), n\u1ebfu gi\xe1 tr\u1ecb = 0 s\u1ebd chuy\u1ec3n sang \u0111\u1ee3i ho\xe0n t\u1ea5t ho\u1ea1t \u0111\u1ed9ng v\xe0 \xe2m thanh" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-clock-o" style="margin:5px 0;color:#7da7d9;font-size:14px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="time" value="${null!==(Pt=at.time)&&void 0!==Pt?Pt:0}" min="0" max="999" step="0.5" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="H\u1ee7y thi\u1ebft l\u1eadp" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <button name="remove" style="box-sizing:border-box;width:24px;height:24px;padding:0;border:1px solid #ddd;line-height: 0;outline:none;background:#eee;background: radial-gradient(#fff, #eee);">\n                            <img src="assets/icon-png/xoa2.png" height="18">\n                          </button>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                  </div>\n              </div>`}}},X);Jt.classList.add("node-input"),jQuery(Jt).on("change",'input[name="idx"]',Qt=>{var At;at.idx=parseInt(null!==(At=Qt.target.value)&&void 0!==At?At:"0")}).on("change",'input[name="time"]',Qt=>{var At;at.time=parseFloat(null!==(At=Qt.target.value)&&void 0!==At?At:"0")}).on("click",'button[name="remove"]',Qt=>{at.idx=0,at.time=null,St(X,F)})})},it=(X,F)=>{var d,at,mt,Pt,zt,Jt;let{color:Qt,opacity:At,path:pt,url:te,base64:Y}=null!==(d=null==F||null===(at=F.svg)||void 0===at?void 0:at.background)&&void 0!==d?d:{},{x:c,y:Q,width:gt,height:dt}=null!==(mt=null==F||null===(Pt=F.svg)||void 0===Pt?void 0:Pt.viewBox)&&void 0!==mt?mt:{x:0,y:0,width:0,height:0};(0,K.$)(void 0,{size:{x:0,y:(0,S.v)(-21),width:gt,height:dt},attribute:{fill:"#999",fontSize:(0,S.v)(14),class:"hide-on-viewer"},source:{type:"text",text:{textContent:null!==(zt=null!==(Jt=null==F?void 0:F.name)&&void 0!==Jt?Jt:null==F?void 0:F.code)&&void 0!==zt?zt:void 0}}},X),(0,A.f)(void 0,{size:{x:c,y:Q,width:gt,height:dt},attribute:{fill:"#fff",stroke:"#999",strokeWidth:(0,S.v)(1),strokeDasharray:(0,S.v)(10),class:"hide-on-viewer"}},X),Qt&&(0,A.f)(void 0,{size:{x:c,y:Q,width:gt,height:dt},attribute:{fill:Qt,fillOpacity:At}},X),pt&&(0,Z.G)(void 0,{size:{x:c,y:Q,width:gt,height:dt},source:{type:"image",image:{path:pt,url:te,base64:Y}}},X)},qt=(X,F,d)=>{var at;switch(jQuery(X).empty(),null===(at=F.test)||void 0===at?void 0:at.type){case"truefalse":{var mt,Pt,zt,Jt;let It=null==F||null===(mt=F.test)||void 0===mt||null===(mt=mt.answer)||void 0===mt||null===(mt=mt.truefalse)||void 0===mt?void 0:mt.value,Ct=null===(Pt=F.svg)||void 0===Pt?void 0:Pt.nodes.find(kt=>{var ut;return"submit"==(null===(ut=kt.source)||void 0===ut||null===(ut=ut.test)||void 0===ut?void 0:ut.type)});null===(zt=F.svg)||void 0===zt||zt.nodes.filter(kt=>{var ut;return"truefalse"==(null===(ut=kt.source)||void 0===ut||null===(ut=ut.test)||void 0===ut?void 0:ut.type)&&(kt.id!=It||!Ct)}).forEach(kt=>{var ut;let{x:ee,y:oe,width:ne,height:re}=null!==(ut=null==kt?void 0:kt.size)&&void 0!==ut?ut:{x:0,y:0,width:0,height:0};(0,_._)(Math.ceil(1e9*Math.random()),{size:{x:ee-.5,y:oe-.5,width:ne+1,height:re+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},X)}),null!=F&&null!==(Jt=F.test)&&void 0!==Jt&&null!==(Jt=Jt.answer)&&void 0!==Jt&&Jt.truefalse&&It&&Ct&&(kt=>{let ut=P.$.findNode(It),{x:ee,y:oe,width:ne,height:re}=null!==(kt=null==ut?void 0:ut.size)&&void 0!==kt?kt:{x:0,y:0,width:0,height:0};(0,_._)(Math.ceil(1e9*Math.random()),{size:{x:ee-2,y:oe-2,width:ne+4,height:re+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},X)})();break}case"singlechoice":{var Qt,At,pt,te;let It=null==F||null===(Qt=F.test)||void 0===Qt||null===(Qt=Qt.answer)||void 0===Qt||null===(Qt=Qt.singlechoice)||void 0===Qt?void 0:Qt.value,Ct=null===(At=F.svg)||void 0===At?void 0:At.nodes.find(kt=>{var ut;return"submit"==(null===(ut=kt.source)||void 0===ut||null===(ut=ut.test)||void 0===ut?void 0:ut.type)});null===(pt=F.svg)||void 0===pt||pt.nodes.filter(kt=>{var ut;return"singlechoice"==(null===(ut=kt.source)||void 0===ut||null===(ut=ut.test)||void 0===ut?void 0:ut.type)&&(kt.id!=It||!Ct)}).forEach(kt=>{var ut;let{x:ee,y:oe,width:ne,height:re}=null!==(ut=null==kt?void 0:kt.size)&&void 0!==ut?ut:{x:0,y:0,width:0,height:0};(0,_._)(Math.ceil(1e9*Math.random()),{size:{x:ee-.5,y:oe-.5,width:ne+1,height:re+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},X)}),null!=F&&null!==(te=F.test)&&void 0!==te&&null!==(te=te.answer)&&void 0!==te&&te.singlechoice&&It&&Ct&&(kt=>{let ut=P.$.findNode(It),{x:ee,y:oe,width:ne,height:re}=null!==(kt=null==ut?void 0:ut.size)&&void 0!==kt?kt:{x:0,y:0,width:0,height:0};(0,_._)(Math.ceil(1e9*Math.random()),{size:{x:ee-2,y:oe-2,width:ne+4,height:re+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},X)})();break}case"multichoice":{var Y,c,Q,gt,dt;let It=null!==(Y=null==F||null===(c=F.test)||void 0===c||null===(c=c.answer)||void 0===c||null===(c=c.multichoice)||void 0===c?void 0:c.map(kt=>kt.value))&&void 0!==Y?Y:[],Ct=null===(Q=F.svg)||void 0===Q?void 0:Q.nodes.find(kt=>{var ut;return"submit"==(null===(ut=kt.source)||void 0===ut||null===(ut=ut.test)||void 0===ut?void 0:ut.type)});var q;null===(gt=F.svg)||void 0===gt||gt.nodes.filter(kt=>{var ut;return!("multichoice"!=(null===(ut=kt.source)||void 0===ut||null===(ut=ut.test)||void 0===ut?void 0:ut.type)||It.includes(kt.id)&&Ct)}).forEach(kt=>{var ut;let{x:ee,y:oe,width:ne,height:re}=null!==(ut=null==kt?void 0:kt.size)&&void 0!==ut?ut:{x:0,y:0,width:0,height:0};(0,A.f)(Math.ceil(1e9*Math.random()),{size:{x:ee-.5,y:oe-.5,width:ne+1,height:re+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},X)}),null!=F&&null!==(dt=F.test)&&void 0!==dt&&null!==(dt=dt.answer)&&void 0!==dt&&dt.multichoice&&It.length&&Ct&&(null==F||null===(q=F.test)||void 0===q||null===(q=q.answer)||void 0===q||q.multichoice.forEach(kt=>{var ut;let Gt=P.$.findNode(kt.value),{x:oe,y:ne,width:re,height:we}=null!==(ut=null==Gt?void 0:Gt.size)&&void 0!==ut?ut:{x:0,y:0,width:0,height:0};(0,A.f)(Math.ceil(1e9*Math.random()),{size:{x:oe-2,y:ne-2,width:re+4,height:we+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},X)}));break}case"fill":var H,rt;null!=F&&null!==(H=F.test)&&void 0!==H&&null!==(H=H.answer)&&void 0!==H&&H.fill&&(null==F||null===(rt=F.test)||void 0===rt||null===(rt=rt.answer)||void 0===rt||rt.fill.forEach(It=>{jQuery("#"+d.id).find(`input[type="text"][data-key="${It.key}"]`).val(It.value)}));break;case"matching":var L,et,Et,Rt;if(null!=F&&null!==(L=F.test)&&void 0!==L&&null!==(L=L.answer)&&void 0!==L&&L.matching)if("matching-empty"==(null===(et=d.source)||void 0===et||null===(et=et.test)||void 0===et?void 0:et.type))null==F||null===(Rt=F.test)||void 0===Rt||null===(Rt=Rt.answer)||void 0===Rt||Rt.matching.filter(It=>{var Ct;return It.key==(null===(Ct=d.source)||void 0===Ct||null===(Ct=Ct.test)||void 0===Ct||null===(Ct=Ct.matching)||void 0===Ct?void 0:Ct.key)}).forEach(It=>{$(`foreignObject .ondrop-here[data-type2="matching-content"][data-key="${It.value}"] .ondrag-item`).appendTo($(`foreignObject#${d.id} .ondrop-here[data-type2="matching-empty"][data-key="${It.key}"]`))});else if("matching-content"==(null===(Et=d.source)||void 0===Et||null===(Et=Et.test)||void 0===Et?void 0:Et.type)){var wt;null==F||null===(wt=F.test)||void 0===wt||null===(wt=wt.answer)||void 0===wt||wt.matching.filter(It=>{var Ct;return It.value==(null===(Ct=d.source)||void 0===Ct||null===(Ct=Ct.test)||void 0===Ct||null===(Ct=Ct.matching)||void 0===Ct?void 0:Ct.key)}).forEach(It=>{$(`foreignObject#${d.id} .ondrop-here[data-type2="matching-content"][data-key="${It.value}"] .ondrag-item`).appendTo($(`foreignObject .ondrop-here[data-type2="matching-empty"][data-key="${It.key}"]:empty`))})}}}},8918:(ue,jt,p)=>{p.d(jt,{e:()=>ot});var k=p(5818);const ot=b=>{switch(null==b?void 0:b.type){case k.t.IMAGE:return"assets/iframe/lib/mk-image-viewer/viewer.html?url="+b.readfileuploadurl+b.path;case k.t.AUDIO:return"assets/iframe/lib/mk-audio-player-2/player.html?url="+b.readfileuploadurl+b.path;case k.t.VIDEO:return"assets/iframe/lib/mk-video-player/player.html?url="+b.readfileuploadurl+b.path;case k.t.OFFICE:return"https://view.officeapps.live.com/op/view.aspx?src="+b.readfileuploadurl+b.path;case k.t.PDF:return"assets/iframe/lib/PDFReader/web/viewer.html?file="+b.readfileuploadurl+b.path;case k.t.HTML:case k.t.IMAGE_ANIMATION:case k.t.PHET:return""+b.readfileuploadurl+b.path;case k.t.ZIP:case k.t.SCORM:var v;return"imsmanifest.xml"==(null===(v=b.path)||void 0===v||null===(v=v.split("/"))||void 0===v?void 0:v.pop())?"assets/iframe/lib/ScormPool_Player/player.html?url="+b.readfileuploadurl+b.path:""+b.readfileuploadurl+b.path;case k.t.TRACK:case k.t.TEXT:return""+b.readfileuploadurl+b.path;case k.t.LINK:switch(b.oss){case 1003:return"assets/iframe/lib/ScormPool_Player/player.html?url="+b.url;case 1002:var R;return null!==(R=j(b.url))&&void 0!==R?R:"";case 1005:var M;return null!==(M=b.url)&&void 0!==M?M:"";default:var h;return null!==(h=b.url)&&void 0!==h?h:""}default:return""+b.readfileuploadurl+b.path}},j=b=>{let v=yt(b);return v?"https://www.youtube.com/embed/"+v+"?"+jQuery.param({wmode:"opaque",border:0,hd:1,autoplay:!1,autohide:1,enablejsapi:1,modestbranding:1,version:3,hl:"vi_VN",rel:0,showinfo:0,iv_load_policy:3}):null},yt=b=>{let v=null==b?void 0:b.match(/(?:.+?)?(?:\/v\/|watch\/|\?v\=|\&v\=|youtu\.be\/|\/v\=|^youtu\.be\/|embed\/)([a-zA-Z0-9_-]{11})+/);return v&&v.length>=2?v[1]:null}},511:(ue,jt,p)=>{function k(){}function E(t){return null==t?k:function(){return this.querySelector(t)}}function yt(){return[]}function b(t){return null==t?yt:function(){return this.querySelectorAll(t)}}function M(t){return function(){return this.matches(t)}}function h(t){return function(e){return e.matches(t)}}p.d(jt,{$0Z:()=>aa,jvg:()=>la});var C=Array.prototype.find;function A(){return this.firstElementChild}var _=Array.prototype.filter;function P(){return Array.from(this.children)}function V(t){return new Array(t.length)}function J(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function vt(t,e,l,s,f,x){for(var G,O=0,U=e.length,lt=x.length;O<lt;++O)(G=e[O])?(G.__data__=x[O],s[O]=G):l[O]=new J(t,x[O]);for(;O<U;++O)(G=e[O])&&(f[O]=G)}function Mt(t,e,l,s,f,x,O){var G,U,Xt,lt=new Map,ct=e.length,Ut=x.length,Wt=new Array(ct);for(G=0;G<ct;++G)(U=e[G])&&(Wt[G]=Xt=O.call(U,U.__data__,G,e)+"",lt.has(Xt)?f[G]=U:lt.set(Xt,U));for(G=0;G<Ut;++G)Xt=O.call(t,x[G],G,x)+"",(U=lt.get(Xt))?(s[G]=U,U.__data__=x[G],lt.delete(Xt)):l[G]=new J(t,x[G]);for(G=0;G<ct;++G)(U=e[G])&&lt.get(Wt[G])===U&&(f[G]=U)}function Kt(t){return t.__data__}function Ft(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function St(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}J.prototype={constructor:J,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var mt="http://www.w3.org/1999/xhtml";const Pt={svg:"http://www.w3.org/2000/svg",xhtml:mt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function zt(t){var e=t+="",l=e.indexOf(":");return l>=0&&"xmlns"!==(e=t.slice(0,l))&&(t=t.slice(l+1)),Pt.hasOwnProperty(e)?{space:Pt[e],local:t}:t}function Jt(t){return function(){this.removeAttribute(t)}}function Qt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function At(t,e){return function(){this.setAttribute(t,e)}}function pt(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function te(t,e){return function(){var l=e.apply(this,arguments);null==l?this.removeAttribute(t):this.setAttribute(t,l)}}function Y(t,e){return function(){var l=e.apply(this,arguments);null==l?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,l)}}function Q(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function gt(t){return function(){this.style.removeProperty(t)}}function dt(t,e,l){return function(){this.style.setProperty(t,e,l)}}function q(t,e,l){return function(){var s=e.apply(this,arguments);null==s?this.style.removeProperty(t):this.style.setProperty(t,s,l)}}function rt(t,e){return t.style.getPropertyValue(e)||Q(t).getComputedStyle(t,null).getPropertyValue(e)}function L(t){return function(){delete this[t]}}function et(t,e){return function(){this[t]=e}}function Et(t,e){return function(){var l=e.apply(this,arguments);null==l?delete this[t]:this[t]=l}}function wt(t){return t.trim().split(/^|\s+/)}function It(t){return t.classList||new Ct(t)}function Ct(t){this._node=t,this._names=wt(t.getAttribute("class")||"")}function kt(t,e){for(var l=It(t),s=-1,f=e.length;++s<f;)l.add(e[s])}function ut(t,e){for(var l=It(t),s=-1,f=e.length;++s<f;)l.remove(e[s])}function Gt(t){return function(){kt(this,t)}}function ee(t){return function(){ut(this,t)}}function oe(t,e){return function(){(e.apply(this,arguments)?kt:ut)(this,t)}}function re(){this.textContent=""}function we(t){return function(){this.textContent=t}}function Fe(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function He(){this.innerHTML=""}function Pe(t){return function(){this.innerHTML=t}}function Ze(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function ii(){this.nextSibling&&this.parentNode.appendChild(this)}function Ye(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ge(t){return function(){var e=this.ownerDocument,l=this.namespaceURI;return l===mt&&e.documentElement.namespaceURI===mt?e.createElement(t):e.createElementNS(l,t)}}function qe(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ve(t){var e=zt(t);return(e.local?qe:Ge)(e)}function $e(){return null}function bt(){var t=this.parentNode;t&&t.removeChild(this)}function i(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function n(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function y(t){return function(){var e=this.__on;if(e){for(var x,l=0,s=-1,f=e.length;l<f;++l)x=e[l],t.type&&x.type!==t.type||x.name!==t.name?e[++s]=x:this.removeEventListener(x.type,x.listener,x.options);++s?e.length=s:delete this.__on}}}function g(t,e,l){return function(){var f,s=this.__on,x=function a(t){return function(e){t.call(this,e,this.__data__)}}(e);if(s)for(var O=0,G=s.length;O<G;++O)if((f=s[O]).type===t.type&&f.name===t.name)return this.removeEventListener(f.type,f.listener,f.options),this.addEventListener(f.type,f.listener=x,f.options=l),void(f.value=e);this.addEventListener(t.type,x,l),f={type:t.type,name:t.name,value:e,listener:x,options:l},s?s.push(f):this.__on=[f]}}function w(t,e,l){var s=Q(t),f=s.CustomEvent;"function"==typeof f?f=new f(e,l):(f=s.document.createEvent("Event"),l?(f.initEvent(e,l.bubbles,l.cancelable),f.detail=l.detail):f.initEvent(e,!1,!1)),t.dispatchEvent(f)}function z(t,e){return function(){return w(this,t,e)}}function N(t,e){return function(){return w(this,t,e.apply(this,arguments))}}Ct.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var xt=[null];function Nt(t,e){this._groups=t,this._parents=e}function Zt(){return new Nt([[document.documentElement]],xt)}Nt.prototype=Zt.prototype={constructor:Nt,select:function ot(t){"function"!=typeof t&&(t=E(t));for(var e=this._groups,l=e.length,s=new Array(l),f=0;f<l;++f)for(var U,lt,x=e[f],O=x.length,G=s[f]=new Array(O),ct=0;ct<O;++ct)(U=x[ct])&&(lt=t.call(U,U.__data__,ct,x))&&("__data__"in U&&(lt.__data__=U.__data__),G[ct]=lt);return new Nt(s,this._parents)},selectAll:function R(t){t="function"==typeof t?function v(t){return function(){return function j(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}(t.apply(this,arguments))}}(t):b(t);for(var e=this._groups,l=e.length,s=[],f=[],x=0;x<l;++x)for(var U,O=e[x],G=O.length,lt=0;lt<G;++lt)(U=O[lt])&&(s.push(t.call(U,U.__data__,lt,O)),f.push(U));return new Nt(s,f)},selectChild:function Z(t){return this.select(null==t?A:function S(t){return function(){return C.call(this.children,t)}}("function"==typeof t?t:h(t)))},selectChildren:function K(t){return this.selectAll(null==t?P:function u(t){return function(){return _.call(this.children,t)}}("function"==typeof t?t:h(t)))},filter:function B(t){"function"!=typeof t&&(t=M(t));for(var e=this._groups,l=e.length,s=new Array(l),f=0;f<l;++f)for(var U,x=e[f],O=x.length,G=s[f]=[],lt=0;lt<O;++lt)(U=x[lt])&&t.call(U,U.__data__,lt,x)&&G.push(U);return new Nt(s,this._parents)},data:function $t(t,e){if(!arguments.length)return Array.from(this,Kt);var l=e?Mt:vt,s=this._parents,f=this._groups;"function"!=typeof t&&(t=function I(t){return function(){return t}}(t));for(var x=f.length,O=new Array(x),G=new Array(x),U=new Array(x),lt=0;lt<x;++lt){var ct=s[lt],Ut=f[lt],Wt=Ut.length,Xt=Ft(t.call(ct,ct&&ct.__data__,lt,s)),_e=Xt.length,Se=G[lt]=new Array(_e),Bt=O[lt]=new Array(_e);l(ct,Ut,Se,Bt,U[lt]=new Array(Wt),Xt,e);for(var he,ge,ae=0,Yt=0;ae<_e;++ae)if(he=Se[ae]){for(ae>=Yt&&(Yt=ae+1);!(ge=Bt[Yt])&&++Yt<_e;);he._next=ge||null}}return(O=new Nt(O,s))._enter=G,O._exit=U,O},enter:function tt(){return new Nt(this._enter||this._groups.map(V),this._parents)},exit:function Lt(){return new Nt(this._exit||this._groups.map(V),this._parents)},join:function st(t,e,l){var s=this.enter(),f=this,x=this.exit();return"function"==typeof t?(s=t(s))&&(s=s.selection()):s=s.append(t+""),null!=e&&(f=e(f))&&(f=f.selection()),null==l?x.remove():l(x),s&&f?s.merge(f).order():f},merge:function W(t){for(var e=t.selection?t.selection():t,l=this._groups,s=e._groups,f=l.length,O=Math.min(f,s.length),G=new Array(f),U=0;U<O;++U)for(var Xt,lt=l[U],ct=s[U],Ut=lt.length,Wt=G[U]=new Array(Ut),_e=0;_e<Ut;++_e)(Xt=lt[_e]||ct[_e])&&(Wt[_e]=Xt);for(;U<f;++U)G[U]=l[U];return new Nt(G,this._parents)},selection:function ye(){return this},order:function _t(){for(var t=this._groups,e=-1,l=t.length;++e<l;)for(var O,s=t[e],f=s.length-1,x=s[f];--f>=0;)(O=s[f])&&(x&&4^O.compareDocumentPosition(x)&&x.parentNode.insertBefore(O,x),x=O);return this},sort:function Ot(t){function e(Ut,Wt){return Ut&&Wt?t(Ut.__data__,Wt.__data__):!Ut-!Wt}t||(t=St);for(var l=this._groups,s=l.length,f=new Array(s),x=0;x<s;++x){for(var lt,O=l[x],G=O.length,U=f[x]=new Array(G),ct=0;ct<G;++ct)(lt=O[ct])&&(U[ct]=lt);U.sort(e)}return new Nt(f,this._parents).order()},call:function it(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function qt(){return Array.from(this)},node:function X(){for(var t=this._groups,e=0,l=t.length;e<l;++e)for(var s=t[e],f=0,x=s.length;f<x;++f){var O=s[f];if(O)return O}return null},size:function F(){let t=0;for(const e of this)++t;return t},empty:function d(){return!this.node()},each:function at(t){for(var e=this._groups,l=0,s=e.length;l<s;++l)for(var G,f=e[l],x=0,O=f.length;x<O;++x)(G=f[x])&&t.call(G,G.__data__,x,f);return this},attr:function c(t,e){var l=zt(t);if(arguments.length<2){var s=this.node();return l.local?s.getAttributeNS(l.space,l.local):s.getAttribute(l)}return this.each((null==e?l.local?Qt:Jt:"function"==typeof e?l.local?Y:te:l.local?pt:At)(l,e))},style:function H(t,e,l){return arguments.length>1?this.each((null==e?gt:"function"==typeof e?q:dt)(t,e,null==l?"":l)):rt(this.node(),t)},property:function Rt(t,e){return arguments.length>1?this.each((null==e?L:"function"==typeof e?Et:et)(t,e)):this.node()[t]},classed:function ne(t,e){var l=wt(t+"");if(arguments.length<2){for(var s=It(this.node()),f=-1,x=l.length;++f<x;)if(!s.contains(l[f]))return!1;return!0}return this.each(("function"==typeof e?oe:e?Gt:ee)(l,e))},text:function Qe(t){return arguments.length?this.each(null==t?re:("function"==typeof t?Fe:we)(t)):this.node().textContent},html:function Xe(t){return arguments.length?this.each(null==t?He:("function"==typeof t?Ze:Pe)(t)):this.node().innerHTML},raise:function Oe(){return this.each(ii)},lower:function De(){return this.each(Ye)},append:function Je(t){var e="function"==typeof t?t:Ve(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function hi(t,e){var l="function"==typeof t?t:Ve(t),s=null==e?$e:"function"==typeof e?e:E(e);return this.select(function(){return this.insertBefore(l.apply(this,arguments),s.apply(this,arguments)||null)})},remove:function D(){return this.each(bt)},clone:function r(t){return this.select(t?n:i)},datum:function o(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function T(t,e,l){var f,O,s=function m(t){return t.trim().split(/^|\s+/).map(function(e){var l="",s=e.indexOf(".");return s>=0&&(l=e.slice(s+1),e=e.slice(0,s)),{type:e,name:l}})}(t+""),x=s.length;if(!(arguments.length<2)){for(G=e?g:y,f=0;f<x;++f)this.each(G(s[f],e,l));return this}var G=this.node().__on;if(G)for(var ct,U=0,lt=G.length;U<lt;++U)for(f=0,ct=G[U];f<x;++f)if((O=s[f]).type===ct.type&&O.name===ct.name)return ct.value},dispatch:function ht(t,e){return this.each(("function"==typeof e?N:z)(t,e))},[Symbol.iterator]:function*ft(){for(var t=this._groups,e=0,l=t.length;e<l;++e)for(var O,s=t[e],f=0,x=s.length;f<x;++f)(O=s[f])&&(yield O)}};const ve=Zt;var me={value:()=>{}};function pe(){for(var s,t=0,e=arguments.length,l={};t<e;++t){if(!(s=arguments[t]+"")||s in l||/[\s.]/.test(s))throw new Error("illegal type: "+s);l[s]=[]}return new xe(l)}function xe(t){this._=t}function ar(t,e){for(var f,l=0,s=t.length;l<s;++l)if((f=t[l]).name===e)return f.value}function gn(t,e,l){for(var s=0,f=t.length;s<f;++s)if(t[s].name===e){t[s]=me,t=t.slice(0,s).concat(t.slice(s+1));break}return null!=l&&t.push({name:e,value:l}),t}xe.prototype=pe.prototype={constructor:xe,on:function(t,e){var f,l=this._,s=function lr(t,e){return t.trim().split(/^|\s+/).map(function(l){var s="",f=l.indexOf(".");if(f>=0&&(s=l.slice(f+1),l=l.slice(0,f)),l&&!e.hasOwnProperty(l))throw new Error("unknown type: "+l);return{type:l,name:s}})}(t+"",l),x=-1,O=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++x<O;)if(f=(t=s[x]).type)l[f]=gn(l[f],t.name,e);else if(null==e)for(f in l)l[f]=gn(l[f],t.name,null);return this}for(;++x<O;)if((f=(t=s[x]).type)&&(f=ar(l[f],t.name)))return f},copy:function(){var t={},e=this._;for(var l in e)t[l]=e[l].slice();return new xe(t)},call:function(t,e){if((f=arguments.length-2)>0)for(var f,x,l=new Array(f),s=0;s<f;++s)l[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,f=(x=this._[t]).length;s<f;++s)x[s].value.apply(e,l)},apply:function(t,e,l){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var s=this._[t],f=0,x=s.length;f<x;++f)s[f].value.apply(e,l)}};const or=pe;var Li,ki,pi=0,Oi=0,Si=0,yn=1e3,Di=0,ci=0,ji=0,Ti="object"==typeof performance&&performance.now?performance:Date,pn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Yi(){return ci||(pn(sr),ci=Ti.now()+ji)}function sr(){ci=0}function Bi(){this._call=this._time=this._next=null}function mn(t,e,l){var s=new Bi;return s.restart(t,e,l),s}function _n(){ci=(Di=Ti.now())+ji,pi=Oi=0;try{!function dr(){Yi(),++pi;for(var e,t=Li;t;)(e=ci-t._time)>=0&&t._call.call(void 0,e),t=t._next;--pi}()}finally{pi=0,function hr(){for(var t,l,e=Li,s=1/0;e;)e._call?(s>e._time&&(s=e._time),t=e,e=e._next):(l=e._next,e._next=null,e=t?t._next=l:Li=l);ki=t,qi(s)}(),ci=0}}function ur(){var t=Ti.now(),e=t-Di;e>yn&&(ji-=e,Di=t)}function qi(t){pi||(Oi&&(Oi=clearTimeout(Oi)),t-ci>24?(t<1/0&&(Oi=setTimeout(_n,t-Ti.now()-ji)),Si&&(Si=clearInterval(Si))):(Si||(Di=Ti.now(),Si=setInterval(ur,yn)),pi=1,pn(_n)))}function wn(t,e,l){var s=new Bi;return s.restart(f=>{s.stop(),t(f+e)},e=null==e?0:+e,l),s}Bi.prototype=mn.prototype={constructor:Bi,restart:function(t,e,l){if("function"!=typeof t)throw new TypeError("callback is not a function");l=(null==l?Yi():+l)+(null==e?0:+e),!this._next&&ki!==this&&(ki?ki._next=this:Li=this,ki=this),this._call=t,this._time=l,qi()},stop:function(){this._call&&(this._call=null,this._time=1/0,qi())}};var cr=or("start","end","cancel","interrupt"),fr=[],bn=0,Ki=3;function Gi(t,e,l,s,f,x){var O=t.__transition;if(O){if(l in O)return}else t.__transition={};!function vr(t,e,l){var f,s=t.__transition;function O(lt){var ct,Ut,Wt,Xt;if(1!==l.state)return U();for(ct in s)if((Xt=s[ct]).name===l.name){if(Xt.state===Ki)return wn(O);4===Xt.state?(Xt.state=6,Xt.timer.stop(),Xt.on.call("interrupt",t,t.__data__,Xt.index,Xt.group),delete s[ct]):+ct<e&&(Xt.state=6,Xt.timer.stop(),Xt.on.call("cancel",t,t.__data__,Xt.index,Xt.group),delete s[ct])}if(wn(function(){l.state===Ki&&(l.state=4,l.timer.restart(G,l.delay,l.time),G(lt))}),l.state=2,l.on.call("start",t,t.__data__,l.index,l.group),2===l.state){for(l.state=Ki,f=new Array(Wt=l.tween.length),ct=0,Ut=-1;ct<Wt;++ct)(Xt=l.tween[ct].value.call(t,t.__data__,l.index,l.group))&&(f[++Ut]=Xt);f.length=Ut+1}}function G(lt){for(var ct=lt<l.duration?l.ease.call(null,lt/l.duration):(l.timer.restart(U),l.state=5,1),Ut=-1,Wt=f.length;++Ut<Wt;)f[Ut].call(t,ct);5===l.state&&(l.on.call("end",t,t.__data__,l.index,l.group),U())}function U(){for(var lt in l.state=6,l.timer.stop(),delete s[e],s)return;delete t.__transition}s[e]=l,l.timer=mn(function x(lt){l.state=1,l.timer.restart(O,l.delay,l.time),l.delay<=lt&&O(lt-l.delay)},0,l.time)}(t,l,{name:e,index:s,group:f,on:cr,tween:fr,time:x.time,delay:x.delay,duration:x.duration,ease:x.ease,timer:null,state:bn})}function en(t,e){var l=ti(t,e);if(l.state>bn)throw new Error("too late; already scheduled");return l}function ni(t,e){var l=ti(t,e);if(l.state>Ki)throw new Error("too late; already running");return l}function ti(t,e){var l=t.__transition;if(!l||!(l=l[e]))throw new Error("transition not found");return l}function di(t,e){return t=+t,e=+e,function(l){return t*(1-l)+e*l}}var Ui,On=180/Math.PI,nn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Sn(t,e,l,s,f,x){var O,G,U;return(O=Math.sqrt(t*t+e*e))&&(t/=O,e/=O),(U=t*l+e*s)&&(l-=t*U,s-=e*U),(G=Math.sqrt(l*l+s*s))&&(l/=G,s/=G,U/=G),t*s<e*l&&(t=-t,e=-e,U=-U,O=-O),{translateX:f,translateY:x,rotate:Math.atan2(e,t)*On,skewX:Math.atan(U)*On,scaleX:O,scaleY:G}}function kn(t,e,l,s){function f(lt){return lt.length?lt.pop()+" ":""}return function(lt,ct){var Ut=[],Wt=[];return lt=t(lt),ct=t(ct),function x(lt,ct,Ut,Wt,Xt,_e){if(lt!==Ut||ct!==Wt){var Se=Xt.push("translate(",null,e,null,l);_e.push({i:Se-4,x:di(lt,Ut)},{i:Se-2,x:di(ct,Wt)})}else(Ut||Wt)&&Xt.push("translate("+Ut+e+Wt+l)}(lt.translateX,lt.translateY,ct.translateX,ct.translateY,Ut,Wt),function O(lt,ct,Ut,Wt){lt!==ct?(lt-ct>180?ct+=360:ct-lt>180&&(lt+=360),Wt.push({i:Ut.push(f(Ut)+"rotate(",null,s)-2,x:di(lt,ct)})):ct&&Ut.push(f(Ut)+"rotate("+ct+s)}(lt.rotate,ct.rotate,Ut,Wt),function G(lt,ct,Ut,Wt){lt!==ct?Wt.push({i:Ut.push(f(Ut)+"skewX(",null,s)-2,x:di(lt,ct)}):ct&&Ut.push(f(Ut)+"skewX("+ct+s)}(lt.skewX,ct.skewX,Ut,Wt),function U(lt,ct,Ut,Wt,Xt,_e){if(lt!==Ut||ct!==Wt){var Se=Xt.push(f(Xt)+"scale(",null,",",null,")");_e.push({i:Se-4,x:di(lt,Ut)},{i:Se-2,x:di(ct,Wt)})}else(1!==Ut||1!==Wt)&&Xt.push(f(Xt)+"scale("+Ut+","+Wt+")")}(lt.scaleX,lt.scaleY,ct.scaleX,ct.scaleY,Ut,Wt),lt=ct=null,function(Xt){for(var Bt,_e=-1,Se=Wt.length;++_e<Se;)Ut[(Bt=Wt[_e]).i]=Bt.x(Xt);return Ut.join("")}}}var _r=kn(function pr(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?nn:Sn(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),wr=kn(function mr(t){return null!=t&&(Ui||(Ui=document.createElementNS("http://www.w3.org/2000/svg","g")),Ui.setAttribute("transform",t),t=Ui.transform.baseVal.consolidate())?Sn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):nn},", ",")",")");function br(t,e){var l,s;return function(){var f=ni(this,t),x=f.tween;if(x!==l)for(var O=0,G=(s=l=x).length;O<G;++O)if(s[O].name===e){(s=s.slice()).splice(O,1);break}f.tween=s}}function xr(t,e,l){var s,f;if("function"!=typeof l)throw new Error;return function(){var x=ni(this,t),O=x.tween;if(O!==s){f=(s=O).slice();for(var G={name:e,value:l},U=0,lt=f.length;U<lt;++U)if(f[U].name===e){f[U]=G;break}U===lt&&f.push(G)}x.tween=f}}function rn(t,e,l){var s=t._id;return t.each(function(){var f=ni(this,s);(f.value||(f.value={}))[e]=l.apply(this,arguments)}),function(f){return ti(f,s).value[e]}}function ln(t,e,l){t.prototype=e.prototype=l,l.constructor=t}function Tn(t,e){var l=Object.create(t.prototype);for(var s in e)l[s]=e[s];return l}function Ci(){}var Wi=1/.7,mi="\\s*([+-]?\\d+)\\s*",Ii="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ri="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Or=/^#([0-9a-f]{3,8})$/,Sr=new RegExp(`^rgb\\(${mi},${mi},${mi}\\)$`),kr=new RegExp(`^rgb\\(${ri},${ri},${ri}\\)$`),Tr=new RegExp(`^rgba\\(${mi},${mi},${mi},${Ii}\\)$`),Cr=new RegExp(`^rgba\\(${ri},${ri},${ri},${Ii}\\)$`),Ar=new RegExp(`^hsl\\(${Ii},${ri},${ri}\\)$`),Ir=new RegExp(`^hsla\\(${Ii},${ri},${ri},${Ii}\\)$`),Cn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function An(){return this.rgb().formatHex()}function In(){return this.rgb().formatRgb()}function Mi(t){var e,l;return t=(t+"").trim().toLowerCase(),(e=Or.exec(t))?(l=e[1].length,e=parseInt(e[1],16),6===l?Mn(e):3===l?new Be(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===l?Fi(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===l?Fi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Sr.exec(t))?new Be(e[1],e[2],e[3],1):(e=kr.exec(t))?new Be(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Tr.exec(t))?Fi(e[1],e[2],e[3],e[4]):(e=Cr.exec(t))?Fi(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ar.exec(t))?Nn(e[1],e[2]/100,e[3]/100,1):(e=Ir.exec(t))?Nn(e[1],e[2]/100,e[3]/100,e[4]):Cn.hasOwnProperty(t)?Mn(Cn[t]):"transparent"===t?new Be(NaN,NaN,NaN,0):null}function Mn(t){return new Be(t>>16&255,t>>8&255,255&t,1)}function Fi(t,e,l,s){return s<=0&&(t=e=l=NaN),new Be(t,e,l,s)}function Qi(t,e,l,s){return 1===arguments.length?function Rr(t){return t instanceof Ci||(t=Mi(t)),t?new Be((t=t.rgb()).r,t.g,t.b,t.opacity):new Be}(t):new Be(t,e,l,null==s?1:s)}function Be(t,e,l,s){this.r=+t,this.g=+e,this.b=+l,this.opacity=+s}function Pn(){return`#${vi(this.r)}${vi(this.g)}${vi(this.b)}`}function Rn(){const t=Hi(this.opacity);return`${1===t?"rgb(":"rgba("}${fi(this.r)}, ${fi(this.g)}, ${fi(this.b)}${1===t?")":`, ${t})`}`}function Hi(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function fi(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function vi(t){return((t=fi(t))<16?"0":"")+t.toString(16)}function Nn(t,e,l,s){return s<=0?t=e=l=NaN:l<=0||l>=1?t=e=NaN:e<=0&&(t=NaN),new ei(t,e,l,s)}function Ln(t){if(t instanceof ei)return new ei(t.h,t.s,t.l,t.opacity);if(t instanceof Ci||(t=Mi(t)),!t)return new ei;if(t instanceof ei)return t;var e=(t=t.rgb()).r/255,l=t.g/255,s=t.b/255,f=Math.min(e,l,s),x=Math.max(e,l,s),O=NaN,G=x-f,U=(x+f)/2;return G?(O=e===x?(l-s)/G+6*(l<s):l===x?(s-e)/G+2:(e-l)/G+4,G/=U<.5?x+f:2-x-f,O*=60):G=U>0&&U<1?0:O,new ei(O,G,U,t.opacity)}function ei(t,e,l,s){this.h=+t,this.s=+e,this.l=+l,this.opacity=+s}function Dn(t){return(t=(t||0)%360)<0?t+360:t}function Vi(t){return Math.max(0,Math.min(1,t||0))}function an(t,e,l){return 255*(t<60?e+(l-e)*t/60:t<180?l:t<240?e+(l-e)*(240-t)/60:e)}function jn(t,e,l,s,f){var x=t*t,O=x*t;return((1-3*t+3*x-O)*e+(4-6*x+3*O)*l+(1+3*t+3*x-3*O)*s+O*f)/6}ln(Ci,Mi,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:An,formatHex:An,formatHex8:function Mr(){return this.rgb().formatHex8()},formatHsl:function Pr(){return Ln(this).formatHsl()},formatRgb:In,toString:In}),ln(Be,Qi,Tn(Ci,{brighter(t){return t=null==t?Wi:Math.pow(Wi,t),new Be(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new Be(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Be(fi(this.r),fi(this.g),fi(this.b),Hi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Pn,formatHex:Pn,formatHex8:function Nr(){return`#${vi(this.r)}${vi(this.g)}${vi(this.b)}${vi(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Rn,toString:Rn})),ln(ei,function Lr(t,e,l,s){return 1===arguments.length?Ln(t):new ei(t,e,l,null==s?1:s)},Tn(Ci,{brighter(t){return t=null==t?Wi:Math.pow(Wi,t),new ei(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new ei(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,l=this.l,s=l+(l<.5?l:1-l)*e,f=2*l-s;return new Be(an(t>=240?t-240:t+120,f,s),an(t,f,s),an(t<120?t+240:t-120,f,s),this.opacity)},clamp(){return new ei(Dn(this.h),Vi(this.s),Vi(this.l),Hi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Hi(this.opacity);return`${1===t?"hsl(":"hsla("}${Dn(this.h)}, ${100*Vi(this.s)}%, ${100*Vi(this.l)}%${1===t?")":`, ${t})`}`}}));const Bn=t=>()=>t;function zn(t,e){var l=e-t;return l?function Kn(t,e){return function(l){return t+l*e}}(t,l):Bn(isNaN(t)?e:t)}const Gn=function t(e){var l=function Kr(t){return 1==(t=+t)?zn:function(e,l){return l-e?function Br(t,e,l){return t=Math.pow(t,l),e=Math.pow(e,l)-t,l=1/l,function(s){return Math.pow(t+s*e,l)}}(e,l,t):Bn(isNaN(e)?l:e)}}(e);function s(f,x){var O=l((f=Qi(f)).r,(x=Qi(x)).r),G=l(f.g,x.g),U=l(f.b,x.b),lt=zn(f.opacity,x.opacity);return function(ct){return f.r=O(ct),f.g=G(ct),f.b=U(ct),f.opacity=lt(ct),f+""}}return s.gamma=t,s}(1);function Un(t){return function(e){var O,G,l=e.length,s=new Array(l),f=new Array(l),x=new Array(l);for(O=0;O<l;++O)G=Qi(e[O]),s[O]=G.r||0,f[O]=G.g||0,x[O]=G.b||0;return s=t(s),f=t(f),x=t(x),G.opacity=1,function(U){return G.r=s(U),G.g=f(U),G.b=x(U),G+""}}}Un(function Dr(t){var e=t.length-1;return function(l){var s=l<=0?l=0:l>=1?(l=1,e-1):Math.floor(l*e),f=t[s],x=t[s+1];return jn((l-s/e)*e,s>0?t[s-1]:2*f-x,f,x,s<e-1?t[s+2]:2*x-f)}}),Un(function jr(t){var e=t.length;return function(l){var s=Math.floor(((l%=1)<0?++l:l)*e);return jn((l-s/e)*e,t[(s+e-1)%e],t[s%e],t[(s+1)%e],t[(s+2)%e])}});var on=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,sn=new RegExp(on.source,"g");function Ur(t,e){var s,f,x,l=on.lastIndex=sn.lastIndex=0,O=-1,G=[],U=[];for(t+="",e+="";(s=on.exec(t))&&(f=sn.exec(e));)(x=f.index)>l&&(x=e.slice(l,x),G[O]?G[O]+=x:G[++O]=x),(s=s[0])===(f=f[0])?G[O]?G[O]+=f:G[++O]=f:(G[++O]=null,U.push({i:O,x:di(s,f)})),l=sn.lastIndex;return l<e.length&&(x=e.slice(l),G[O]?G[O]+=x:G[++O]=x),G.length<2?U[0]?function Gr(t){return function(e){return t(e)+""}}(U[0].x):function zr(t){return function(){return t}}(e):(e=U.length,function(lt){for(var Ut,ct=0;ct<e;++ct)G[(Ut=U[ct]).i]=Ut.x(lt);return G.join("")})}function Wn(t,e){var l;return("number"==typeof e?di:e instanceof Mi?Gn:(l=Mi(e))?(e=l,Gn):Ur)(t,e)}function Wr(t){return function(){this.removeAttribute(t)}}function Fr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Qr(t,e,l){var s,x,f=l+"";return function(){var O=this.getAttribute(t);return O===f?null:O===s?x:x=e(s=O,l)}}function Hr(t,e,l){var s,x,f=l+"";return function(){var O=this.getAttributeNS(t.space,t.local);return O===f?null:O===s?x:x=e(s=O,l)}}function Vr(t,e,l){var s,f,x;return function(){var O,U,G=l(this);return null==G?void this.removeAttribute(t):(O=this.getAttribute(t))===(U=G+"")?null:O===s&&U===f?x:(f=U,x=e(s=O,G))}}function Jr(t,e,l){var s,f,x;return function(){var O,U,G=l(this);return null==G?void this.removeAttributeNS(t.space,t.local):(O=this.getAttributeNS(t.space,t.local))===(U=G+"")?null:O===s&&U===f?x:(f=U,x=e(s=O,G))}}function qr(t,e){var l,s;function f(){var x=e.apply(this,arguments);return x!==s&&(l=(s=x)&&function Yr(t,e){return function(l){this.setAttributeNS(t.space,t.local,e.call(this,l))}}(t,x)),l}return f._value=e,f}function $r(t,e){var l,s;function f(){var x=e.apply(this,arguments);return x!==s&&(l=(s=x)&&function Xr(t,e){return function(l){this.setAttribute(t,e.call(this,l))}}(t,x)),l}return f._value=e,f}function el(t,e){return function(){en(this,t).delay=+e.apply(this,arguments)}}function il(t,e){return e=+e,function(){en(this,t).delay=e}}function rl(t,e){return function(){ni(this,t).duration=+e.apply(this,arguments)}}function ll(t,e){return e=+e,function(){ni(this,t).duration=e}}var wl=ve.prototype.constructor;function Fn(t){return function(){this.style.removeProperty(t)}}var Bl=0;function ai(t,e,l,s){this._groups=t,this._parents=e,this._name=l,this._id=s}function Qn(){return++Bl}var oi=ve.prototype;ai.prototype=function Kl(t){return ve().transition(t)}.prototype={constructor:ai,select:function ml(t){var e=this._name,l=this._id;"function"!=typeof t&&(t=E(t));for(var s=this._groups,f=s.length,x=new Array(f),O=0;O<f;++O)for(var ct,Ut,G=s[O],U=G.length,lt=x[O]=new Array(U),Wt=0;Wt<U;++Wt)(ct=G[Wt])&&(Ut=t.call(ct,ct.__data__,Wt,G))&&("__data__"in ct&&(Ut.__data__=ct.__data__),lt[Wt]=Ut,Gi(lt[Wt],e,l,Wt,lt,ti(ct,l)));return new ai(x,this._parents,e,l)},selectAll:function _l(t){var e=this._name,l=this._id;"function"!=typeof t&&(t=b(t));for(var s=this._groups,f=s.length,x=[],O=[],G=0;G<f;++G)for(var ct,U=s[G],lt=U.length,Ut=0;Ut<lt;++Ut)if(ct=U[Ut]){for(var Xt,Wt=t.call(ct,ct.__data__,Ut,U),_e=ti(ct,l),Se=0,Bt=Wt.length;Se<Bt;++Se)(Xt=Wt[Se])&&Gi(Xt,e,l,Se,Wt,_e);x.push(Wt),O.push(ct)}return new ai(x,O,e,l)},selectChild:oi.selectChild,selectChildren:oi.selectChildren,filter:function hl(t){"function"!=typeof t&&(t=M(t));for(var e=this._groups,l=e.length,s=new Array(l),f=0;f<l;++f)for(var U,x=e[f],O=x.length,G=s[f]=[],lt=0;lt<O;++lt)(U=x[lt])&&t.call(U,U.__data__,lt,x)&&G.push(U);return new ai(s,this._parents,this._name,this._id)},merge:function cl(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,l=t._groups,s=e.length,x=Math.min(s,l.length),O=new Array(s),G=0;G<x;++G)for(var Wt,U=e[G],lt=l[G],ct=U.length,Ut=O[G]=new Array(ct),Xt=0;Xt<ct;++Xt)(Wt=U[Xt]||lt[Xt])&&(Ut[Xt]=Wt);for(;G<s;++G)O[G]=e[G];return new ai(O,this._parents,this._name,this._id)},selection:function bl(){return new wl(this._groups,this._parents)},transition:function Dl(){for(var t=this._name,e=this._id,l=Qn(),s=this._groups,f=s.length,x=0;x<f;++x)for(var U,O=s[x],G=O.length,lt=0;lt<G;++lt)if(U=O[lt]){var ct=ti(U,e);Gi(U,t,l,lt,O,{time:ct.time+ct.delay+ct.duration,delay:0,duration:ct.duration,ease:ct.ease})}return new ai(s,this._parents,t,l)},call:oi.call,nodes:oi.nodes,node:oi.node,size:oi.size,empty:oi.empty,each:oi.each,on:function gl(t,e){var l=this._id;return arguments.length<2?ti(this.node(),l).on.on(t):this.each(function vl(t,e,l){var s,f,x=function fl(t){return(t+"").trim().split(/^|\s+/).every(function(e){var l=e.indexOf(".");return l>=0&&(e=e.slice(0,l)),!e||"start"===e})}(e)?en:ni;return function(){var O=x(this,t),G=O.on;G!==s&&(f=(s=G).copy()).on(e,l),O.on=f}}(l,t,e))},attr:function Zr(t,e){var l=zt(t),s="transform"===l?wr:Wn;return this.attrTween(t,"function"==typeof e?(l.local?Jr:Vr)(l,s,rn(this,"attr."+t,e)):null==e?(l.local?Fr:Wr)(l):(l.local?Hr:Qr)(l,s,e))},attrTween:function tl(t,e){var l="attr."+t;if(arguments.length<2)return(l=this.tween(l))&&l._value;if(null==e)return this.tween(l,null);if("function"!=typeof e)throw new Error;var s=zt(t);return this.tween(l,(s.local?qr:$r)(s,e))},style:function kl(t,e,l){var s="transform"==(t+="")?_r:Wn;return null==e?this.styleTween(t,function xl(t,e){var l,s,f;return function(){var x=rt(this,t),O=(this.style.removeProperty(t),rt(this,t));return x===O?null:x===l&&O===s?f:f=e(l=x,s=O)}}(t,s)).on("end.style."+t,Fn(t)):"function"==typeof e?this.styleTween(t,function Ol(t,e,l){var s,f,x;return function(){var O=rt(this,t),G=l(this),U=G+"";return null==G&&(this.style.removeProperty(t),U=G=rt(this,t)),O===U?null:O===s&&U===f?x:(f=U,x=e(s=O,G))}}(t,s,rn(this,"style."+t,e))).each(function Sl(t,e){var l,s,f,G,x="style."+e,O="end."+x;return function(){var U=ni(this,t),lt=U.on,ct=null==U.value[x]?G||(G=Fn(e)):void 0;(lt!==l||f!==ct)&&(s=(l=lt).copy()).on(O,f=ct),U.on=s}}(this._id,t)):this.styleTween(t,function El(t,e,l){var s,x,f=l+"";return function(){var O=rt(this,t);return O===f?null:O===s?x:x=e(s=O,l)}}(t,s,e),l).on("end.style."+t,null)},styleTween:function Al(t,e,l){var s="style."+(t+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(null==e)return this.tween(s,null);if("function"!=typeof e)throw new Error;return this.tween(s,function Cl(t,e,l){var s,f;function x(){var O=e.apply(this,arguments);return O!==f&&(s=(f=O)&&function Tl(t,e,l){return function(s){this.style.setProperty(t,e.call(this,s),l)}}(t,O,l)),s}return x._value=e,x}(t,e,null==l?"":l))},text:function Pl(t){return this.tween("text","function"==typeof t?function Ml(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(rn(this,"text",t)):function Il(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function Ll(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function Nl(t){var e,l;function s(){var f=t.apply(this,arguments);return f!==l&&(e=(l=f)&&function Rl(t){return function(e){this.textContent=t.call(this,e)}}(f)),e}return s._value=t,s}(t))},remove:function pl(){return this.on("end.remove",function yl(t){return function(){var e=this.parentNode;for(var l in this.__transition)if(+l!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function Er(t,e){var l=this._id;if(t+="",arguments.length<2){for(var O,s=ti(this.node(),l).tween,f=0,x=s.length;f<x;++f)if((O=s[f]).name===t)return O.value;return null}return this.each((null==e?br:xr)(l,t,e))},delay:function nl(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?el:il)(e,t)):ti(this.node(),e).delay},duration:function al(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?rl:ll)(e,t)):ti(this.node(),e).duration},ease:function sl(t){var e=this._id;return arguments.length?this.each(function ol(t,e){if("function"!=typeof e)throw new Error;return function(){ni(this,t).ease=e}}(e,t)):ti(this.node(),e).ease},easeVarying:function ul(t){if("function"!=typeof t)throw new Error;return this.each(function dl(t,e){return function(){var l=e.apply(this,arguments);if("function"!=typeof l)throw new Error;ni(this,t).ease=l}}(this._id,t))},end:function jl(){var t,e,l=this,s=l._id,f=l.size();return new Promise(function(x,O){var G={value:O},U={value:function(){0==--f&&x()}};l.each(function(){var lt=ni(this,s),ct=lt.on;ct!==t&&((e=(t=ct).copy())._.cancel.push(G),e._.interrupt.push(G),e._.end.push(U)),lt.on=e}),0===f&&x()})},[Symbol.iterator]:oi[Symbol.iterator]};var Gl={time:null,delay:0,duration:250,ease:function zl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Ul(t,e){for(var l;!(l=t.__transition)||!(l=l[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return l}ve.prototype.interrupt=function yr(t){return this.each(function(){!function gr(t,e){var s,f,O,l=t.__transition,x=!0;if(l){for(O in e=null==e?null:e+"",l)(s=l[O]).name===e?(f=s.state>2&&s.state<5,s.state=6,s.timer.stop(),s.on.call(f?"interrupt":"cancel",t,t.__data__,s.index,s.group),delete l[O]):x=!1;x&&delete t.__transition}}(this,t)})},ve.prototype.transition=function Wl(t){var e,l;t instanceof ai?(e=t._id,t=t._name):(e=Qn(),(l=Gl).time=Yi(),t=null==t?null:t+"");for(var s=this._groups,f=s.length,x=0;x<f;++x)for(var U,O=s[x],G=O.length,lt=0;lt<G;++lt)(U=O[lt])&&Gi(U,t,e,lt,O,l||Ul(U,e));return new ai(s,this._parents,t,e)};Math;function Pi(t){return{type:t}}function bi(t){return function(){return t}}function Yn(t){this._context=t}function ql(t){return new Yn(t)}["w","e"].map(Pi),["n","s"].map(Pi),["n","w","e","s","nw","ne","sw","se"].map(Pi),Yn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};const fn=Math.PI,vn=2*fn,gi=1e-6,$l=vn-gi;function qn(t){this._+=t[0];for(let e=1,l=t.length;e<l;++e)this._+=arguments[e]+t[e]}class Xi{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?qn:function ta(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return qn;const l=10**e;return function(s){this._+=s[0];for(let f=1,x=s.length;f<x;++f)this._+=Math.round(arguments[f]*l)/l+s[f]}}(e)}moveTo(e,l){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,l){this._append`L${this._x1=+e},${this._y1=+l}`}quadraticCurveTo(e,l,s,f){this._append`Q${+e},${+l},${this._x1=+s},${this._y1=+f}`}bezierCurveTo(e,l,s,f,x,O){this._append`C${+e},${+l},${+s},${+f},${this._x1=+x},${this._y1=+O}`}arcTo(e,l,s,f,x){if(e=+e,l=+l,s=+s,f=+f,(x=+x)<0)throw new Error(`negative radius: ${x}`);let O=this._x1,G=this._y1,U=s-e,lt=f-l,ct=O-e,Ut=G-l,Wt=ct*ct+Ut*Ut;if(null===this._x1)this._append`M${this._x1=e},${this._y1=l}`;else if(Wt>gi)if(Math.abs(Ut*U-lt*ct)>gi&&x){let Xt=s-O,_e=f-G,Se=U*U+lt*lt,Bt=Xt*Xt+_e*_e,Dt=Math.sqrt(Se),ae=Math.sqrt(Wt),Yt=x*Math.tan((fn-Math.acos((Se+Wt-Bt)/(2*Dt*ae)))/2),he=Yt/ae,ge=Yt/Dt;Math.abs(he-1)>gi&&this._append`L${e+he*ct},${l+he*Ut}`,this._append`A${x},${x},0,0,${+(Ut*Xt>ct*_e)},${this._x1=e+ge*U},${this._y1=l+ge*lt}`}else this._append`L${this._x1=e},${this._y1=l}`}arc(e,l,s,f,x,O){if(e=+e,l=+l,O=!!O,(s=+s)<0)throw new Error(`negative radius: ${s}`);let G=s*Math.cos(f),U=s*Math.sin(f),lt=e+G,ct=l+U,Ut=1^O,Wt=O?f-x:x-f;null===this._x1?this._append`M${lt},${ct}`:(Math.abs(this._x1-lt)>gi||Math.abs(this._y1-ct)>gi)&&this._append`L${lt},${ct}`,s&&(Wt<0&&(Wt=Wt%vn+vn),Wt>$l?this._append`A${s},${s},0,1,${Ut},${e-G},${l-U}A${s},${s},0,1,${Ut},${this._x1=lt},${this._y1=ct}`:Wt>gi&&this._append`A${s},${s},0,${+(Wt>=fn)},${Ut},${this._x1=e+s*Math.cos(x)},${this._y1=l+s*Math.sin(x)}`)}rect(e,l,s,f){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}h${s=+s}v${+f}h${-s}Z`}toString(){return this._}}function na(t){return t[0]}function ra(t){return t[1]}function la(t,e){var l=bi(!0),s=null,f=ql,x=null,O=function ia(t){let e=3;return t.digits=function(l){if(!arguments.length)return e;if(null==l)e=null;else{const s=Math.floor(l);if(!(s>=0))throw new RangeError(`invalid digits: ${l}`);e=s}return t},()=>new Xi(e)}(G);function G(U){var lt,Ut,Xt,ct=(U=function Yl(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(U)).length,Wt=!1;for(null==s&&(x=f(Xt=O())),lt=0;lt<=ct;++lt)!(lt<ct&&l(Ut=U[lt],lt,U))===Wt&&((Wt=!Wt)?x.lineStart():x.lineEnd()),Wt&&x.point(+t(Ut,lt,U),+e(Ut,lt,U));if(Xt)return x=null,Xt+""||null}return t="function"==typeof t?t:void 0===t?na:bi(t),e="function"==typeof e?e:void 0===e?ra:bi(e),G.x=function(U){return arguments.length?(t="function"==typeof U?U:bi(+U),G):t},G.y=function(U){return arguments.length?(e="function"==typeof U?U:bi(+U),G):e},G.defined=function(U){return arguments.length?(l="function"==typeof U?U:bi(!!U),G):l},G.curve=function(U){return arguments.length?(f=U,null!=s&&(x=f(s)),G):f},G.context=function(U){return arguments.length?(null==U?s=x=null:x=f(s=U),G):s},G}function $n(t,e,l){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+l)/6)}function tr(t){this._context=t}function aa(t){return new tr(t)}function xi(t,e,l){this.k=t,this.x=e,this.y=l}tr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:$n(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:$n(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},xi.prototype={constructor:xi,scale:function(t){return 1===t?this:new xi(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new xi(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new xi(1,0,0)}}]);