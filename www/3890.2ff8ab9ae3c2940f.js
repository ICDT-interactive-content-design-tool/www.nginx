"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3890],{3890:(me,_t,M)=>{M.d(_t,{x:()=>ft});var B=M(177),a=M(9417),Y=M(6637),k=M(2706),et=M(4342),$=M(9445),J=M(9362),rt=M(4438);let ft=(()=>{var O;class it{}return(O=it).\u0275fac=function(mt){return new(mt||O)},O.\u0275mod=rt.$C({type:O}),O.\u0275inj=rt.G2t({imports:[B.MD,a.YN,Y.bv,k.G,et.LP,$.w,J._D,k.G,et.LP]}),it})()},9445:(me,_t,M)=>{M.d(_t,{h:()=>zs,w:()=>Ps});var B=M(467),a=M(4438);class Y{constructor(e){if(this.crashes=[],this.state="initializing",this._now=Date.now,this.crashes=[],this._crashNumberLimit="number"==typeof e.crashNumberLimit?e.crashNumberLimit:3,this._minimumNonErrorTimePeriod="number"==typeof e.minimumNonErrorTimePeriod?e.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=i=>{const s="error"in i?i.error:i.reason;s instanceof Error&&this._handleError(s,i)},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.")}destroy(){this._stopErrorHandling(),this._listeners={}}on(e,i){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(i)}off(e,i){this._listeners[e]=this._listeners[e].filter(s=>s!==i)}_fire(e,...i){const s=this._listeners[e]||[];for(const d of s)d.apply(this,[null,...i])}_startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler)}_stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler)}_handleError(e,i){if(this._shouldReactToError(e)){this.crashes.push({message:e.message,stack:e.stack,filename:i instanceof ErrorEvent?i.filename:void 0,lineno:i instanceof ErrorEvent?i.lineno:void 0,colno:i instanceof ErrorEvent?i.colno:void 0,date:this._now()});const s=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:e,causesRestart:s}),s?this._restart():(this.state="crashedPermanently",this._fire("stateChange"))}}_shouldReactToError(e){return e.is&&e.is("CKEditorError")&&null!=e.context&&"ready"===this.state&&this._isErrorComingFromThisItem(e)}_shouldRestart(){return this.crashes.length<=this._crashNumberLimit||(this.crashes[this.crashes.length-1].date-this.crashes[this.crashes.length-1-this._crashNumberLimit].date)/this._crashNumberLimit>this._minimumNonErrorTimePeriod}}function k(t,e=new Set){const i=[t],s=new Set;let d=0;for(;i.length>d;){const u=i[d++];if(!s.has(u)&&et(u)&&!e.has(u))if(s.add(u),Symbol.iterator in u)try{for(const _ of u)i.push(_)}catch{}else for(const _ in u)"defaultValue"!==_&&i.push(u[_])}return s}function et(t){const e=Object.prototype.toString.call(t),i=typeof t;return!("number"===i||"boolean"===i||"string"===i||"symbol"===i||"function"===i||"[object Date]"===e||"[object RegExp]"===e||"[object Module]"===e||null==t||t._watchdogExcluded||t instanceof EventTarget||t instanceof Event)}const O=function ft(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},nt="object"==typeof global&&global&&global.Object===Object&&global;var mt="object"==typeof self&&self&&self.Object===Object&&self;const S=nt||mt||Function("return this")(),yt=function(){return S.Date.now()};var kt=/\s/;var Gt=/^\s+/;const Xt=function Qt(t){return t&&t.slice(0,function Vt(t){for(var e=t.length;e--&&kt.test(t.charAt(e)););return e}(t)+1).replace(Gt,"")},V=S.Symbol;var Et=Object.prototype,Yt=Et.hasOwnProperty,$t=Et.toString,ot=V?V.toStringTag:void 0;var r=Object.prototype.toString;var l=V?V.toStringTag:void 0;const C=function y(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":l&&l in Object(t)?function p(t){var e=Yt.call(t,ot),i=t[ot];try{t[ot]=void 0;var s=!0}catch{}var d=$t.call(t);return s&&(e?t[ot]=i:delete t[ot]),d}(t):function n(t){return r.call(t)}(t)},A=function v(t){return null!=t&&"object"==typeof t};var N=/^[-+]0x[0-9a-f]+$/i,E=/^0b[01]+$/i,L=/^0o[0-7]+$/i,It=parseInt;const bt=function Ot(t){if("number"==typeof t)return t;if(function z(t){return"symbol"==typeof t||A(t)&&"[object Symbol]"==C(t)}(t))return NaN;if(O(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=O(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Xt(t);var i=E.test(t);return i||L.test(t)?It(t.slice(2),i?2:8):N.test(t)?NaN:+t};var jt=Math.max,Jt=Math.min;const Bt=function at(t,e,i){var s=!0,d=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return O(i)&&(s="leading"in i?!!i.leading:s,d="trailing"in i?!!i.trailing:d),function qt(t,e,i){var s,d,u,_,f,x,b=0,j=!1,W=!1,X=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function pt(I){var K=s,Tt=d;return s=d=void 0,b=I,_=t.apply(Tt,K)}function U(I){var K=I-x;return void 0===x||K>=e||K<0||W&&I-b>=u}function F(){var I=yt();if(U(I))return lr(I);f=setTimeout(F,function Lt(I){var dr=e-(I-x);return W?Jt(dr,u-(I-b)):dr}(I))}function lr(I){return f=void 0,X&&s?pt(I):(s=d=void 0,_)}function fe(){var I=yt(),K=U(I);if(s=arguments,d=this,x=I,K){if(void 0===f)return function _e(I){return b=I,f=setTimeout(F,e),j?pt(I):_}(x);if(W)return clearTimeout(f),f=setTimeout(F,e),pt(x)}return void 0===f&&(f=setTimeout(F,e)),_}return e=bt(e)||0,O(i)&&(j=!!i.leading,u=(W="maxWait"in i)?jt(bt(i.maxWait)||0,e):u,X="trailing"in i?!!i.trailing:X),fe.cancel=function Ws(){void 0!==f&&clearTimeout(f),b=0,s=x=d=f=void 0},fe.flush=function Fs(){return void 0===f?_:lr(yt())},fe}(t,e,{leading:s,maxWait:e,trailing:d})},zt=function Zt(t,e){return function(i){return t(e(i))}},ct=zt(Object.getPrototypeOf,Object);var ye=Function.prototype.toString,ur=Object.prototype.hasOwnProperty,pr=ye.call(Object);const be=function mr(t){return A(t)&&1===t.nodeType&&!function _r(t){if(!A(t)||"[object Object]"!=C(t))return!1;var e=ct(t);if(null===e)return!0;var i=ur.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&ye.call(i)==pr}(t)},xe=function xr(t,e){return t===e||t!=t&&e!=e},Dt=function Cr(t,e){for(var i=t.length;i--;)if(xe(t[i][0],e))return i;return-1};var Ar=Array.prototype.splice;function ht(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var s=t[e];this.set(s[0],s[1])}}ht.prototype.clear=function yr(){this.__data__=[],this.size=0},ht.prototype.delete=function Mr(t){var e=this.__data__,i=Dt(e,t);return!(i<0||(i==e.length-1?e.pop():Ar.call(e,i,1),--this.size,0))},ht.prototype.get=function Tr(t){var e=this.__data__,i=Dt(e,t);return i<0?void 0:e[i][1]},ht.prototype.has=function Er(t){return Dt(this.__data__,t)>-1},ht.prototype.set=function Or(t,e){var i=this.__data__,s=Dt(i,t);return s<0?(++this.size,i.push([t,e])):i[s][1]=e,this};const Pt=ht,Ce=function Vr(t){if(!O(t))return!1;var e=C(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e};var t,Gr=S["__core-js_shared__"],ve=(t=/[^.]+$/.exec(Gr&&Gr.keys&&Gr.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"";var Yr=Function.prototype.toString;const q=function $r(t){if(null!=t){try{return Yr.call(t)}catch{}try{return t+""}catch{}}return""};var qr=/^\[object .+?Constructor\]$/,ii=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const oi=function ni(t){return!(!O(t)||function Qr(t){return!!ve&&ve in t}(t))&&(Ce(t)?ii:qr).test(q(t))},Z=function ci(t,e){var i=function ai(t,e){return null==t?void 0:t[e]}(t,e);return oi(i)?i:void 0},vt=Z(S,"Map"),At=Z(Object,"create");var mi=Object.prototype.hasOwnProperty;var Ci=Object.prototype.hasOwnProperty;function lt(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var s=t[e];this.set(s[0],s[1])}}lt.prototype.clear=function di(){this.__data__=At?At(null):{},this.size=0},lt.prototype.delete=function ui(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},lt.prototype.get=function yi(t){var e=this.__data__;if(At){var i=e[t];return"__lodash_hash_undefined__"===i?void 0:i}return mi.call(e,t)?e[t]:void 0},lt.prototype.has=function vi(t){var e=this.__data__;return At?void 0!==e[t]:Ci.call(e,t)},lt.prototype.set=function wi(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=At&&void 0===e?"__lodash_hash_undefined__":e,this};const Ae=lt,Wt=function Ri(t,e){var i=t.__data__;return function Ii(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?i["string"==typeof e?"string":"hash"]:i.map};function dt(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var s=t[e];this.set(s[0],s[1])}}dt.prototype.clear=function Si(){this.size=0,this.__data__={hash:new Ae,map:new(vt||Pt),string:new Ae}},dt.prototype.delete=function ji(t){var e=Wt(this,t).delete(t);return this.size-=e?1:0,e},dt.prototype.get=function zi(t){return Wt(this,t).get(t)},dt.prototype.has=function Pi(t){return Wt(this,t).has(t)},dt.prototype.set=function Fi(t,e){var i=Wt(this,t),s=i.size;return i.set(t,e),this.size+=i.size==s?0:1,this};const Li=dt;function gt(t){var e=this.__data__=new Pt(t);this.size=e.size}gt.prototype.clear=function jr(){this.__data__=new Pt,this.size=0},gt.prototype.delete=function zr(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i},gt.prototype.get=function Pr(t){return this.__data__.get(t)},gt.prototype.has=function Fr(t){return this.__data__.has(t)},gt.prototype.set=function Ni(t,e){var i=this.__data__;if(i instanceof Pt){var s=i.__data__;if(!vt||s.length<199)return s.push([t,e]),this.size=++i.size,this;i=this.__data__=new Li(s)}return i.set(t,e),this.size=i.size,this};const Vi=gt;var Xi=function(){try{var t=Z(Object,"defineProperty");return t({},"",{}),t}catch{}}();const Me=Xi,we=function Ki(t,e,i){"__proto__"==e&&Me?Me(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i};var $i=Object.prototype.hasOwnProperty;const Te=function Ji(t,e,i){var s=t[e];(!$i.call(t,e)||!xe(s,i)||void 0===i&&!(e in t))&&we(t,e,i)},Ft=function qi(t,e,i,s){var d=!i;i||(i={});for(var u=-1,_=e.length;++u<_;){var f=e[u],x=s?s(i[f],t[f],f,i,t):void 0;void 0===x&&(x=t[f]),d?we(i,f,x):Te(i,f,x)}return i},Se=function rn(t){return A(t)&&"[object Arguments]"==C(t)};var Ee=Object.prototype,nn=Ee.hasOwnProperty,on=Ee.propertyIsEnumerable,an=Se(function(){return arguments}())?Se:function(t){return A(t)&&nn.call(t,"callee")&&!on.call(t,"callee")};const sn=an,ee=Array.isArray;var Ie="object"==typeof exports&&exports&&!exports.nodeType&&exports,Oe=Ie&&"object"==typeof module&&module&&!module.nodeType&&module,Re=Oe&&Oe.exports===Ie?S.Buffer:void 0;const je=(Re?Re.isBuffer:void 0)||function hn(){return!1};var _n=/^(?:0|[1-9]\d*)$/;const mn=function fn(t,e){var i=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==i||"symbol"!=i&&_n.test(t))&&t>-1&&t%1==0&&t<e},Be=function bn(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var T={};T["[object Float32Array]"]=T["[object Float64Array]"]=T["[object Int8Array]"]=T["[object Int16Array]"]=T["[object Int32Array]"]=T["[object Uint8Array]"]=T["[object Uint8ClampedArray]"]=T["[object Uint16Array]"]=T["[object Uint32Array]"]=!0,T["[object Arguments]"]=T["[object Array]"]=T["[object ArrayBuffer]"]=T["[object Boolean]"]=T["[object DataView]"]=T["[object Date]"]=T["[object Error]"]=T["[object Function]"]=T["[object Map]"]=T["[object Number]"]=T["[object Object]"]=T["[object RegExp]"]=T["[object Set]"]=T["[object String]"]=T["[object WeakMap]"]=!1;const re=function Qn(t){return function(e){return t(e)}};var ze="object"==typeof exports&&exports&&!exports.nodeType&&exports,Mt=ze&&"object"==typeof module&&module&&!module.nodeType&&module,ie=Mt&&Mt.exports===ze&&nt.process;const ut=function(){try{return Mt&&Mt.require&&Mt.require("util").types||ie&&ie.binding&&ie.binding("util")}catch{}}();var De=ut&&ut.isTypedArray;const $n=De?re(De):function Vn(t){return A(t)&&Be(t.length)&&!!T[C(t)]};var qn=Object.prototype.hasOwnProperty;const Pe=function Zn(t,e){var i=ee(t),s=!i&&sn(t),d=!i&&!s&&je(t),u=!i&&!s&&!d&&$n(t),_=i||s||d||u,f=_?function Zi(t,e){for(var i=-1,s=Array(t);++i<t;)s[i]=e(i);return s}(t.length,String):[],x=f.length;for(var b in t)(e||qn.call(t,b))&&(!_||!("length"==b||d&&("offset"==b||"parent"==b)||u&&("buffer"==b||"byteLength"==b||"byteOffset"==b)||mn(b,x)))&&f.push(b);return f};var to=Object.prototype;const ne=function eo(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||to)},io=zt(Object.keys,Object);var oo=Object.prototype.hasOwnProperty;const We=function co(t){return null!=t&&Be(t.length)&&!Ce(t)},oe=function ho(t){return We(t)?Pe(t):function ao(t){if(!ne(t))return io(t);var e=[];for(var i in Object(t))oo.call(t,i)&&"constructor"!=i&&e.push(i);return e}(t)};var fo=Object.prototype.hasOwnProperty;const yo=function mo(t){if(!O(t))return function uo(t){var e=[];if(null!=t)for(var i in Object(t))e.push(i);return e}(t);var e=ne(t),i=[];for(var s in t)"constructor"==s&&(e||!fo.call(t,s))||i.push(s);return i},ae=function bo(t){return We(t)?Pe(t,!0):yo(t)};var Fe="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ue=Fe&&"object"==typeof module&&module&&!module.nodeType&&module,Le=Ue&&Ue.exports===Fe?S.Buffer:void 0,He=Le?Le.allocUnsafe:void 0;const Ne=function Io(){return[]};var Ro=Object.prototype.propertyIsEnumerable,ke=Object.getOwnPropertySymbols,jo=ke?function(t){return null==t?[]:(t=Object(t),function So(t,e){for(var i=-1,s=null==t?0:t.length,d=0,u=[];++i<s;){var _=t[i];e(_,i,t)&&(u[d++]=_)}return u}(ke(t),function(e){return Ro.call(t,e)}))}:Ne;const se=jo,Ve=function Do(t,e){for(var i=-1,s=e.length,d=t.length;++i<s;)t[d+i]=e[i];return t};var Wo=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Ve(e,se(t)),t=ct(t);return e}:Ne;const Ge=Wo,Qe=function Lo(t,e,i){var s=e(t);return ee(t)?s:Ve(s,i(t))},No=function Ho(t){return Qe(t,oe,se)},Vo=function ko(t){return Qe(t,ae,Ge)},ce=Z(S,"DataView"),he=Z(S,"Promise"),le=Z(S,"Set"),de=Z(S,"WeakMap");var Xe="[object Map]",Ke="[object Promise]",Ye="[object Set]",$e="[object WeakMap]",Je="[object DataView]",$o=q(ce),Jo=q(vt),qo=q(he),Zo=q(le),ta=q(de),tt=C;(ce&&tt(new ce(new ArrayBuffer(1)))!=Je||vt&&tt(new vt)!=Xe||he&&tt(he.resolve())!=Ke||le&&tt(new le)!=Ye||de&&tt(new de)!=$e)&&(tt=function(t){var e=C(t),i="[object Object]"==e?t.constructor:void 0,s=i?q(i):"";if(s)switch(s){case $o:return Je;case Jo:return Xe;case qo:return Ke;case Zo:return Ye;case ta:return $e}return e});const ge=tt;var ra=Object.prototype.hasOwnProperty;const qe=S.Uint8Array,ue=function aa(t){var e=new t.constructor(t.byteLength);return new qe(e).set(new qe(t)),e};var ha=/\w*$/;var Ze=V?V.prototype:void 0,tr=Ze?Ze.valueOf:void 0;const Pa=function Da(t,e,i){var s=t.constructor;switch(e){case"[object ArrayBuffer]":return ue(t);case"[object Boolean]":case"[object Date]":return new s(+t);case"[object DataView]":return function sa(t,e){var i=e?ue(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}(t,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function pa(t,e){var i=e?ue(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}(t,i);case"[object Map]":case"[object Set]":return new s;case"[object Number]":case"[object String]":return new s(t);case"[object RegExp]":return function la(t){var e=new t.constructor(t.source,ha.exec(t));return e.lastIndex=t.lastIndex,e}(t);case"[object Symbol]":return function ga(t){return tr?Object(tr.call(t)):{}}(t)}};var er=Object.create,Wa=function(){function t(){}return function(e){if(!O(e))return{};if(er)return er(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}();const Fa=Wa;var rr=ut&&ut.isMap;const Ga=rr?re(rr):function Na(t){return A(t)&&"[object Map]"==ge(t)};var ir=ut&&ut.isSet;const $a=ir?re(ir):function Xa(t){return A(t)&&"[object Set]"==ge(t)};var nr="[object Arguments]",or="[object Function]",ar="[object Object]",w={};w[nr]=w["[object Array]"]=w["[object ArrayBuffer]"]=w["[object DataView]"]=w["[object Boolean]"]=w["[object Date]"]=w["[object Float32Array]"]=w["[object Float64Array]"]=w["[object Int8Array]"]=w["[object Int16Array]"]=w["[object Int32Array]"]=w["[object Map]"]=w["[object Number]"]=w[ar]=w["[object RegExp]"]=w["[object Set]"]=w["[object String]"]=w["[object Symbol]"]=w["[object Uint8Array]"]=w["[object Uint8ClampedArray]"]=w["[object Uint16Array]"]=w["[object Uint32Array]"]=!0,w["[object Error]"]=w[or]=w["[object WeakMap]"]=!1;const As=function Ut(t,e,i,s,d,u){var _,f=1&e,x=2&e,b=4&e;if(i&&(_=d?i(t,s,d,u):i(t)),void 0!==_)return _;if(!O(t))return t;var j=ee(t);if(j){if(_=function ia(t){var e=t.length,i=new t.constructor(e);return e&&"string"==typeof t[0]&&ra.call(t,"index")&&(i.index=t.index,i.input=t.input),i}(t),!f)return function wo(t,e){var i=-1,s=t.length;for(e||(e=Array(s));++i<s;)e[i]=t[i];return e}(t,_)}else{var W=ge(t),X=W==or||"[object GeneratorFunction]"==W;if(je(t))return function Ao(t,e){if(e)return t.slice();var i=t.length,s=He?He(i):new t.constructor(i);return t.copy(s),s}(t,f);if(W==ar||W==nr||X&&!d){if(_=x||X?{}:function Ua(t){return"function"!=typeof t.constructor||ne(t)?{}:Fa(ct(t))}(t),!f)return x?function Fo(t,e){return Ft(t,Ge(t),e)}(t,function xo(t,e){return t&&Ft(e,ae(e),t)}(_,t)):function Bo(t,e){return Ft(t,se(t),e)}(t,function lo(t,e){return t&&Ft(e,oe(e),t)}(_,t))}else{if(!w[W])return d?t:{};_=Pa(t,W,f)}}u||(u=new Vi);var pt=u.get(t);if(pt)return pt;u.set(t,_),$a(t)?t.forEach(function(U){_.add(Ut(U,e,i,U,t,u))}):Ga(t)&&t.forEach(function(U,F){_.set(F,Ut(U,e,i,F,t,u))});var Lt=j?void 0:(b?x?Vo:No:x?ae:oe)(t);return function Gi(t,e){for(var i=-1,s=null==t?0:t.length;++i<s&&!1!==e(t[i],i,t););}(Lt||t,function(U,F){Lt&&(U=t[F=U]),Te(_,F,Ut(U,e,i,F,t,u))}),_};class sr extends Y{constructor(e,i={}){super(i),this._editor=null,this._lifecyclePromise=null,this._initUsingData=!0,this._editables={},this._throttledSave=Bt(this._save.bind(this),"number"==typeof i.saveInterval?i.saveInterval:5e3),e&&(this._creator=(s,d)=>e.create(s,d)),this._destructor=s=>s.destroy()}get editor(){return this._editor}get _item(){return this._editor}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}_restart(){return Promise.resolve().then(()=>(this.state="initializing",this._fire("stateChange"),this._destroy())).catch(e=>{console.error("An error happened during the editor destroying.",e)}).then(()=>{const e={},i=[],s=this._config.rootsAttributes||{},d={};for(const[_,f]of Object.entries(this._data.roots))f.isLoaded?(e[_]="",d[_]=s[_]||{}):i.push(_);const u={...this._config,extraPlugins:this._config.extraPlugins||[],lazyRoots:i,rootsAttributes:d,_watchdogInitialData:this._data};return delete u.initialData,u.extraPlugins.push(Es),this._initUsingData?this.create(e,u,u.context):be(this._elementOrData)?this.create(this._elementOrData,u,u.context):this.create(this._editables,u,u.context)}).then(()=>{this._fire("restart")})}create(e=this._elementOrData,i=this._config,s){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(super._startErrorHandling(),this._elementOrData=e,this._initUsingData="string"==typeof e||Object.keys(e).length>0&&"string"==typeof Object.values(e)[0],this._config=this._cloneEditorConfiguration(i)||{},this._config.context=s,this._creator(e,this._config))).then(d=>{this._editor=d,d.model.document.on("change:data",this._throttledSave),this._lastDocumentVersion=d.model.document.version,this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this.state="ready",this._fire("stateChange")}).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}destroy(){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy())).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling(),this._throttledSave.cancel();const e=this._editor;return this._editor=null,e.model.document.off("change:data",this._throttledSave),this._destructor(e)})}_save(){const e=this._editor.model.document.version;try{this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this._lastDocumentVersion=e}catch(i){console.error(i,"An error happened during restoring editor data. Editor will be restored from the previously saved data.")}}_setExcludedProperties(e){this._excludedProps=e}_getData(){const e=this._editor,i=e.model.document.roots.filter(f=>f.isAttached()&&"$graveyard"!=f.rootName),{plugins:s}=e,d=s.has("CommentsRepository")&&s.get("CommentsRepository"),u=s.has("TrackChanges")&&s.get("TrackChanges"),_={roots:{},markers:{},commentThreads:JSON.stringify([]),suggestions:JSON.stringify([])};i.forEach(f=>{_.roots[f.rootName]={content:JSON.stringify(Array.from(f.getChildren())),attributes:JSON.stringify(Array.from(f.getAttributes())),isLoaded:f._isLoaded}});for(const f of e.model.markers)f._affectsData&&(_.markers[f.name]={rangeJSON:f.getRange().toJSON(),usingOperation:f._managedUsingOperations,affectsData:f._affectsData});return d&&(_.commentThreads=JSON.stringify(d.getCommentThreads({toJSON:!0,skipNotAttached:!0}))),u&&(_.suggestions=JSON.stringify(u.getSuggestions({toJSON:!0,skipNotAttached:!0}))),_}_getEditables(){const e={};for(const i of this.editor.model.document.getRootNames()){const s=this.editor.ui.getEditableElement(i);s&&(e[i]=s)}return e}_isErrorComingFromThisItem(e){return function $(t,e,i=new Set){if(t===e&&function rt(t){return"object"==typeof t&&null!==t}(t))return!0;const s=k(t,i),d=k(e,i);for(const u of s)if(d.has(u))return!0;return!1}(this._editor,e.context,this._excludedProps)}_cloneEditorConfiguration(e){return function Ts(t,e){return As(t,5,e="function"==typeof e?e:void 0)}(e,(i,s)=>{if(be(i)||"context"===s)return i})}}class Es{constructor(e){this.editor=e,this._data=e.config.get("_watchdogInitialData")}init(){this.editor.data.on("init",e=>{e.stop(),this.editor.model.enqueueChange({isUndoable:!1},i=>{this._restoreCollaborationData(),this._restoreEditorData(i)}),this.editor.data.fire("ready")},{priority:999})}_createNode(e,i){if("name"in i){const s=e.createElement(i.name,i.attributes);if(i.children)for(const d of i.children)s._appendChild(this._createNode(e,d));return s}return e.createText(i.data,i.attributes)}_restoreEditorData(e){const i=this.editor;Object.entries(this._data.roots).forEach(([s,{content:d,attributes:u}])=>{const _=JSON.parse(d),f=JSON.parse(u),x=i.model.document.getRoot(s);for(const[b,j]of f)e.setAttribute(b,j,x);for(const b of _){const j=this._createNode(e,b);e.insert(j,x,"end")}}),Object.entries(this._data.markers).forEach(([s,d])=>{const{document:u}=i.model,{rangeJSON:{start:_,end:f},...x}=d,b=u.getRoot(_.root),j=e.createPositionFromPath(b,_.path,_.stickiness),W=e.createPositionFromPath(b,f.path,f.stickiness),X=e.createRange(j,W);e.addMarker(s,{range:X,...x})})}_restoreCollaborationData(){const e=JSON.parse(this._data.commentThreads),i=JSON.parse(this._data.suggestions);e.forEach(s=>{const d=this.editor.config.get("collaboration.channelId"),u=this.editor.plugins.get("CommentsRepository");u.hasCommentThread(s.threadId)&&u.getCommentThread(s.threadId).remove(),u.addCommentThread({channelId:d,...s})}),i.forEach(s=>{const d=this.editor.plugins.get("TrackChangesEditing");d.hasSuggestion(s.id)?d.getSuggestion(s.id).attributes=s.attributes:d.addSuggestionData(s)})}}Symbol("MainQueueId");var Os=M(4046),hr=M(9417),Rs=M(177);function js(t,e){}const D=new Array(256).fill(0).map((t,e)=>("0"+e.toString(16)).slice(-2)),pe="Lock from Angular integration (@ckeditor/ckeditor5-angular)";let zs=(()=>{class t{constructor(i,s){this.config={},this.data="",this.tagName="div",this.disableTwoWayDataBinding=!1,this.ready=new a.bkB,this.change=new a.bkB,this.blur=new a.bkB,this.focus=new a.bkB,this.error=new a.bkB,this.initiallyDisabled=!1,this.isEditorSettingData=!1,this.id=function Bs(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0,s=4294967296*Math.random()>>>0;return"e"+D[255&t]+D[t>>8&255]+D[t>>16&255]+D[t>>24&255]+D[255&e]+D[e>>8&255]+D[e>>16&255]+D[e>>24&255]+D[255&i]+D[i>>8&255]+D[i>>16&255]+D[i>>24&255]+D[255&s]+D[s>>8&255]+D[s>>16&255]+D[s>>24&255]}(),this.ngZone=s,this.elementRef=i;const{CKEDITOR_VERSION:d}=window;if(d){const[u]=d.split(".").map(Number);u<37&&console.warn("The <CKEditor> component requires using CKEditor 5 in version 37 or higher.")}else console.warn('Cannot find the "CKEDITOR_VERSION" in the "window" scope.')}set disabled(i){this.setDisabledState(i)}get disabled(){return this.editorInstance?this.editorInstance.isReadOnly:this.initiallyDisabled}get editorInstance(){let i=this.editorWatchdog;return this.watchdog&&(i=this.watchdog._watchdogs.get(this.id)),i?i.editor:null}getId(){return this.id}ngOnChanges(i){Object.prototype.hasOwnProperty.call(i,"data")&&i.data&&!i.data.isFirstChange()&&this.writeValue(i.data.currentValue)}ngAfterViewInit(){this.attachToWatchdog()}ngOnDestroy(){var i=this;return(0,B.A)(function*(){i.watchdog?yield i.watchdog.remove(i.id):i.editorWatchdog&&i.editorWatchdog.editor&&(yield i.editorWatchdog.destroy(),i.editorWatchdog=void 0)})()}writeValue(i){null===i&&(i=""),this.editorInstance?(this.isEditorSettingData=!0,this.editorInstance.data.set(i),this.isEditorSettingData=!1):(this.data=i,this.ready.pipe((0,Os.$)()).subscribe(s=>{s.data.set(this.data)}))}registerOnChange(i){this.cvaOnChange=i}registerOnTouched(i){this.cvaOnTouched=i}setDisabledState(i){this.editorInstance&&(i?this.editorInstance.enableReadOnlyMode(pe):this.editorInstance.disableReadOnlyMode(pe)),this.initiallyDisabled=i}attachToWatchdog(){var i=this;const s=(x,b)=>this.ngZone.runOutsideAngular((0,B.A)(function*(){i.elementRef.nativeElement.appendChild(x);const j=yield i.editor.create(x,b);return i.initiallyDisabled&&j.enableReadOnlyMode(pe),i.ngZone.run(()=>{i.ready.emit(j)}),i.setUpEditorEvents(j),j})),d=function(){var x=(0,B.A)(function*(b){yield b.destroy(),i.elementRef.nativeElement.removeChild(i.editorElement)});return function(j){return x.apply(this,arguments)}}(),u=x=>{(function Ds(t){return t.observed||t.observers.length>0})(this.error)&&this.ngZone.run(()=>this.error.emit(x))},_=document.createElement(this.tagName),f=this.getConfig();if(this.editorElement=_,this.watchdog)this.watchdog.add({id:this.id,type:"editor",creator:s,destructor:d,sourceElementOrData:_,config:f}).catch(x=>{u(x)}),this.watchdog.on("itemError",(x,{itemId:b})=>{b===this.id&&u()});else{const x=new sr(this.editor,this.editorWatchdogConfig);x.setCreator(s),x.setDestructor(d),x.on("error",u),this.editorWatchdog=x,this.ngZone.runOutsideAngular(()=>{x.create(_,f).catch(b=>{u(b)})})}}getConfig(){if(this.data&&this.config.initialData)throw new Error("Editor data should be provided either using `config.initialData` or `data` properties.");const i={...this.config},s=this.config.initialData||this.data;return s&&(i.initialData=s),i}setUpEditorEvents(i){const d=i.editing.view.document;i.model.document.on("change:data",u=>{this.ngZone.run(()=>{if(!this.disableTwoWayDataBinding){if(this.cvaOnChange&&!this.isEditorSettingData){const _=i.data.get();this.cvaOnChange(_)}this.change.emit({event:u,editor:i})}})}),d.on("focus",u=>{this.ngZone.run(()=>{this.focus.emit({event:u,editor:i})})}),d.on("blur",u=>{this.ngZone.run(()=>{this.cvaOnTouched&&this.cvaOnTouched(),this.blur.emit({event:u,editor:i})})})}}return t.\u0275fac=function(i){return new(i||t)(a.rXU(a.aKT),a.rXU(a.SKi))},t.\u0275cmp=a.VBU({type:t,selectors:[["ckeditor"]],inputs:{editor:"editor",config:"config",data:"data",tagName:"tagName",watchdog:"watchdog",editorWatchdogConfig:"editorWatchdogConfig",disableTwoWayDataBinding:"disableTwoWayDataBinding",disabled:"disabled"},outputs:{ready:"ready",change:"change",blur:"blur",focus:"focus",error:"error"},features:[a.Jv_([{provide:hr.kq,useExisting:(0,a.Rfq)(()=>t),multi:!0}]),a.OA$],decls:1,vars:0,template:function(i,s){1&i&&a.DNE(0,js,0,0,"ng-template")},encapsulation:2}),t})(),Ps=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=a.$C({type:t}),t.\u0275inj=a.G2t({imports:[[hr.YN,Rs.MD]]}),t})()},9362:(me,_t,M)=>{M.d(_t,{_D:()=>$t});var B=M(467),a=M(4438),Y=M(345),k=M(7605),et=M(4046),$=M(4670),J=M(3586),rt=M(177);const ft=["wrapper"],O=["sourceImage"];function it(p,m){if(1&p){const g=a.RV6();a.j41(0,"img",5,1),a.bIt("load",function(){a.eBV(g);const n=a.XpG();return a.Njj(n.imageLoadedInView())})("mousedown",function(n){a.eBV(g);const o=a.XpG();return a.Njj(o.startMove(n,o.moveTypes.Drag))})("touchstart",function(n){a.eBV(g);const o=a.XpG();return a.Njj(o.startMove(n,o.moveTypes.Drag))})("error",function(n){a.eBV(g);const o=a.XpG();return a.Njj(o.loadImageError(n))}),a.k0s()}if(2&p){const g=a.XpG();a.xc7("visibility",g.imageVisible?"visible":"hidden")("transform",g.safeTransformStyle),a.AVh("ngx-ic-draggable",!g.disabled&&g.allowMoveImage),a.Y8G("src",g.safeImgDataUrl,a.B4B),a.BMQ("alt",g.imageAltText)}}function nt(p,m){if(1&p){const g=a.RV6();a.qex(0),a.j41(1,"span",9),a.bIt("mousedown",function(n){a.eBV(g);const o=a.XpG(2);return a.Njj(o.startMove(n,o.moveTypes.Resize,"topleft"))})("touchstart",function(n){a.eBV(g);const o=a.XpG(2);return a.Njj(o.startMove(n,o.moveTypes.Resize,"topleft"))}),a.nrm(2,"span",10),a.k0s(),a.j41(3,"span",11),a.nrm(4,"span",10),a.k0s(),a.j41(5,"span",12),a.bIt("mousedown",function(n){a.eBV(g);const o=a.XpG(2);return a.Njj(o.startMove(n,o.moveTypes.Resize,"topright"))})("touchstart",function(n){a.eBV(g);const o=a.XpG(2);return a.Njj(o.startMove(n,o.moveTypes.Resize,"topright"))}),a.nrm(6,"span",10),a.k0s(),a.j41(7,"span",13),a.nrm(8,"span",10),a.k0s(),a.j41(9,"span",14),a.bIt("mousedown",function(n){a.eBV(g);const o=a.XpG(2);return a.Njj(o.startMove(n,o.moveTypes.Resize,"bottomright"))})("touchstart",function(n){a.eBV(g);const o=a.XpG(2);return a.Njj(o.startMove(n,o.moveTypes.Resize,"bottomright"))}),a.nrm(10,"span",10),a.k0s(),a.j41(11,"span",15),a.nrm(12,"span",10),a.k0s(),a.j41(13,"span",16),a.bIt("mousedown",function(n){a.eBV(g);const o=a.XpG(2);return a.Njj(o.startMove(n,o.moveTypes.Resize,"bottomleft"))})("touchstart",function(n){a.eBV(g);const o=a.XpG(2);return a.Njj(o.startMove(n,o.moveTypes.Resize,"bottomleft"))}),a.nrm(14,"span",10),a.k0s(),a.j41(15,"span",17),a.nrm(16,"span",10),a.k0s(),a.j41(17,"span",18),a.bIt("mousedown",function(n){a.eBV(g);const o=a.XpG(2);return a.Njj(o.startMove(n,o.moveTypes.Resize,"top"))})("touchstart",function(n){a.eBV(g);const o=a.XpG(2);return a.Njj(o.startMove(n,o.moveTypes.Resize,"top"))}),a.k0s(),a.j41(18,"span",19),a.bIt("mousedown",function(n){a.eBV(g);const o=a.XpG(2);return a.Njj(o.startMove(n,o.moveTypes.Resize,"right"))})("touchstart",function(n){a.eBV(g);const o=a.XpG(2);return a.Njj(o.startMove(n,o.moveTypes.Resize,"right"))}),a.k0s(),a.j41(19,"span",20),a.bIt("mousedown",function(n){a.eBV(g);const o=a.XpG(2);return a.Njj(o.startMove(n,o.moveTypes.Resize,"bottom"))})("touchstart",function(n){a.eBV(g);const o=a.XpG(2);return a.Njj(o.startMove(n,o.moveTypes.Resize,"bottom"))}),a.k0s(),a.j41(20,"span",21),a.bIt("mousedown",function(n){a.eBV(g);const o=a.XpG(2);return a.Njj(o.startMove(n,o.moveTypes.Resize,"left"))})("touchstart",function(n){a.eBV(g);const o=a.XpG(2);return a.Njj(o.startMove(n,o.moveTypes.Resize,"left"))}),a.k0s(),a.bVm()}}function mt(p,m){if(1&p){const g=a.RV6();a.j41(0,"div",6),a.bIt("keydown",function(n){a.eBV(g);const o=a.XpG();return a.Njj(o.keyboardAccess(n))}),a.j41(1,"div",7),a.bIt("mousedown",function(n){a.eBV(g);const o=a.XpG();return a.Njj(o.startMove(n,o.moveTypes.Move))})("touchstart",function(n){a.eBV(g);const o=a.XpG();return a.Njj(o.startMove(n,o.moveTypes.Move))}),a.k0s(),a.DNE(2,nt,21,0,"ng-container",8),a.k0s()}if(2&p){const g=a.XpG();a.xc7("top",g.cropper.y1,"px")("left",g.cropper.x1,"px")("width",g.cropper.x2-g.cropper.x1,"px")("height",g.cropper.y2-g.cropper.y1,"px")("margin-left","center"===g.alignImage?g.marginLeft:null)("visibility",g.imageVisible?"visible":"hidden"),a.AVh("ngx-ic-round",g.roundCropper),a.BMQ("aria-label",g.cropperFrameAriaLabel),a.R7$(2),a.Y8G("ngIf",!g.hideResizeSquares)}}class Ht{constructor(){this.format="png",this.output="blob",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperFrameAriaLabel="Crop photo",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(m){Object.keys(m).filter(g=>g in this).forEach(g=>this[g]=m[g]),this.validateOptions()}setOptionsFromChanges(m){Object.keys(m).filter(g=>g in this).forEach(g=>this[g]=m[g].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}var S=function(p){return p.Drag="drag",p.Move="move",p.Resize="resize",p.Pinch="pinch",p}(S||{});function St(p,m){return p/100*m}let Gt=(()=>{var p;class m{crop(r,n,o,h,c){const l=this.getImagePosition(r,n,o,c),y=l.x2-l.x1,C=l.y2-l.y1,v=document.createElement("canvas");v.width=y,v.height=C;const A=v.getContext("2d");if(!A)return null;null!=o.backgroundColor&&(A.fillStyle=o.backgroundColor,A.fillRect(0,0,y,C));const R=(o.transform.scale||1)*(o.transform.flipH?-1:1),z=(o.transform.scale||1)*(o.transform.flipV?-1:1),{translateH:P,translateV:H}=this.getCanvasTranslate(r,o,c),N=r.transformed;A.setTransform(R,0,0,z,N.size.width/2+P,N.size.height/2+H),A.translate(-l.x1/R,-l.y1/z),A.rotate((o.transform.rotate||0)*Math.PI/180),A.drawImage(N.image,-N.size.width/2,-N.size.height/2);const E={width:y,height:C,imagePosition:l,cropperPosition:{...n}};o.containWithinAspectRatio&&(E.offsetImagePosition=this.getOffsetImagePosition(r,n,o,c));const L=this.getResizeRatio(y,C,o);return 1!==L&&(E.width=Math.round(y*L),E.height=o.maintainAspectRatio?Math.round(E.width/o.aspectRatio):Math.round(C*L),function Vt(p,m,g){const r=p.width,n=p.height,o=r/(m=Math.round(m)),h=n/(g=Math.round(g)),c=Math.ceil(o/2),l=Math.ceil(h/2),y=p.getContext("2d");if(y){const C=y.getImageData(0,0,r,n),v=y.createImageData(m,g),A=C.data,R=v.data;for(let z=0;z<g;z++)for(let P=0;P<m;P++){const H=4*(P+z*m),N=z*h;let E=0,L=0,It=0,Ot=0,bt=0,Rt=0,jt=0;const Jt=Math.floor(P*o),qt=Math.floor(z*h);let xt=Math.ceil((P+1)*o),Ct=Math.ceil((z+1)*h);xt=Math.min(xt,r),Ct=Math.min(Ct,n);for(let at=qt;at<Ct;at++){const Bt=Math.abs(N-at)/l,Zt=P*o,zt=Bt*Bt;for(let st=Jt;st<xt;st++){const ct=Math.abs(Zt-st)/c,G=Math.sqrt(zt+ct*ct);if(G>=1)continue;E=2*G*G*G-3*G*G+1;const Q=4*(st+at*r);jt+=E*A[Q+3],It+=E,A[Q+3]<255&&(E=E*A[Q+3]/250),Ot+=E*A[Q],bt+=E*A[Q+1],Rt+=E*A[Q+2],L+=E}}R[H]=Ot/L,R[H+1]=bt/L,R[H+2]=Rt/L,R[H+3]=jt/It}p.width=m,p.height=g,y.putImageData(v,0,0)}}(v,E.width,E.height)),"blob"===h?this.cropToBlob(E,v,o):(E.base64=v.toDataURL("image/"+o.format,this.getQuality(o)),E)}cropToBlob(r,n,o){var h=this;return(0,B.A)(function*(){return r.blob=yield new Promise(c=>n.toBlob(c,"image/"+o.format,h.getQuality(o))),r.blob&&(r.objectUrl=URL.createObjectURL(r.blob)),r})()}getCanvasTranslate(r,n,o){if("px"===n.transform.translateUnit){const h=this.getRatio(r,o);return{translateH:(n.transform.translateH||0)*h,translateV:(n.transform.translateV||0)*h}}return{translateH:n.transform.translateH?St(n.transform.translateH,r.transformed.size.width):0,translateV:n.transform.translateV?St(n.transform.translateV,r.transformed.size.height):0}}getRatio(r,n){return r.transformed.size.width/n.width}getImagePosition(r,n,o,h){const c=this.getRatio(r,h),l={x1:Math.round(n.x1*c),y1:Math.round(n.y1*c),x2:Math.round(n.x2*c),y2:Math.round(n.y2*c)};return o.containWithinAspectRatio||(l.x1=Math.max(l.x1,0),l.y1=Math.max(l.y1,0),l.x2=Math.min(l.x2,r.transformed.size.width),l.y2=Math.min(l.y2,r.transformed.size.height)),l}getOffsetImagePosition(r,n,o,h){const c=o.canvasRotation+r.exifTransform.rotate,l=this.getRatio(r,h);let y,C;c%2?(y=(r.transformed.size.width-r.original.size.height)/2,C=(r.transformed.size.height-r.original.size.width)/2):(y=(r.transformed.size.width-r.original.size.width)/2,C=(r.transformed.size.height-r.original.size.height)/2);const v={x1:Math.round(n.x1*l)-y,y1:Math.round(n.y1*l)-C,x2:Math.round(n.x2*l)-y,y2:Math.round(n.y2*l)-C};return o.containWithinAspectRatio||(v.x1=Math.max(v.x1,0),v.y1=Math.max(v.y1,0),v.x2=Math.min(v.x2,r.transformed.size.width),v.y2=Math.min(v.y2,r.transformed.size.height)),v}getResizeRatio(r,n,o){const h=o.resizeToWidth/r,c=o.resizeToHeight/n,l=new Array;o.resizeToWidth>0&&l.push(h),o.resizeToHeight>0&&l.push(c);const y=0===l.length?1:Math.min(...l);return y>1&&!o.onlyScaleDown?y:Math.min(y,1)}getQuality(r){return Math.min(1,Math.max(0,r.imageQuality/100))}}return(p=m).\u0275fac=function(r){return new(r||p)},p.\u0275prov=a.jDH({token:p,factory:p.\u0275fac,providedIn:"root"}),m})(),Qt=(()=>{var p;class m{resetCropperPosition(r,n,o,h){if(null!=r&&r.nativeElement)if(o.cropperStaticHeight&&o.cropperStaticWidth)n.x1=0,n.x2=h.width>o.cropperStaticWidth?o.cropperStaticWidth:h.width,n.y1=0,n.y2=h.height>o.cropperStaticHeight?o.cropperStaticHeight:h.height;else{const c=Math.min(o.cropperScaledMaxWidth,h.width),l=Math.min(o.cropperScaledMaxHeight,h.height);if(o.maintainAspectRatio)if(h.width/o.aspectRatio<h.height){n.x1=0,n.x2=c;const y=c/o.aspectRatio;n.y1=(h.height-y)/2,n.y2=n.y1+y}else{n.y1=0,n.y2=l;const y=l*o.aspectRatio;n.x1=(h.width-y)/2,n.x2=n.x1+y}else n.x1=0,n.x2=c,n.y1=0,n.y2=l}}move(r,n,o){const h=this.getClientX(r)-n.clientX,c=this.getClientY(r)-n.clientY;o.x1=n.x1+h,o.y1=n.y1+c,o.x2=n.x2+h,o.y2=n.y2+c}resize(r,n,o,h,c){const l=this.getClientX(r)-n.clientX,y=this.getClientY(r)-n.clientY;switch(n.position){case"left":o.x1=Math.min(Math.max(n.x1+l,o.x2-c.cropperScaledMaxWidth),o.x2-c.cropperScaledMinWidth);break;case"topleft":o.x1=Math.min(Math.max(n.x1+l,o.x2-c.cropperScaledMaxWidth),o.x2-c.cropperScaledMinWidth),o.y1=Math.min(Math.max(n.y1+y,o.y2-c.cropperScaledMaxHeight),o.y2-c.cropperScaledMinHeight);break;case"top":o.y1=Math.min(Math.max(n.y1+y,o.y2-c.cropperScaledMaxHeight),o.y2-c.cropperScaledMinHeight);break;case"topright":o.x2=Math.max(Math.min(n.x2+l,o.x1+c.cropperScaledMaxWidth),o.x1+c.cropperScaledMinWidth),o.y1=Math.min(Math.max(n.y1+y,o.y2-c.cropperScaledMaxHeight),o.y2-c.cropperScaledMinHeight);break;case"right":o.x2=Math.max(Math.min(n.x2+l,o.x1+c.cropperScaledMaxWidth),o.x1+c.cropperScaledMinWidth);break;case"bottomright":o.x2=Math.max(Math.min(n.x2+l,o.x1+c.cropperScaledMaxWidth),o.x1+c.cropperScaledMinWidth),o.y2=Math.max(Math.min(n.y2+y,o.y1+c.cropperScaledMaxHeight),o.y1+c.cropperScaledMinHeight);break;case"bottom":o.y2=Math.max(Math.min(n.y2+y,o.y1+c.cropperScaledMaxHeight),o.y1+c.cropperScaledMinHeight);break;case"bottomleft":o.x1=Math.min(Math.max(n.x1+l,o.x2-c.cropperScaledMaxWidth),o.x2-c.cropperScaledMinWidth),o.y2=Math.max(Math.min(n.y2+y,o.y1+c.cropperScaledMaxHeight),o.y1+c.cropperScaledMinHeight);break;case"center":const C=r.scale,v=Math.min(Math.max(c.cropperScaledMinWidth,Math.abs(n.x2-n.x1)*C),c.cropperScaledMaxWidth),A=Math.min(Math.max(c.cropperScaledMinHeight,Math.abs(n.y2-n.y1)*C),c.cropperScaledMaxHeight);o.x1=n.clientX-v/2,o.x2=n.clientX+v/2,o.y1=n.clientY-A/2,o.y2=n.clientY+A/2,o.x1<0?(o.x2-=o.x1,o.x1=0):o.x2>h.width&&(o.x1-=o.x2-h.width,o.x2=h.width),o.y1<0?(o.y2-=o.y1,o.y1=0):o.y2>h.height&&(o.y1-=o.y2-h.height,o.y2=h.height)}c.maintainAspectRatio&&this.checkAspectRatio(n.position,o,h,c)}checkAspectRatio(r,n,o,h){let c=0,l=0;switch(r){case"top":n.x2=n.x1+(n.y2-n.y1)*h.aspectRatio,c=Math.max(n.x2-o.width,0),l=Math.max(0-n.y1,0),(c>0||l>0)&&(n.x2-=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y1+=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"bottom":n.x2=n.x1+(n.y2-n.y1)*h.aspectRatio,c=Math.max(n.x2-o.width,0),l=Math.max(n.y2-o.height,0),(c>0||l>0)&&(n.x2-=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y2-=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"topleft":n.y1=n.y2-(n.x2-n.x1)/h.aspectRatio,c=Math.max(0-n.x1,0),l=Math.max(0-n.y1,0),(c>0||l>0)&&(n.x1+=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y1+=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"topright":n.y1=n.y2-(n.x2-n.x1)/h.aspectRatio,c=Math.max(n.x2-o.width,0),l=Math.max(0-n.y1,0),(c>0||l>0)&&(n.x2-=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y1+=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"right":case"bottomright":n.y2=n.y1+(n.x2-n.x1)/h.aspectRatio,c=Math.max(n.x2-o.width,0),l=Math.max(n.y2-o.height,0),(c>0||l>0)&&(n.x2-=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y2-=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"left":case"bottomleft":n.y2=n.y1+(n.x2-n.x1)/h.aspectRatio,c=Math.max(0-n.x1,0),l=Math.max(n.y2-o.height,0),(c>0||l>0)&&(n.x1+=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y2-=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"center":n.x2=n.x1+(n.y2-n.y1)*h.aspectRatio,n.y2=n.y1+(n.x2-n.x1)/h.aspectRatio;const y=Math.max(0-n.x1,0),C=Math.max(n.x2-o.width,0),v=Math.max(n.y2-o.height,0),A=Math.max(0-n.y1,0);(y>0||C>0||v>0||A>0)&&(n.x1+=v*h.aspectRatio>y?v*h.aspectRatio:y,n.x2-=A*h.aspectRatio>C?A*h.aspectRatio:C,n.y1+=A*h.aspectRatio>C?A:C/h.aspectRatio,n.y2-=v*h.aspectRatio>y?v:y/h.aspectRatio)}}getClientX(r){return"touches"in r&&r.touches[0]?r.touches[0].clientX:"clientX"in r?r.clientX:0}getClientY(r){return"touches"in r&&r.touches[0]?r.touches[0].clientY:"clientX"in r?r.clientY:0}}return(p=m).\u0275fac=function(r){return new(r||p)},p.\u0275prov=a.jDH({token:p,factory:p.\u0275fac,providedIn:"root"}),m})();let Yt=(()=>{var p;class m{constructor(){this.autoRotateSupported=function Kt(){return new Promise(p=>{const m=new Image;m.onload=()=>{p(1===m.width&&2===m.height)},m.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(r,n){var o=this;return(0,B.A)(function*(){const h=yield r.arrayBuffer();return yield o.checkImageTypeAndLoadImageFromArrayBuffer(h,r.type,n)})()}checkImageTypeAndLoadImageFromArrayBuffer(r,n,o){return this.isValidImageType(n)?this.loadImageFromArrayBuffer(r,o,n):Promise.reject(new Error("Invalid image type"))}isValidImageType(r){return/image\/(png|jpg|jpeg|bmp|gif|tiff|svg|webp|x-icon|vnd.microsoft.icon)/.test(r)}loadImageFromURL(r,n){var o=this;return(0,B.A)(function*(){const c=yield(yield fetch(r)).blob(),l=yield c.arrayBuffer();return yield o.loadImageFromArrayBuffer(l,n,c.type)})()}loadBase64Image(r,n){const o=this.base64ToArrayBuffer(r);return this.loadImageFromArrayBuffer(o,n)}base64ToArrayBuffer(r){r=r.replace(/^data:([^;]+);base64,/gim,"");const n=atob(r),o=n.length,h=new Uint8Array(o);for(let c=0;c<o;c++)h[c]=n.charCodeAt(c);return h.buffer}loadImageFromArrayBuffer(r,n,o){var h=this;return(0,B.A)(function*(){const c=yield new Promise(function(){var l=(0,B.A)(function*(y,C){try{const v=new Blob([r],o?{type:o}:void 0),A=URL.createObjectURL(v),R=new Image,P="image/svg+xml"===o?yield h.getSvgImageSize(v):void 0;R.onload=()=>y({originalImage:R,originalImageSize:P,originalObjectUrl:A,originalArrayBuffer:r}),R.onerror=C,R.src=A}catch(v){C(v)}});return function(y,C){return l.apply(this,arguments)}}());return yield h.transformImageFromArrayBuffer(c,n,null!=c.originalImageSize)})()}getSvgImageSize(r){return(0,B.A)(function*(){const h=(new DOMParser).parseFromString(yield r.text(),"image/svg+xml").querySelector("svg");if(!h)throw Error("Failed to parse SVG image");const c=h.getAttribute("width"),l=h.getAttribute("height");if(c&&l)return null;const y=h.getAttribute("viewBox")||h.getAttribute("viewbox");if(y){const C=y.split(" ");return{width:+C[2],height:+C[3]}}throw Error("Failed to load SVG image. SVG must have width + height or viewBox definition.")})()}transformImageFromArrayBuffer(r,n,o=!1){var h=this;return(0,B.A)(function*(){var c;const y=function V(p){switch("object"==typeof p&&(p=function Et(p){const m=new DataView(p);if(65496!==m.getUint16(0,!1))return-2;const g=m.byteLength;let r=2;for(;r<g;){if(m.getUint16(r+2,!1)<=8)return-1;const n=m.getUint16(r,!1);if(r+=2,65505==n){if(1165519206!==m.getUint32(r+=2,!1))return-1;const o=18761==m.getUint16(r+=6,!1);r+=m.getUint32(r+4,o);const h=m.getUint16(r,o);r+=2;for(let c=0;c<h;c++)if(274==m.getUint16(r+12*c,o))return m.getUint16(r+12*c+8,o)}else{if(65280&~n)break;r+=m.getUint16(r,!1)}}return-1}(p)),p){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}((yield h.autoRotateSupported)?-1:r.originalArrayBuffer);if(!r.originalImage||!r.originalImage.complete)return Promise.reject(new Error("No image loaded"));const C={original:{objectUrl:r.originalObjectUrl,image:r.originalImage,size:null!==(c=r.originalImageSize)&&void 0!==c?c:{width:r.originalImage.naturalWidth,height:r.originalImage.naturalHeight}},exifTransform:y};return h.transformLoadedImage(C,n,o)})()}transformLoadedImage(r,n,o=!1){var h=this;return(0,B.A)(function*(){const c=n.canvasRotation+r.exifTransform.rotate,l=r.original.size;if(!o&&0===c&&!r.exifTransform.flip&&!n.containWithinAspectRatio)return{original:{objectUrl:r.original.objectUrl,image:r.original.image,size:{...l}},transformed:{objectUrl:r.original.objectUrl,image:r.original.image,size:{...l}},exifTransform:r.exifTransform};const y=h.getTransformedSize(l,r.exifTransform,n),C=document.createElement("canvas");C.width=y.width,C.height=y.height;const v=C.getContext("2d");null==v||v.setTransform(r.exifTransform.flip?-1:1,0,0,1,C.width/2,C.height/2),null==v||v.rotate(Math.PI*(c/2)),null==v||v.drawImage(r.original.image,-l.width/2,-l.height/2);const A=yield new Promise(P=>C.toBlob(P,n.format));if(!A)throw new Error("Failed to get Blob for transformed image.");const R=URL.createObjectURL(A),z=yield h.loadImageFromObjectUrl(R);return{original:{objectUrl:r.original.objectUrl,image:r.original.image,size:{...l}},transformed:{objectUrl:R,image:z,size:{width:z.width,height:z.height}},exifTransform:r.exifTransform}})()}loadImageFromObjectUrl(r){return new Promise((n,o)=>{const h=new Image;h.onload=()=>n(h),h.onerror=o,h.src=r})}getTransformedSize(r,n,o){const h=o.canvasRotation+n.rotate;if(o.containWithinAspectRatio){if(h%2){const l=r.height/o.aspectRatio;return{width:Math.max(r.height,r.width*o.aspectRatio),height:Math.max(r.width,l)}}{const l=r.width/o.aspectRatio;return{width:Math.max(r.width,r.height*o.aspectRatio),height:Math.max(r.height,l)}}}return h%2?{height:r.width,width:r.height}:{width:r.width,height:r.height}}}return(p=m).\u0275fac=function(r){return new(r||p)},p.\u0275prov=a.jDH({token:p,factory:p.\u0275fac,providedIn:"root"}),m})(),$t=(()=>{var p;class m{constructor(r,n,o,h,c,l,y){this.cropService=r,this.cropperPositionService=n,this.loadImageService=o,this.sanitizer=h,this.cd=c,this.zone=l,this.hammerLoader=y,this.settings=new Ht,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.marginLeft="0px",this.maxSize={width:0,height:0},this.moveTypes=S,this.imageVisible=!1,this.cropperFrameAriaLabel=this.settings.cropperFrameAriaLabel,this.output=this.settings.output,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resetCropOnAspectRatioChange=this.settings.resetCropOnAspectRatioChange,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.allowMoveImage=!1,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.hidden=!1,this.imageCropped=new a.bkB,this.startCropImage=new a.bkB,this.imageLoaded=new a.bkB,this.cropperReady=new a.bkB,this.loadImageFailed=new a.bkB,this.transformChange=new a.bkB,this.reset()}ngOnChanges(r){var n;this.onChangesUpdateSettings(r),this.onChangesInputImage(r),null!==(n=this.loadedImage)&&void 0!==n&&n.original.image.complete&&(r.containWithinAspectRatio||r.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(o=>this.setLoadedImage(o)).catch(o=>this.loadImageError(o)),(r.cropper||r.maintainAspectRatio||r.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),!this.maintainAspectRatio||!this.resetCropOnAspectRatioChange&&this.aspectRatioIsCorrect()||!r.maintainAspectRatio&&!r.aspectRatio?r.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()):this.resetCropperPosition()),r.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop()),r.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesUpdateSettings(r){this.settings.setOptionsFromChanges(r),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&(this.hideResizeSquares=!0,this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1}))}onChangesInputImage(r){(r.imageChangedEvent||r.imageURL||r.imageBase64||r.imageFile)&&this.reset(),r.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),r.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),r.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),r.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){var r;const n=null===(r=this.imageChangedEvent)||void 0===r||null===(r=r.target)||void 0===r?void 0:r.files;return n instanceof FileList&&n.length>0}setCssTransform(){var r;const n=(null===(r=this.transform)||void 0===r?void 0:r.translateUnit)||"%";this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle(`translate(${this.transform.translateH||0}${n}, ${this.transform.translateV||0}${n}) scaleX(`+(this.transform.scale||1)*(this.transform.flipH?-1:1)+") scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+") rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=void 0,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(r){this.loadImageService.loadImageFile(r,this.settings).then(n=>this.setLoadedImage(n)).catch(n=>this.loadImageError(n))}loadBase64Image(r){this.loadImageService.loadBase64Image(r,this.settings).then(n=>this.setLoadedImage(n)).catch(n=>this.loadImageError(n))}loadImageFromURL(r){this.loadImageService.loadImageFromURL(r,this.settings).then(n=>this.setLoadedImage(n)).catch(n=>this.loadImageError(n))}setLoadedImage(r){this.loadedImage=r,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(r.transformed.objectUrl),this.cd.markForCheck()}loadImageError(r){console.error(r),this.loadImageFailed.emit()}imageLoadedInView(){null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit({...this.maxSize}),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){var r;return(null===(r=this.sourceImage)||void 0===r||null===(r=r.nativeElement)||void 0===r?void 0:r.offsetWidth)>0}onResize(){if(this.loadedImage)if(this.hidden)this.resizedWhileHidden=!0;else{const r={...this.maxSize};this.setMaxSize(),this.resizeCropperPosition(r),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()}}activatePinchGesture(){var r=this;return(0,B.A)(function*(){var n,o;yield null===(n=r.hammerLoader)||void 0===n?void 0:n.call(r);const h=(null===(o=window)||void 0===o?void 0:o.Hammer)||null;if(h){const c=new h(r.wrapper.nativeElement);c.get("pinch").set({enable:!0}),c.on("pinchmove",r.onPinch.bind(r)),c.on("pinchend",r.pinchStop.bind(r)),c.on("pinchstart",r.startPinch.bind(r))}else(0,a.naY)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")})()}resizeCropperPosition(r){(r.width!==this.maxSize.width||r.height!==this.maxSize.height)&&(this.cropper.x1=this.cropper.x1*this.maxSize.width/r.width,this.cropper.x2=this.cropper.x2*this.maxSize.width/r.width,this.cropper.y1=this.cropper.y1*this.maxSize.height/r.height,this.cropper.y2=this.cropper.y2*this.maxSize.height/r.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings,this.maxSize),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(r){this.changeKeyboardStepSize(r),this.keyboardMoveCropper(r)}changeKeyboardStepSize(r){const n=+r.key;n>=1&&n<=9&&(this.settings.stepSize=n)}keyboardMoveCropper(r){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(r.key))return;const o=r.shiftKey?S.Resize:S.Move,h=r.altKey?function yt(p){switch(p){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";default:return"right"}}(r.key):function Nt(p){switch(p){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";default:return"left"}}(r.key),c=function kt(p,m){switch(p){case"ArrowUp":return{clientX:0,clientY:-1*m};case"ArrowRight":return{clientX:m,clientY:0};case"ArrowDown":return{clientX:0,clientY:m};default:return{clientX:-1*m,clientY:0}}}(r.key,this.settings.stepSize);r.preventDefault(),r.stopPropagation(),this.startMove({clientX:0,clientY:0},o,h),this.handleMouseMove(c),this.handleMouseUp()}startMove(r,n,o=null){var h,c;this.disabled||null!==(h=this.moveStart)&&void 0!==h&&h.active&&(null===(c=this.moveStart)||void 0===c?void 0:c.type)===S.Pinch||n===S.Drag&&!this.allowMoveImage||("preventDefault"in r&&r.preventDefault(),this.moveStart={active:!0,type:n,position:o,transform:{...this.transform},clientX:this.cropperPositionService.getClientX(r),clientY:this.cropperPositionService.getClientY(r),...this.cropper},this.initMouseMove())}initMouseMove(){(0,$.h)((0,J.R)(document,"mousemove"),(0,J.R)(document,"touchmove")).pipe((0,k.Q)((0,$.h)((0,J.R)(document,"mouseup"),(0,J.R)(document,"touchend")).pipe((0,et.$)()))).subscribe({next:r=>this.zone.run(()=>{this.handleMouseMove(r),this.cd.markForCheck()}),complete:()=>this.zone.run(()=>{this.handleMouseUp(),this.cd.markForCheck()})})}startPinch(r){this.safeImgDataUrl&&(r.preventDefault&&r.preventDefault(),this.moveStart={active:!0,type:S.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2,...this.cropper})}handleMouseMove(r){if(this.moveStart.active)if("stopPropagation"in r&&r.stopPropagation(),"preventDefault"in r&&r.preventDefault(),this.moveStart.type===S.Move)this.cropperPositionService.move(r,this.moveStart,this.cropper),this.checkCropperPosition(!0);else if(this.moveStart.type===S.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(r,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1);else if(this.moveStart.type===S.Drag){var n,o;const h=this.cropperPositionService.getClientX(r)-this.moveStart.clientX,c=this.cropperPositionService.getClientY(r)-this.moveStart.clientY;this.transform={...this.transform,translateH:((null===(n=this.moveStart.transform)||void 0===n?void 0:n.translateH)||0)+h,translateV:((null===(o=this.moveStart.transform)||void 0===o?void 0:o.translateV)||0)+c},this.setCssTransform()}}onPinch(r){this.moveStart.active&&(r.stopPropagation&&r.stopPropagation(),r.preventDefault&&r.preventDefault(),this.moveStart.type===S.Pinch&&(this.cropperPositionService.resize(r,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.markForCheck())}setMaxSize(){if(this.sourceImage){const r=getComputedStyle(this.sourceImage.nativeElement);this.maxSize.width=parseFloat(r.width),this.maxSize.height=parseFloat(r.height),this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){var r;null!==(r=this.loadedImage)&&void 0!==r&&null!==(r=r.transformed)&&void 0!==r&&r.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}setCropperScaledMaxSize(){var r;if(null!==(r=this.loadedImage)&&void 0!==r&&null!==(r=r.transformed)&&void 0!==r&&r.image){const n=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/n:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/n:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(r=!1){this.cropper.x1<0&&(this.cropper.x2-=r?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=r?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=r?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=r?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}handleMouseUp(){var r;this.moveStart.active&&(this.moveStart.active=!1,(null===(r=this.moveStart)||void 0===r?void 0:r.type)===S.Drag?this.transformChange.emit(this.transform):this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(r=this.settings.output){var n;if(null!=(null===(n=this.loadedImage)||void 0===n||null===(n=n.transformed)||void 0===n?void 0:n.image)){if(this.startCropImage.emit(),"blob"===r)return this.cropToBlob();if("base64"===r)return this.cropToBase64()}return null}cropToBlob(){var r=this;return new Promise((n,o)=>this.zone.run((0,B.A)(function*(){const h=yield r.cropService.crop(r.loadedImage,r.cropper,r.settings,"blob",r.maxSize);h?(r.imageCropped.emit(h),n(h)):o("Crop image failed")})))}cropToBase64(){const r=this.cropService.crop(this.loadedImage,this.cropper,this.settings,"base64",this.maxSize);return r?(this.imageCropped.emit(r),r):null}aspectRatioIsCorrect(){return(this.cropper.x2-this.cropper.x1)/(this.cropper.y2-this.cropper.y1)===this.aspectRatio}}return(p=m).\u0275fac=function(r){return new(r||p)(a.rXU(Gt),a.rXU(Qt),a.rXU(Yt),a.rXU(Y.up),a.rXU(a.gRc),a.rXU(a.SKi),a.rXU(Y.Bn,8))},p.\u0275cmp=a.VBU({type:p,selectors:[["image-cropper"]],viewQuery:function(r,n){if(1&r&&(a.GBs(ft,7),a.GBs(O,5)),2&r){let o;a.mGM(o=a.lsd())&&(n.wrapper=o.first),a.mGM(o=a.lsd())&&(n.sourceImage=o.first)}},hostVars:6,hostBindings:function(r,n){1&r&&a.bIt("resize",function(){return n.onResize()},!1,a.tSv),2&r&&(a.xc7("text-align",n.alignImage),a.AVh("disabled",n.disabled)("ngx-ix-hidden",n.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",cropperFrameAriaLabel:"cropperFrameAriaLabel",output:"output",format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange"},standalone:!0,features:[a.OA$,a.aNF],decls:5,vars:10,consts:[["wrapper",""],["sourceImage",""],["class","ngx-ic-source-image","role","presentation",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart","error",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],["role","presentation",1,"ngx-ic-source-image",3,"load","mousedown","touchstart","error","src"],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],["role","presentation",1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(r,n){1&r&&(a.j41(0,"div",null,0),a.DNE(2,it,2,8,"img",2),a.nrm(3,"div",3),a.DNE(4,mt,3,16,"div",4),a.k0s()),2&r&&(a.xc7("background",n.imageVisible&&n.backgroundColor),a.R7$(2),a.Y8G("ngIf",n.safeImgDataUrl),a.R7$(),a.xc7("width",n.maxSize.width,"px")("height",n.maxSize.height,"px")("margin-left","center"===n.alignImage?n.marginLeft:null),a.R7$(),a.Y8G("ngIf",n.imageVisible))},dependencies:[rt.bT],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535c;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ix-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0}),m})()}}]);