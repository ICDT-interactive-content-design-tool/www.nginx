(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8408],{8408:(zr,qi,xi)=>{"use strict";xi.d(qi,{A9o:()=>Gr,_5L:()=>za,IBb:()=>Qr,arO:()=>Fa,XdC:()=>_t,FLf:()=>rt,r_I:()=>bt,FCb:()=>Dt,PSO:()=>vt,Q$J:()=>mt,hv$:()=>F,i0Z:()=>rc,HYM:()=>lc,U9V:()=>ac,IPF:()=>Fh,uDg:()=>wh,ZFU:()=>bh,o8m:()=>Eh,zc9:()=>Ch,jme:()=>Ih,woc:()=>Th,OuQ:()=>Jh,tEe:()=>Lh,NP2:()=>xh,gRD:()=>Oh,R11:()=>Nh,Djb:()=>_h,GwF:()=>Sh,hko:()=>kh,Lz2:()=>zh,qBK:()=>jh,WYX:()=>Ah,iyY:()=>Rh,wSf:()=>nc,nOo:()=>et,dLO:()=>St,vmR:()=>qn,CUZ:()=>ec,Uqb:()=>It,_KM:()=>ae,LVk:()=>y,Dlr:()=>te,MhA:()=>ah,gyC:()=>oh,enI:()=>nh,Wzt:()=>sh,k5W:()=>hh,_Rs:()=>fh,yND:()=>dh,As1:()=>vh,jK7:()=>ch,okK:()=>uh,dfT:()=>lh,OQD:()=>gh,Hcq:()=>yh,wMG:()=>rh,OVU:()=>ql,zHt:()=>Zl,XWC:()=>Ur,DSO:()=>Jt,tix:()=>ce,zOM:()=>C,JRt:()=>V,yUR:()=>Xu,tGH:()=>ph,Cfb:()=>mh,t8k:()=>ui,RYD:()=>N,qGx:()=>Jc,GRx:()=>Ac,_mz:()=>Ic,yhd:()=>Cc,cZ9:()=>Tc,xhT:()=>Fc,cKw:()=>zc,qe3:()=>jc,obU:()=>Rc,U$t:()=>Lc,dns:()=>Zc,cuZ:()=>qc,DNi:()=>Yc,yFt:()=>Hc,RZc:()=>Wc,uJ$:()=>Xc,im6:()=>Qc,Dbh:()=>Dc,qRy:()=>Gc,lcK:()=>Uc,o0:()=>Mc,RL2:()=>Bc,otK:()=>Pc,tdO:()=>Kc,Xu9:()=>cc,ZjY:()=>uc,fYU:()=>sc,JAM:()=>dc,to0:()=>oc,uiC:()=>Jr,TKJ:()=>vc,lFL:()=>fc,TV_:()=>hc,N6o:()=>gc,I6k:()=>_c,tTI:()=>Oc,yqB:()=>Nc,nyA:()=>Ec,$TK:()=>Sc,Q6X:()=>bc,BTq:()=>xc,WpQ:()=>kc,Hr7:()=>mc,MQK:()=>yc,RdK:()=>pc,wGP:()=>wc,XTt:()=>De,Pe_:()=>Ar,wTo:()=>ht,fug:()=>Ma,NxJ:()=>Ka,E$G:()=>Pa,eil:()=>or,ZF9:()=>sr,SFI:()=>wa,vxI:()=>Oa,smx:()=>xa,xOc:()=>Pr,kTo:()=>Sa,$x6:()=>ma,T1W:()=>ka,_oT:()=>pa,rIr:()=>Br,r49:()=>ba,r7c:()=>Yh,R$j:()=>Xh,t9h:()=>Kh,PxE:()=>Dh,mJh:()=>Gh,Ptn:()=>Mh,eQP:()=>Ph,BiI:()=>Hh,BlC:()=>Qh,I06:()=>Uh,zgC:()=>Wh,lh0:()=>Bh,_Sz:()=>tf,Au4:()=>nf,I6V:()=>ef,IBK:()=>Xt,qbd:()=>$h,nGQ:()=>Vh,pHJ:()=>qh,wjX:()=>Zh,I6f:()=>st,IAo:()=>nt,AEO:()=>G,I1Q:()=>di,nWF:()=>th,YpM:()=>ih,mmi:()=>eh,xR4:()=>$c,dBz:()=>Vc});const rt={RESIZE_GROUP:"icdt-resize-g",SELECT_GROUP:"icdt-select-g",SCAN_GROUP:"icdt-scan-g",CREATE_GROUP:"icdt-create-g",INTERACTIVE_GROUP:"icdt-interactive-g",INDEX_GROUP:"icdt-index-g",BACKGROUND_GROUP:"icdt-background-g",TEST_GROUP:"icdt-test-g"},vt={POINTER:0,HAND:1,PEN:2,SHAPE:3,FOREIGNOBJECT:6,IMAGE:7,TEXT:4,ERASER:5,INDEX:8},Dt={DRAW:1,HIGHTLIGH:2,INTERACTIVE:3},F={GROUP:0,CIRCLE:1,ELLIPSE:2,LINE:5,RECT:3,POLYGON:4,FOREIGNOBJECT:6,IMAGE:9,TEXT:7,TSPAN:10,PATH:8,POLYLINE:11},mt={TRIANGLE_ISOSCELES:3,TRIANGLE_EQUILATERAL:31,RECTANGLE:4,PENTAGON:5,HEXAGON:6,BOOKMARK:101,COMMENT:102,CROSS:104,ARROW_ONEWAY:201,ARROW_TWOWAY:202,STAR_FOUR:304,STAR_FIVE:305,STAR_SIX:306},Wt=[{name:"tam gi\xe1c vu\xf4ng",type:mt.TRIANGLE_ISOSCELES,ratios:[[0,0],[1,1],[0,1]]},{name:"tam gi\xe1c c\xe2n",type:mt.TRIANGLE_EQUILATERAL,ratios:[[.5,0],[0,1],[1,1]]},{name:"h\xecnh ch\u1eef nh\u1eadt",type:mt.RECTANGLE,ratios:[[0,0],[1,0],[1,1],[0,1]]},{name:"h\xecnh ng\u0169 gi\xe1c \u0111\u1ec1u",type:mt.PENTAGON,ratios:[[.5,0],[1,.4],[.8,1],[.2,1],[0,.4]]},{name:"h\xecnh l\u1ee5c gi\xe1c \u0111\u1ec1u",type:mt.HEXAGON,ratios:[[.5,0],[1,.25],[1,.75],[.5,1],[0,.75],[0,.25]]},{name:"khung \u0111\xe1nh d\u1ea5u v\u1ecb tr\xed",type:mt.BOOKMARK,ratios:[[0,0],[1,0],[1,.8],[.5,1],[0,.8]]},{name:"khung \u0111\xe1nh tr\xf2 chuy\u1ec7n",type:mt.COMMENT,ratios:[[0,0],[1,0],[1,.9],[.3,.9],[.2,1],[.1,.9],[0,.9]]},{name:"h\xecnh ch\u1eef th\u1eadp",type:mt.CROSS,ratios:[[0,.3],[.3,.3],[.3,0],[.7,0],[.7,.3],[1,.3],[1,.7],[.7,.7],[.7,1],[.3,1],[.3,.7],[0,.7]]},{name:"h\xecnh m\u0169i t\xean 1 chi\u1ec1u",type:mt.ARROW_ONEWAY,ratios:[[0,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[0,.8]]},{name:"h\xecnh m\u0169i t\xean 2 chi\u1ec1u",type:mt.ARROW_TWOWAY,ratios:[[.2,0],[.2,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[.2,.8],[.2,1],[0,.5]]},{name:"h\xecnh ng\xf4i sao 4 c\xe1nh",type:mt.STAR_FOUR,ratios:[[.5,0],[.65,.35],[1,.5],[.65,.65],[.5,1],[.35,.65],[0,.5],[.35,.35]]},{name:"h\xecnh ng\xf4i sao 5 c\xe1nh",type:mt.STAR_FIVE,ratios:[[.5,0],[.625,.4],[1,.4],[.675,.625],[.8,1],[.5,.775],[.2,1],[.325,.625],[0,.4],[.375,.4]]},{name:"h\xecnh ng\xf4i sao 6 c\xe1nh",type:mt.STAR_SIX,ratios:[[.5,0],[.667,.25],[1,.25],[.5+.334,.5],[1,.75],[.667,.75],[.5,1],[.334,.75],[0,.75],[.167,.5],[0,.25],[.334,.25]]}],_t={IMAGE:1,HTML:2,AUDIO:3,VIDEO:4},bt={Digit1:49,Digit2:50,Digit3:51,Digit4:52,Digit5:53,Digit6:54,Digit7:55,Digit8:56,Digit9:57,Digit0:48,KeyA:65,KeyB:66,KeyC:67,KeyD:68,KeyE:69,KeyF:70,KeyG:71,KeyH:72,KeyI:73,KeyJ:74,KeyK:75,KeyL:76,KeyM:77,KeyN:78,KeyO:79,KeyP:80,KeyQ:81,KeyR:82,KeyS:83,KeyT:84,KeyU:85,KeyV:86,KeyW:87,KeyX:88,KeyY:89,KeyZ:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,Insert:45,Delete:46,Home:36,End:35,PageUp:33,PageDown:34,ArrowUp:38,ArrowDown:40,ArrowLeft:37,ArrowRight:39,Escape:27,Tab:9,Backspace:8,Enter:13,Space:32,BracketLeft:219,BracketRight:221,Minus:189,Equal:187},ot={stroke:"#0D99FF",strokeWidth:1,strokeLinecap:"square",strokeDasharrays:[2,5]},Xt={fill:"none",stroke:"#2299F8",strokeWidth:1},et=i=>{var t,e,n={};let r=/Italic$/,l=/Thin$/,a=/ExtraLight|UltraLight$/i,o=/Light$/,s=/Regular|Normal$/,d=/Medium$/,u=/SemiBold|DemiBold$/i,c=/Bold$/,h=/ExtraBold|UltraBold$/i,f=/Black|Heavy$/;return(i=null!==(t=null===(e=i.split(","))||void 0===e||null===(e=e.shift())||void 0===e?void 0:e.trim().replace(/[^a-zA-Z_-\s]/g,""))&&void 0!==t?t:"").match(r)&&(n.fontStyle="italic",i=i.replace(r,"").trim()),i.match(l)?(n.fontWeight=100,i=i.replace(l,"").trim()):i.match(a)?(n.fontWeight=200,i=i.replace(a,"").trim()):i.match(o)?(n.fontWeight=300,i=i.replace(o,"").trim()):i.match(s)?(n.fontWeight=400,i=i.replace(s,"").trim()):i.match(d)?(n.fontWeight=500,i=i.replace(d,"").trim()):i.match(u)?(n.fontWeight=600,i=i.replace(u,"").trim()):i.match(c)?(n.fontWeight=700,i=i.replace(c,"").trim()):i.match(h)?(n.fontWeight=800,i=i.replace(h,"").trim()):i.match(f)&&(n.fontWeight=900,i=i.replace(f,"").trim()),n.fontFamily=i.replace(/[\-\_\s]+$/,""),n},St=i=>{let t=[];return[/font-family\s*:\s*([^;]+);/g,/"fontFamily":"([a-zA-Z0-9\-\_\'\s]+)"/g].forEach(e=>{var n,r;t=[...t,...null!==(n=null===(r=i.replace(/&quot;/g,"'").match(e))||void 0===r?void 0:r.filter((l,a,o)=>o.indexOf(l)==a).map(l=>l.replace(e,"$1").replace(/[^a-zA-Z0-9\-\_\s\,]/g,"").trim()).filter((l,a,o)=>l&&o.indexOf(l)==a))&&void 0!==n?n:[]]}),t.filter((e,n,r)=>r.indexOf(e)==n).map(e=>et(e).fontFamily).filter(e=>!!e).filter((e,n,r)=>r.indexOf(e)==n)},ht=(i,t)=>{if(!i)return"";let e=i.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i),n=(e&&e[4]||"").trim(),r=e?(256|e[1]).toString(16).slice(1)+(256|e[2]).toString(16).slice(1)+(256|e[3]).toString(16).slice(1):i;if("0"==n)return"transparent";if(t){let l;l=""!==n?n:"01",l=(255*l|256).toString(16).slice(1),r+=l}return`#${r}`};var Gt=/^#?[a-fA-F0-9]+$/;const Yt=(i,t)=>{var e;if("none"==(i=null!==(e=i)&&void 0!==e?e:""))return"none";if("transparent"==i)return"rgba(0,0,0,0)";if(i.includes("rgba("))return i;if(i.includes("rgb(")&&(i=ht(i)),!(i=i.replace(/[^0-9a-fA-F]/g,"")))return"";if(!Gt.test(i))return console.error(`hex2rgba -> ${i}: first argument has invalid hexadecimal characters`),"";if("#"===i[0]&&(i=i.slice(1)),3===i.length){let r=i.split("");r.splice(2,0,i[2]),r.splice(1,0,i[1]),r.splice(0,0,i[0]),i=r.join("")}if(6!==i.length)return console.error("hex2rgba: first argument has invalid hexadecimal length"),"";var n=[parseInt(i.slice(0,2),16),parseInt(i.slice(2,4),16),parseInt(i.slice(4,6),16)];return t="number"==typeof t?t:parseFloat(t),n.push(t>=0&&t<=1?t:1),"rgba("+n.join(",")+")"},ae=i=>{switch(null==i?void 0:i.type){case 901:return`assets/iframe/lib/mk-image-viewer/viewer.html?url=${encodeURIComponent(i.readfileuploadurl+""+i.path)}`;case 902:return`assets/iframe/lib/mk-audio-player-2/player.html?url=${encodeURIComponent(i.readfileuploadurl+""+i.path)}`;case 903:return`assets/iframe/lib/mk-video-player/player.html?url=${encodeURIComponent(i.readfileuploadurl+""+i.path)}`;case 908:case 916:case 917:case 918:return`assets/iframe/lib/ONLYOFFICE/player.html?url=${encodeURIComponent(i.readfileuploadurl+""+i.path)}`;case 909:return"assets/iframe/lib/PDFReader/web/viewer.html?file="+i.readfileuploadurl+i.path;case 906:case 911:case 910:return""+i.readfileuploadurl+i.path;case 905:case 912:var t;return"imsmanifest.xml"==(null===(t=i.path)||void 0===t||null===(t=t.split("/"))||void 0===t?void 0:t.pop())?"assets/iframe/lib/ScormPool_Player/player.html?url="+i.readfileuploadurl+i.path:""+i.readfileuploadurl+i.path;case 907:case 900:return""+i.readfileuploadurl+i.path;case 904:switch(i.oss){case 1003:return"assets/iframe/lib/ScormPool_Player/player.html?url="+i.url;case 1002:var e;return null!==(e=Qe(i.url))&&void 0!==e?e:"";case 1005:var n;return null!==(n=i.url)&&void 0!==n?n:"";default:var r;return null!==(r=i.url)&&void 0!==r?r:""}default:return""+i.readfileuploadurl+i.path}},Qe=i=>{let t=ri(i);return t?"https://www.youtube.com/embed/"+t+"?"+jQuery.param({wmode:"opaque",border:0,hd:1,autoplay:!1,autohide:1,enablejsapi:1,modestbranding:1,version:3,hl:"vi_VN",rel:0,showinfo:0,iv_load_policy:3}):null},ri=i=>{let t=null==i?void 0:i.match(/(?:.+?)?(?:\/v\/|watch\/|\?v\=|\&v\=|youtu\.be\/|\/v\=|^youtu\.be\/|embed\/)([a-zA-Z0-9_-]{11})+/);return t&&t.length>=2?t[1]:null},C=(i,t)=>{var e;return t=null!==(e=t)&&void 0!==e?e:100,Math.round((i+Number.EPSILON)*t)/t},lt=i=>C(i/y.screen.scale),ye=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:y.attribute.fill,stroke:y.attribute.stroke,strokeWidth:y.attribute.strokeWidth};return{nodeId:i,element:qt(i,F.RECT,"rect",{size:n,attribute:r},e),size:n,attribute:r}},Se=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{preserveAspectRatio:"none"},l=(null==t?void 0:t.source)||{type:"image",image:{url:"../../assets/image-svg/logo.svg",path:"assets/image-svg/logo.svg",name:"logo.svg"}};return{nodeId:i,element:qt(i,F.IMAGE,"image",{size:n,attribute:r,source:l},e),size:n,attribute:r,source:l}},ke=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:y.attribute.fill,stroke:y.attribute.stroke,strokeWidth:y.attribute.strokeWidth};return{nodeId:i,element:qt(i,F.CIRCLE,"circle",{size:n,attribute:r},e),size:n,attribute:r}},Oe=(i,t,e)=>{var n;if(!t.value)return void e();let r=jQuery("#"+i).parents("g");if(!r.length)return void e();let{size:l}=t.node;r.css("transform-origin",`${l.x+l.width/2}px ${l.y+l.height/2}px`);let a="",o=null!==(n=t.iteration)&&void 0!==n?n:0,s=[];(t.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?s.push(t.value):t.value?["top-left","top","top-right","left","right","bottom-left","bottom","bottom-right"].includes(t.value)?(s.push("animation"),s.push(`animation-${t.value}`)):(s.push("animate__animated"),s.push(`animate__${t.value}`)):(s.push("animation"),s.push("animation-fadein")),o<0?(s.push("animation-iteration-infinite"),e(),e=function(){}):o>0&&s.push("animation-iteration-"+(o+1)),a=s.join(" "),function(u){let c=function(){r.data("animate-running")?r.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){r.data("animate-running",!1),setTimeout(function(){u()},100)}):u()};r.hasClass("animation")?setTimeout(function(){c()}):c()}(function(){var u;li(i),(o>0||o<0)&&r.one("animationiteration",function(){t.slideStatus===V.slideStatus||(r.data("animate-running",!1),li(i),t.slideStatus===V.slideStatus&&e())}),r.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(r.data("animate-running",!1),li(i),t.finish){default:case 0:case 1:break;case 2:var c;Oe(i,{node:t.node,value:null===(c=t.node.animate)||void 0===c?void 0:c.out,nodeStatus:t.nodeStatus,slideStatus:t.slideStatus},()=>{r.addClass("hide")})}t.slideStatus===V.slideStatus&&e()}),r.attr("data-class",null!==(u=r.attr("class"))&&void 0!==u?u:""),r.addClass(a),r.data("animate-running",!0)})},li=function(i){var t,e,n=jQuery("#"+i).parents("g"),r=null===(t=n.attr("class"))||void 0===t?void 0:t.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm),l=null===(e=n.attr("class"))||void 0===e?void 0:e.match(/animate((__[a-zA-Z0-9]+)+)?(\s+||\")/gm);r&&r.forEach(function(o){jQuery(n).removeClass(o)}),l&&l.forEach(function(o){jQuery(n).removeClass(o)});let a=n.attr("data-class");a&&(n.attr("class",a),n.removeAttr("data-class")),jQuery(n).data("animation-running",!1)},Zi=(i,t,e)=>{var n;if(!t.value)return void e();let r=jQuery("#"+i).parents("g");if(!r.length)return void e();let{size:l}=t.node;r.css("transform-origin",`${l.x+l.width/2}px ${l.y+l.height/2}px`);let a="",o=null!==(n=t.iteration)&&void 0!==n?n:0,s=[];(t.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?s.push(t.value):(s.push("animation"),s.push(t.value?"animation-"+t.value:"animation-fadein")),o<0?(s.push("animation-iteration-infinite"),e(),e=function(){}):o>0&&s.push("animation-iteration-"+(o+1)),a=s.join(" "),function(u){let c=function(){r.data("animate-running")?r.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){r.data("animate-running",!1),setTimeout(function(){u()},100)}):u()};r.hasClass("animation")?setTimeout(function(){c()}):c()}(function(){var u;ai(i),(o>0||o<0)&&r.one("animationiteration",function(){t.slideStatus===V.slideStatus||(r.data("animate-running",!1),ai(i),t.slideStatus===V.slideStatus&&e())}),r.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(r.data("animate-running",!1),ai(i),t.finish){default:case 0:case 1:break;case 2:var c;Oe(i,{node:t.node,value:null===(c=t.node.animate)||void 0===c?void 0:c.out,nodeStatus:t.nodeStatus,slideStatus:t.slideStatus},()=>{r.addClass("hide")})}t.slideStatus===V.slideStatus&&e()}),r.attr("data-class",null!==(u=r.attr("class"))&&void 0!==u?u:""),r.addClass(a),r.data("animate-running",!0)})},ai=function(i){var t,e=jQuery("#"+i).parents("g"),n=null===(t=e.attr("class"))||void 0===t?void 0:t.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm);n&&n.forEach(function(l){jQuery(e).removeClass(l)});let r=e.attr("data-class");r&&(e.attr("class",r),e.removeAttr("data-class")),jQuery(e).data("animation-running",!1)},Ue=i=>{var t;return null===(t=i.split(/(?=[MLCSQTAHVZmlcsqtahvz])/))||void 0===t?void 0:t.map(e=>{let n={type:e.substring(0,1)},r=(l=e.replace(/\s?\-?[0-9\.]+e-[0-9]+/g," 0").replace(/\,/g," ").replace(/\s?\-/g," -").replace(/(\.[0-9]+)(\.[0-9]+)/g,"$1 0$2").replace(/\-\./g,"-0.").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim())?l.split(/\s/).map(a=>C(parseFloat(a),1e6)):[];var l;return r.length&&(n.points=r),n})},He=i=>{let t=[],e=[],n=[],r=[];return i.forEach(l=>{switch(["M","L","C","S","Q","T"].includes(l.type)&&l.points&&l.points.forEach((v,b)=>{b%2==0?t.push(v):e.push(v)}),l.type){case"A":var a;7==(null===(a=l.points)||void 0===a?void 0:a.length)&&(n.push(l.points[5]),r.push(l.points[6]));break;case"H":var o;null!==(o=l.points)&&void 0!==o&&o.length&&(t.push(l.points[0]),n.push(l.points[0]));break;case"V":var s;null!==(s=l.points)&&void 0!==s&&s.length&&(e.push(l.points[0]),r.push(l.points[0]));break;case"a":var d;if(7==(null===(d=l.points)||void 0===d?void 0:d.length)){let v=t[t.length-1];t.push(v+l.points[5]),n.push(v+l.points[5]);let b=e[e.length-1];e.push(b+l.points[6]),r.push(b+l.points[6])}break;case"h":var u;if(null!==(u=l.points)&&void 0!==u&&u.length){let v=t[t.length-1];t.push(v+l.points[0]),n.push(v+l.points[0])}break;case"v":var c;if(null!==(c=l.points)&&void 0!==c&&c.length){let v=e[e.length-1];e.push(v+l.points[0]),r.push(v+l.points[0])}break;case"M":case"L":case"C":case"S":case"Q":case"T":var h;null===(h=l.points)||void 0===h||h.forEach((v,b)=>{b%2==0?n.push(v):r.push(v)});break;case"m":case"l":case"c":case"s":case"q":case"t":var f;null===(f=l.points)||void 0===f||f.forEach((v,b)=>{if(b%2==0){let p=t[t.length-1];t.push(p+v),n.push(p+v)}else{let p=e[e.length-1];e.push(p+v),r.push(p+v)}})}}),{minX:Math.min.apply(null,n),minY:Math.min.apply(null,r),maxX:Math.max.apply(null,n),maxY:Math.max.apply(null,r)}},We=(i,t)=>t.map(e=>{let n=[];switch(e.type){case"a":var r;7==(null===(r=e.points)||void 0===r?void 0:r.length)&&n.push([C(e.points[0]/i.width,1e6),C(e.points[1]/i.height,1e6),e.points[2],e.points[3],e.points[4],C(e.points[5]/i.width,1e6),C(e.points[6]/i.height,1e6)]);break;case"A":var l;7==(null===(l=e.points)||void 0===l?void 0:l.length)&&n.push([C(e.points[0]/i.width,1e6),C(e.points[1]/i.height,1e6),e.points[2],e.points[3],e.points[4],C((e.points[5]-i.x)/i.width,1e6),C((e.points[6]-i.y)/i.height,1e6)]);break;case"h":var a;null!==(a=e.points)&&void 0!==a&&a.length&&n.push([C(e.points[0]/i.width,1e6)]);break;case"H":var o;null!==(o=e.points)&&void 0!==o&&o.length&&n.push([C((e.points[0]-i.x)/i.width,1e6)]);break;case"v":var s;null!==(s=e.points)&&void 0!==s&&s.length&&n.push([C(e.points[0]/i.height,1e6)]);break;case"V":var d;null!==(d=e.points)&&void 0!==d&&d.length&&n.push([C((e.points[0]-i.y)/i.height,1e6)]);break;case"z":case"Z":break;case"M":case"L":case"C":case"S":case"Q":case"T":var u;if(null!==(u=e.points)&&void 0!==u&&u.length)for(let h=0,f=e.points.length-1;h<f;h+=2)n.push([C((e.points[h]-i.x)/i.width,1e6),C((e.points[h+1]-i.y)/i.height,1e6)]);break;case"m":case"l":case"c":case"s":case"q":case"t":var c;if(null!==(c=e.points)&&void 0!==c&&c.length)for(let h=0,f=e.points.length-1;h<f;h+=2)n.push([C(e.points[h]/i.width,1e6),C(e.points[h+1]/i.height,1e6)])}return n.length?{type:e.type,ratios:n}:{type:e.type}}),jn=(i,t)=>t.map(e=>{switch(e.type){case"a":var n,r;return`${e.type}${null!==(n=null===(r=e.ratios)||void 0===r||null===(r=r.map(x=>{var w,S,R,J,B,z,T;return[C(i.width*(null!==(w=x[0])&&void 0!==w?w:0),1e6),C(i.height*(null!==(S=x[1])&&void 0!==S?S:0),1e6),null!==(R=x[2])&&void 0!==R?R:0,null!==(J=x[3])&&void 0!==J?J:0,null!==(B=x[4])&&void 0!==B?B:0,C(i.width*(null!==(z=x[5])&&void 0!==z?z:0),1e6),C(i.height*(null!==(T=x[6])&&void 0!==T?T:0),1e6)]}))||void 0===r||null===(r=r.map(x=>x.join(" ")))||void 0===r?void 0:r.join(" "))&&void 0!==n?n:""}`;case"A":var l,a;return`${e.type}${null!==(l=null===(a=e.ratios)||void 0===a||null===(a=a.map(x=>{var w,S,R,J,B,z,T;return[C(i.width*(null!==(w=x[0])&&void 0!==w?w:0),1e6),C(i.height*(null!==(S=x[1])&&void 0!==S?S:0),1e6),null!==(R=x[2])&&void 0!==R?R:0,null!==(J=x[3])&&void 0!==J?J:0,null!==(B=x[4])&&void 0!==B?B:0,C(i.x+i.width*(null!==(z=x[5])&&void 0!==z?z:0),1e6),C(i.y+i.height*(null!==(T=x[6])&&void 0!==T?T:0),1e6)]}))||void 0===a||null===(a=a.map(x=>x.join(" ")))||void 0===a?void 0:a.join(" "))&&void 0!==l?l:""}`;case"h":var o,s;return`${e.type}${null!==(o=null===(s=e.ratios)||void 0===s||null===(s=s.map(x=>{var w;return C(i.width*(null!==(w=x[0])&&void 0!==w?w:0),1e6)}))||void 0===s?void 0:s.join(" "))&&void 0!==o?o:""}`;case"H":var d,u;return`${e.type}${null!==(d=null===(u=e.ratios)||void 0===u||null===(u=u.map(x=>{var w;return C(i.x+i.width*(null!==(w=x[0])&&void 0!==w?w:0),1e6)}))||void 0===u?void 0:u.join(" "))&&void 0!==d?d:""}`;case"v":var c,h;return`${e.type}${null!==(c=null===(h=e.ratios)||void 0===h||null===(h=h.map(x=>{var w;return C(i.height*(null!==(w=x[0])&&void 0!==w?w:0),1e6)}))||void 0===h?void 0:h.join(" "))&&void 0!==c?c:""}`;case"V":var f,v;return`${e.type}${null!==(f=null===(v=e.ratios)||void 0===v||null===(v=v.map(x=>{var w;return C(i.y+i.height*(null!==(w=x[0])&&void 0!==w?w:0),1e6)}))||void 0===v?void 0:v.join(" "))&&void 0!==f?f:""}`;case"z":case"Z":return e.type;case"M":case"L":case"C":case"S":case"Q":case"T":var b,p;return`${e.type}${null!==(b=null===(p=e.ratios)||void 0===p||null===(p=p.map(x=>{var w,S;return[C(i.x+i.width*(null!==(w=x[0])&&void 0!==w?w:0),1e6),C(i.y+i.height*(null!==(S=x[1])&&void 0!==S?S:0),1e6)]}))||void 0===p||null===(p=p.map(x=>x.join(" ")))||void 0===p?void 0:p.join(" "))&&void 0!==b?b:""}`;case"m":case"l":case"c":case"s":case"q":case"t":var g,O;return`${e.type}${null!==(g=null===(O=e.ratios)||void 0===O||null===(O=O.map(x=>{var w,S;return[C(i.width*(null!==(w=x[0])&&void 0!==w?w:0),1e6),C(i.height*(null!==(S=x[1])&&void 0!==S?S:0),1e6)]}))||void 0===O||null===(O=O.map(x=>x.join(" ")))||void 0===O?void 0:O.join(" "))&&void 0!==g?g:""}`;default:return""}}).join(""),Ln=(i,t)=>{let e=[];for(let n=0,r=t.length-1;n<r;n+=2)e.push([(t[n]-i.x)/i.width,(t[n+1]-i.y)/i.height]);return e},Bn=(i,t)=>t.map(e=>[C(i.x+i.width*e[0],1e6),C(i.y+i.height*e[1],1e6)]).map(e=>e.join(" ")).join(" "),oe=(i,t)=>{let e=Vi(t);if(e){let n=window.Snap.matrix(e.a,e.b,e.c,e.d,e.e,e.f);if(n){let{dx:r,dy:l,rotate:a,scalex:o,scaley:s}=n.split();return{x:i.x+r,y:i.y+l,dx:r,dy:l,rotate:a,scalex:o,scaley:s}}return{x:oi(i.x,i.y,e),y:ki(i.x,i.y,e)}}return i},Vi=i=>{let t=i.replace(/\s?\-?[0-9\.]+e-[0-9]+/g," 0").replace(/\,/g," ").replace(/\s?\-/g," -").replace(/(\.[0-9]+)(\.[0-9]+)/g,"$1 0$2").replace(/\-\./g,"-0.").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim().split(" ").map(e=>C(parseFloat(e),1e6));if(6==t.length)return{a:t[0],b:t[1],c:t[2],d:t[3],e:t[4],f:t[5]}},oi=function(i,t,e){return C(i*e.a+t*e.c+e.e,10)},ki=function(i,t,e){return C(i*e.b+t*e.d+e.f,10)},Qt=(i,t,e,n,r)=>{let l={x:Math.min(i,e),y:Math.min(t,n),width:Math.abs(e-i)||1,height:Math.abs(n-t)||1};return null!=r&&r.ratio&&(l.width<=l.height?l.height=l.width*(null==r?void 0:r.ratio):l.width=l.height/(null==r?void 0:r.ratio)),Object.assign(l,{ratios:(null==r?void 0:r.ratios)||[[(i-l.x)/(l.width||1),(t-l.y)/(l.height||1)],[(e-l.x)/(l.width||1),(n-l.y)/(l.height||1)]]}),null!=r&&r.points&&(l.points=null==r?void 0:r.points),l},at=(i,t,e)=>{var n,r=(()=>{switch(i){case F.CIRCLE:return{cx:t.x+t.width/2,cy:t.y+t.height/2,r:Math.min(t.width/2,t.height/2)};case F.ELLIPSE:return{cx:t.x+t.width/2,cy:t.y+t.height/2,rx:t.width/2,ry:t.height/2};case F.LINE:{var l;let u={};return null===(l=t.ratios)||void 0===l||l.forEach((c,h)=>{u[`x${h+1}`]=t.x+t.width*c[0],u[`y${h+1}`]=t.y+t.height*c[1]}),u}case F.RECT:case F.FOREIGNOBJECT:case F.IMAGE:return{x:t.x,y:t.y,width:t.width,height:t.height};case F.TEXT:case F.TSPAN:var a;return{x:t.x,y:t.y+(e.alignmentBaseline||e.dominantBaseline?0:null!==(a=e.fontSize)&&void 0!==a?a:16)};case F.POLYGON:case F.POLYLINE:var o;if(null!==(o=t.ratios)&&void 0!==o&&o.length)return{points:Bn(t,t.ratios)};break;case F.PATH:var s,d;if(null!==(s=t.ratioMaps)&&void 0!==s&&s.length)return{d:jn(t,t.ratioMaps)};if(null!==(d=t.points)&&void 0!==d&&d.length)return{d:`M ${(u=t.points)[0][0]} ${u[0][1]} L ${(u.map(c=>[c[0],c[1]])||[]).map(c=>c.join(" ")).join(" ")}`}}var u;return{}})();return t.rotate?(r.transform=`rotate(${t.rotate})`,r.transformOrigin=`${t.x+t.width/2} ${t.y+t.height/2}`):null!==(n=e.transform)&&void 0!==n&&n.match(/^rotate/)&&(e.transform=null,e.transformOrigin=null),r},Oi=(i,t,e)=>{var n;if(!t.points||!t.points.length)return void e();let r=jQuery("#"+i),a=function tn(i){let t=[];2===i.length&&i.splice(1,0,[(i[0][0]+i[1][0])/2,(i[0][1]+i[1][1])/2]);let a,o,s,e=1,n=i.length;for(;e<n;){if(a=i[e-1],o=i[e],s=i[e+1],(Math.abs(a[0]-o[0])>=15||Math.abs(a[1]-o[1])>=15)&&Math.pow(a[0]-o[0],2)+Math.pow(a[1]-o[1],2)>=Math.pow(15,2)&&s&&(Math.abs(a[0]-s[0])<=20||Math.abs(a[1]-s[1])<=20)&&Math.pow(a[0]-s[0],2)+Math.pow(a[1]-s[1],2)<=Math.pow(20,2))t.push(o);else{let u=o[0]-a[0],c=o[1]-a[1],h=Math.max(Math.abs(u),Math.abs(c));for(var d=0;d<h;d+=15)t.push([a[0]+u*d/h,a[1]+c*d/h])}e++}return n>0&&(t.splice(0,0,i[0]),t.push(i[n-1])),t}((p=>{if(1==p.length){let{size:g}=t.node;return[[g.x+g.width/2,g.y+g.height/2],...p]}return[...p]})(t.points||[])),o=null!==(n=t.iteration)&&void 0!==n?n:0;if(o<0&&(e(),e=function(){}),r.data("work-running")&&o<0)return;r.data("work-running",!0);let v,s=a.length,d=Math.max(20,1e3*(t.time||3)/s),{id:u,type:c,size:h,attribute:f}=V.findNode(i),b=function(p){if(t.slideStatus!==V.slideStatus)return r.data("work-running",!1),void(t.slideStatus===V.slideStatus&&e());if(p<s){let O=a[p];O&&(v=Object.assign({},h,{x:O[0]-h.width/2,y:O[1]-h.height/2}),Object.assign(f,at(c,v,f)),m(window.document.getElementById(u),f),setTimeout(function(){b(++p)},d))}else if(o>0)o--,b(1);else if(o<0)b(1);else switch(r.data("work-running",!1),t.slideStatus===V.slideStatus&&e(),t.finish){default:case 0:break;case 1:Object.assign(f,at(c,h,f)),m(window.document.getElementById(u),f);break;case 2:var g;Oe(t.node.id,{node:t.node,value:null===(g=t.node.animate)||void 0===g?void 0:g.out,nodeStatus:t.nodeStatus,slideStatus:t.slideStatus},()=>{r.addClass("hide")})}};b(1)},Ni=(i,t,e,n,r)=>{var l,a,o,s,d,u,c;if(n.slideStatus!=V.slideStatus)return t.async&&"change-slide"!=t.async?void 0:void r();if(n.nodeStatus!=V.nodeStatus&&(!t.async||"change-node"==t.async))return void r();if(!(null!==(l=t.source)&&void 0!==l&&l.path||null!==(a=t.source)&&void 0!==a&&a.url))return console.warn(`${i} -> audio no source!`),r(),void(r=()=>{});var h=jQuery("#"+i);let f=null!==(o=t.iteration)&&void 0!==o?o:0;if(f<0&&(r(),r=function(){}),!(h.data("audio-running")&&f<0)){h.data("audio-running",!0);var v=function(p){p.pause(),p.remove(),h.data("audio-running",!1)},b=new Audio;return b.autoplay=!0,b.loop=0!=f,b.preload="auto",b.controls=!0,b.setAttributeNode(document.createAttribute("playsinline")),b.addEventListener("canplay",function(){var p=b.play();p&&p.then(function(g){var O;h.data("audio-running",!0),"time"==t.async?setTimeout(()=>{n.slideStatus===V.slideStatus&&(v(b),r(),r=()=>{})},1e3*(null!==(O=t.time)&&void 0!==O?O:1)):"non-stop"==t.async&&(r(),r=()=>{})}).catch(function(g){h.data("audio-running",!1),n.slideStatus===V.slideStatus&&(r(),r=()=>{})})}),b.addEventListener("timeupdate",function(){switch(t.async){case"time":case"change-slide":n.slideStatus!==V.slideStatus&&(v(this),r(),r=()=>{});break;case"finish-action":e.total>=2&&e.total-e.counter==1&&(v(this),r(),r=()=>{});break;default:case"change-node":n.nodeStatus!==V.nodeStatus&&(v(this),r(),r=()=>{});case"non-stop":}}),b.addEventListener("canplaythrough",function(){this.loop&&(f>0?f--:0==f&&(this.loop=!1))}),b.addEventListener("play",function(){}),b.addEventListener("pause",function(){}),b.addEventListener("ended",function(){this.remove(),h.data("audio-running",!1),n.slideStatus===V.slideStatus&&(r(),r=()=>{})}),b.onerror=function(){this.remove(),h.data("audio-running",!1),n.slideStatus===V.slideStatus&&(r(),r=()=>{})},b.src=(null!==(s=t.source)&&void 0!==s&&s.path?(null===(d=y.config)||void 0===d?void 0:d.readfileuploadurl)+(null===(u=t.source)||void 0===u?void 0:u.path):null===(c=t.source)||void 0===c?void 0:c.url)||"",b}},Ne=i=>{i.id?jQuery("#"+i.id).removeClass("hide"):i.ids&&i.ids.forEach(t=>{jQuery("#"+t).removeClass("hide")})},Ce=i=>{i.id?(jQuery("#"+i.id).removeClass("hide"),Ye(V.findNode(i.id),i.nodeStatus,i.slideStatus)):i.ids&&i.ids.forEach(t=>{jQuery("#"+t).removeClass("hide"),Ye(V.findNode(t),i.nodeStatus,i.slideStatus)})},Ae=i=>{if(i.id){var t;let e=V.findNode(i.id);Oe(i.id,{node:e,value:null===(t=e.animate)||void 0===t?void 0:t.out,nodeStatus:i.nodeStatus,slideStatus:i.slideStatus},()=>{jQuery("#"+i.id).addClass("hide")})}else i.ids&&i.ids.forEach(e=>{var n;let r=V.findNode(e);Oe(e,{node:r,value:null===(n=r.animate)||void 0===n?void 0:n.out,nodeStatus:i.nodeStatus,slideStatus:i.slideStatus},()=>{jQuery("#"+e).addClass("hide")})})},Ye=(i,t,e,n)=>{var r,l,a;let o={total:0,counter:0},{triggershow:s,triggerrun:d,triggerhide:u,action:c,audio:h,slide:f,media:v}=null!==(r=null===(l=i.interactive)||void 0===l?void 0:l.click)&&void 0!==r?r:{};if(console.log(`node(${i.id}) | nodeStatus(${t}) | slideStatus(${e}) | click`),s){let{id:x,ids:w,time:S,async:R}=s;"asynctrue"==R?Ne({id:x,ids:w,nodeStatus:t,slideStatus:e}):"time"==R&&setTimeout(()=>{Ne({id:x,ids:w,nodeStatus:t,slideStatus:e})},1e3*(null!=S?S:0))}if(d){let{id:x,ids:w,time:S,async:R}=d;"asynctrue"==R?Ce({id:x,ids:w,nodeStatus:t,slideStatus:e}):"time"==R&&setTimeout(()=>{Ce({id:x,ids:w,nodeStatus:t,slideStatus:e})},1e3*(null!=S?S:0))}if(u){let{id:x,ids:w,time:S,async:R}=u;"asynctrue"==R?Ae({id:x,ids:w,nodeStatus:t,slideStatus:e}):"time"==R&&setTimeout(()=>{Ae({id:x,ids:w,nodeStatus:t,slideStatus:e})},1e3*(null!=S?S:0))}let b=()=>{setTimeout(()=>{if(o.counter>=o.total){if(n&&n(),s){let{id:x,ids:w,async:S}=s;(!S||"asyncfalse"==S)&&Ne({id:x,ids:w,nodeStatus:t,slideStatus:e})}if(d){let{id:x,ids:w,async:S}=d;(!S||"asyncfalse"==S)&&Ce({id:x,ids:w,nodeStatus:t,slideStatus:e})}if(u){let{id:x,ids:w,async:S}=u;(!S||"asyncfalse"==S)&&Ae({id:x,ids:w,nodeStatus:t,slideStatus:e})}}})};if(null!=c&&c.value){o.total+=1;let x=()=>{o.counter+=1,b()};switch(null==c?void 0:c.value){case"hide":var p;Oe(i.id,{node:i,value:null===(p=i.animate)||void 0===p?void 0:p.out,nodeStatus:t,slideStatus:e},()=>{jQuery("#"+i.id).addClass("hide"),x()});break;case"points":{let{points:w,time:S,iteration:R,finish:J}=c;w&&Oi(i.id,{node:i,points:w,time:S,iteration:R,finish:J,nodeStatus:t,slideStatus:e},x);break}default:{let{value:w,time:S,iteration:R,finish:J}=c;Zi(i.id,{node:i,value:w,time:S,iteration:R,finish:J,nodeStatus:t,slideStatus:e},x);break}}}if(null!=h&&null!==(a=h.source)&&void 0!==a&&a.path){o.total+=1;let x=()=>{o.counter+=1,b()};Ni(i.id,h,o,{nodeStatus:t,slideStatus:e},x)}if(o.total||b(),null!=f&&f.id)switch(f.id){case-1:V.runSlide(V.slideIdx-1);break;case-2:V.runSlide(V.slideIdx+1);break;default:var g;V.runSlide(void 0,f.id,null===(g=f.code)||void 0===g?void 0:g.toString())}if(null!=v&&v.type){var O;let w=`<div class="popup-media-viewer"><iframe src="${ae({readfileuploadurl:null===(O=y.config)||void 0===O?void 0:O.readfileuploadurl,type:null==v?void 0:v.type,oss:null==v?void 0:v.oss,path:null==v?void 0:v.path,url:null==v?void 0:v.url})}" frameborder="0" allowfullscreen\n        webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen"></iframe><div class="btn-close"><img src="assets/icon-svg/close-outline.svg"/></div></div>`,S=jQuery(w).appendTo(window.document.body);S.find(".btn-close").click(function(R){R.preventDefault(),S.remove()})}},Je=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:320,height:80},r=(null==t?void 0:t.attribute)||{fill:y.attribute.stroke,fontFamily:y.attribute.fontFamily,fontSize:y.attribute.fontSize,textLength:y.attribute.textLength},l=(null==t?void 0:t.source)||{type:"text",text:{textContent:""}};return{nodeId:i,element:qt(i,F.TEXT,"text",{size:n,attribute:r,source:l},e),size:n,attribute:r,source:l}},Pe=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{};return{nodeId:i,element:qt(i,F.GROUP,"g",{size:n,attribute:r},e),size:n,attribute:r}},Ti=(i,t,e)=>{var n,r,l,a;let o=1,s=new Image;s.onload=()=>{var d,u,c,h;o=C(s.naturalWidth/s.naturalHeight,100);let f=0,v=0,b=0,p=0;var g,O,x,w;o>=1?(b=Math.min(s.naturalWidth,null!==(g=null===(O=V.slide.svg)||void 0===O||null===(O=O.viewBox)||void 0===O?void 0:O.width)&&void 0!==g?g:0),p=b/o):(p=Math.min(s.naturalHeight,null!==(x=null===(w=V.slide.svg)||void 0===w||null===(w=w.viewBox)||void 0===w?void 0:w.height)&&void 0!==x?x:0),b=p/o),f=((null!==(d=null===(u=V.slide.svg)||void 0===u||null===(u=u.viewBox)||void 0===u?void 0:u.width)&&void 0!==d?d:0)-b)/2,v=((null!==(c=null===(h=V.slide.svg)||void 0===h||null===(h=h.viewBox)||void 0===h?void 0:h.height)&&void 0!==c?c:0)-p)/2,t.size={x:f,y:v,width:b,height:p},Gn(t,e)},s.onerror=d=>{console.error(`ImgSrc load failed -> ${JSON.stringify(t.source)}`,d)},s.src=(null!==(n=t.source)&&void 0!==n&&n.path?(null===(r=y.config)||void 0===r?void 0:r.readfileuploadurl)+(null===(l=t.source)||void 0===l?void 0:l.path):null===(a=t.source)||void 0===a?void 0:a.url)||""},Gn=(i,t)=>{if(i.slideStatus!=V.slideStatus)return void t();let{element:e}=Se(Math.ceil(1e9*Math.random()),{size:i.size,source:{type:"image",image:null==i?void 0:i.source}});setTimeout(()=>{null==e||e.remove(),t()},3e3)},Ut=(i,t,e)=>{var n,r,l,a;let o=new Image;o.onload=()=>{Qn(i,{width:o.naturalWidth,height:o.naturalHeight},t,e)},o.onerror=s=>{console.error(`ImgSrc load failed -> ${JSON.stringify(t.source)}`,s),e()},o.src=(null!==(n=t.source)&&void 0!==n&&n.path?(null===(r=y.config)||void 0===r?void 0:r.readfileuploadurl)+(null===(l=t.source)||void 0===l?void 0:l.path):null===(a=t.source)||void 0===a?void 0:a.url)||""},Qn=(i,t,e,n)=>{if(e.slideStatus!=V.slideStatus)return void n();let r=C(t.width/t.height,100),l=0,a=0,o=0,s=0;r>=1?(o=t.width,o=Math.max(o,40),o=Math.min(o,40),s=o/r):(s=t.height,s=Math.max(s,40),s=Math.min(s,40),o=s/r);let{size:c}=i;l=c.x+c.width-o/2,a=c.y-s/2;let h=N(rt.TEST_GROUP,"g",void 0,y.target);Se(`icon-${i.id}`,{size:{x:l,y:a,width:o,height:s},source:{type:"image",image:null==e?void 0:e.source}},h),setTimeout(()=>{n()},3e3)},nn=(i,t,e)=>{var n,r,l,a,o,s,d;if(t.slideStatus!=V.slideStatus)return void e();if(!(null!==(n=t.source)&&void 0!==n&&n.path||null!==(r=t.source)&&void 0!==r&&r.url))return console.warn(`${i.id} -> audio no source!`),void e();var u=jQuery("#"+i.id);let c=null!==(l=t.iteration)&&void 0!==l?l:0;if(c<0&&(e(),e=function(){}),!(u.data("audio-running")&&c<0)){u.data("audio-running",!0);var h=new Audio;return h.autoplay=!0,h.loop=0!=c,h.preload="auto",h.controls=!0,h.setAttributeNode(document.createAttribute("playsinline")),h.addEventListener("canplay",function(){var f=h.play();f&&f.then(function(v){u.data("audio-running",!0)}).catch(function(v){u.data("audio-running",!1),t.slideStatus===V.slideStatus&&e()})}),h.addEventListener("timeupdate",function(){var v;t.slideStatus!==V.slideStatus&&((v=this).pause(),v.remove(),u.data("audio-running",!1))}),h.addEventListener("canplaythrough",function(){this.loop&&(c>0?c--:0==c&&(this.loop=!1))}),h.addEventListener("play",function(){}),h.addEventListener("pause",function(){}),h.addEventListener("ended",function(){this.remove(),u.data("audio-running",!1),t.slideStatus===V.slideStatus&&e()}),h.onerror=function(){this.remove(),u.data("audio-running",!1),t.slideStatus===V.slideStatus&&e()},h.src=(null!==(a=t.source)&&void 0!==a&&a.path?(null===(o=y.config)||void 0===o?void 0:o.readfileuploadurl)+(null===(s=t.source)||void 0===s?void 0:s.path):null===(d=t.source)||void 0===d?void 0:d.url)||"",h}};var rn=/^#[a-fA-F0-9]+$/i,Un=/^rgb\((\d+),(\d+),(\d+)\)$/i,Hn=/^rgba\((\d+),(\d+),(\d+),([0-9\.]+)\)$/i;const Ii=i=>{let t=null,e=null;if(i)if("transparent"==i)t="#000000",e=0;else if(i.match(rn))t=i;else{let n=(i=i.replace(/\s+/g,"")).match(Hn);if(n)t="#"+(256|n[1]).toString(16).slice(1)+(256|n[2]).toString(16).slice(1)+(256|n[3]).toString(16).slice(1),e=C(parseFloat(n[4]),100);else{let r=i.match(Un);r&&(t="#"+(256|r[1]).toString(16).slice(1)+(256|r[2]).toString(16).slice(1)+(256|r[3]).toString(16).slice(1))}}return{hex:t,alpha:e}},It=i=>Ft(null==i?void 0:i.url,null==i?void 0:i.path,null==i?void 0:i.src,null==i?void 0:i.name);var Ft=(i,t,e,n)=>{var r,l;let a,o,s,d;var u,c;return i&&(a=i.replace(/\\/g,"/")),t&&(o=t.replace(/\\/g,"/")),e&&(s=e.replace(/\\/g,"/")),o&&!a&&(a=(null===(u=y.config)||void 0===u?void 0:u.readfileuploadurl)+o),!s||o||a||(o=s.replace(/^[a-zA-Z0-9\-\_\/\\\:\.]+(upload|FileUpload|files|readfileupload|filereader|readfile)\//g,""),a=(null===(c=y.config)||void 0===c?void 0:c.readfileuploadurl)+o),d=n||(null!==(r=a)&&void 0!==r?r:"").split("/").pop()||(null!==(l=o)&&void 0!==l?l:"").split("/").pop()||"",{url:a,path:o,name:d}};const qn=i=>{let t={x:0,y:0,width:i.screen.w,height:i.screen.h},e=[];return i.data.forEach((n,r)=>{var l,a;let o={id:"number"==typeof n.id?n.id:y.data.newSlideId,code:null===(l=n.id)||void 0===l?void 0:l.toString(),name:"string"==typeof n.id?n.id:`Trang ${r+1}`,svg:{viewBox:t,nodes:[]},test:(s=n.test2,s?(s.audiotrue&&(s.audiotrue=It({path:s.audiotrue.path})),s.audiofalse&&(s.audiofalse=It({path:s.audiofalse.path})),s.effecttrue&&(s.effecttrue=It({path:s.effecttrue.path})),s.effectfalse&&(s.effectfalse=It({path:s.effectfalse.path})),s.icontrue&&(s.icontrue=It({path:s.icontrue.path})),s.iconfalse&&(s.iconfalse=It({path:s.iconfalse.path})),s):{})};var s;n.background&&o.svg&&(o.svg.background=function(i){return i&&(null!==i.match(/#([a-zA-Z0-9]+)/)||null!==i.match(/rgb\([0-9]+,[0-9]+,[0-9]+\)/)||null!==i.match(/rgba\([0-9]+,[0-9]+,[0-9]+,[0-9\.]+\)/))}(n.background)?{color:n.background}:function(i){return i&&null!==i.match(/data:[^;]+;base64,/)}(n.background)?{base64:n.background}:function(i){return i&&null!==i.match(/http(s)?:\/\//)}(n.background)?Ft(n.background):Ft(void 0,n.background)),jQuery(null!==(a=n.svg)&&void 0!==a?a:"").find(".indexs").find("polygon,path,circle,ellipse,line,rect,foreignObject").each((s,d)=>{var u,c;let h=jQuery(d).parents(".indexs"),f=(g=h.attr("data-index"))?parseInt(g):0,v=(g=>f&&g?parseInt(g):0)(h.attr("data-time")),b=null!==(u=d.getAttribute("id"))&&void 0!==u?u:(1e9*Math.random()).toFixed(),p={id:parseInt(b),code:`${d.nodeName}-${b}`,name:d.nodeName,idx:f,time:v,type:(()=>{switch(d.nodeName){case"polygon":return F.POLYGON;case"path":return F.PATH;case"circle":return F.CIRCLE;case"ellipse":return F.ELLIPSE;case"line":return F.LINE;case"rect":return F.RECT;case"foreignObject":return F.FOREIGNOBJECT}return 0})(),size:(g=>{let O={},x=0,w=0,S=0,R=0,J=null,B=null,z=parseFloat((null===(g=d.getAttribute("transform"))||void 0===g?void 0:g.replace("rotate(","").replace(")",""))||"0")||null;switch(d.nodeName){case"polygon":{var T,A;let Q=[],D=[],E=999999999,P=999999999,L=0,M=0;J=JSON.parse(d.getAttribute("ratios")||"[]"),B=null!==(T=null===(A=d.getAttribute("points"))||void 0===A?void 0:A.split(",").map(function(K){return K.split(" ").map(function(W){return parseFloat(W)})}))&&void 0!==T?T:[],B.forEach(function(K){Q.push(K[0]),D.push(K[1])}),E=Math.min.apply(null,Q),P=Math.min.apply(null,D),L=Math.max.apply(null,Q),M=Math.max.apply(null,D),x=E,w=P,S=L-x,R=M-w;break}case"path":{let Q=d.getAttribute("d");if(Q){let D=Ue(Q),{minX:E,minY:P,maxX:L,maxY:M}=He(D);x=E,w=P,S=L-x||1,R=M-w||1,Object.assign(O,{ratioMaps:We({x,y:w,width:S,height:R},D)})}break}case"circle":{let Q=parseFloat(d.getAttribute("cx")||"0"),D=parseFloat(d.getAttribute("cy")||"0"),E=parseFloat(d.getAttribute("r")||"0");x=Q-E,w=D-E,S=2*E,R=2*E;break}case"ellipse":{let Q=parseFloat(d.getAttribute("cx")||"0"),D=parseFloat(d.getAttribute("cy")||"0"),E=parseFloat(d.getAttribute("rx")||"0"),P=parseFloat(d.getAttribute("ry")||"0");x=Q-E,w=D-P,S=2*E,R=2*P;break}case"line":{let Q=parseFloat(d.getAttribute("x1")||"0"),D=parseFloat(d.getAttribute("y1")||"0"),E=parseFloat(d.getAttribute("x2")||"0"),P=parseFloat(d.getAttribute("y2")||"0"),L=999999999,M=999999999,K=0,W=0;L=Math.min(Q,E),M=Math.min(D,P),K=Math.max(Q,E),W=Math.max(D,P),x=L,w=M,S=K-x,R=W-w,J=[[(Q-x)/(S||1),(D-w)/(R||1)],[(E-x)/(S||1),(P-w)/(R||1)]];break}case"rect":case"foreignObject":x=parseFloat(d.getAttribute("x")||"0"),w=parseFloat(d.getAttribute("y")||"0"),S=parseFloat(d.getAttribute("width")||"0"),R=parseFloat(d.getAttribute("height")||"0")}return Object.assign(O,{x,y:w,width:S,height:R,ratios:J,points:B,rotate:z})})(),attribute:(()=>{let g={};switch(d.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":{var O,x,w,S,R,J,B,z;let K=null!==(O=d.getAttribute("fill"))&&void 0!==O?O:null,W=null!==(x=d.getAttribute("stroke"))&&void 0!==x?x:null,tt=null!==(w=parseFloat(null!==(S=d.getAttribute("stroke-opacity"))&&void 0!==S?S:"1"))&&void 0!==w?w:null,Z=null!==(R=parseFloat(d.getAttribute("stroke-width")||"0"))&&void 0!==R?R:null,X=null!==(J=d.getAttribute("stroke-linecap"))&&void 0!==J?J:null,dt=null!==(B=d.getAttribute("stroke-linejoin"))&&void 0!==B?B:null,ft=null!==(z=parseFloat(d.getAttribute("stroke-dasharray")||"0"))&&void 0!==z?z:null;Object.assign(g,{fill:K,stroke:W,strokeOpacity:tt,strokeWidth:Z,strokeLinecap:X,strokeLinejoin:dt,strokeDasharray:ft});break}case"path":{let K=h.get(0);if(K){var T,A,Q,D,E,P,L,M;let W=null!==(T=K.getAttribute("fill"))&&void 0!==T?T:null,tt=null!==(A=K.getAttribute("stroke"))&&void 0!==A?A:null,Z=null!==(Q=parseFloat(null!==(D=K.getAttribute("stroke-opacity"))&&void 0!==D?D:"1"))&&void 0!==Q?Q:null,X=null!==(E=parseFloat(K.getAttribute("stroke-width")||"0"))&&void 0!==E?E:null,dt=null!==(P=K.getAttribute("stroke-linecap"))&&void 0!==P?P:null,ft=null!==(L=K.getAttribute("stroke-linejoin"))&&void 0!==L?L:null,xt=null!==(M=parseFloat(K.getAttribute("stroke-dasharray")||"0"))&&void 0!==M?M:null;Object.assign(g,{fill:W,stroke:tt,strokeOpacity:Z,strokeWidth:X,strokeLinecap:dt,strokeLinejoin:ft,strokeDasharray:xt})}break}}return g})(),style:(()=>{let g={};switch(d.nodeName){case"polygon":case"path":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":{let w=jQuery(d).find(".svg-container");if(w.length){let R=parseFloat(w.css("border-width")||"0")||null,J=w.css("border-style")||null,B=w.css("border-color")||null,z=null,T=w.css("background-color")||null,A=null;(()=>{let{hex:Q,alpha:D}=Ii(B);B=Q,z=D})(),(()=>{let{hex:Q,alpha:D}=Ii(T);T=Q,A=D})(),Object.assign(g,{borderWidth:R,borderStyle:J,borderColor:B,borderOpacity:z,backgroundColor:T,backgroundOpacity:A})}let S=jQuery(d).find(".svg-editor-content");if(S.length){var O,x;let R=JSON.parse((S.attr("data-style")||"{}").replace(/\&quot\;/gm,'"')),{hex:J,alpha:B}=Ii(R.TextColor);Object.assign(g,{fontFamily:null!==(O=R.FontFamily)&&void 0!==O?O:null,fontSize:null!==(x=R.FontSize)&&void 0!==x?x:null,color:J,opacity:B})}break}}return g})(),source:(()=>{let g={};switch(d.nodeName){case"polygon":case"path":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":if(h.hasClass("editors")){var O;let M="div,h1,h2,h3,h4,h5,h6,p,span,strong,b,i",K=Z=>{null==Z||Z.forEach(X=>{let dt=X.querySelectorAll(`:scope > ${M}`);dt.length&&K(dt),!X.querySelectorAll(":scope > *").length&&""==X.textContent&&X.remove()})},W=Z=>{let X=null==Z?void 0:Z.querySelectorAll(":scope > div,h1,h2,h3,h4,h5,h6,p,strong,span");if(null!=X&&X.length){var dt;let ft=X[X.length-1];if(""==(null===(dt=ft.textContent)||void 0===dt?void 0:dt.trim())){let xt=ft.querySelectorAll(":scope > *");if(xt.length){let Nt=xt[xt.length-1];["br","BR"].includes(null==Nt?void 0:Nt.nodeName)&&(Nt.remove(),W(Z))}else ft.remove(),W(Z)}}};K(null===(O=jQuery(d).find(".svg-editor-content").get(0))||void 0===O?void 0:O.querySelectorAll(`:scope > ${M}`)),W(jQuery(d).find(".svg-editor-content").get(0));let tt=jQuery(d).find(".svg-editor-content");if(tt.length){var x;let Z=tt.html(),X=null!==(x=(null!=Z?Z:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==x?x:[];Object.assign(g,{type:"html",html:{htmlContent:Z,variableKeywords:X}})}}else if(h.hasClass("inputs")||h.hasClass("textareas"))Object.assign(g,{type:"input",input:{input:!!jQuery(d).find("input").length,textarea:!!jQuery(d).find("textarea").length}});else if(h.hasClass("tests")){let M=jQuery(d).find(".svg-test");if(h.hasClass("tests-truefalse")){var w,S;let K=M.find(".svg-editor-content").html(),W=null!==(w=(null!=K?K:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==w?w:[];Object.assign(g,{type:"test",test:{type:"truefalse",truefalse:{iscorrect:null===(S=n.test2.truefalse)||void 0===S?void 0:S.includes(b)}},html:{htmlContent:K,variableKeywords:W}})}else if(h.hasClass("tests-singlechoice")){var R,J;let K=M.find(".svg-editor-content").html(),W=null!==(R=(null!=K?K:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==R?R:[];Object.assign(g,{type:"test",test:{type:"singlechoice",singlechoice:{iscorrect:null===(J=n.test2.singlechoice)||void 0===J?void 0:J.includes(b)}},html:{htmlContent:K,variableKeywords:W}})}else if(h.hasClass("tests-multichoice")){var B,z;let K=M.find(".svg-editor-content").html(),W=null!==(B=(null!=K?K:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==B?B:[];Object.assign(g,{type:"test",test:{type:"multichoice",multichoice:{iscorrect:null===(z=n.test2.multichoice)||void 0===z?void 0:z.includes(b)}},html:{htmlContent:K,variableKeywords:W}})}else if(h.hasClass("tests-fill")){var T,A;let K=M.find(".svg-editor-content").html(),W=null!==(T=(null!=K?K:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==T?T:[],tt=null!==(A=(null!=K?K:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==A?A:[];tt=tt.filter((Z,X,dt)=>dt.indexOf(Z)==X),Object.assign(g,{type:"test",test:{type:"fill",fill:tt.map(Z=>{var X;return{key:Z,value:null===(X=n.test2.fill)||void 0===X||null===(X=X.find(dt=>dt.id==b))||void 0===X||null===(X=X.vals)||void 0===X?void 0:X.map(dt=>dt.text).filter(dt=>!["",null,void 0,NaN].includes(dt))}})},html:{htmlContent:K,variableKeywords:W,fillKeywords:tt}})}else if(h.hasClass("tests-matching")){if(M.hasClass("svg-test-empty"))Object.assign(g,{type:"test",test:{type:"matching-empty",matching:{key:M.attr("data-name")||null}}});else if(M.hasClass("svg-test-content")){var Q;let K=M.find(".svg-editor-content").html(),W=null!==(Q=(null!=K?K:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==Q?Q:[];Object.assign(g,{type:"test",test:{type:"matching-content",matching:{key:M.attr("data-name")||null}},html:{htmlContent:K,variableKeywords:W}})}}else if(h.hasClass("tests-speech")){var D;Object.assign(g,{type:"speech",speech:{value:null===(D=n.test2.speech)||void 0===D||null===(D=D.find(K=>K.id==b))||void 0===D||null===(D=D.vals)||void 0===D?void 0:D.map(K=>K.text).filter(K=>!["",null,void 0,NaN].includes(K))}})}else if(h.hasClass("tests-submit")){let K=jQuery(d).find(".svg-container img");Object.assign(g,{type:"test",test:{type:"submit"},image:Ft(K.attr("url"),K.attr("path"),K.attr("src"))})}}else if(h.hasClass("images")){let M=jQuery(d).find(".svg-editor-content img");if(M.length)Object.assign(g,{type:"image",image:Ft(M.attr("url"),M.attr("path"),M.attr("src"))});else{let K=jQuery(d).find("iframe");Object.assign(g,{type:"iframe",iframe:Ft(K.attr("url"),K.attr("path"),K.attr("src"))})}}else if(h.hasClass("sounds")){let M=jQuery(d).find(".svg-editor-content img");M.length&&Object.assign(g,{type:"image",image:Ft(M.attr("url"),M.attr("path"),M.attr("src"))})}else if(h.hasClass("htmls")){let M=jQuery(d).find("iframe");M.length&&Object.assign(g,{type:"iframe",iframe:Ft(M.attr("url"),M.attr("path"),M.attr("src"))})}else if(h.hasClass("svgs")){let M=jQuery(d).find("svg");var E,P;M.length&&Object.assign(g,{type:"svg",svg:Object.assign(Ft(M.attr("url"),M.attr("path"),M.attr("src")),{svgContent:null!==(E=null===(P=M.get(0))||void 0===P?void 0:P.outerHTML)&&void 0!==E?E:null})})}else if(h.hasClass("medias")){let M=jQuery(d).find(".media-item");if(M.length)switch(M.attr("type")){case"audio":Object.assign(g,{type:"audio",audio:Ft(M.attr("url"),M.attr("path"),M.attr("src"))});break;case"video":Object.assign(g,{type:"video",video:Ft(M.attr("url"),M.attr("path"),M.attr("src"))});break;case"file":Object.assign(g,{type:"file",file:Ft(M.attr("url"),M.attr("path"),M.attr("src"))});break;default:var L;Object.assign(g,{type:"link",link:{url:null!==(L=M.attr("url"))&&void 0!==L?L:null}})}let K=jQuery(d).find("img");K.length&&(Object.assign(g,{image:Ft(K.attr("url"),K.attr("path"),K.attr("src"))}),g.type||Object.assign(g,{type:"image"}))}}return g})(),animate:(g=>{let O={},x=null===(g=n.animates)||void 0===g?void 0:g.find(w=>w.elementId==b);return x&&Object.assign(O,{value:x.value}),O})(),interactive:(()=>{let g={},O=n.actions.show.filter(w=>w.elementId==b&&w.active);O.length&&(g.show={},O.forEach(w=>{let{source:S}=w;switch(null==S?void 0:S.type){case"work":var R,J,B,z,T;g.show.action={},Object.assign(g.show.action,{value:null!==(R=S.value)&&void 0!==R?R:null,iteration:null!==(J=S.iteration)&&void 0!==J?J:null,finish:null!==(B=S.end)&&void 0!==B?B:null,time:null!==(z=S.time)&&void 0!==z?z:null,points:null!==(T=S.points)&&void 0!==T?T:null});break;case"audio":var A,Q,D;g.show.audio={},Object.assign(g.show.audio,{source:Ft(null,null,S.url),iteration:null!==(A=S.iteration)&&void 0!==A?A:null,finish:null!==(Q=S.end)&&void 0!==Q?Q:null,time:null!==(D=S.time)&&void 0!==D?D:null,async:-1==S.iteration?"change-slide":"change-node"});break;case"node":case"node2":var E,P,L,M,K,W,tt,Z,X,dt,ft,xt,Nt,yt,At;S.options.includes("show")&&(g.show.triggershow={},Object.assign(g.show.triggershow,{id:null!==(E=parseInt(null!==(P=S.id)&&void 0!==P?P:"0"))&&void 0!==E?E:null,ids:null===(L=S.ids)||void 0===L?void 0:L.map(Kt=>parseInt(Kt)),async:null!==(M=S.async)&&void 0!==M?M:null,time:null!==(K=S.time)&&void 0!==K?K:null})),S.options.includes("run")&&(g.show.triggerrun={},Object.assign(g.show.triggerrun,{id:null!==(W=parseInt(null!==(tt=S.id)&&void 0!==tt?tt:"0"))&&void 0!==W?W:null,ids:null===(Z=S.ids)||void 0===Z?void 0:Z.map(Kt=>parseInt(Kt)),async:null!==(X=S.async)&&void 0!==X?X:null,time:null!==(dt=S.time)&&void 0!==dt?dt:null})),S.options.includes("hide")&&(g.show.triggerhide={},Object.assign(g.show.triggerhide,{id:null!==(ft=parseInt(null!==(xt=S.id)&&void 0!==xt?xt:"0"))&&void 0!==ft?ft:null,ids:null===(Nt=S.ids)||void 0===Nt?void 0:Nt.map(Kt=>parseInt(Kt)),async:null!==(yt=S.async)&&void 0!==yt?yt:null,time:null!==(At=S.time)&&void 0!==At?At:null}))}}));let x=n.actions.click.filter(w=>w.elementId==b&&w.active);return x&&(g.click={},x.forEach(w=>{let{source:S}=w;switch(null==S?void 0:S.type){case"work":var R,J,B,z,T;g.click.action={},Object.assign(g.click.action,{value:null!==(R=S.value)&&void 0!==R?R:null,iteration:null!==(J=S.iteration)&&void 0!==J?J:null,finish:null!==(B=S.end)&&void 0!==B?B:null,time:null!==(z=S.time)&&void 0!==z?z:null,points:null!==(T=S.points)&&void 0!==T?T:null});break;case"audio":var A,Q,D;g.click.audio={},Object.assign(g.click.audio,{source:Ft(null,null,S.url),iteration:null!==(A=S.iteration)&&void 0!==A?A:null,finish:null!==(Q=S.end)&&void 0!==Q?Q:null,time:null!==(D=S.time)&&void 0!==D?D:null,async:-1==S.iteration?"change-slide":"change-node"});break;case"video":{g.click.video={},Object.assign(g.click.video,{source:Ft(S.url,S.path)});let{url:Pt,path:he,name:fe}=Ft(S.url,S.path);g.click.media={},Object.assign(g.click.media,{url:Pt,path:he,name:fe,type:903});break}case"image":{g.click.image={},Object.assign(g.click.image,{source:Ft(S.url,S.path)});let{url:Pt,path:he,name:fe}=Ft(S.url,S.path);g.click.media={},Object.assign(g.click.media,{url:Pt,path:he,name:fe,type:901});break}case"link":{g.click.link={},Object.assign(g.click.link,{url:S.url,target:S.target});let{url:Pt,path:he,name:fe}=Ft(S.url,S.path);g.click.media={},Object.assign(g.click.media,{url:Pt,path:he,name:fe,type:904});break}case"text":g.click.text={},Object.assign(g.click.text,{content:S.content});break;case"node":case"node2":var E,P,L,M,K,W,tt,Z,X,dt,ft,xt,Nt,yt,At;S.options.includes("show")&&(g.click.triggershow={},Object.assign(g.click.triggershow,{id:null!==(E=parseInt(null!==(P=S.id)&&void 0!==P?P:"0"))&&void 0!==E?E:null,ids:null===(L=S.ids)||void 0===L?void 0:L.map(Pt=>parseInt(Pt)),async:null!==(M=S.async)&&void 0!==M?M:null,time:null!==(K=S.time)&&void 0!==K?K:null})),S.options.includes("run")&&(g.click.triggerrun={},Object.assign(g.click.triggerrun,{id:null!==(W=parseInt(null!==(tt=S.id)&&void 0!==tt?tt:"0"))&&void 0!==W?W:null,ids:null===(Z=S.ids)||void 0===Z?void 0:Z.map(Pt=>parseInt(Pt)),async:null!==(X=S.async)&&void 0!==X?X:null,time:null!==(dt=S.time)&&void 0!==dt?dt:null})),S.options.includes("hide")&&(g.click.triggerhide={},Object.assign(g.click.triggerhide,{id:null!==(ft=parseInt(null!==(xt=S.id)&&void 0!==xt?xt:"0"))&&void 0!==ft?ft:null,ids:null===(Nt=S.ids)||void 0===Nt?void 0:Nt.map(Pt=>parseInt(Pt)),async:null!==(yt=S.async)&&void 0!==yt?yt:null,time:null!==(At=S.time)&&void 0!==At?At:null}));break;case"slide":var Kt;g.click.slide={},Object.assign(g.click.slide,{id:parseInt(null!==(Kt=S.id)&&void 0!==Kt?Kt:"0")||S.num||null,code:S.id})}})),g})(),variable:(g=>{let O={};var x;d.getAttribute("data-variable")&&(O.input={},Object.assign(O.input,{variable:null!==(x=d.getAttribute("data-variable"))&&void 0!==x?x:null}));let w=null===(g=n.nodes)||void 0===g||null===(g=g.find(z=>z.id==b))||void 0===g?void 0:g.variable;var S,R,J,B;return w&&(O.click={},Object.assign(O.click,{variable:null!==(S=w.variable)&&void 0!==S?S:null,operator:null!==(R=w.operator)&&void 0!==R?R:null,valuetype:null!==(J=w.valuetype)&&void 0!==J?J:null,value:null!==(B=w.value)&&void 0!==B?B:null})),O})()};var g;null===(c=o.svg)||void 0===c||c.nodes.push(p)}),e.push(o)}),{screen:{width:i.screen.w,height:i.screen.h},data:{slides:e},variable:i.variable,fonts:[]}},an=(i,t)=>{var e;null===(e=t.test)||void 0===e||null===(e=e.answer)||void 0===e||null===(e=e.matching)||void 0===e||e.filter(n=>n.id==i.id).forEach(n=>n.value=""),jQuery(`#node-${i.id}`).remove()},Me=(i,t,e,n,r,l)=>{var a,o,s,d,u,c,h,f;r.iscorrect?(null!==(a=t.test)&&void 0!==a&&null!==(a=a.audiotrue)&&void 0!==a&&a.path&&nn(i,{source:It(null===(s=t.test)||void 0===s?void 0:s.audiotrue),iteration:0,nodeStatus:e,slideStatus:n},l),null!==(o=t.test)&&void 0!==o&&null!==(o=o.effecttrue)&&void 0!==o&&o.path&&Ti(0,{source:It(null===(d=t.test)||void 0===d?void 0:d.effecttrue),iteration:0,nodeStatus:e,slideStatus:n},l)):(null!==(u=t.test)&&void 0!==u&&null!==(u=u.audiofalse)&&void 0!==u&&u.path&&nn(i,{source:It(null===(h=t.test)||void 0===h?void 0:h.audiofalse),iteration:0,nodeStatus:e,slideStatus:n},l),null!==(c=t.test)&&void 0!==c&&null!==(c=c.effectfalse)&&void 0!==c&&c.path&&Ti(0,{source:It(null===(f=t.test)||void 0===f?void 0:f.effectfalse),iteration:0,nodeStatus:e,slideStatus:n},l));on(t,e,n,l)},on=(i,t,e,n)=>{var r;switch(null===(r=i.test)||void 0===r?void 0:r.type){case"truefalse":{var l,a;let{value:w,iscorrect:S}=null!==(l=null==i||null===(a=i.test)||void 0===a||null===(a=a.answer)||void 0===a?void 0:a.truefalse)&&void 0!==l?l:{};if(w){let R=V.findNode(w);var o,s,d,u;S?null!==(o=i.test)&&void 0!==o&&null!==(o=o.icontrue)&&void 0!==o&&o.path&&Ut(R,{source:It(null===(s=i.test)||void 0===s?void 0:s.icontrue),iteration:0,nodeStatus:t,slideStatus:e},n):null!==(d=i.test)&&void 0!==d&&null!==(d=d.iconfalse)&&void 0!==d&&d.path&&Ut(R,{source:It(null===(u=i.test)||void 0===u?void 0:u.iconfalse),iteration:0,nodeStatus:t,slideStatus:e},n)}break}case"singlechoice":{var c,h;let{value:w,iscorrect:S}=null!==(c=null==i||null===(h=i.test)||void 0===h||null===(h=h.answer)||void 0===h?void 0:h.singlechoice)&&void 0!==c?c:{};if(w){let R=V.findNode(w);var f,v,b,p;S?null!==(f=i.test)&&void 0!==f&&null!==(f=f.icontrue)&&void 0!==f&&f.path&&Ut(R,{source:It(null===(v=i.test)||void 0===v?void 0:v.icontrue),iteration:0,nodeStatus:t,slideStatus:e},n):null!==(b=i.test)&&void 0!==b&&null!==(b=b.iconfalse)&&void 0!==b&&b.path&&Ut(R,{source:It(null===(p=i.test)||void 0===p?void 0:p.iconfalse),iteration:0,nodeStatus:t,slideStatus:e},n)}break}case"multichoice":var g;null==i||null===(g=i.test)||void 0===g||null===(g=g.answer)||void 0===g||null===(g=g.multichoice)||void 0===g||g.forEach(w=>{let{value:S,iscorrect:R}=w;if(S){let A=V.findNode(S);var J,B,z,T;R?null!==(J=i.test)&&void 0!==J&&null!==(J=J.icontrue)&&void 0!==J&&J.path&&Ut(A,{source:It(null===(B=i.test)||void 0===B?void 0:B.icontrue),iteration:0,nodeStatus:t,slideStatus:e},n):null!==(z=i.test)&&void 0!==z&&null!==(z=z.iconfalse)&&void 0!==z&&z.path&&Ut(A,{source:It(null===(T=i.test)||void 0===T?void 0:T.iconfalse),iteration:0,nodeStatus:t,slideStatus:e},n)}});break;case"fill":var O;null==i||null===(O=i.test)||void 0===O||null===(O=O.answer)||void 0===O||null===(O=O.fill)||void 0===O||O.forEach(w=>{let{id:S,value:J,iscorrect:B}=w;if(J){let D=V.findNode(S);var z,T,A,Q;B?null!==(z=i.test)&&void 0!==z&&null!==(z=z.icontrue)&&void 0!==z&&z.path&&Ut(D,{source:It(null===(T=i.test)||void 0===T?void 0:T.icontrue),iteration:0,nodeStatus:t,slideStatus:e},n):null!==(A=i.test)&&void 0!==A&&null!==(A=A.iconfalse)&&void 0!==A&&A.path&&Ut(D,{source:It(null===(Q=i.test)||void 0===Q?void 0:Q.iconfalse),iteration:0,nodeStatus:t,slideStatus:e},n)}});break;case"matching":var x;null==i||null===(x=i.test)||void 0===x||null===(x=x.answer)||void 0===x||null===(x=x.matching)||void 0===x||x.forEach(w=>{let{id:S,key:R,value:J}=w;if(J){let Q=V.findNode(S);var B,z,T,A;R==J?null!==(B=i.test)&&void 0!==B&&null!==(B=B.icontrue)&&void 0!==B&&B.path&&Ut(Q,{source:It(null===(z=i.test)||void 0===z?void 0:z.icontrue),iteration:0,nodeStatus:t,slideStatus:e},n):null!==(T=i.test)&&void 0!==T&&null!==(T=T.iconfalse)&&void 0!==T&&T.path&&Ut(Q,{source:It(null===(A=i.test)||void 0===A?void 0:A.iconfalse),iteration:0,nodeStatus:t,slideStatus:e},n)}})}},nr=(i,t,e,n)=>{var r,l,a,o,s,d,c,f,h;null!==(r=t.animate)&&void 0!==r&&r.value&&((i,t,e)=>{var n;let{value:l}=null!==(n=i.animate)&&void 0!==n?n:{};Oe(i.id,{node:i,value:l,nodeStatus:t,slideStatus:e},()=>{})})(t,e.nodeStatus,e.slideStatus),null!==(l=t.interactive)&&void 0!==l&&l.show?(console.log(`node(${t.id}) | nodeStatus(${e.nodeStatus}) | slideStatus(${e.slideStatus}) | show`),((i,t,e,n)=>{var r,l,a;let o={total:0,counter:0},{triggershow:s,triggerrun:d,triggerhide:u,action:c,audio:h}=null!==(r=null===(l=i.interactive)||void 0===l?void 0:l.show)&&void 0!==r?r:{};if(console.log(`node(${i.id}) | nodeStatus(${t}) | slideStatus(${e}) | show`),s){let{id:v,ids:b,time:p,async:g}=s;"asynctrue"==g?setTimeout(()=>{Ne({id:v,ids:b,nodeStatus:t,slideStatus:e})}):"time"==g&&setTimeout(()=>{Ne({id:v,ids:b,nodeStatus:t,slideStatus:e})},1e3*(null!=p?p:0))}if(d){let{id:v,ids:b,time:p,async:g}=d;"asynctrue"==g?setTimeout(()=>{Ce({id:v,ids:b,nodeStatus:t,slideStatus:e})}):"time"==g&&setTimeout(()=>{Ce({id:v,ids:b,nodeStatus:t,slideStatus:e})},1e3*(null!=p?p:0))}if(u){let{id:v,ids:b,time:p,async:g}=u;"asynctrue"==g?setTimeout(()=>{Ae({id:v,ids:b,nodeStatus:t,slideStatus:e})}):"time"==g&&setTimeout(()=>{Ae({id:v,ids:b,nodeStatus:t,slideStatus:e})},1e3*(null!=p?p:0))}let f=()=>{setTimeout(()=>{if(o.counter>=o.total){if(n&&n(),s){let{id:v,ids:b,async:p}=s;(!p||"asyncfalse"==p)&&Ne({id:v,ids:b,nodeStatus:t,slideStatus:e})}if(d){let{id:v,ids:b,async:p}=d;(!p||"asyncfalse"==p)&&Ce({id:v,ids:b,nodeStatus:t,slideStatus:e})}if(u){let{id:v,ids:b,async:p}=u;(!p||"asyncfalse"==p)&&Ae({id:v,ids:b,nodeStatus:t,slideStatus:e})}}})};if(null!=c&&c.value){o.total+=1;let v=()=>{o.counter+=1,f()};switch(null==c?void 0:c.value){case"hide":jQuery("#"+i.id).addClass("hide"),v();break;case"points":{let{points:b,time:p,iteration:g,finish:O}=c;Oi(i.id,{node:i,points:b,time:p,iteration:g,finish:O,nodeStatus:t,slideStatus:e},v);break}default:{let{value:b,time:p,iteration:g,finish:O}=c;Zi(i.id,{node:i,value:b,time:p,iteration:g,finish:O,nodeStatus:t,slideStatus:e},v);break}}}if(null!=h&&null!==(a=h.source)&&void 0!==a&&a.path){o.total+=1;let v=()=>{o.counter+=1,f()},b=Ni(i.id,h,o,{nodeStatus:t,slideStatus:e},v);-1==(null==h?void 0:h.iteration)&&jQuery("#"+i.id).click(p=>{p.preventDefault(),b&&(b.volume=b.volume>=1?0:b.volume+.25),console.log(null==b?void 0:b.volume)})}o.total||f()})(t,e.nodeStatus,e.slideStatus,n)):n&&n(),null!==(a=t.interactive)&&void 0!==a&&a.click&&(f=null===(c=t.interactive)||void 0===c?void 0:c.click,Object.keys(null!=f?f:{}).map(b=>f[b]?1:0).includes(1)&&jQuery("#"+t.id).addClass("interactive-click"),jQuery("#"+t.id).click(f=>{f.preventDefault(),e.nodeStatus=V.refreshNodeStatus(),console.log(`node(${t.id}) | nodeStatus(${e.nodeStatus}) | slideStatus(${e.slideStatus}) | click`),Ye(t,e.nodeStatus,e.slideStatus)})),null!==(o=t.variable)&&void 0!==o&&o.input&&jQuery("#"+t.id).on("change","input,textarea",f=>{f.preventDefault(),((i,t,e)=>{var n,r;y.variable.setValue(null!==(n=null===(r=t.variable)||void 0===r||null===(r=r.input)||void 0===r?void 0:r.variable)&&void 0!==n?n:"",i),(i=>{var t;let e=(n,r)=>{null==n||n.forEach(l=>{switch(l.type){case F.GROUP:Pe(l.id,{},r?window.document.getElementById(r):null),e(l.nodes,l.id);break;case F.POLYGON:break;case F.TEXT:Je(l.id,{size:l.size,attribute:l.attribute,source:l.source},r?window.document.getElementById(r):null)}})};e(null===(t=i.svg)||void 0===t?void 0:t.nodes)})(e)})(f.target.value,t,i)}),null!==(s=t.variable)&&void 0!==s&&s.click&&(null!==(h=t.variable)&&void 0!==h&&null!==(h=h.click)&&void 0!==h&&h.variable&&jQuery("#"+t.id).addClass("variable-click"),jQuery("#"+t.id).click(f=>{f.preventDefault(),((i,t)=>{var e;y.variable.setValueOperator(null===(e=i.variable)||void 0===e?void 0:e.click),(i=>{var t;let e=(n,r)=>{null==n||n.forEach(l=>{switch(l.type){case F.GROUP:Pe(l.id,{},r?window.document.getElementById(r):null),e(l.nodes,l.id);break;case F.POLYGON:break;case F.TEXT:Je(l.id,{size:l.size,attribute:l.attribute,source:l.source},r?window.document.getElementById(r):null)}})};e(null===(t=i.svg)||void 0===t?void 0:t.nodes)})(t)})(t,i)})),"test"==(null===(d=t.source)||void 0===d?void 0:d.type)&&((i,t)=>{var e;let n=()=>{};switch(null===(e=i.source)||void 0===e||null===(e=e.test)||void 0===e?void 0:e.type){case"truefalse":{jQuery("#"+i.id).click(a=>{a.preventDefault(),((i,t,e,n,r)=>{var l,a;let o=null===(l=i.source)||void 0===l||null===(l=l.test)||void 0===l||null===(l=l.truefalse)||void 0===l?void 0:l.iscorrect;t.test?t.test.answer?t.test.answer.truefalse={value:i.id,iscorrect:o}:t.test.answer={truefalse:{value:i.id,iscorrect:o}}:t.test={answer:{truefalse:{value:i.id,iscorrect:o}}},null!==(a=t.svg)&&void 0!==a&&a.nodes.find(d=>{var u;return"submit"==(null===(u=d.source)||void 0===u||null===(u=u.test)||void 0===u?void 0:u.type)})||Me(i,t,e,n,{iscorrect:o},r);let s=N(rt.TEST_GROUP,"g",void 0,y.target);ct(s,t,i)})(i,t,V.nodeStatus,V.slideStatus,n)});let l=N(rt.TEST_GROUP,"g",void 0,y.target);ct(l,t,i);break}case"singlechoice":{jQuery("#"+i.id).click(a=>{a.preventDefault(),((i,t,e,n,r)=>{var l,a;let o=null===(l=i.source)||void 0===l||null===(l=l.test)||void 0===l||null===(l=l.singlechoice)||void 0===l?void 0:l.iscorrect;t.test?t.test.answer?t.test.answer.singlechoice={value:i.id,iscorrect:o}:t.test.answer={singlechoice:{value:i.id,iscorrect:o}}:t.test={answer:{singlechoice:{value:i.id,iscorrect:o}}},null!==(a=t.svg)&&void 0!==a&&a.nodes.find(d=>{var u;return"submit"==(null===(u=d.source)||void 0===u||null===(u=u.test)||void 0===u?void 0:u.type)})||Me(i,t,e,n,{iscorrect:o},r);let s=N(rt.TEST_GROUP,"g",void 0,y.target);ct(s,t,i)})(i,t,V.nodeStatus,V.slideStatus,n)});let l=N(rt.TEST_GROUP,"g",void 0,y.target);ct(l,t,i);break}case"multichoice":{jQuery("#"+i.id).click(a=>{a.preventDefault(),((i,t,e,n,r)=>{var l,a;let o=null===(l=i.source)||void 0===l||null===(l=l.test)||void 0===l||null===(l=l.multichoice)||void 0===l?void 0:l.iscorrect;t.test?t.test.answer?t.test.answer.multichoice?t.test.answer.multichoice.find(d=>d.value==i.id)?t.test.answer.multichoice=t.test.answer.multichoice.filter(d=>d.value!=i.id):t.test.answer.multichoice.push({value:i.id,iscorrect:o}):t.test.answer.multichoice=[{value:i.id,iscorrect:o}]:t.test.answer={multichoice:[{value:i.id,iscorrect:o}]}:t.test={answer:{multichoice:[{value:i.id,iscorrect:o}]}},null!==(a=t.svg)&&void 0!==a&&a.nodes.find(d=>{var u;return"submit"==(null===(u=d.source)||void 0===u||null===(u=u.test)||void 0===u?void 0:u.type)})||Me(i,t,e,n,{iscorrect:o},r);let s=N(rt.TEST_GROUP,"g",void 0,y.target);ct(s,t,i)})(i,t,V.nodeStatus,V.slideStatus,n)});let l=N(rt.TEST_GROUP,"g",void 0,y.target);ct(l,t,i);break}case"fill":{var r;jQuery("#"+i.id).on("keyup",'input[type="text"]',a=>{var o;let s=jQuery("<div/>").css({"font-size":jQuery(a.target).css("font-size"),visibility:"hidden",float:"left"}).text(a.target.value).appendTo(window.document.body);jQuery(a.target).css({width:(null!==(o=s.width())&&void 0!==o?o:0)+30})}).on("keypress",'input[type="text"]',a=>{13===(a.keyCode||a.charCode||a.which)&&(a.preventDefault(),a.stopPropagation(),jQuery(a.target).blur())}).on("change",'input[type="text"]',a=>{var o,s;let d=null===(o=a.target)||void 0===o?void 0:o.getAttribute("data-key"),u=null===(s=a.target)||void 0===s||null===(s=s.value)||void 0===s?void 0:s.trim();jQuery("#"+i.id).find(`input[type="text"][data-key="${d}"]`).val(u),((i,t,e,n,r,l)=>{var a,o,s,d;let{value:u}=null!==(a=null===(o=i.source)||void 0===o||null===(o=o.test)||void 0===o||null===(o=o.fill)||void 0===o?void 0:o.find(f=>f.key==`[[${r.key}]]`))&&void 0!==a?a:{},c=u&&u.map(f=>null==f?void 0:f.toLocaleLowerCase()).includes(null===(s=r.value)||void 0===s?void 0:s.toLocaleLowerCase());r.iscorrect=c,t.test?t.test.answer?t.test.answer.fill?t.test.answer.fill.find(f=>f.key==r.key)?t.test.answer.fill.filter(f=>f.key==r.key).forEach(f=>{f.value=r.value,f.iscorrect=r.iscorrect}):t.test.answer.fill.push(r):t.test.answer.fill=[r]:t.test.answer={fill:[r]}:t.test={answer:{fill:[r]}};let h=N(rt.TEST_GROUP,"g",void 0,y.target);ct(h,t,i),null!==(d=t.svg)&&void 0!==d&&d.nodes.find(f=>{var v;return"submit"==(null===(v=f.source)||void 0===v||null===(v=v.test)||void 0===v?void 0:v.type)})||Me(i,t,e,n,{iscorrect:c},l)})(i,t,V.nodeStatus,V.slideStatus,{id:i.id,key:d,value:u},n)}),null!==(r=t.test)&&void 0!==r&&r.showselection||jQuery("#"+i.id).addClass("hide-selection");let l=N(rt.TEST_GROUP,"g",void 0,y.target);ct(l,t,i);break}case"matching-empty":{jQuery("#"+i.id).on("touchmove",".ondrag-item",function(a){a.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(a){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${i.size.height/i.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${a.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(a){var o;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(o=t.test)&&void 0!==o&&o.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection"),an(i,t)},drag:function(a){},dragend:function(a){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${i.id} .ondrop-here`).kendoDropTarget({dragenter:function(a){a.dropTarget.hasClass("actived")&&a.dropTarget.addClass("focused")},dragleave:function(a){a.dropTarget.hasClass("actived")&&a.dropTarget.removeClass("focused")},drop:function(a){if(!a.dropTarget.hasClass("actived"))return;a.dropTarget.removeClass("focused");let o=a.dropTarget,s=a.draggable.currentTarget;o.is(":empty")||o.find(".ondrag-item").appendTo($('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').first()),s.appendTo(o);let d=N(rt.TEST_GROUP,"g",void 0,y.target);ct(d,t,i),((i,t,e,n,r,l)=>{var a,o,s;let{key:d}=null!==(a=null===(o=i.source)||void 0===o||null===(o=o.test)||void 0===o?void 0:o.matching)&&void 0!==a?a:{key:"KIEN"},u=r.key==d;an(i,t);let c={id:i.id,key:null!=d?d:"",value:r.key};t.test?t.test.answer?t.test.answer.matching?t.test.answer.matching.find(h=>h.id==c.id)?t.test.answer.matching.filter(h=>h.id==c.id).forEach(h=>{h.key=c.key,h.value=c.value}):t.test.answer.matching.push(c):t.test.answer.matching=[c]:t.test.answer={matching:[c]}:t.test={answer:{matching:[c]}},null!==(s=t.svg)&&void 0!==s&&s.nodes.find(h=>{var f;return"submit"==(null===(f=h.source)||void 0===f||null===(f=f.test)||void 0===f?void 0:f.type)})||Me(i,t,e,n,{iscorrect:u},l)})(i,t,V.nodeStatus,V.slideStatus,{key:s.data("key")},n)}});let l=N(rt.TEST_GROUP,"g",void 0,y.target);ct(l,t,i);break}case"matching-content":{jQuery("#"+i.id).on("touchmove",".ondrag-item",function(a){a.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(a){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${i.size.height/i.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${a.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(a){var o;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(o=t.test)&&void 0!==o&&o.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(a){},dragend:function(a){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${i.id} .ondrop-here`).kendoDropTarget({dragenter:function(a){a.dropTarget.hasClass("actived")&&a.dropTarget.addClass("focused")},dragleave:function(a){a.dropTarget.hasClass("actived")&&a.dropTarget.removeClass("focused")},drop:function(a){if(!a.dropTarget.hasClass("actived"))return;a.dropTarget.removeClass("focused");let o=N(rt.TEST_GROUP,"g",void 0,y.target);ct(o,t,i),a.draggable.currentTarget.appendTo(a.dropTarget),on(t,V.nodeStatus,V.slideStatus,n)}});let l=N(rt.TEST_GROUP,"g",void 0,y.target);ct(l,t,i);break}case"speech":break;case"submit":jQuery("#"+i.id).click(l=>{l.preventDefault(),((i,t,e,n,r)=>{var l,a,o,s,d;let u;var c;if(null!=t&&null!==(l=t.test)&&void 0!==l&&null!==(l=l.answer)&&void 0!==l&&l.truefalse)u=null==t||null===(c=t.test)||void 0===c||null===(c=c.answer)||void 0===c||null===(c=c.truefalse)||void 0===c?void 0:c.iscorrect;else if(null!=t&&null!==(a=t.test)&&void 0!==a&&null!==(a=a.answer)&&void 0!==a&&a.singlechoice){var h;u=null==t||null===(h=t.test)||void 0===h||null===(h=h.answer)||void 0===h||null===(h=h.singlechoice)||void 0===h?void 0:h.iscorrect}else if(null!=t&&null!==(o=t.test)&&void 0!==o&&null!==(o=o.answer)&&void 0!==o&&o.multichoice){var f,v,b;u=1==[null==t||null===(f=t.test)||void 0===f||null===(f=f.answer)||void 0===f||null===(f=f.multichoice)||void 0===f?void 0:f.length,null==t||null===(v=t.test)||void 0===v||null===(v=v.answer)||void 0===v||null===(v=v.multichoice)||void 0===v||null===(v=v.map(w=>w.iscorrect?1:0))||void 0===v?void 0:v.reduce((w,S)=>w+S),null==t||null===(b=t.svg)||void 0===b||null===(b=b.nodes)||void 0===b||null===(b=b.filter(w=>{var S,R;return"multichoice"==(null===(S=w.source)||void 0===S||null===(S=S.test)||void 0===S?void 0:S.type)&&(null===(R=w.source)||void 0===R||null===(R=R.test)||void 0===R||null===(R=R.multichoice)||void 0===R?void 0:R.iscorrect)}))||void 0===b?void 0:b.length].filter((w,S,R)=>R.indexOf(w)==S).length}else if(null!=t&&null!==(s=t.test)&&void 0!==s&&null!==(s=s.answer)&&void 0!==s&&s.fill){var p,g;u=(null==t||null===(p=t.test)||void 0===p||null===(p=p.answer)||void 0===p||null===(p=p.fill)||void 0===p||null===(p=p.map(w=>w.iscorrect?1:0))||void 0===p?void 0:p.reduce((w,S)=>w+S))==(null===(g=t.svg)||void 0===g||null===(g=g.nodes)||void 0===g||null===(g=g.filter(w=>{var S;return"fill"==(null===(S=w.source)||void 0===S||null===(S=S.test)||void 0===S?void 0:S.type)}))||void 0===g?void 0:g.length)}else if(null!=t&&null!==(d=t.test)&&void 0!==d&&null!==(d=d.answer)&&void 0!==d&&d.matching){var O,x;u=(null===(O=t.svg)||void 0===O||null===(O=O.nodes)||void 0===O||null===(O=O.filter(w=>{var S;return"matching-empty"==(null===(S=w.source)||void 0===S||null===(S=S.test)||void 0===S?void 0:S.type)}))||void 0===O?void 0:O.length)==((null==t||null===(x=t.test)||void 0===x||null===(x=x.answer)||void 0===x?void 0:x.matching)||[]).map(w=>w.key==w.value?1:0).reduce((w,S)=>w+S)}Me(i,t,e,n,{iscorrect:u},r)})(i,t,V.nodeStatus,V.slideStatus,n)})}})(t,i)},Ci=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:y.attribute.fill,stroke:y.attribute.stroke,strokeWidth:y.attribute.strokeWidth};return{nodeId:i,element:qt(i,F.ELLIPSE,"ellipse",{size:n,attribute:r},e),size:n,attribute:r}},Ai=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{stroke:y.attribute.stroke,strokeWidth:y.attribute.strokeWidth,strokeLinecap:y.attribute.strokeLinecap};return{nodeId:i,element:qt(i,F.LINE,"line",{size:n,attribute:r},e),size:n,attribute:r}},Ji=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:y.attribute.fill,stroke:y.attribute.stroke,strokeWidth:y.attribute.strokeWidth};return{nodeId:i,element:qt(i,F.POLYGON,"polygon",{size:n,attribute:r},e),size:n,attribute:r}},de=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:320,height:80},r=(null==t?void 0:t.attribute)||{},l=(null==t?void 0:t.source)||{type:"html",html:{htmlContent:""}},a=(null==t?void 0:t.style)||{};return{nodeId:i,element:qt(i,F.FOREIGNOBJECT,"foreignObject",{size:n,attribute:r,style:a,source:l},e),size:n,attribute:r,style:a,source:l}},_e=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{stroke:y.attribute.stroke,strokeWidth:y.attribute.strokeWidth};return{nodeId:i,element:qt(i,F.PATH,"path",{size:n,attribute:r},e),size:n,attribute:r}},sn=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:y.attribute.fill,stroke:y.attribute.stroke,strokeWidth:y.attribute.strokeWidth};return{nodeId:i,element:qt(i,F.POLYLINE,"polyline",{size:n,attribute:r},e),size:n,attribute:r}},Ri=(i,t,e)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:320,height:80},r=(null==t?void 0:t.attribute)||{fill:y.attribute.stroke,fontFamily:y.attribute.fontFamily,fontSize:y.attribute.fontSize,textLength:y.attribute.textLength},l=(null==t?void 0:t.source)||{type:"text",text:{textContent:""}};return{nodeId:i,element:qt(i,F.TSPAN,"tspan",{size:n,attribute:r,source:l},e),size:n,attribute:r,source:l}},si=(i,t,e)=>{if(e.slideStatus!=V.slideStatus||!t.length)return;let n=t.shift(),r=i.filter(s=>{var d;return(null!==(d=s.idx)&&void 0!==d?d:0)==n});if(!r.length)return;let l=Math.max.apply(null,r.map(s=>{var d;return null!==(d=s.time)&&void 0!==d?d:0})),a=!1,o=l<.5?0:setTimeout(()=>{a||(a=!0,si(i,t,e))},1e3*l);Re(i,t,r,0,e,{idx:n,total:r.length,counter:0,isRecursive:a,timeoutRecursive:o,maxTimeCoundown:l,uid:Math.floor(1e9*Math.random())})},Re=(i,t,e,n,r,l)=>{if(r.slideStatus!=V.slideStatus)return;let a=e[n];if(a){switch(a.type){case F.GROUP:break;case F.CIRCLE:ke(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case F.ELLIPSE:Ci(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case F.LINE:Ai(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case F.RECT:ye(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case F.POLYGON:Ji(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case F.POLYLINE:sn(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null);break;case F.FOREIGNOBJECT:de(a.id,{size:a.size,attribute:a.attribute,style:a.style,source:a.source},a.pid?window.document.getElementById(a.pid):null);break;case F.IMAGE:Se(a.id,{size:a.size,attribute:a.attribute,source:a.source},a.pid?window.document.getElementById(a.pid):null);break;case F.TEXT:Je(a.id,{size:a.size,attribute:a.attribute,source:a.source},a.pid?window.document.getElementById(a.pid):null);break;case F.TSPAN:Ri(a.id,{size:a.size,attribute:a.attribute,source:a.source},a.pid?window.document.getElementById(a.pid):null);break;case F.PATH:_e(a.id,{size:a.size,attribute:a.attribute},a.pid?window.document.getElementById(a.pid):null)}nr(r.slide,a,r,()=>{l.counter+=1,l.maxTimeCoundown<.5&&l.counter>=l.total&&(l.total=l.counter=0,l.isRecursive||(clearTimeout(l.timeoutRecursive),l.isRecursive=!0,setTimeout(()=>{si(i,t,r)},250)))}),Re(i,t,e,++n,r,l)}},V=new class rr{constructor(){this._nodeStatus=0,this._slideStatus=0,this._slideIdx=0,this._fnChangeSlides=[]}set data(t){this._dataSource=t.data||{},y.variable.set=t.variable||{}}get nodeStatus(){return this._nodeStatus}refreshNodeStatus(){return this._nodeStatus=Math.floor(999999999*Math.random()),this._nodeStatus}get slideStatus(){return this._slideStatus}refreshSlideStatus(){return this._slideStatus=Math.floor(999999999*Math.random()),this._slideStatus}get slideIdx(){return this._slideIdx}get slideTotal(){var t,e;return null!==(t=null===(e=this._dataSource)||void 0===e||null===(e=e.slides)||void 0===e?void 0:e.length)&&void 0!==t?t:0}get slides(){var t;return(null===(t=this._dataSource)||void 0===t?void 0:t.slides)||[]}get slide(){var t;return((null===(t=this._dataSource)||void 0===t?void 0:t.slides)||[])[this._slideIdx]||{}}findNode(t){var e;let n=null===(e=this._dataSource)||void 0===e||null===(e=e.slides)||void 0===e?void 0:e.find((h,f)=>f==this._slideIdx),r=null==n?void 0:n.svg,l=(h,f)=>{let v=null==h?void 0:h.find(g=>g.id==t);if(v)return v;let b=0,p=h.length||0;for(;b<p&&!v&&(v=l(h[b].nodes||[],h[b].id),!v);)b++;return v},a=l((null==r?void 0:r.nodes)||[]);var o,s,d,u,c;return a?(a.style=null!==(o=a.style)&&void 0!==o?o:{},a.source=null!==(s=a.source)&&void 0!==s?s:{},a.animate=null!==(d=a.animate)&&void 0!==d?d:{},a.interactive=null!==(u=a.interactive)&&void 0!==u?u:{},a.variable=null!==(c=a.variable)&&void 0!==c?c:{},a):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}runSlide(t,e,n){var r;let l;var a,o;if(this.refreshNodeStatus(),this.refreshSlideStatus(),n)l=null===(a=this._dataSource)||void 0===a||null===(a=a.slides)||void 0===a?void 0:a.find(c=>c.code==n||c.id==n),l&&(this._slideIdx=(null===(o=this._dataSource)||void 0===o||null===(o=o.slides)||void 0===o?void 0:o.indexOf(l))||0);else if(e){var s,d;l=null===(s=this._dataSource)||void 0===s||null===(s=s.slides)||void 0===s?void 0:s.find(c=>c.id==e),l&&(this._slideIdx=(null===(d=this._dataSource)||void 0===d||null===(d=d.slides)||void 0===d?void 0:d.indexOf(l))||0)}else this._slideIdx=Math.min(Math.max(t||0,0),this.slideTotal-1),l=this.slide;if(l){var u;di(y.container,y.svg,l,!0),null===(u=jQuery(y.svg).find("#"+rt.BACKGROUND_GROUP))||void 0===u||u.empty();let c=N(rt.BACKGROUND_GROUP,"g",void 0,y.svg);st(c,l),(i=>{var t,e,n,r;i.test&&(i.test.answer=void 0);let l=V.nodeStatus,a=V.slideStatus;null===(t=i.svg)||void 0===t||t.nodes.forEach(s=>{s.pid=Math.ceil(1e9*Math.random()),Pe(s.pid)});let o=null===(e=i.svg)||void 0===e||null===(e=e.nodes)||void 0===e?void 0:e.map(s=>{var d;return null!==(d=s.idx)&&void 0!==d?d:0}).filter((s,d,u)=>u.indexOf(s)==d).sort((s,d)=>(null!=s?s:0)-(null!=d?d:0));si(null!==(n=null===(r=i.svg)||void 0===r?void 0:r.nodes)&&void 0!==n?n:[],null!=o?o:[],{slide:i,nodeStatus:l,slideStatus:a})})(l)}this.changeSlide(this.slides,null===(r=this.slide)||void 0===r?void 0:r.id,this.slideIdx,this.slides.length,l)}set onChangeSlide(t){this._fnChangeSlides.push(t)}changeSlide(t,e,n,r,l){this._fnChangeSlides.forEach(a=>a(t,e,n,r,l))}},di=(i,t,e,n)=>{var r,l,a,o;let s=window.document.querySelector(t);var d;s||(s=document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(d=window.document.querySelector(i))||void 0===d||d.appendChild(s)),n&&(s.textContent=null);let{x:u,y:c,width:h,height:f}=null!==(r=null==e||null===(l=e.svg)||void 0===l?void 0:l.viewBox)&&void 0!==r?r:y.screen.frameSize;s.setAttributeNS(null,"viewBox",u+" "+c+" "+h+" "+f),s.setAttribute("id",t.replace("#",""));var O,x,v=null!==(a=jQuery(i).width())&&void 0!==a?a:1080,b=null!==(o=jQuery(i).height())&&void 0!==o?o:1080,g=h/f;g>=v/b?x=(O=v)/g:O=(x=b)*g,s.setAttributeNS(null,"width",O.toString()),s.setAttributeNS(null,"height",x.toString())};class lr{constructor(t,e){let n=window.document.querySelector(e);var r;n||(n=window.document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(r=window.document.querySelector(t))||void 0===r||r.appendChild(n));let{svgViewBox:l,svgSize:a}=y.screen.init();n.setAttributeNS(null,"viewBox",`${l.x} ${l.y} ${l.width} ${l.height}`),n.setAttribute("id",e.replace("#","")),n.style.display="block",n.style.width=`${a.width}px`,n.style.height=`${a.height}px`,n.style.backgroundColor="#fafafa",n.style.cursor="default"}}const ui=i=>{jQuery(y.target).find("#"+rt.BACKGROUND_GROUP).empty();let t=N(rt.BACKGROUND_GROUP,"g",void 0,y.target);st(t,i),(()=>{let e=window.document.getElementById(null==i?void 0:i.id);jQuery(e).find("#"+rt.BACKGROUND_GROUP).empty();let n=N(rt.BACKGROUND_GROUP,"g",void 0,e);st(n,i)})()},ci=()=>{jQuery(y.target).find(">*:not(defs)").remove()},qt=(i,t,e,n,r)=>{let l;if(!e)switch(t){case F.GROUP:e="g";break;case F.CIRCLE:e="circle";break;case F.ELLIPSE:e="ellipse";break;case F.LINE:e="line";break;case F.RECT:e="rect";break;case F.POLYGON:e="polygon";break;case F.POLYLINE:e="polyline";break;case F.PATH:e="path";break;case F.FOREIGNOBJECT:e="foreignObject";break;case F.IMAGE:e="image";break;case F.TEXT:e="text";break;case F.TSPAN:e="tspan"}if(t&&null!=n&&n.size&&null!=n&&n.attribute&&Object.assign(n.attribute,at(t,n.size,n.attribute)),i)if(l=jQuery(r||y.target).find("#"+i).get(0),l){if(l.nodeName!=e){let a=window.document.createElementNS("http://www.w3.org/2000/svg",e);a.setAttribute("id",i),t==F.FOREIGNOBJECT&&a.setAttribute("xmlns:html","http://www.w3.org/1999/xhtml"),jQuery(l).replaceWith(a),l=a}}else l=window.document.createElementNS("http://www.w3.org/2000/svg",e),l.setAttribute("id",i),t==F.FOREIGNOBJECT&&l.setAttribute("xmlns:html","http://www.w3.org/1999/xhtml"),jQuery(l).appendTo(r||y.target);else l=window.document.createElementNS("http://www.w3.org/2000/svg",e),jQuery(l).appendTo(r||y.target);return null!=n&&n.attribute&&m(l,null==n?void 0:n.attribute),null!=n&&n.style&&_(l,null==n?void 0:n.style),null!=n&&n.source&&k(l,t,null==n?void 0:n.source,i),l},m=(i,t)=>{return jQuery(i).attr((e=Object.assign({},t||{}),null===(n=Object.keys(e))||void 0===n||n.forEach(a=>{switch(a){case"fill":break;case"fillRule":var o;Object.assign(e,{"fill-rule":null!==(o=e.fillRule)&&void 0!==o?o:null,fillRule:null});break;case"stroke":var s;Object.assign(e,{"stroke-width":null!==(s=e.strokeWidth)&&void 0!==s?s:null,strokeWidth:null});break;case"strokeLinecap":var d;Object.assign(e,{"stroke-linecap":null!==(d=e.strokeLinecap)&&void 0!==d?d:null,strokeLinecap:null});break;case"strokeLinejoin":var u;Object.assign(e,{"stroke-linejoin":null!==(u=e.strokeLinejoin)&&void 0!==u?u:null,strokeLinejoin:null});break;case"strokeMiterlimit":var c;Object.assign(e,{"stroke-miterlimit":null!==(c=e.strokeMiterlimit)&&void 0!==c?c:null,strokeMiterlimit:null});break;case"strokeDasharray":var h;Object.assign(e,{"stroke-dasharray":null!==(h=e.strokeDasharray)&&void 0!==h?h:null,strokeDasharray:null});break;case"strokeDasharrays":var f,v;Object.assign(e,{"stroke-dasharray":null!==(f=null===(v=e.strokeDasharrays)||void 0===v?void 0:v.join(" "))&&void 0!==f?f:null,strokeDasharrays:null});break;case"fontFamily":var b;Object.assign(e,{"font-family":null!==(b=e.fontFamily)&&void 0!==b?b:null,fontFamily:null});break;case"fontWeight":var p;Object.assign(e,{"font-weight":null!==(p=e.fontWeight)&&void 0!==p?p:null,fontWeight:null});break;case"fontStyle":var g;Object.assign(e,{"font-style":null!==(g=e.fontStyle)&&void 0!==g?g:null,fontStyle:null});break;case"fontSize":var O;Object.assign(e,{"font-size":null!==(O=e.fontSize)&&void 0!==O?O:null,fontSize:null});break;case"textLength":Object.assign(e,{textLength:e.textLength?`${e.textLength}px`:null});break;case"letterSpacing":var x;Object.assign(e,{"letter-spacing":null!==(x=e.letterSpacing)&&void 0!==x?x:null,letterSpacing:null});break;case"wordSpacing":var w;Object.assign(e,{"word-spacing":null!==(w=e.wordSpacing)&&void 0!==w?w:null,wordSpacing:null});break;case"alignmentBaseline":var S;Object.assign(e,{"alignment-baseline":null!==(S=e.alignmentBaseline)&&void 0!==S?S:null,alignmentBaseline:null});break;case"dominantBaseline":var R;Object.assign(e,{"dominant-baseline":null!==(R=e.dominantBaseline)&&void 0!==R?R:null,dominantBaseline:null});break;case"textAnchor":var J;Object.assign(e,{"text-anchor":null!==(J=e.textAnchor)&&void 0!==J?J:null,textAnchor:null});break;case"textDecoration":var B;Object.assign(e,{"text-decoration":null!==(B=e.textDecoration)&&void 0!==B?B:null,textDecoration:null});break;case"transformOrigin":var z;Object.assign(e,{"transform-origin":null!==(z=e.transformOrigin)&&void 0!==z?z:null,transformOrigin:null})}}),Object.assign({},null!=e?e:{},{fill:null!=e&&e.fill?Yt(e.fill,null!==(r=null==e?void 0:e.fillOpacity)&&void 0!==r?r:1):"rgba(0,0,0,0)",fillOpacity:null,stroke:null!=e&&e.stroke?Yt(e.stroke,null!==(l=null==e?void 0:e.strokeOpacity)&&void 0!==l?l:1):"rgba(0,0,0,0)",strokeOpacity:null}))),i;var e,n,r,l},_=(i,t)=>{return jQuery(i).css((e=Object.assign({},t||{}),null===(n=Object.keys(e))||void 0===n||n.forEach(r=>{switch(r){case"padding":Object.assign(e,{padding:e.padding?`${e.padding}px`:null});break;case"borderWidth":var l;Object.assign(e,e.borderWidth&&e.borderColor?{"border-width":`${e.borderWidth}px`,"border-style":e.borderStyle||"solid","border-color":Yt(e.borderColor,null!==(l=e.borderOpacity)&&void 0!==l?l:1)}:{"border-width":"","border-style":"","border-color":""}),Object.assign(e,{borderWidth:null,borderStyle:null,borderColor:null,borderOpacity:null});break;case"borderRadius":Object.assign(e,{"border-radius":e.borderRadius?`${e.borderRadius}px`:null,borderRadius:null});break;case"backgroundColor":var a;Object.assign(e,e.backgroundColor?{"background-color":Yt(e.backgroundColor,null!==(a=e.backgroundOpacity)&&void 0!==a?a:1)}:{"background-color":""}),Object.assign(e,{backgroundColor:null,backgroundOpacity:null})}}),e)),i;var e,n},k=(i,t,e,n)=>{switch(t){case F.TEXT:{var r;let gt=n==y.dataSelect.contenteditable_id,Tt=(null==e||null===(r=e.text)||void 0===r?void 0:r.textContent)||"H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!";var l,a;if(!gt&&null!=e&&null!==(l=e.text)&&void 0!==l&&l.variableKeywords&&null!=e&&null!==(a=e.text)&&void 0!==a&&a.variableKeywords.length){let ge=y.variable.getKeys();e.text.variableKeywords.forEach(Mt=>{var Ht=Mt.replace(/[^a-zA-Z0-9_]/gm,"");if(ge.indexOf(Ht)>=0){var ee=y.variable.getValue(Ht);Tt=Tt.replace(Mt,ee)}})}gt?jQuery(i).attr("editable",`${gt}`).html(`<div contenteditable="${gt}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${Tt}</div>`):jQuery(i).attr("editable",`${gt}`).text(Tt);break}case F.TSPAN:var o,s;jQuery(i).text(null!==(o=null==e||null===(s=e.text)||void 0===s?void 0:s.textContent)&&void 0!==o?o:"");break;case F.IMAGE:var d,u,c,h,f;jQuery(i).attr("href",(null==e||null===(d=e.image)||void 0===d?void 0:d.base64)||(null!=e&&null!==(u=e.image)&&void 0!==u&&u.path?(null===(c=y.config)||void 0===c?void 0:c.readfileuploadurl)+(null==e||null===(h=e.image)||void 0===h?void 0:h.path):null==e||null===(f=e.image)||void 0===f?void 0:f.url)||"");break;case F.FOREIGNOBJECT:switch(null==e?void 0:e.type){case"text":{var v;let gt=n==y.dataSelect.contenteditable_id,Tt=(null===(v=e.text)||void 0===v?void 0:v.textContent)||"H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!";var b,p;if(!gt&&null!==(b=e.text)&&void 0!==b&&b.variableKeywords&&null!==(p=e.text)&&void 0!==p&&p.variableKeywords.length){let ge=y.variable.getKeys();e.text.variableKeywords.forEach(Mt=>{var Ht=Mt.replace(/[^a-zA-Z0-9_]/gm,"");if(ge.indexOf(Ht)>=0){var ee=y.variable.getValue(Ht);Tt=Tt.replace(Mt,ee)}})}gt?jQuery(i).attr("editable",`${gt}`).html(`<div contenteditable="${gt}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${Tt}</div>`):jQuery(i).attr("editable",`${gt}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${Tt}</div>`);break}case"html":{var g;let gt=n==y.dataSelect.contenteditable_id,Tt=(null==e||null===(g=e.html)||void 0===g?void 0:g.htmlContent)||'<span style="font-family: Roboto; font-size: 24px;">H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!</span>';var O,x;if(!gt&&null!==(O=e.html)&&void 0!==O&&O.variableKeywords&&null!==(x=e.html)&&void 0!==x&&x.variableKeywords.length){let ge=y.variable.getKeys();e.html.variableKeywords.forEach(Mt=>{var Ht=Mt.replace(/[^a-zA-Z0-9_]/gm,"");if(ge.indexOf(Ht)>=0){var ee=y.variable.getValue(Ht);Tt=Tt.replace(Mt,ee)}})}jQuery(i).attr("editable",`${gt}`).html(`<div contenteditable="${gt}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${Tt}</div>`).find("img[path],video[path],iframe[path]").each((ge,Mt)=>{var Ht,ee;Mt.setAttribute("src",(null!==(Ht=null===(ee=y.config)||void 0===ee?void 0:ee.readfileuploadurl)&&void 0!==Ht?Ht:"")+Mt.getAttribute("path")),Mt.removeAttribute("path")});break}case"input":var w,S,R,J;if(null!==(w=e.input)&&void 0!==w&&w.input)jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><input type="text" placeholder="${null!==(R=null===(J=e.input)||void 0===J?void 0:J.placeholder)&&void 0!==R?R:""}" maxlength="100" /></div>`);else if(null!==(S=e.input)&&void 0!==S&&S.textarea){var B,z;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><textarea placeholder="${null!==(B=null===(z=e.input)||void 0===z?void 0:z.placeholder)&&void 0!==B?B:""}" maxlength="1000"></textarea></div>`)}break;case"image":var T,A,Q,D,E;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><img src="${(null===(T=e.image)||void 0===T?void 0:T.base64)||(null!==(A=e.image)&&void 0!==A&&A.path?(null===(Q=y.config)||void 0===Q?void 0:Q.readfileuploadurl)+(null===(D=e.image)||void 0===D?void 0:D.path):null===(E=e.image)||void 0===E?void 0:E.url)||""}" style="width:100%;height:100%;display:block;"/></div>`);break;case"iframe":var P,L,M,K;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${(null!==(P=e.iframe)&&void 0!==P&&P.path?(null===(L=y.config)||void 0===L?void 0:L.readfileuploadurl)+(null===(M=e.iframe)||void 0===M?void 0:M.path):null===(K=e.iframe)||void 0===K?void 0:K.url)||""}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break;case"embed":{var W,tt,Z,X,dt;let gt=ae({readfileuploadurl:null===(W=y.config)||void 0===W?void 0:W.readfileuploadurl,type:null===(tt=e.embed)||void 0===tt?void 0:tt.type,oss:null===(Z=e.embed)||void 0===Z?void 0:Z.oss,path:null===(X=e.embed)||void 0===X?void 0:X.path,url:null===(dt=e.embed)||void 0===dt?void 0:dt.url});jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${gt}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break}case"svg":var ft,xt;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${null!==(ft=null===(xt=e.svg)||void 0===xt?void 0:xt.svgContent)&&void 0!==ft?ft:""}</div>`);break;case"test":{var Nt,yt;let gt=n==y.dataSelect.contenteditable_id,Tt=(null==e||null===(Nt=e.html)||void 0===Nt?void 0:Nt.htmlContent)||"";var At,Kt;if(!gt&&null!==(At=e.html)&&void 0!==At&&At.variableKeywords&&null!==(Kt=e.html)&&void 0!==Kt&&Kt.variableKeywords.length){let ge=y.variable.getKeys();e.html.variableKeywords.forEach(Mt=>{var Ht=Mt.replace(/[^a-zA-Z0-9_]/gm,"");if(ge.indexOf(Ht)>=0){var ee=y.variable.getValue(Ht);Tt=Tt.replace(Mt,ee)}})}switch(null==e||null===(yt=e.test)||void 0===yt?void 0:yt.type){case"truefalse":var Pt;gt?jQuery(i).attr("editable",`${gt}`).html(`<div contenteditable="${gt}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${Tt}</div>`):jQuery(i).attr("editable",`${gt}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==e?void 0:e.test.type}" data-correct="${null!=e&&null!==(Pt=e.test.truefalse)&&void 0!==Pt&&Pt.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${Tt}</div></div></div>`);break;case"singlechoice":var he;gt?jQuery(i).attr("editable",`${gt}`).html(`<div contenteditable="${gt}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${Tt}</div>`):jQuery(i).attr("editable",`${gt}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==e?void 0:e.test.type}" data-correct="${null!=e&&null!==(he=e.test.singlechoice)&&void 0!==he&&he.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${Tt}</div></div></div>`);break;case"multichoice":var fe;gt?jQuery(i).attr("editable",`${gt}`).html(`<div contenteditable="${gt}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${Tt}</div>`):jQuery(i).attr("editable",`${gt}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==e?void 0:e.test.type}" data-correct="${null!=e&&null!==(fe=e.test.multichoice)&&void 0!==fe&&fe.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${Tt}</div></div></div>`);break;case"matching-empty":var xe;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-empty" data-key="${null==e||null===(xe=e.test.matching)||void 0===xe?void 0:xe.key}"></div>`);break;case"matching-content":var bi,Xi,Ge;gt?jQuery(i).attr("editable",`${gt}`).html(`<div contenteditable="${gt}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${Tt}</div>`):jQuery(i).attr("editable",`${gt}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-content" data-key="${null==e||null===(bi=e.test.matching)||void 0===bi?void 0:bi.key}"><div class="ondrag-item" data-key="${null!==(Xi=null==e||null===(Ge=e.test)||void 0===Ge||null===(Ge=Ge.matching)||void 0===Ge?void 0:Ge.key)&&void 0!==Xi?Xi:"MIDDLEKIEN"}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${Tt}</div></div></div></div>`);break;case"fill":var ut;gt||((null===(ut=e.html)||void 0===ut?void 0:ut.fillKeywords)||[]).forEach(ge=>{var Mt=`<input type="text" maxlength="128" style="display:inline-block;width:100px;min-width:100px;max-width:100%;padding:0px 10px;margin:0px;box-sizing:border-box;outline:none;box-shadow:none;border-width:0px 0px 1px;border-top-style:initial;border-right-style:initial;border-left-style:initial;border-top-color:initial;border-right-color:initial;border-left-color:initial;border-image:initial;border-bottom-style:dashed;border-bottom-color:rgb(123,146,254);background:transparent;animation:0.3s ease-in-out 0s 1 normal none running width;text-align:inherit;" data-key="${ge.replace(/[^a-zA-Z0-9]+/gm,"")}"/>`;Tt=Tt.replace(new RegExp(ge.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),"g"),Mt)}),gt?jQuery(i).attr("editable",`${gt}`).html(`<div contenteditable="${gt}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${Tt}</div>`):jQuery(i).attr("editable",`${gt}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${Tt}</div></div></div>`);break;case"speech":jQuery(i).html('<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><img src="images/svg/component/microphone4.svg" width="60" height="60"/></div></div>');break;case"submit":var jt,Be,ve,Rr,jr;jQuery(i).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><img src="${null!==(jt=null!==(Be=e.image)&&void 0!==Be&&Be.path?(null===(ve=y.config)||void 0===ve?void 0:ve.readfileuploadurl)+(null===(Rr=e.image)||void 0===Rr?void 0:Rr.path):null===(jr=e.image)||void 0===jr?void 0:jr.url)&&void 0!==jt?jt:""}" style="width:100%;height:100%;display:block;"/></div>`)}jQuery(i).find("img[path],video[path],iframe[path]").each((ge,Mt)=>{var Ht,ee;Mt.setAttribute("src",(null!==(Ht=null===(ee=y.config)||void 0===ee?void 0:ee.readfileuploadurl)&&void 0!==Ht?Ht:"")+Mt.getAttribute("path")),Mt.removeAttribute("path")})}}}},N=(i,t,e,n)=>{let r=jQuery(n||y.target).find("#"+i).get(0);return r||(r=window.document.createElementNS("http://www.w3.org/2000/svg",t),r.setAttribute("id",i),jQuery(r).appendTo(n||y.target)),jQuery(r).attr((null==e?void 0:e.attribute)||{}),jQuery(r).css((null==e?void 0:e.style)||{}),r},I=(i,t)=>{let e=lt(2),n={fill:"transparent",stroke:"#129bff","stroke-width":lt(1)};return[{element:N("icdt-temp-create-rect-center","rect",{attribute:Object.assign({x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e},n)},i),posType:"rect-center"}]},G=(i,t)=>{let e=[],{size:n}=t,r=lt(1),l=lt(2),a=lt(3),d=(lt(5),lt(7),lt(10)),u={stroke:ot.stroke,"stroke-width":lt(ot.strokeWidth),"stroke-linecap":ot.strokeLinecap,"stroke-dasharray":ot.strokeDasharrays.map(D=>lt(D)).join(" ")},c={fill:"transparent",stroke:"transparent","stroke-width":lt(1)},h={fill:"#FFFFFF",stroke:"#0D99FF","stroke-width":lt(1),width:lt(7),height:lt(7)},f={fill:"#FFFFFF",stroke:"#0D99FF","stroke-width":lt(1),width:lt(7),height:lt(7)},v=N("icdt-temp-resize-rect-center","rect",{attribute:Object.assign({x:n.x,y:n.y,width:n.width,height:n.height},c),style:{cursor:"move"}},i);if(N("icdt-temp-resize-line-left","line",{attribute:Object.assign({x1:n.x-r,y1:n.y-r,x2:n.x-r,y2:n.y+n.height+r},u)},i),N("icdt-temp-resize-line-top","line",{attribute:Object.assign({x1:n.x-r,y1:n.y-r,x2:n.x+n.width+r,y2:n.y-r},u)},i),N("icdt-temp-resize-line-right","line",{attribute:Object.assign({x1:n.x+n.width+r,y1:n.y-r,x2:n.x+n.width+r,y2:n.y+n.height+r},u)},i),N("icdt-temp-resize-line-bottom","line",{attribute:Object.assign({x1:n.x-r,y1:n.y+n.height+r,x2:n.x+n.width+r,y2:n.y+n.height+r},u)},i),t.type==F.LINE){var x;let{size:D}=t,E=[];return null===(x=D.ratios)||void 0===x||x.forEach(function(P){E.push([D.x+D.width*P[0],D.y+D.height*P[1]])}),E.forEach((P,L)=>{e.push({posType:`point-${L}`,element:N(`icdt-temp-resize-point-${L+1}`,"circle",{attribute:Object.assign(at(F.CIRCLE,{x:P[0]-l-r,y:P[1]-l-r,width:f.width,height:f.height},{}),f)},i)})}),e.concat([{element:v,posType:"rect-center"}])}if(t.type==F.POLYGON){var w;let{size:D}=t,E=[];null===(w=D.ratios)||void 0===w||w.forEach(function(P){E.push([D.x+D.width*P[0],D.y+D.height*P[1]])}),E.forEach((P,L)=>{e.push({posType:`point-${L}`,element:N(`icdt-temp-resize-point-${L+1}`,"circle",{attribute:Object.assign(at(F.CIRCLE,{x:P[0]-l-r,y:P[1]-l-r,width:f.width,height:f.height},{}),f)},i)})})}let S=N("icdt-temp-resize-rect-top-left","rect",{attribute:Object.assign({x:n.x-d,y:n.y-d},h),style:{cursor:"nw-resize"}},i),R=N("icdt-temp-resize-rect-top-right","rect",{attribute:Object.assign({x:n.x+n.width+a,y:n.y-d},h),style:{cursor:"ne-resize"}},i),J=N("icdt-temp-resize-rect-bottom-left","rect",{attribute:Object.assign({x:n.x-d,y:n.y+n.height+a},h),style:{cursor:"sw-resize"}},i),B=N("icdt-temp-resize-rect-bottom-right","rect",{attribute:Object.assign({x:n.x+n.width+a,y:n.y+n.height+a},h),style:{cursor:"se-resize"}},i),z=N("icdt-temp-resize-rect-left","rect",{attribute:Object.assign({x:n.x-d,y:n.y+n.height/2-l-r},h),style:{cursor:"w-resize"}},i),T=N("icdt-temp-resize-rect-top","rect",{attribute:Object.assign({x:n.x+n.width/2-l-r,y:n.y-d},h),style:{cursor:"n-resize"}},i),A=N("icdt-temp-resize-rect-right","rect",{attribute:Object.assign({x:n.x+n.width+a,y:n.y+n.height/2-l-r},h),style:{cursor:"e-resize"}},i),Q=N("icdt-temp-resize-rect-bottom","rect",{attribute:Object.assign({x:n.x+n.width/2-l-r,y:n.y+n.height+a},h),style:{cursor:"s-resize"}},i);return e.concat([{element:v,posType:"rect-center"},{element:S,posType:"rect-top-left"},{element:R,posType:"rect-top-right"},{element:J,posType:"rect-bottom-left"},{element:B,posType:"rect-bottom-right"},{element:z,posType:"rect-left"},{element:T,posType:"rect-top"},{element:A,posType:"rect-right"},{element:Q,posType:"rect-bottom"}])},U=(i,t,e)=>{let n=lt(1),r=lt(2),l=lt(5),a={stroke:ot.stroke,"stroke-width":lt(ot.strokeWidth),"stroke-linecap":ot.strokeLinecap},o={fill:"transparent",stroke:"transparent","stroke-width":lt(1)},s={fill:"#FFFFFF",stroke:"#0D99FF","stroke-width":lt(1),width:lt(7),height:lt(7)},d={fill:"#0D99FF",rx:lt(4)},u={fill:"#fff","alignment-baseline":"central","text-anchor":"middle","font-size":lt(14)},c={fill:Xt.fill,stroke:Xt.stroke,"stroke-width":lt(Xt.strokeWidth)},p=(N("icdt-temp-resize-line-left","line",{attribute:Object.assign({x1:e.x-n,y1:e.y-n,x2:e.x-n,y2:e.y+e.height+n},a)},i),N("icdt-temp-resize-line-top","line",{attribute:Object.assign({x1:e.x-n,y1:e.y-n,x2:e.x+e.width+n,y2:e.y-n},a)},i),N("icdt-temp-resize-line-right","line",{attribute:Object.assign({x1:e.x+e.width+n,y1:e.y-n,x2:e.x+e.width+n,y2:e.y+e.height+n},a)},i),N("icdt-temp-resize-line-bottom","line",{attribute:Object.assign({x1:e.x-n,y1:e.y+e.height+n,x2:e.x+e.width+n,y2:e.y+e.height+n},a)},i),N("icdt-temp-resize-rect-center","rect",{attribute:Object.assign({x:e.x,y:e.y,width:e.width,height:e.height},o)},i)),g=`${e.width} x ${e.height}`,O=8*g.length;return N("icdt-temp-select-rect-text","rect",{attribute:Object.assign({x:e.x+e.width/2-lt(O/2),y:e.y+e.height+lt(10),width:lt(O),height:lt(20)},d)},i),N("icdt-temp-select-text","text",{attribute:Object.assign({x:e.x+e.width/2,y:e.y+e.height+lt(20)},u)},i).textContent=g,t.length>1&&t.forEach(D=>{let{size:E}=D;N("icdt-temp-select-rect-node-"+D.id,"rect",{attribute:Object.assign({x:E.x,y:E.y,width:E.width,height:E.height},c)},i)}),[{element:p,posType:"rect-center"},{element:N("icdt-temp-resize-rect-top-left","rect",{attribute:Object.assign({x:e.x-l,y:e.y-l},s),style:{cursor:"nw-resize"}},i),posType:"rect-top-left"},{element:N("icdt-temp-resize-rect-top-right","rect",{attribute:Object.assign({x:e.x+e.width-r,y:e.y-l},s),style:{cursor:"ne-resize"}},i),posType:"rect-top-right"},{element:N("icdt-temp-resize-rect-bottom-left","rect",{attribute:Object.assign({x:e.x-l,y:e.y+e.height-r},s),style:{cursor:"sw-resize"}},i),posType:"rect-bottom-left"},{element:N("icdt-temp-resize-rect-bottom-right","rect",{attribute:Object.assign({x:e.x+e.width-r,y:e.y+e.height-r},s),style:{cursor:"se-resize"}},i),posType:"rect-bottom-right"},{element:N("icdt-temp-resize-rect-left","rect",{attribute:Object.assign({x:e.x-l,y:e.y+e.height/2-r-n},s),style:{cursor:"w-resize"}},i),posType:"rect-left"},{element:N("icdt-temp-resize-rect-top","rect",{attribute:Object.assign({x:e.x+e.width/2-r-n,y:e.y-l},s),style:{cursor:"n-resize"}},i),posType:"rect-top"},{element:N("icdt-temp-resize-rect-right","rect",{attribute:Object.assign({x:e.x+e.width-r,y:e.y+e.height/2-r-n},s),style:{cursor:"e-resize"}},i),posType:"rect-right"},{element:N("icdt-temp-resize-rect-bottom","rect",{attribute:Object.assign({x:e.x+e.width/2-r-n,y:e.y+e.height-r},s),style:{cursor:"s-resize"}},i),posType:"rect-bottom"}]},H=(i,t)=>{let e=lt(1),n={stroke:ot.stroke,"stroke-width":lt(ot.strokeWidth),"stroke-linecap":ot.strokeLinecap},r={fill:"transparent",stroke:"transparent","stroke-width":lt(1)};return N("icdt-temp-scan-line-left","line",{attribute:Object.assign({x1:t.x-e,y1:t.y,x2:t.x-e,y2:t.y+t.height},n)},i),N("icdt-temp-scan-line-top","line",{attribute:Object.assign({x1:t.x,y1:t.y-e,x2:t.x+t.width,y2:t.y-e},n)},i),N("icdt-temp-scan-line-right","line",{attribute:Object.assign({x1:t.x+t.width+e,y1:t.y,x2:t.x+t.width+e,y2:t.y+t.height},n)},i),N("icdt-temp-scan-line-bottom","line",{attribute:Object.assign({x1:t.x,y1:t.y+t.height+e,x2:t.x+t.width,y2:t.y+t.height+e},n)},i),[{element:N("icdt-temp-scan-rect-center","rect",{attribute:Object.assign({x:t.x,y:t.y,width:t.width,height:t.height},r)},i),posType:"rect-center"}]},nt=(i,t)=>{let e={fill:"none",stroke:"#999","stroke-width":lt(1),"stroke-dasharray":lt(2)};jQuery(i).empty(),t.forEach(n=>{var r,l;let{size:a}=n;if(!n.idx)return;N("icdt-temp-index-rect-node-"+n.id,"rect",{attribute:Object.assign({x:a.x-5,y:a.y-5,width:a.width+10,height:a.height+10},e)},i);let{element:o}=de(Math.ceil(1e9*Math.random()),{size:{x:a.x-76,y:a.y-6,width:70,height:80},attribute:{},style:{},source:{type:"html",html:{htmlContent:`<div class="position-slide" style="position:relative;width:100%;height:100%;">\n                  <div style="position:absolute;top:0;right:0;line-height:22px;">\n                    <div title="Th\u1ee9 t\u1ef1 xu\u1ea5t hi\u1ec7n">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-play" style="margin:6px 0;color:#7da7d9;font-size:12px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="idx" value="${null!==(r=n.idx)&&void 0!==r?r:0}" min="0" max="999" step="1" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="Th\u1eddi gian \u0111\u1ee3i(s), n\u1ebfu gi\xe1 tr\u1ecb = 0 s\u1ebd chuy\u1ec3n sang \u0111\u1ee3i ho\xe0n t\u1ea5t ho\u1ea1t \u0111\u1ed9ng v\xe0 \xe2m thanh" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-clock-o" style="margin:5px 0;color:#7da7d9;font-size:14px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="time" value="${null!==(l=n.time)&&void 0!==l?l:0}" min="0" max="999" step="0.5" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="H\u1ee7y thi\u1ebft l\u1eadp" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <button name="remove" style="box-sizing:border-box;width:24px;height:24px;padding:0;border:1px solid #ddd;line-height: 0;outline:none;background:#eee;background: radial-gradient(#fff, #eee);">\n                            <img src="assets/icon-png/xoa2.png" height="18">\n                          </button>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                  </div>\n              </div>`}}},i);o.classList.add("node-input"),jQuery(o).on("change",'input[name="idx"]',s=>{var d;n.idx=parseInt(null!==(d=s.target.value)&&void 0!==d?d:"0")}).on("change",'input[name="time"]',s=>{var d;n.time=parseFloat(null!==(d=s.target.value)&&void 0!==d?d:"0")}).on("click",'button[name="remove"]',s=>{n.idx=0,n.time=null,nt(i,t)})})},st=(i,t)=>{var e,n,r,l,a,o;let{color:s,opacity:d,path:u,url:c,base64:h}=null!==(e=null==t||null===(n=t.svg)||void 0===n?void 0:n.background)&&void 0!==e?e:{},{x:f,y:v,width:b,height:p}=null!==(r=null==t||null===(l=t.svg)||void 0===l?void 0:l.viewBox)&&void 0!==r?r:{x:0,y:0,width:0,height:0};Je(void 0,{size:{x:0,y:lt(-10),width:100,height:20},attribute:{fill:"#999",textAnchor:"start",alignmentBaseline:"central",fontSize:lt(12),class:"hide-on-viewer"},source:{type:"text",text:{textContent:null!==(a=null!==(o=null==t?void 0:t.name)&&void 0!==o?o:null==t?void 0:t.code)&&void 0!==a?a:void 0}}},i),ye(void 0,{size:{x:f,y:v,width:b,height:p},attribute:{fill:"#fff",stroke:"#999",strokeWidth:lt(1),strokeDasharray:lt(10),class:"hide-on-viewer"}},i),s&&ye(void 0,{size:{x:f,y:v,width:b,height:p},attribute:{fill:s,fillOpacity:d}},i),u&&Se(void 0,{size:{x:f,y:v,width:b,height:p},source:{type:"image",image:{path:u,url:c,base64:h}}},i)},ct=(i,t,e)=>{var n;switch(jQuery(i).empty(),null===(n=t.test)||void 0===n?void 0:n.type){case"truefalse":var r;if(null!==(r=t.test)&&void 0!==r&&r.showselection){var l,a,o;let z=null==t||null===(l=t.test)||void 0===l||null===(l=l.answer)||void 0===l||null===(l=l.truefalse)||void 0===l?void 0:l.value;null===(a=t.svg)||void 0===a||a.nodes.filter(T=>{var A;return"truefalse"==(null===(A=T.source)||void 0===A||null===(A=A.test)||void 0===A?void 0:A.type)&&T.id!=z}).forEach(T=>{var A;let{x:D,y:E,width:P,height:L}=null!==(A=null==T?void 0:T.size)&&void 0!==A?A:{x:0,y:0,width:0,height:0};ke(Math.ceil(1e9*Math.random()),{size:{x:D-.5,y:E-.5,width:P+1,height:L+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},i)}),null!=t&&null!==(o=t.test)&&void 0!==o&&null!==(o=o.answer)&&void 0!==o&&o.truefalse&&z&&(T=>{let A=V.findNode(z),{x:D,y:E,width:P,height:L}=null!==(T=null==A?void 0:A.size)&&void 0!==T?T:{x:0,y:0,width:0,height:0};ke(Math.ceil(1e9*Math.random()),{size:{x:D-2,y:E-2,width:P+4,height:L+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},i)})()}break;case"singlechoice":var s;if(null!==(s=t.test)&&void 0!==s&&s.showselection){var d,u,c;let z=null==t||null===(d=t.test)||void 0===d||null===(d=d.answer)||void 0===d||null===(d=d.singlechoice)||void 0===d?void 0:d.value;null===(u=t.svg)||void 0===u||u.nodes.filter(T=>{var A;return"singlechoice"==(null===(A=T.source)||void 0===A||null===(A=A.test)||void 0===A?void 0:A.type)&&T.id!=z}).forEach(T=>{var A;let{x:D,y:E,width:P,height:L}=null!==(A=null==T?void 0:T.size)&&void 0!==A?A:{x:0,y:0,width:0,height:0};ke(Math.ceil(1e9*Math.random()),{size:{x:D-.5,y:E-.5,width:P+1,height:L+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},i)}),null!=t&&null!==(c=t.test)&&void 0!==c&&null!==(c=c.answer)&&void 0!==c&&c.singlechoice&&z&&(T=>{let A=V.findNode(z),{x:D,y:E,width:P,height:L}=null!==(T=null==A?void 0:A.size)&&void 0!==T?T:{x:0,y:0,width:0,height:0};ke(Math.ceil(1e9*Math.random()),{size:{x:D-2,y:E-2,width:P+4,height:L+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},i)})()}break;case"multichoice":var h;if(null!==(h=t.test)&&void 0!==h&&h.showselection){var f,v,b,p;let z=null!==(f=null==t||null===(v=t.test)||void 0===v||null===(v=v.answer)||void 0===v||null===(v=v.multichoice)||void 0===v?void 0:v.map(T=>T.value))&&void 0!==f?f:[];var g;null===(b=t.svg)||void 0===b||b.nodes.filter(T=>{var A;return"multichoice"==(null===(A=T.source)||void 0===A||null===(A=A.test)||void 0===A?void 0:A.type)&&!z.includes(T.id)}).forEach(T=>{var A;let{x:D,y:E,width:P,height:L}=null!==(A=null==T?void 0:T.size)&&void 0!==A?A:{x:0,y:0,width:0,height:0};ye(Math.ceil(1e9*Math.random()),{size:{x:D-.5,y:E-.5,width:P+1,height:L+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},i)}),null!=t&&null!==(p=t.test)&&void 0!==p&&null!==(p=p.answer)&&void 0!==p&&p.multichoice&&z.length&&(null==t||null===(g=t.test)||void 0===g||null===(g=g.answer)||void 0===g||g.multichoice.forEach(T=>{var A;let Q=V.findNode(T.value),{x:E,y:P,width:L,height:M}=null!==(A=null==Q?void 0:Q.size)&&void 0!==A?A:{x:0,y:0,width:0,height:0};ye(Math.ceil(1e9*Math.random()),{size:{x:E-2,y:P-2,width:L+4,height:M+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},i)}))}break;case"fill":var O,x;null!=t&&null!==(O=t.test)&&void 0!==O&&null!==(O=O.answer)&&void 0!==O&&O.fill&&(null==t||null===(x=t.test)||void 0===x||null===(x=x.answer)||void 0===x||x.fill.forEach(z=>{jQuery("#"+e.id).find(`input[type="text"][data-key="${z.key}"]`).val(z.value)}));break;case"matching":var w,S,R,J;if(null!=t&&null!==(w=t.test)&&void 0!==w&&null!==(w=w.answer)&&void 0!==w&&w.matching)if("matching-empty"==(null===(S=e.source)||void 0===S||null===(S=S.test)||void 0===S?void 0:S.type))null==t||null===(J=t.test)||void 0===J||null===(J=J.answer)||void 0===J||J.matching.filter(z=>{var T;return z.key==(null===(T=e.source)||void 0===T||null===(T=T.test)||void 0===T||null===(T=T.matching)||void 0===T?void 0:T.key)}).forEach(z=>{});else if("matching-content"==(null===(R=e.source)||void 0===R||null===(R=R.test)||void 0===R?void 0:R.type)){var B;null==t||null===(B=t.test)||void 0===B||null===(B=B.answer)||void 0===B||B.matching.filter(z=>{var T;return z.value==(null===(T=e.source)||void 0===T||null===(T=T.test)||void 0===T||null===(T=T.matching)||void 0===T?void 0:T.key)}).forEach(z=>{})}}};class Ot{constructor(t){this._points=[],this._options=t}start(t){this._points.length=0,this._points.push([t.x,t.y]),this._options.start(t)}move(t,e){this._points.push([t.x,t.y]),this._options.move(t,this._points,e)}end(){this._options.end(this.offsetLast,this._points)}get offsetFirst(){return this._points.length>=1?{x:(t=this._points[0])[0],y:t[1]}:{x:0,y:0};var t}get offsetLast(){return this._points.length>=1?{x:(t=this._points[this._points.length-1])[0],y:t[1]}:{x:0,y:0};var t}}const Jt=(i,t,e,n)=>(i.x-=n.x,i.y-=n.y,i.x/=t,i.y/=t,i.x-=e.x,i.y-=e.y,i.x=C(i.x),i.y=C(i.y),i),Ct=(i,t,e,n,r)=>{var l,a,o;let s=null,d=0,u=0;i.mouseEvent?(s=i.mouseEvent.target,d=i.mouseEvent.offsetX,u=i.mouseEvent.offsetY):i.touchEvent&&(s=i.touchEvent.target,i.touchEvent.touches.length&&(d=i.touchEvent.touches[0].clientX,u=i.touchEvent.touches[0].clientY));let c=null!=e?e:y.screen.scale,h=null!=n?n:y.screen.dislocation,f=null!=r?r:y.screen.offset,v=()=>{};var b=new Ot({start:null!==(l=null==t?void 0:t.start)&&void 0!==l?l:v,move:null!==(a=null==t?void 0:t.move)&&void 0!==a?a:v,end:null!==(o=null==t?void 0:t.end)&&void 0!==o?o:v});i.mouseEvent?b.start(Jt({x:d,y:u},c,h,{x:0,y:0})):i.touchEvent&&b.start(Jt({x:d,y:u},c,h,f));let p=J=>{b.move(Jt({x:J.clientX,y:J.clientY},c,h,f),{ctrlKey:J.ctrlKey,shiftKey:J.shiftKey,altKey:J.altKey})},g=J=>{b.end(),[vt.SHAPE,vt.FOREIGNOBJECT,vt.IMAGE,vt.TEXT].includes(y.pointer.pointer_type)&&(J.shiftKey||(y.pointer.pointer_type=vt.POINTER))},O=J=>{J.touches.length&&p({clientX:J.touches[0].clientX,clientY:J.touches[0].clientY,ctrlKey:J.ctrlKey,shiftKey:J.shiftKey,altKey:J.altKey})},x=J=>{g({ctrlKey:J.ctrlKey,shiftKey:J.shiftKey,altKey:J.altKey}),window.removeEventListener("touchmove",O,!1),window.removeEventListener("touchend",x,!1)},w=J=>{0==J.button&&p({clientX:J.clientX,clientY:J.clientY,ctrlKey:J.ctrlKey,shiftKey:J.shiftKey,altKey:J.altKey})},S=J=>{0==J.button&&(g({shiftKey:J.shiftKey,ctrlKey:J.ctrlKey,altKey:J.altKey}),window.removeEventListener("mousemove",w,!1),window.removeEventListener("mouseup",S,!1))};if(i.mouseEvent)window.addEventListener("mousemove",w,!1),window.addEventListener("mouseup",S,!1);else if(i.touchEvent){var R;window.addEventListener("touchmove",O,!1),window.addEventListener("touchend",x,!1),null===(R=s)||void 0===R||R.addEventListener("touchmove",function(J){J.preventDefault()})}},dn=(i,t,e,n,r)=>{let{x:l,y:a,width:o,height:s}=e;0==o&&(o=1),0==s&&(s=1);let d=n.map(p=>Object.assign({},p.size)),c=[],v=!1;Ct(i,{start:p=>{n.forEach(p=>{let{id:g,size:O,attribute:x}=p;c.push({id:g,type:"size",from:JSON.parse(JSON.stringify({id:g,size:O,attribute:x}))})})},move:(p,g,O)=>{((p,g,O,x,w)=>{let S=O-p,R=x-g;(()=>{let B,J=(o||1)/(s||1);switch(t){case"rect-center":B=null!=w&&w.shiftKey?Math.abs(O-p)>=Math.abs(x-g)?{x:l+O-p,y:a,width:o,height:s}:{x:l,y:a+x-g,width:o,height:s}:{x:l+O-p,y:a+x-g,width:o,height:s};break;case"rect-top-left":B=null!=w&&w.shiftKey&&null!=w&&w.altKey?J>=1?{x:l+(O-p),y:a+(O-p)/J,width:o-2*(O-p),height:s-2*(O-p)/J}:{x:l+(x-g)*J,y:a+(x-g),width:o-2*(x-g)*J,height:s-2*(x-g)}:null!=w&&w.shiftKey?J>=1?{x:l+(O-p),y:a+(O-p)/J,width:o-(O-p),height:s-(O-p)/J}:{x:l+(x-g)*J,y:a+(x-g),width:o-(x-g)*J,height:s-(x-g)}:null!=w&&w.altKey?{x:l+(O-p),y:a+(x-g),width:o-2*(O-p),height:s-2*(x-g)}:{x:l+(O-p),y:a+(x-g),width:o-(O-p),height:s-(x-g)};break;case"rect-top-right":B=null!=w&&w.shiftKey&&null!=w&&w.altKey?J>=1?{x:l-(O-p),y:a-(O-p)/J,width:o+2*(O-p),height:s+2*(O-p)/J}:{x:l+(x-g)*J,y:a+(x-g),width:o-2*(x-g)*J,height:s-2*(x-g)}:null!=w&&w.shiftKey?J>=1?{x:l,y:a-(O-p)/J,width:o+(O-p),height:s+(O-p)/J}:{x:l,y:a+(x-g),width:o-(x-g)*J,height:s-(x-g)}:null!=w&&w.altKey?{x:l-(O-p),y:a+(x-g),width:o+2*(O-p),height:s-2*(x-g)}:{x:l,y:a+(x-g),width:o+(O-p),height:s-(x-g)};break;case"rect-bottom-left":B=null!=w&&w.shiftKey&&null!=w&&w.altKey?J>=1?{x:l+(O-p),y:a+(O-p)/J,width:o-2*(O-p),height:s-2*(O-p)/J}:{x:l-(x-g)*J,y:a-(x-g),width:o+2*(x-g)*J,height:s+2*(x-g)}:null!=w&&w.shiftKey?J>=1?{x:l+(O-p),y:a,width:o-(O-p),height:s-(O-p)/J}:{x:l-(x-g)*J,y:a,width:o+(x-g)*J,height:s+(x-g)}:null!=w&&w.altKey?{x:l+(O-p),y:a-(x-g),width:o-2*(O-p),height:s+2*(x-g)}:{x:l+(O-p),y:a,width:o-(O-p),height:s+(x-g)};break;case"rect-bottom-right":B=null!=w&&w.shiftKey&&null!=w&&w.altKey?J>=1?{x:l-(O-p),y:a-(O-p)/J,width:o+2*(O-p),height:s+2*(O-p)/J}:{x:l-(x-g)*J,y:a-(x-g),width:o+2*(x-g)*J,height:s+2*(x-g)}:null!=w&&w.shiftKey?J>=1?{x:l,y:a,width:o+(O-p),height:s+(O-p)/J}:{x:l,y:a,width:o+(x-g)*J,height:s+(x-g)}:null!=w&&w.altKey?{x:l-(O-p),y:a-(x-g),width:o+2*(O-p),height:s+2*(x-g)}:{x:l,y:a,width:o+(O-p),height:s+(x-g)};break;case"rect-top":B=null!=w&&w.shiftKey?{x:l+R/2*J,y:a+R,width:o-R*J,height:s-R}:null!=w&&w.altKey?{x:l,y:a+R,width:o,height:s-2*R}:{x:l,y:a+R,width:o,height:s-R};break;case"rect-bottom":B=null!=w&&w.shiftKey?{x:l-R/2*J,y:a,width:o+R*J,height:s+R}:null!=w&&w.altKey?{x:l,y:a-R,width:o,height:s+2*R}:{x:l,y:a,width:o,height:s+R};break;case"rect-left":B=null!=w&&w.shiftKey?{x:l+S,y:a+S/2/J,width:o-S,height:s-S/J}:null!=w&&w.altKey?{x:l+S,y:a,width:o-2*S,height:s}:{x:l+S,y:a,width:o-S,height:s};break;case"rect-right":B=null!=w&&w.shiftKey?{x:l,y:a-S/2/J,width:o+S,height:s+S/J}:null!=w&&w.altKey?{x:l-S,y:a,width:o+2*S,height:s}:{x:l,y:a,width:o+S,height:s};break;default:B={x:l+O-p,y:a+x-g,width:o,height:s}}B.width<=0&&(B.width=1),B.height<=0&&(B.height=1),B.x=C(B.x,1),B.y=C(B.y,1),B.width=C(B.width,1),B.height=C(B.height,1),Object.assign(e,B),U(r,n,B),(()=>{let z=l-B.x,T=a-B.y,A=(B.width-o)/o,Q=(B.height-s)/s;n.forEach((D,E)=>{let P=d[E],M=a-P.y,K={x:C(P.x-(z+(l-P.x)*A),100),y:C(P.y-(T+M*Q),100),width:C(P.width+P.width*A,100),height:C(P.height+P.height*Q,100)},{id:W,type:tt,size:Z,attribute:X}=D;Object.assign(Z,K),Object.assign(X,at(tt,Z,X)),m(window.document.getElementById(W),X)})})()})()})(g[0][0],g[0][1],p.x,p.y,O),v=!0},end:(p,g)=>{v&&(n.forEach(p=>{let{id:g,size:O,attribute:x}=p,w=c.find(S=>S.id==g);w&&(w.to=JSON.parse(JSON.stringify({id:g,size:O,attribute:x})))}),y.history.push(c))}})},un=(i,t,e,n)=>{let v,{id:r,type:l,size:a,attribute:o}=e,{x:s,y:d,width:u,height:c,ratios:h}=a,f=(u||1)/(c||1),p=null,x=!1;Ct(i,{start:S=>{p=JSON.parse(JSON.stringify({id:r,size:a,attribute:o}))},move:(S,R,J)=>{((S,R,J,B,z)=>{let T=J-S,A=B-R;switch(t){case"rect-center":v=null!=z&&z.shiftKey?Math.abs(T)>=Math.abs(A)?{x:s+T,y:d,width:u,height:c}:{x:s,y:d+A,width:u,height:c}:{x:s+T,y:d+A,width:u,height:c};break;case"rect-top-left":v=null!=z&&z.shiftKey&&null!=z&&z.altKey?f>=1?{x:s+T,y:d+T/f,width:u-2*T,height:c-2*T/f}:{x:s+A*f,y:d+A,width:u-2*A*f,height:c-2*A}:null!=z&&z.shiftKey?f>=1?{x:s+T,y:d+T/f,width:u-T,height:c-T/f}:{x:s+A*f,y:d+A,width:u-A*f,height:c-A}:null!=z&&z.altKey?{x:s+T,y:d+A,width:u-2*T,height:c-2*A}:{x:s+T,y:d+A,width:u-T,height:c-A};break;case"rect-top-right":v=null!=z&&z.shiftKey&&null!=z&&z.altKey?f>=1?{x:s-T,y:d-T/f,width:u+2*T,height:c+2*T/f}:{x:s+A*f,y:d+A,width:u-2*A*f,height:c-2*A}:null!=z&&z.shiftKey?f>=1?{x:s,y:d-T/f,width:u+T,height:c+T/f}:{x:s,y:d+A,width:u-A*f,height:c-A}:null!=z&&z.altKey?{x:s-T,y:d+A,width:u+2*T,height:c-2*A}:{x:s,y:d+A,width:u+T,height:c-A};break;case"rect-bottom-left":v=null!=z&&z.shiftKey&&null!=z&&z.altKey?f>=1?{x:s+T,y:d+T/f,width:u-2*T,height:c-2*T/f}:{x:s-A*f,y:d-A,width:u+2*A*f,height:c+2*A}:null!=z&&z.shiftKey?f>=1?{x:s+T,y:d,width:u-T,height:c-T/f}:{x:s-A*f,y:d,width:u+A*f,height:c+A}:null!=z&&z.altKey?{x:s+T,y:d-A,width:u-2*T,height:c+2*A}:{x:s+T,y:d,width:u-T,height:c+A};break;case"rect-bottom-right":v=null!=z&&z.shiftKey&&null!=z&&z.altKey?f>=1?{x:s-T,y:d-T/f,width:u+2*T,height:c+2*T/f}:{x:s-A*f,y:d-A,width:u+2*A*f,height:c+2*A}:null!=z&&z.shiftKey?f>=1?{x:s,y:d,width:u+T,height:c+T/f}:{x:s,y:d,width:u+A*f,height:c+A}:null!=z&&z.altKey?{x:s-T,y:d-A,width:u+2*T,height:c+2*A}:{x:s,y:d,width:u+T,height:c+A};break;case"rect-top":v=null!=z&&z.shiftKey?{x:s+A/2*f,y:d+A,width:u-A*f,height:c-A}:null!=z&&z.altKey?{x:s,y:d+A,width:u,height:c-2*A}:{x:s,y:d+A,width:u,height:c-A};break;case"rect-bottom":v=null!=z&&z.shiftKey?{x:s-A/2*f,y:d,width:u+A*f,height:c+A}:null!=z&&z.altKey?{x:s,y:d-A,width:u,height:c+2*A}:{x:s,y:d,width:u,height:c+A};break;case"rect-left":v=null!=z&&z.shiftKey?{x:s+T,y:d+T/2/f,width:u-T,height:c-T/f}:null!=z&&z.altKey?{x:s+T,y:d,width:u-2*T,height:c}:{x:s+T,y:d,width:u-T,height:c};break;case"rect-right":v=null!=z&&z.shiftKey?{x:s,y:d-T/2/f,width:u+T,height:c+T/f}:null!=z&&z.altKey?{x:s-T,y:d,width:u+2*T,height:c}:{x:s,y:d,width:u+T,height:c};break;default:v=t.match(/^point-(\d+)/)?{x:s,y:d,width:u,height:c}:{x:s+T,y:d+A,width:u,height:c}}v.width<=0&&(v.width=1),v.height<=0&&(v.height=1);let Q=t.match(/^point-(\d+)/);if(Q){let E=parseInt(Q[1]);if("number"==typeof E){var D;v.ratios=null==h?void 0:h.map((K,W)=>W==E?[C(K[0]+(0==v.width?0:T/v.width),100),C(K[1]+(0==v.height?0:A/v.height),100)]:K);let P=ar(v.x,v.y,v.width,v.height,null!==(D=v.ratios)&&void 0!==D?D:[]),L=va(P),M=cn(L.x,L.y,L.width,L.height,P);v={x:L.x,y:L.y,width:L.width,height:L.height,ratios:M}}}v.x=C(v.x,1),v.y=C(v.y,1),v.width=C(v.width,1),v.height=C(v.height,1),Object.assign(a,v),Object.assign(o,at(l,a,o)),m(window.document.getElementById(r),o),G(n,e)})(R[0][0],R[0][1],S.x,S.y,J),x=!0},end:(S,R)=>{x&&p&&y.history.push([{type:"size",from:p,to:JSON.parse(JSON.stringify({id:r,size:a,attribute:o}))}])}})},ar=(i,t,e,n,r)=>r.map(l=>[i+e*l[0],t+n*l[1]]),cn=(i,t,e,n,r)=>r.map(l=>[0==e?0:C((l[0]-i)/e,100),0==n?0:C((l[1]-t)/n,100)]),va=i=>{let t=[],e=[];i.map(o=>{t.push(o[0]),e.push(o[1])});let n=Math.min.apply(null,t),r=Math.min.apply(null,e);return{x:n,y:r,width:Math.max.apply(null,t)-n||1,height:Math.max.apply(null,e)-r||1}},te=i=>{i.length>1?(i=>{let t=999999,e=999999,n=-999999,r=-999999;i.forEach(o=>{t=Math.min(t,o.size.x),e=Math.min(e,o.size.y),n=Math.max(n,o.size.x+o.size.width),r=Math.max(r,o.size.y+o.size.height)});let l=N(rt.RESIZE_GROUP,"g"),a=Qt(t,e,n,r);a.x=C(a.x,100),a.y=C(a.y,100),a.width=C(a.width,100),a.height=C(a.height,100),U(l,i,a).forEach(o=>{((i,t,e,n,r)=>{let l=!1;null==i||i.addEventListener("touchstart",a=>{l=!0,dn({touchEvent:a},t,e,n,r)}),null==i||i.addEventListener("mousedown",a=>{if(0==a.button){if(l)return void(l=!1);dn({mouseEvent:a},t,e,n,r)}})})(o.element,o.posType,a,i,l)})})(i):1==i.length&&(i=>{let t=N(rt.RESIZE_GROUP,"g");if(i.length>0){let e=i[0];G(t,e).forEach(n=>{((i,t,e,n)=>{let r=!1;null==i||i.addEventListener("touchstart",l=>{r=!0,un({touchEvent:l},t,e,n)}),null==i||i.addEventListener("mousedown",l=>{if(0==l.button){if(r)return void(r=!1);un({mouseEvent:l},t,e,n)}})})(n.element,n.posType,e,t)})}})(i)},Br=(i,t,e)=>{var n;let{id:r,type:l,source:a}=i;t=null===(n=t)||void 0===n?void 0:n.replace(/<[^>]+>/g,"");let o=JSON.parse(JSON.stringify({id:r,type:l,source:a}));var s,d;if(a)if(a.text){var h,f;a.text.textContent=t,a.text.variableKeywords=null!==(h=(null!==(f=t)&&void 0!==f?f:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==h?h:[]}else{var u,c;a.text={textContent:t,variableKeywords:null!==(u=(null!==(c=t)&&void 0!==c?c:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==u?u:[]}}else a={text:{textContent:t,variableKeywords:null!==(s=(null!==(d=t)&&void 0!==d?d:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==s?s:[]}};e||k(window.document.getElementById(r),l,a),y.history.push([{type:"source",from:o,to:JSON.parse(JSON.stringify({id:r,type:l,source:a}))}])},Pr=(i,t,e)=>{var n;let{id:r,type:l,source:a}=i,o=JSON.parse(JSON.stringify({id:r,type:l,source:a})),s=u=>{var c;return null!==(c=(null!=u?u:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==c?c:[]},d=u=>{var c;return(null!==(c=(null!=u?u:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==c?c:[]).filter((f,v,b)=>b.indexOf(f)==v)};a?a.html?(a.html.htmlContent=t,a.html.variableKeywords=s(t),a.html.fillKeywords=d(t)):a.html={htmlContent:t,variableKeywords:s(t),fillKeywords:d(t)}:a={html:{htmlContent:t,variableKeywords:s(t),fillKeywords:d(t)}},"fill"==(null===(n=a.test)||void 0===n?void 0:n.type)&&(a.test.fill=d(t).map(u=>{var c,h;return{key:u,value:null!==(c=null===(h=a)||void 0===h||null===(h=h.test)||void 0===h||null===(h=h.fill)||void 0===h||null===(h=h.find(f=>f.key==u))||void 0===h?void 0:h.value)&&void 0!==c?c:[]}})),e||k(window.document.getElementById(r),l,a),y.history.push([{type:"source",from:o,to:JSON.parse(JSON.stringify({id:r,type:l,source:a}))}])},pa=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.link?(r.link.url=t.url,r.link.title=t.title,r.link.description=t.description):r.link=t:r={link:t},k(window.document.getElementById(e),n,r),y.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},ma=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.image?(r.image.url=null==t?void 0:t.url,r.image.path=null==t?void 0:t.path,r.image.name=null==t?void 0:t.name,r.image.base64=void 0):r.image=t:r={image:t},k(window.document.getElementById(e),n,r),y.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},wa=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.audio?(r.audio.url=t.url,r.audio.path=t.path,r.audio.name=t.name):r.audio=t:r={audio:t},k(window.document.getElementById(e),n,r),y.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},ba=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.video?(r.video.url=t.url,r.video.path=t.path,r.video.name=t.name):r.video=t:r={video:t},k(window.document.getElementById(e),n,r),y.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},xa=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.file?(r.file.url=t.url,r.file.path=t.path,r.file.name=t.name):r.file=t:r={file:t},k(window.document.getElementById(e),n,r),y.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},Sa=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.iframe?(r.iframe.url=null==t?void 0:t.url,r.iframe.path=null==t?void 0:t.path,r.iframe.name=null==t?void 0:t.name):r.iframe=t:r={iframe:t},k(window.document.getElementById(e),n,r),y.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},ka=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.input?r.input.placeholder=t:r.input={placeholder:t}:r={input:{placeholder:t}},k(window.document.getElementById(e),n,r),y.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},Oa=(i,t)=>{let{id:e,type:n,source:r}=i,l=JSON.parse(JSON.stringify({id:e,type:n,source:r}));r?r.embed?(r.embed.type=null==t?void 0:t.type,r.embed.oss=null==t?void 0:t.oss,r.embed.name=null==t?void 0:t.name,r.embed.path=null==t?void 0:t.path,r.embed.url=null==t?void 0:t.url):r.embed=t:r={embed:t},k(window.document.getElementById(e),n,r),y.history.push([{type:"source",from:l,to:JSON.parse(JSON.stringify({id:e,type:n,source:r}))}])},_a=i=>{var t,e,n,r,l,a,o;let s=(null===(t=i.mouseEvent)||void 0===t?void 0:t.target)||(null===(e=i.touchEvent)||void 0===e?void 0:e.target),d=(null===(n=s)||void 0===n?void 0:n.getAttribute("id"))||"",u=null===(r=s)||void 0===r?void 0:r.nodeName;y.dataSelect.nodeName.includes(u)||(s=jQuery(s).parents("foreignObject").get(0),s&&(d=s.getAttribute("id")||"",u=s.nodeName));let c=(null===(l=s)||void 0===l||null===(l=l.parentNode)||void 0===l?void 0:l.getAttribute("id"))||"";var h,f,v;if([rt.RESIZE_GROUP,rt.SELECT_GROUP].includes(c))return null===(h=i.mouseEvent)||void 0===h||h.stopPropagation(),null===(f=i.mouseEvent)||void 0===f||f.preventDefault(),void("dblclick"==(null===(v=i.mouseEvent)||void 0===v?void 0:v.type)&&1==y.dataSelect.ids.length&&(i=>{var t,e,n,r,l;if(1!=i.length)return;let a=i[0];if(!(a.type==F.FOREIGNOBJECT&&["html","text"].includes(null!==(t=null===(e=a.source)||void 0===e?void 0:e.type)&&void 0!==t?t:"")||a.type==F.FOREIGNOBJECT&&"test"==(null===(n=a.source)||void 0===n?void 0:n.type)&&["truefalse","singlechoice","multichoice","matching-content","fill"].includes(null!==(r=null===(l=a.source)||void 0===l||null===(l=l.test)||void 0===l?void 0:l.type)&&void 0!==r?r:"")||a.type==F.TEXT))return;y.dataSelect.openEditable();let o=$(`#${a.id}`).find("[contenteditable]");o.on("input",()=>{var d,u,c;"html"==(null===(d=a.source)||void 0===d?void 0:d.type)||"test"==(null===(u=a.source)||void 0===u?void 0:u.type)?Pr(a,o.html(),!0):"text"==(null===(c=a.source)||void 0===c?void 0:c.type)&&Br(a,o.text(),!0)}).on("focusout",()=>{y.dataSelect.closeEditable()}).focus();let s=o.get(0);if(s){let d=document.createRange(),u=window.getSelection();u&&(d.selectNodeContents(s),u.removeAllRanges(),u.addRange(d))}})(y.dataSelect.nodes));if(null!==(a=i.mouseEvent)&&void 0!==a&&a.altKey||null!==(o=i.touchEvent)&&void 0!==o&&o.altKey||!d||d.match(/[^0-9]/)||!y.dataSelect.nodeName.includes(u)){var b;y.dataSelect.ids.length&&(y.dataSelect.ids=[]),(0==(null===(b=i.mouseEvent)||void 0===b?void 0:b.button)||i.touchEvent)&&(i=>{let l=N(rt.SCAN_GROUP,"g"),a=Qt(0,0,1,1);H(l,a),((i,t,e)=>{Ct(i,{start:l=>{},move:(l,a)=>{((l,a,o,s)=>{t=Qt(l,a,o,s),H(e,t)})(a[0][0],a[0][1],l.x,l.y)},end:(l,a)=>{null==e||e.remove(),y.dataSelect.ids=y.data.getNodeInArea(Math.min(a[0][0],l.x),Math.min(a[0][1],l.y),Math.max(a[0][0],l.x),Math.max(a[0][1],l.y)),te(y.dataSelect.nodes)}})})(i,a,l)})(i)}else{var p,g;let O=parseFloat(d||"0");if(O==y.dataSelect.contenteditable_id)return;y.dataSelect.ids=null!==(p=i.mouseEvent)&&void 0!==p&&p.shiftKey||null!==(g=i.touchEvent)&&void 0!==g&&g.shiftKey?[O].concat(y.dataSelect.ids).filter((x,w,S)=>S.indexOf(x)==w):[O],te(y.dataSelect.nodes)}};class Ta{constructor(){let{x:t,y:e}=y.screen.dislocation;var n=(r,l,a,o)=>{y.screen.move({x:t,y:e},{x:a-r,y:o-l})};return{start:r=>{},move:(r,l)=>{n(l[0][0],l[0][1],r.x,r.y)},end:(r,l)=>{n(l[0][0],l[0][1],r.x,r.y)}}}}class Ia{constructor(){let t=N(rt.CREATE_GROUP,"g"),{nodeId:e,element:n,attribute:r,size:l}=ke(Math.ceil(1e9*Math.random())),a=(o,s,d,u)=>{l=Qt(o,s,d,u,{ratio:1}),l.x=C(l.x),l.y=C(l.y),l.width=C(l.width),l.height=C(l.height),Object.assign(r,at(F.CIRCLE,l,r)),m(n,r),I(t,l)};return{start:o=>{a(o.x,o.y,o.x+l.width,o.y+l.height)},move:(o,s)=>{a(s[0][0],s[0][1],o.x,o.y)},end:(o,s)=>{(l.width<=8||l.height<=8)&&(l.width=80,l.height=80,l.x=l.x-l.width/2,l.y=l.y-l.height/2,Object.assign(r,at(F.CIRCLE,l,r)),m(n,r)),y.data.node=Object.assign({id:e,type:F.CIRCLE,name:"Circle"},{size:l,attribute:r}),null==t||t.remove()}}}}class Ca{constructor(){let t=N(rt.CREATE_GROUP,"g"),{nodeId:e,element:n,attribute:r,size:l}=Ci(Math.ceil(1e9*Math.random()));var a=(o,s,d,u)=>{l=Qt(o,s,d,u),l.x=C(l.x),l.y=C(l.y),l.width=C(l.width),l.height=C(l.height),Object.assign(r,at(F.ELLIPSE,l,r)),m(n,r),I(t,l)};return{start:o=>{a(o.x,o.y,o.x+l.width,o.y+l.height)},move:(o,s)=>{a(s[0][0],s[0][1],o.x,o.y)},end:(o,s)=>{l.width<4&&(l.width=4),l.height<4&&(l.height=4),l.width+l.height<8&&(l.width=90,l.height=60,l.x=l.x-l.width/2,l.y=l.y-l.height/2,Object.assign(r,at(F.ELLIPSE,l,r)),m(n,r)),y.data.node=Object.assign({id:e,type:F.ELLIPSE,name:"Ellipse"},{size:l,attribute:r}),null==t||t.remove()}}}}class Aa{constructor(){let t=N(rt.CREATE_GROUP,"g"),{nodeId:e,element:n,attribute:r,size:l}=ye(Math.ceil(1e9*Math.random()));var a=(o,s,d,u)=>{l=Qt(o,s,d,u),l.x=C(l.x),l.y=C(l.y),l.width=C(l.width),l.height=C(l.height),Object.assign(r,at(F.RECT,l,r)),m(n,r),I(t,l)};return{start:o=>{a(o.x,o.y,o.x+l.width,o.y+l.height)},move:(o,s)=>{a(s[0][0],s[0][1],o.x,o.y)},end:(o,s)=>{l.width<1&&(l.width=1),l.height<1&&(l.height=1),l.width+l.height<8&&(l.width=80,l.height=80,l.x=l.x-l.width/2,l.y=l.y-l.height/2,Object.assign(r,at(F.RECT,l,r)),m(n,r)),y.data.node=Object.assign({id:e,type:F.RECT,name:"Rect"},{size:l,attribute:r}),null==t||t.remove()}}}}class Ja{constructor(t){let e=N(rt.CREATE_GROUP,"g"),n=t||[[0,0],[1,1],[0,1]],{nodeId:r,element:l,attribute:a,size:o}=Ji(Math.ceil(1e9*Math.random()));o.ratios=n;var s=(d,u,c,h)=>{o=Qt(d,u,c,h,{ratios:n}),o.x=C(o.x),o.y=C(o.y),o.width=C(o.width),o.height=C(o.height),Object.assign(a,at(F.POLYGON,o,a)),m(l,a),I(e,o)};return{start:d=>{s(d.x,d.y,d.x+o.width,d.y+o.height)},move:(d,u)=>{s(u[0][0],u[0][1],d.x,d.y)},end:(d,u)=>{o.width<1&&(o.width=1),o.height<1&&(o.height=1),o.width+o.height<8&&(o.width=80,o.height=80,o.x=o.x-o.width/2,o.y=o.y-o.height/2,Object.assign(a,at(F.POLYGON,o,a)),m(l,a)),y.data.node=Object.assign({id:r,type:F.POLYGON,name:"Polygon"},{size:o,attribute:a}),null==e||e.remove()}}}}class Ra{constructor(){let t=N(rt.CREATE_GROUP,"g"),{nodeId:e,element:n,attribute:r,size:l}=Ai(Math.ceil(1e9*Math.random()));return{start:o=>{},move:(o,s)=>{((o,s,d,u)=>{l=Qt(o,s,d,u),l.x=C(l.x),l.y=C(l.y),l.width=C(l.width),l.height=C(l.height),Object.assign(r,at(F.LINE,l,r)),m(n,r),I(t,l)})(s[0][0],s[0][1],o.x,o.y)},end:(o,s)=>{s.length>=2?(l.width<8&&(l.width=0),l.height<8&&(l.height=0),l.width+l.height<8&&(l.width=80,l.height=0,l.x=l.x-l.width/2,l.y=l.y-l.height/2,Object.assign(r,at(F.LINE,l,r)),m(n,r)),y.data.node=Object.assign({id:e,type:F.LINE,name:"Line"},{size:l,attribute:r})):null==n||n.remove(),null==t||t.remove()}}}}class Mr{constructor(){let{nodeId:t,element:e,attribute:n,size:r}=_e(Math.ceil(1e9*Math.random())),a="";return{start:s=>{a=`M ${s.x} ${s.y} L ${s.x} ${s.y}`},move:(s,d)=>{((s,d)=>{a+=` ${s} ${d}`,e.setAttribute("d",a)})(s.x,s.y)},end:(s,d)=>{let u=Ue(a),{minX:c,minY:h,maxX:f,maxY:v}=He(u);r.x=c,r.y=h,r.width=f-c||1,r.height=v-h||1,r.ratioMaps=We(r,u),y.data.node=Object.assign({id:t,type:F.PATH,name:"Path"},{size:r,attribute:n})}}}}class Kr{constructor(){let t=N(rt.CREATE_GROUP,"g"),{nodeId:e,element:n,size:r,attribute:l,style:a,source:o}=de(Math.ceil(1e9*Math.random()));var s=(d,u,c,h)=>{r=Qt(d,u,c,h),r.x=C(r.x),r.y=C(r.y),r.width=C(r.width),r.height=C(r.height),Object.assign(l,at(F.FOREIGNOBJECT,r,l)),m(n,l),I(t,r)};return{start:d=>{s(d.x,d.y,d.x+r.width,d.y+r.height)},move:(d,u)=>{s(u[0][0],u[0][1],d.x,d.y)},end:(d,u)=>{(r.width<=16||r.height<=16)&&(r.width=90,r.height=60,r.x=r.x-r.width/2,r.y=r.y-r.height/2,Object.assign(l,at(F.FOREIGNOBJECT,r,l)),m(n,l)),y.data.node=Object.assign({id:e,type:F.FOREIGNOBJECT,name:"ForeignObject"},{size:r,attribute:l,style:a,source:o}),null==t||t.remove()}}}}class Dr{constructor(){var t,e;let n=N(rt.CREATE_GROUP,"g"),{nodeId:r,element:l,size:a,attribute:o,source:s}=Se(Math.ceil(1e9*Math.random())),d=1;(c=>{if(!c)return;let h=new Image;h.onload=()=>{d=C(h.naturalWidth/h.naturalHeight,100)},h.onerror=f=>{console.error(`ImgSrc load failed -> ${c}`,f)},h.src=c})(null!==(t=null===(e=s.image)||void 0===e?void 0:e.url)&&void 0!==t?t:"");var u=(c,h,f,v)=>{a=Qt(c,h,f,v,{ratio:d}),a.x=C(a.x),a.y=C(a.y),a.width=C(a.width),a.height=C(a.height),Object.assign(o,at(F.IMAGE,a,o)),m(l,o),I(n,a)};return{start:c=>{u(c.x,c.y,c.x+a.width,c.y+a.height)},move:(c,h)=>{u(h[0][0],h[0][1],c.x,c.y)},end:(c,h)=>{(a.width<=16||a.height<=16)&&(a.width=80,a.height=80,a.x=a.x-a.width/2,a.y=a.y-a.height/2,Object.assign(o,at(F.IMAGE,a,o)),m(l,o)),y.data.node=Object.assign({id:r,type:F.IMAGE,name:"Image"},{size:a,attribute:o,source:s}),null==n||n.remove()}}}}var je=xi(467),Ze=xi(8547);Ze.config({driver:[Ze.INDEXEDDB,Ze.LOCALSTORAGE,Ze.WEBSQL],name:"_localDataDB",version:1});const ue={create:(i=(0,je.A)(function*(){return Ze}),function(){return i.apply(this,arguments)}),get:function(){var i=(0,je.A)(function*(t){return Ze.getItem(t)});return function(e){return i.apply(this,arguments)}}(),set:function(){var i=(0,je.A)(function*(t,e){return Ze.setItem(t,e)});return function(e,n){return i.apply(this,arguments)}}()},za=function(){var i=(0,je.A)(function*(t){yield ue.create();var e=(yield ue.get("icdt-data"))||[];"function"==typeof t.callback&&t.callback(e)});return function(e){return i.apply(this,arguments)}}(),Fa=function(){var i=(0,je.A)(function*(t){yield ue.create(),t.params=t.params||{};try{yield ue.set("icdt-data",t.params),"function"==typeof t.callback&&t.callback(t.params)}catch(e){"function"==typeof t.callback&&t.callback(null),console.error(e)}});return function(e){return i.apply(this,arguments)}}(),La=function(){var i=(0,je.A)(function*(t){yield ue.create();try{var e=(yield ue.get("icdt-config"))||{};"function"==typeof t.callback&&t.callback(e)}catch(n){"function"==typeof t.callback&&t.callback(null),console.error(n)}});return function(e){return i.apply(this,arguments)}}(),Ba=function(){var i=(0,je.A)(function*(t){yield ue.create(),t.params=t.params||{};try{yield ue.set("icdt-config",t.params),"function"==typeof t.callback&&t.callback(t.params)}catch(e){"function"==typeof t.callback&&t.callback(null),console.error(e)}});return function(e){return i.apply(this,arguments)}}(),Gr=function(){var i=(0,je.A)(function*(t){yield ue.create();try{var e=(yield ue.get("icdt-clipboard"))||{};"function"==typeof t.callback&&t.callback(e)}catch(n){"function"==typeof t.callback&&t.callback(null),console.error(n)}});return function(e){return i.apply(this,arguments)}}(),Qr=function(){var i=(0,je.A)(function*(t){yield ue.create(),t.params=t.params||{};try{yield ue.set("icdt-clipboard",t.params),"function"==typeof t.callback&&t.callback(t.params)}catch(e){"function"==typeof t.callback&&t.callback(null),console.error(e)}});return function(e){return i.apply(this,arguments)}}(),ce=(i,t,e)=>{var n;if(t&&!(null!=e?e:window).document.getElementById(t))return;if(t){let l=(null!=e?e:window).document.getElementById(t);jQuery(l).find("#"+rt.BACKGROUND_GROUP).empty();let a=N(rt.BACKGROUND_GROUP,"g",void 0,l);st(a,i)}else{jQuery(y.target).find("#"+rt.BACKGROUND_GROUP).empty();let l=N(rt.BACKGROUND_GROUP,"g",void 0,y.target);st(l,i)}let r=(l,a)=>{a=t&&a?`${t}-${a}`:null!=t?t:a,null==l||l.forEach(o=>{let s=t?`${t}-${o.id}`:o.id;var d;if(o.isdeleted)null===(d=(null!=e?e:window).document.getElementById(s))||void 0===d||d.remove();else switch(o.type){case F.GROUP:Pe(s,{},a?(null!=e?e:window).document.getElementById(a):null),r(o.nodes,o.id);break;case F.CIRCLE:ke(s,{size:o.size,attribute:o.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case F.ELLIPSE:Ci(s,{size:o.size,attribute:o.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case F.LINE:Ai(s,{size:o.size,attribute:o.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case F.RECT:ye(s,{size:o.size,attribute:o.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case F.POLYGON:Ji(s,{size:o.size,attribute:o.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case F.POLYLINE:sn(s,{size:o.size,attribute:o.attribute},a?(null!=e?e:window).document.getElementById(a):null);break;case F.FOREIGNOBJECT:de(s,{size:o.size,attribute:o.attribute,style:o.style,source:o.source},a?(null!=e?e:window).document.getElementById(a):null);break;case F.IMAGE:Se(s,{size:o.size,attribute:o.attribute,source:o.source},a?(null!=e?e:window).document.getElementById(a):null);break;case F.TEXT:Je(s,{size:o.size,attribute:o.attribute,source:o.source},a?(null!=e?e:window).document.getElementById(a):null);break;case F.TSPAN:Ri(s,{size:o.size,attribute:o.attribute,source:o.source},a?(null!=e?e:window).document.getElementById(a):null);break;case F.PATH:_e(s,{size:o.size,attribute:o.attribute},a?(null!=e?e:window).document.getElementById(a):null)}})};r(null==i||null===(n=i.svg)||void 0===n?void 0:n.nodes)},hn=(i,t)=>{var e;if(t&&!window.document.getElementById(t))return;let n=(r,l)=>{l=l?`${t}-${l}`:t,null==r||r.forEach(a=>{jQuery("#"+(t?`${t}-${a.id}`:a.id)).appendTo(l?window.document.getElementById(l):y.target),a.type==F.GROUP&&n(a.nodes,a.id)})};n(null==i||null===(e=i.svg)||void 0===e?void 0:e.nodes)},or=(i,t)=>{let{id:e,type:n,size:r,attribute:l}=i,a=JSON.parse(JSON.stringify({id:e,size:r,attribute:l}));r.x=C(t||0),Object.assign(l,at(n,r,l)),m(window.document.getElementById(e),l),y.history.push([{type:"size",from:a,to:JSON.parse(JSON.stringify({id:e,size:r,attribute:l}))}])},sr=(i,t)=>{let{id:e,type:n,size:r,attribute:l}=i,a=JSON.parse(JSON.stringify({id:e,size:r,attribute:l}));r.y=C(t||0),Object.assign(l,at(n,r,l)),m(window.document.getElementById(e),l),y.history.push([{type:"size",from:a,to:JSON.parse(JSON.stringify({id:e,size:r,attribute:l}))}])},Pa=(i,t,e)=>{let{id:n,type:r,size:l,attribute:a}=i;t<=0&&(t=1);let o=JSON.parse(JSON.stringify({id:n,size:l,attribute:a}));e&&(l.height=C(t*l.height/(l.width||1))),l.width=C(t),Object.assign(a,at(r,l,a)),m(window.document.getElementById(n),a),y.history.push([{type:"size",from:o,to:JSON.parse(JSON.stringify({id:n,size:l,attribute:a}))}])},Ma=(i,t,e)=>{let{id:n,type:r,size:l,attribute:a}=i;t<=0&&(t=1);let o=JSON.parse(JSON.stringify({id:n,size:l,attribute:a}));e&&(l.width=C(t*l.width/(l.height||1))),l.height=C(t),Object.assign(a,at(r,l,a)),m(window.document.getElementById(n),a),y.history.push([{type:"size",from:o,to:JSON.parse(JSON.stringify({id:n,size:l,attribute:a}))}])},Ka=(i,t)=>{let{id:e,type:n,size:r,attribute:l}=i,a=JSON.parse(JSON.stringify({id:e,size:r,attribute:l}));r.rotate="number"==typeof t?C(t,100):void 0,Object.assign(l,at(n,r,l)),m(window.document.getElementById(e),l),y.history.push([{type:"size",from:a,to:JSON.parse(JSON.stringify({id:e,size:r,attribute:l}))}])};var i;const Ur=new class Da{constructor(){this._fnChanges=[],this.onchange={type:"keydown",key:bt.Escape,fn:()=>{y.dataSelect.ids.length&&(y.dataSelect.ids=[])}},this.onchange={type:"keydown",key:bt.Delete,fn:()=>{y.dataSelect.deleteNode()}},this.onchange={type:"keydown",key:bt.Space,fn:()=>{y.pointer.pointer_type_temp=vt.HAND}},this.onchange={type:"keyup",key:bt.Space,fn:()=>{y.pointer.pointer_type_temp=vt.POINTER}},this.onchange={type:"keydown",key:bt.ArrowLeft,fn:()=>{y.dataSelect.ids.length||y.data.backSlide()}},this.onchange={type:"keydown",key:bt.ArrowRight,fn:()=>{y.dataSelect.ids.length||y.data.nextSlide()}},this.onchange={type:"keydown",key:bt.PageDown,fn:()=>{y.dataSelect.ids.length||y.data.backSlide()}},this.onchange={type:"keydown",key:bt.PageUp,fn:()=>{y.dataSelect.ids.length||y.data.nextSlide()}},this.onchange={type:"keydown",key:bt.ArrowLeft,fn:()=>{y.dataSelect.ids.length&&(y.dataSelect.nodes.forEach(t=>{or(t,C(t.size.x-lt(1)))}),te(y.dataSelect.nodes))}},this.onchange={type:"keydown",key:bt.ArrowRight,fn:()=>{y.dataSelect.ids.length&&(y.dataSelect.nodes.forEach(t=>{or(t,C(t.size.x+lt(1)))}),te(y.dataSelect.nodes))}},this.onchange={type:"keydown",key:bt.ArrowUp,fn:()=>{y.dataSelect.ids.length&&(y.dataSelect.nodes.forEach(t=>{sr(t,C(t.size.y-lt(1)))}),te(y.dataSelect.nodes))}},this.onchange={type:"keydown",key:bt.ArrowDown,fn:()=>{y.dataSelect.ids.length&&(y.dataSelect.nodes.forEach(t=>{sr(t,C(t.size.y+lt(1)))}),te(y.dataSelect.nodes))}},this.onchange={type:"keydown",key:bt.Digit1,fn:t=>{t.shiftKey&&(y.reloadView(),y.screen.zoomTo="fit")}},this.onchange={type:"keydown",key:bt.Digit0,fn:t=>{t.ctrlKey&&(y.screen.zoomTo=100)}},this.onchange={type:"keydown",key:bt.Equal,fn:t=>{t.ctrlKey&&y.screen.zoomIn()}},this.onchange={type:"keydown",key:bt.Minus,fn:t=>{t.ctrlKey&&y.screen.zoomOut()}},this.onchange={type:"keydown",key:bt.KeyA,fn:t=>{t.ctrlKey&&(y.dataSelect.ids=y.data.getNodeAll(),te(y.dataSelect.nodes))}},this.onchange={type:"keydown",key:bt.KeyC,fn:t=>{if(t.ctrlKey){let e=y.dataSelect.nodes;e&&Qr({params:{type:"nodes",nodes:e}})}}},this.onchange={type:"keydown",key:bt.KeyV,fn:t=>{t.ctrlKey&&Gr({callback:e=>{var n,r;"nodes"==(null==e?void 0:e.type)&&null!=e&&null!==(n=e.nodes)&&void 0!==n&&n.length&&(null==e||null===(r=e.nodes)||void 0===r||r.forEach(l=>{t.shiftKey||y.data.findNode(l.id).id&&(l.size.x+=16,l.size.y+=16),l.id=Math.ceil(1e9*Math.random()),y.data.node=l}),ce(y.data.slide))}})}},this.onchange={type:"keydown",key:bt.KeyZ,fn:t=>{t.ctrlKey&&t.shiftKey?y.history.redo():t.ctrlKey&&y.history.undo()}},this.onchange={type:"keydown",key:bt.BracketLeft,fn:t=>{t.ctrlKey&&t.shiftKey?y.data.sendToBack(y.dataSelect.ids):t.ctrlKey?y.data.sendToBackStep(y.dataSelect.ids,-2):y.data.sendToBackArea(y.dataSelect.ids)}},this.onchange={type:"keydown",key:bt.BracketRight,fn:t=>{t.ctrlKey&&t.shiftKey?y.data.bringToFront(y.dataSelect.ids):t.ctrlKey?y.data.bringToFrontStep(y.dataSelect.ids,1):y.data.bringToFrontArea(y.dataSelect.ids)}}}set onchange(t){let e=this._fnChanges.find(n=>n.eventType==t.type&&n.eventKey==t.key);e?e.fns.push(t.fn):this._fnChanges.push({eventType:t.type,eventKey:t.key,fns:[t.fn]})}change(t,e,n){var r;y.dataSelect.contenteditable_id||null===(r=this._fnChanges.find(l=>l.eventType==t&&l.eventKey==e))||void 0===r||r.fns.forEach(l=>l(n))}},Hr=i=>{Ur.change(i.type,i.keyCode||i.which||i.charCode||0,i)};function Ga(){}function dr(i){return null==i?Ga:function(){return this.querySelector(i)}}function Ha(){return[]}function Wr(i){return null==i?Ha:function(){return this.querySelectorAll(i)}}function Yr(i){return function(){return this.matches(i)}}function Xr(i){return function(t){return t.matches(i)}}var Xa=Array.prototype.find;function Za(){return this.firstElementChild}var $a=Array.prototype.filter;function to(){return Array.from(this.children)}function qr(i){return new Array(i.length)}function fn(i,t){this.ownerDocument=i.ownerDocument,this.namespaceURI=i.namespaceURI,this._next=null,this._parent=i,this.__data__=t}function ao(i,t,e,n,r,l){for(var o,a=0,s=t.length,d=l.length;a<d;++a)(o=t[a])?(o.__data__=l[a],n[a]=o):e[a]=new fn(i,l[a]);for(;a<s;++a)(o=t[a])&&(r[a]=o)}function oo(i,t,e,n,r,l,a){var o,s,f,d=new Map,u=t.length,c=l.length,h=new Array(u);for(o=0;o<u;++o)(s=t[o])&&(h[o]=f=a.call(s,s.__data__,o,t)+"",d.has(f)?r[o]=s:d.set(f,s));for(o=0;o<c;++o)f=a.call(i,l[o],o,l)+"",(s=d.get(f))?(n[o]=s,s.__data__=l[o],d.delete(f)):e[o]=new fn(i,l[o]);for(o=0;o<u;++o)(s=t[o])&&d.get(h[o])===s&&(r[o]=s)}function so(i){return i.__data__}function co(i){return"object"==typeof i&&"length"in i?i:Array.from(i)}function po(i,t){return i<t?-1:i>t?1:i>=t?0:NaN}fn.prototype={constructor:fn,appendChild:function(i){return this._parent.insertBefore(i,this._next)},insertBefore:function(i,t){return this._parent.insertBefore(i,t)},querySelector:function(i){return this._parent.querySelector(i)},querySelectorAll:function(i){return this._parent.querySelectorAll(i)}};var ur="http://www.w3.org/1999/xhtml";const Zr={svg:"http://www.w3.org/2000/svg",xhtml:ur,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function vn(i){var t=i+="",e=t.indexOf(":");return e>=0&&"xmlns"!==(t=i.slice(0,e))&&(i=i.slice(e+1)),Zr.hasOwnProperty(t)?{space:Zr[t],local:i}:i}function Oo(i){return function(){this.removeAttribute(i)}}function No(i){return function(){this.removeAttributeNS(i.space,i.local)}}function _o(i,t){return function(){this.setAttribute(i,t)}}function Eo(i,t){return function(){this.setAttributeNS(i.space,i.local,t)}}function To(i,t){return function(){var e=t.apply(this,arguments);null==e?this.removeAttribute(i):this.setAttribute(i,e)}}function Io(i,t){return function(){var e=t.apply(this,arguments);null==e?this.removeAttributeNS(i.space,i.local):this.setAttributeNS(i.space,i.local,e)}}function Vr(i){return i.ownerDocument&&i.ownerDocument.defaultView||i.document&&i||i.defaultView}function Ao(i){return function(){this.style.removeProperty(i)}}function Jo(i,t,e){return function(){this.style.setProperty(i,t,e)}}function Ro(i,t,e){return function(){var n=t.apply(this,arguments);null==n?this.style.removeProperty(i):this.style.setProperty(i,n,e)}}function hi(i,t){return i.style.getPropertyValue(t)||Vr(i).getComputedStyle(i,null).getPropertyValue(t)}function zo(i){return function(){delete this[i]}}function Fo(i,t){return function(){this[i]=t}}function Lo(i,t){return function(){var e=t.apply(this,arguments);null==e?delete this[i]:this[i]=e}}function $r(i){return i.trim().split(/^|\s+/)}function cr(i){return i.classList||new tl(i)}function tl(i){this._node=i,this._names=$r(i.getAttribute("class")||"")}function el(i,t){for(var e=cr(i),n=-1,r=t.length;++n<r;)e.add(t[n])}function il(i,t){for(var e=cr(i),n=-1,r=t.length;++n<r;)e.remove(t[n])}function Po(i){return function(){el(this,i)}}function Mo(i){return function(){il(this,i)}}function Ko(i,t){return function(){(t.apply(this,arguments)?el:il)(this,i)}}function Go(){this.textContent=""}function Qo(i){return function(){this.textContent=i}}function Uo(i){return function(){var t=i.apply(this,arguments);this.textContent=null==t?"":t}}function Wo(){this.innerHTML=""}function Yo(i){return function(){this.innerHTML=i}}function Xo(i){return function(){var t=i.apply(this,arguments);this.innerHTML=null==t?"":t}}function Zo(){this.nextSibling&&this.parentNode.appendChild(this)}function $o(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function es(i){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===ur&&t.documentElement.namespaceURI===ur?t.createElement(i):t.createElementNS(e,i)}}function is(i){return function(){return this.ownerDocument.createElementNS(i.space,i.local)}}function nl(i){var t=vn(i);return(t.local?is:es)(t)}function rs(){return null}function as(){var i=this.parentNode;i&&i.removeChild(this)}function ss(){var i=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(i,this.nextSibling):i}function ds(){var i=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(i,this.nextSibling):i}function vs(i){return function(){var t=this.__on;if(t){for(var l,e=0,n=-1,r=t.length;e<r;++e)l=t[e],i.type&&l.type!==i.type||l.name!==i.name?t[++n]=l:this.removeEventListener(l.type,l.listener,l.options);++n?t.length=n:delete this.__on}}}function gs(i,t,e){return function(){var r,n=this.__on,l=function hs(i){return function(t){i.call(this,t,this.__data__)}}(t);if(n)for(var a=0,o=n.length;a<o;++a)if((r=n[a]).type===i.type&&r.name===i.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=l,r.options=e),void(r.value=t);this.addEventListener(i.type,l,e),r={type:i.type,name:i.name,value:t,listener:l,options:e},n?n.push(r):this.__on=[r]}}function rl(i,t,e){var n=Vr(i),r=n.CustomEvent;"function"==typeof r?r=new r(t,e):(r=n.document.createEvent("Event"),e?(r.initEvent(t,e.bubbles,e.cancelable),r.detail=e.detail):r.initEvent(t,!1,!1)),i.dispatchEvent(r)}function ps(i,t){return function(){return rl(this,i,t)}}function ms(i,t){return function(){return rl(this,i,t.apply(this,arguments))}}tl.prototype={add:function(i){this._names.indexOf(i)<0&&(this._names.push(i),this._node.setAttribute("class",this._names.join(" ")))},remove:function(i){var t=this._names.indexOf(i);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(i){return this._names.indexOf(i)>=0}};var xs=[null];function me(i,t){this._groups=i,this._parents=t}function ll(){return new me([[document.documentElement]],xs)}me.prototype=ll.prototype={constructor:me,select:function Qa(i){"function"!=typeof i&&(i=dr(i));for(var t=this._groups,e=t.length,n=new Array(e),r=0;r<e;++r)for(var s,d,l=t[r],a=l.length,o=n[r]=new Array(a),u=0;u<a;++u)(s=l[u])&&(d=i.call(s,s.__data__,u,l))&&("__data__"in s&&(d.__data__=s.__data__),o[u]=d);return new me(n,this._parents)},selectAll:function Ya(i){i="function"==typeof i?function Wa(i){return function(){return function Ua(i){return null==i?[]:Array.isArray(i)?i:Array.from(i)}(i.apply(this,arguments))}}(i):Wr(i);for(var t=this._groups,e=t.length,n=[],r=[],l=0;l<e;++l)for(var s,a=t[l],o=a.length,d=0;d<o;++d)(s=a[d])&&(n.push(i.call(s,s.__data__,d,a)),r.push(s));return new me(n,r)},selectChild:function Va(i){return this.select(null==i?Za:function qa(i){return function(){return Xa.call(this.children,i)}}("function"==typeof i?i:Xr(i)))},selectChildren:function io(i){return this.selectAll(null==i?to:function eo(i){return function(){return $a.call(this.children,i)}}("function"==typeof i?i:Xr(i)))},filter:function no(i){"function"!=typeof i&&(i=Yr(i));for(var t=this._groups,e=t.length,n=new Array(e),r=0;r<e;++r)for(var s,l=t[r],a=l.length,o=n[r]=[],d=0;d<a;++d)(s=l[d])&&i.call(s,s.__data__,d,l)&&o.push(s);return new me(n,this._parents)},data:function uo(i,t){if(!arguments.length)return Array.from(this,so);var e=t?oo:ao,n=this._parents,r=this._groups;"function"!=typeof i&&(i=function lo(i){return function(){return i}}(i));for(var l=r.length,a=new Array(l),o=new Array(l),s=new Array(l),d=0;d<l;++d){var u=n[d],c=r[d],h=c.length,f=co(i.call(u,u&&u.__data__,d,n)),v=f.length,b=o[d]=new Array(v),p=a[d]=new Array(v);e(u,c,b,p,s[d]=new Array(h),f,t);for(var w,S,O=0,x=0;O<v;++O)if(w=b[O]){for(O>=x&&(x=O+1);!(S=p[x])&&++x<v;);w._next=S||null}}return(a=new me(a,n))._enter=o,a._exit=s,a},enter:function ro(){return new me(this._enter||this._groups.map(qr),this._parents)},exit:function ho(){return new me(this._exit||this._groups.map(qr),this._parents)},join:function fo(i,t,e){var n=this.enter(),r=this,l=this.exit();return"function"==typeof i?(n=i(n))&&(n=n.selection()):n=n.append(i+""),null!=t&&(r=t(r))&&(r=r.selection()),null==e?l.remove():e(l),n&&r?n.merge(r).order():r},merge:function vo(i){for(var t=i.selection?i.selection():i,e=this._groups,n=t._groups,r=e.length,a=Math.min(r,n.length),o=new Array(r),s=0;s<a;++s)for(var f,d=e[s],u=n[s],c=d.length,h=o[s]=new Array(c),v=0;v<c;++v)(f=d[v]||u[v])&&(h[v]=f);for(;s<r;++s)o[s]=e[s];return new me(o,this._parents)},selection:function Ss(){return this},order:function go(){for(var i=this._groups,t=-1,e=i.length;++t<e;)for(var a,n=i[t],r=n.length-1,l=n[r];--r>=0;)(a=n[r])&&(l&&4^a.compareDocumentPosition(l)&&l.parentNode.insertBefore(a,l),l=a);return this},sort:function yo(i){function t(c,h){return c&&h?i(c.__data__,h.__data__):!c-!h}i||(i=po);for(var e=this._groups,n=e.length,r=new Array(n),l=0;l<n;++l){for(var d,a=e[l],o=a.length,s=r[l]=new Array(o),u=0;u<o;++u)(d=a[u])&&(s[u]=d);s.sort(t)}return new me(r,this._parents).order()},call:function mo(){var i=arguments[0];return arguments[0]=this,i.apply(null,arguments),this},nodes:function wo(){return Array.from(this)},node:function bo(){for(var i=this._groups,t=0,e=i.length;t<e;++t)for(var n=i[t],r=0,l=n.length;r<l;++r){var a=n[r];if(a)return a}return null},size:function xo(){let i=0;for(const t of this)++i;return i},empty:function So(){return!this.node()},each:function ko(i){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var o,r=t[e],l=0,a=r.length;l<a;++l)(o=r[l])&&i.call(o,o.__data__,l,r);return this},attr:function Co(i,t){var e=vn(i);if(arguments.length<2){var n=this.node();return e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}return this.each((null==t?e.local?No:Oo:"function"==typeof t?e.local?Io:To:e.local?Eo:_o)(e,t))},style:function jo(i,t,e){return arguments.length>1?this.each((null==t?Ao:"function"==typeof t?Ro:Jo)(i,t,null==e?"":e)):hi(this.node(),i)},property:function Bo(i,t){return arguments.length>1?this.each((null==t?zo:"function"==typeof t?Lo:Fo)(i,t)):this.node()[i]},classed:function Do(i,t){var e=$r(i+"");if(arguments.length<2){for(var n=cr(this.node()),r=-1,l=e.length;++r<l;)if(!n.contains(e[r]))return!1;return!0}return this.each(("function"==typeof t?Ko:t?Po:Mo)(e,t))},text:function Ho(i){return arguments.length?this.each(null==i?Go:("function"==typeof i?Uo:Qo)(i)):this.node().textContent},html:function qo(i){return arguments.length?this.each(null==i?Wo:("function"==typeof i?Xo:Yo)(i)):this.node().innerHTML},raise:function Vo(){return this.each(Zo)},lower:function ts(){return this.each($o)},append:function ns(i){var t="function"==typeof i?i:nl(i);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function ls(i,t){var e="function"==typeof i?i:nl(i),n=null==t?rs:"function"==typeof t?t:dr(t);return this.select(function(){return this.insertBefore(e.apply(this,arguments),n.apply(this,arguments)||null)})},remove:function os(){return this.each(as)},clone:function us(i){return this.select(i?ds:ss)},datum:function cs(i){return arguments.length?this.property("__data__",i):this.node().__data__},on:function ys(i,t,e){var r,a,n=function fs(i){return i.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(i+""),l=n.length;if(!(arguments.length<2)){for(o=t?gs:vs,r=0;r<l;++r)this.each(o(n[r],t,e));return this}var o=this.node().__on;if(o)for(var u,s=0,d=o.length;s<d;++s)for(r=0,u=o[s];r<l;++r)if((a=n[r]).type===u.type&&a.name===u.name)return u.value},dispatch:function ws(i,t){return this.each(("function"==typeof t?ms:ps)(i,t))},[Symbol.iterator]:function*bs(){for(var i=this._groups,t=0,e=i.length;t<e;++t)for(var a,n=i[t],r=0,l=n.length;r<l;++r)(a=n[r])&&(yield a)}};const Li=ll;var ks={value:()=>{}};function al(){for(var n,i=0,t=arguments.length,e={};i<t;++i){if(!(n=arguments[i]+"")||n in e||/[\s.]/.test(n))throw new Error("illegal type: "+n);e[n]=[]}return new gn(e)}function gn(i){this._=i}function Ns(i,t){for(var r,e=0,n=i.length;e<n;++e)if((r=i[e]).name===t)return r.value}function ol(i,t,e){for(var n=0,r=i.length;n<r;++n)if(i[n].name===t){i[n]=ks,i=i.slice(0,n).concat(i.slice(n+1));break}return null!=e&&i.push({name:t,value:e}),i}gn.prototype=al.prototype={constructor:gn,on:function(i,t){var r,e=this._,n=function Os(i,t){return i.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}})}(i+"",e),l=-1,a=n.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++l<a;)if(r=(i=n[l]).type)e[r]=ol(e[r],i.name,t);else if(null==t)for(r in e)e[r]=ol(e[r],i.name,null);return this}for(;++l<a;)if((r=(i=n[l]).type)&&(r=Ns(e[r],i.name)))return r},copy:function(){var i={},t=this._;for(var e in t)i[e]=t[e].slice();return new gn(i)},call:function(i,t){if((r=arguments.length-2)>0)for(var r,l,e=new Array(r),n=0;n<r;++n)e[n]=arguments[n+2];if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(n=0,r=(l=this._[i]).length;n<r;++n)l[n].value.apply(t,e)},apply:function(i,t,e){if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(var n=this._[i],r=0,l=n.length;r<l;++r)n[r].value.apply(t,e)}};const _s=al;var yn,Mi,fi=0,Bi=0,Pi=0,sl=1e3,pn=0,Ve=0,mn=0,Ki="object"==typeof performance&&performance.now?performance:Date,dl="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(i){setTimeout(i,17)};function hr(){return Ve||(dl(Es),Ve=Ki.now()+mn)}function Es(){Ve=0}function wn(){this._call=this._time=this._next=null}function ul(i,t,e){var n=new wn;return n.restart(i,t,e),n}function cl(){Ve=(pn=Ki.now())+mn,fi=Bi=0;try{!function Ts(){hr(),++fi;for(var t,i=yn;i;)(t=Ve-i._time)>=0&&i._call.call(void 0,t),i=i._next;--fi}()}finally{fi=0,function Cs(){for(var i,e,t=yn,n=1/0;t;)t._call?(n>t._time&&(n=t._time),i=t,t=t._next):(e=t._next,t._next=null,t=i?i._next=e:yn=e);Mi=i,fr(n)}(),Ve=0}}function Is(){var i=Ki.now(),t=i-pn;t>sl&&(mn-=t,pn=i)}function fr(i){fi||(Bi&&(Bi=clearTimeout(Bi)),i-Ve>24?(i<1/0&&(Bi=setTimeout(cl,i-Ki.now()-mn)),Pi&&(Pi=clearInterval(Pi))):(Pi||(pn=Ki.now(),Pi=setInterval(Is,sl)),fi=1,dl(cl)))}function hl(i,t,e){var n=new wn;return n.restart(r=>{n.stop(),i(r+t)},t=null==t?0:+t,e),n}wn.prototype=ul.prototype={constructor:wn,restart:function(i,t,e){if("function"!=typeof i)throw new TypeError("callback is not a function");e=(null==e?hr():+e)+(null==t?0:+t),!this._next&&Mi!==this&&(Mi?Mi._next=this:yn=this,Mi=this),this._call=i,this._time=e,fr()},stop:function(){this._call&&(this._call=null,this._time=1/0,fr())}};var As=_s("start","end","cancel","interrupt"),Js=[],fl=0,bn=3;function Sn(i,t,e,n,r,l){var a=i.__transition;if(a){if(e in a)return}else i.__transition={};!function Rs(i,t,e){var r,n=i.__transition;function a(d){var u,c,h,f;if(1!==e.state)return s();for(u in n)if((f=n[u]).name===e.name){if(f.state===bn)return hl(a);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",i,i.__data__,f.index,f.group),delete n[u]):+u<t&&(f.state=6,f.timer.stop(),f.on.call("cancel",i,i.__data__,f.index,f.group),delete n[u])}if(hl(function(){e.state===bn&&(e.state=4,e.timer.restart(o,e.delay,e.time),o(d))}),e.state=2,e.on.call("start",i,i.__data__,e.index,e.group),2===e.state){for(e.state=bn,r=new Array(h=e.tween.length),u=0,c=-1;u<h;++u)(f=e.tween[u].value.call(i,i.__data__,e.index,e.group))&&(r[++c]=f);r.length=c+1}}function o(d){for(var u=d<e.duration?e.ease.call(null,d/e.duration):(e.timer.restart(s),e.state=5,1),c=-1,h=r.length;++c<h;)r[c].call(i,u);5===e.state&&(e.on.call("end",i,i.__data__,e.index,e.group),s())}function s(){for(var d in e.state=6,e.timer.stop(),delete n[t],n)return;delete i.__transition}n[t]=e,e.timer=ul(function l(d){e.state=1,e.timer.restart(a,e.delay,e.time),e.delay<=d&&a(d-e.delay)},0,e.time)}(i,e,{name:t,index:n,group:r,on:As,tween:Js,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:fl})}function yr(i,t){var e=we(i,t);if(e.state>fl)throw new Error("too late; already scheduled");return e}function Ee(i,t){var e=we(i,t);if(e.state>bn)throw new Error("too late; already running");return e}function we(i,t){var e=i.__transition;if(!e||!(e=e[t]))throw new Error("transition not found");return e}function Ke(i,t){return i=+i,t=+t,function(e){return i*(1-e)+t*e}}var kn,yl=180/Math.PI,pr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function pl(i,t,e,n,r,l){var a,o,s;return(a=Math.sqrt(i*i+t*t))&&(i/=a,t/=a),(s=i*e+t*n)&&(e-=i*s,n-=t*s),(o=Math.sqrt(e*e+n*n))&&(e/=o,n/=o,s/=o),i*n<t*e&&(i=-i,t=-t,s=-s,a=-a),{translateX:r,translateY:l,rotate:Math.atan2(t,i)*yl,skewX:Math.atan(s)*yl,scaleX:a,scaleY:o}}function ml(i,t,e,n){function r(d){return d.length?d.pop()+" ":""}return function(d,u){var c=[],h=[];return d=i(d),u=i(u),function l(d,u,c,h,f,v){if(d!==c||u!==h){var b=f.push("translate(",null,t,null,e);v.push({i:b-4,x:Ke(d,c)},{i:b-2,x:Ke(u,h)})}else(c||h)&&f.push("translate("+c+t+h+e)}(d.translateX,d.translateY,u.translateX,u.translateY,c,h),function a(d,u,c,h){d!==u?(d-u>180?u+=360:u-d>180&&(d+=360),h.push({i:c.push(r(c)+"rotate(",null,n)-2,x:Ke(d,u)})):u&&c.push(r(c)+"rotate("+u+n)}(d.rotate,u.rotate,c,h),function o(d,u,c,h){d!==u?h.push({i:c.push(r(c)+"skewX(",null,n)-2,x:Ke(d,u)}):u&&c.push(r(c)+"skewX("+u+n)}(d.skewX,u.skewX,c,h),function s(d,u,c,h,f,v){if(d!==c||u!==h){var b=f.push(r(f)+"scale(",null,",",null,")");v.push({i:b-4,x:Ke(d,c)},{i:b-2,x:Ke(u,h)})}else(1!==c||1!==h)&&f.push(r(f)+"scale("+c+","+h+")")}(d.scaleX,d.scaleY,u.scaleX,u.scaleY,c,h),d=u=null,function(f){for(var p,v=-1,b=h.length;++v<b;)c[(p=h[v]).i]=p.x(f);return c.join("")}}}var Bs=ml(function Fs(i){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(i+"");return t.isIdentity?pr:pl(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),Ps=ml(function Ls(i){return null!=i&&(kn||(kn=document.createElementNS("http://www.w3.org/2000/svg","g")),kn.setAttribute("transform",i),i=kn.transform.baseVal.consolidate())?pl((i=i.matrix).a,i.b,i.c,i.d,i.e,i.f):pr},", ",")",")");function Ms(i,t){var e,n;return function(){var r=Ee(this,i),l=r.tween;if(l!==e)for(var a=0,o=(n=e=l).length;a<o;++a)if(n[a].name===t){(n=n.slice()).splice(a,1);break}r.tween=n}}function Ks(i,t,e){var n,r;if("function"!=typeof e)throw new Error;return function(){var l=Ee(this,i),a=l.tween;if(a!==n){r=(n=a).slice();for(var o={name:t,value:e},s=0,d=r.length;s<d;++s)if(r[s].name===t){r[s]=o;break}s===d&&r.push(o)}l.tween=r}}function mr(i,t,e){var n=i._id;return i.each(function(){var r=Ee(this,n);(r.value||(r.value={}))[t]=e.apply(this,arguments)}),function(r){return we(r,n).value[t]}}function wr(i,t,e){i.prototype=t.prototype=e,e.constructor=i}function wl(i,t){var e=Object.create(i.prototype);for(var n in t)e[n]=t[n];return e}function Di(){}var On=1/.7,vi="\\s*([+-]?\\d+)\\s*",Qi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Te="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Gs=/^#([0-9a-f]{3,8})$/,Qs=new RegExp(`^rgb\\(${vi},${vi},${vi}\\)$`),Us=new RegExp(`^rgb\\(${Te},${Te},${Te}\\)$`),Hs=new RegExp(`^rgba\\(${vi},${vi},${vi},${Qi}\\)$`),Ws=new RegExp(`^rgba\\(${Te},${Te},${Te},${Qi}\\)$`),Ys=new RegExp(`^hsl\\(${Qi},${Te},${Te}\\)$`),Xs=new RegExp(`^hsla\\(${Qi},${Te},${Te},${Qi}\\)$`),bl={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function xl(){return this.rgb().formatHex()}function Sl(){return this.rgb().formatRgb()}function Ui(i){var t,e;return i=(i+"").trim().toLowerCase(),(t=Gs.exec(i))?(e=t[1].length,t=parseInt(t[1],16),6===e?kl(t):3===e?new re(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===e?Nn(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===e?Nn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Qs.exec(i))?new re(t[1],t[2],t[3],1):(t=Us.exec(i))?new re(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Hs.exec(i))?Nn(t[1],t[2],t[3],t[4]):(t=Ws.exec(i))?Nn(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Ys.exec(i))?_l(t[1],t[2]/100,t[3]/100,1):(t=Xs.exec(i))?_l(t[1],t[2]/100,t[3]/100,t[4]):bl.hasOwnProperty(i)?kl(bl[i]):"transparent"===i?new re(NaN,NaN,NaN,0):null}function kl(i){return new re(i>>16&255,i>>8&255,255&i,1)}function Nn(i,t,e,n){return n<=0&&(i=t=e=NaN),new re(i,t,e,n)}function _n(i,t,e,n){return 1===arguments.length?function Vs(i){return i instanceof Di||(i=Ui(i)),i?new re((i=i.rgb()).r,i.g,i.b,i.opacity):new re}(i):new re(i,t,e,null==n?1:n)}function re(i,t,e,n){this.r=+i,this.g=+t,this.b=+e,this.opacity=+n}function Ol(){return`#${ti(this.r)}${ti(this.g)}${ti(this.b)}`}function Nl(){const i=En(this.opacity);return`${1===i?"rgb(":"rgba("}${$e(this.r)}, ${$e(this.g)}, ${$e(this.b)}${1===i?")":`, ${i})`}`}function En(i){return isNaN(i)?1:Math.max(0,Math.min(1,i))}function $e(i){return Math.max(0,Math.min(255,Math.round(i)||0))}function ti(i){return((i=$e(i))<16?"0":"")+i.toString(16)}function _l(i,t,e,n){return n<=0?i=t=e=NaN:e<=0||e>=1?i=t=NaN:t<=0&&(i=NaN),new be(i,t,e,n)}function El(i){if(i instanceof be)return new be(i.h,i.s,i.l,i.opacity);if(i instanceof Di||(i=Ui(i)),!i)return new be;if(i instanceof be)return i;var t=(i=i.rgb()).r/255,e=i.g/255,n=i.b/255,r=Math.min(t,e,n),l=Math.max(t,e,n),a=NaN,o=l-r,s=(l+r)/2;return o?(a=t===l?(e-n)/o+6*(e<n):e===l?(n-t)/o+2:(t-e)/o+4,o/=s<.5?l+r:2-l-r,a*=60):o=s>0&&s<1?0:a,new be(a,o,s,i.opacity)}function be(i,t,e,n){this.h=+i,this.s=+t,this.l=+e,this.opacity=+n}function Tl(i){return(i=(i||0)%360)<0?i+360:i}function Tn(i){return Math.max(0,Math.min(1,i||0))}function br(i,t,e){return 255*(i<60?t+(e-t)*i/60:i<180?e:i<240?t+(e-t)*(240-i)/60:t)}function Il(i,t,e,n,r){var l=i*i,a=l*i;return((1-3*i+3*l-a)*t+(4-6*l+3*a)*e+(1+3*i+3*l-3*a)*n+a*r)/6}wr(Di,Ui,{copy(i){return Object.assign(new this.constructor,this,i)},displayable(){return this.rgb().displayable()},hex:xl,formatHex:xl,formatHex8:function qs(){return this.rgb().formatHex8()},formatHsl:function Zs(){return El(this).formatHsl()},formatRgb:Sl,toString:Sl}),wr(re,_n,wl(Di,{brighter(i){return i=null==i?On:Math.pow(On,i),new re(this.r*i,this.g*i,this.b*i,this.opacity)},darker(i){return i=null==i?.7:Math.pow(.7,i),new re(this.r*i,this.g*i,this.b*i,this.opacity)},rgb(){return this},clamp(){return new re($e(this.r),$e(this.g),$e(this.b),En(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ol,formatHex:Ol,formatHex8:function $s(){return`#${ti(this.r)}${ti(this.g)}${ti(this.b)}${ti(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Nl,toString:Nl})),wr(be,function td(i,t,e,n){return 1===arguments.length?El(i):new be(i,t,e,null==n?1:n)},wl(Di,{brighter(i){return i=null==i?On:Math.pow(On,i),new be(this.h,this.s,this.l*i,this.opacity)},darker(i){return i=null==i?.7:Math.pow(.7,i),new be(this.h,this.s,this.l*i,this.opacity)},rgb(){var i=this.h%360+360*(this.h<0),t=isNaN(i)||isNaN(this.s)?0:this.s,e=this.l,n=e+(e<.5?e:1-e)*t,r=2*e-n;return new re(br(i>=240?i-240:i+120,r,n),br(i,r,n),br(i<120?i+240:i-120,r,n),this.opacity)},clamp(){return new be(Tl(this.h),Tn(this.s),Tn(this.l),En(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const i=En(this.opacity);return`${1===i?"hsl(":"hsla("}${Tl(this.h)}, ${100*Tn(this.s)}%, ${100*Tn(this.l)}%${1===i?")":`, ${i})`}`}}));const Cl=i=>()=>i;function Jl(i,t){var e=t-i;return e?function Al(i,t){return function(e){return i+e*t}}(i,e):Cl(isNaN(i)?t:i)}const Rl=function i(t){var e=function rd(i){return 1==(i=+i)?Jl:function(t,e){return e-t?function nd(i,t,e){return i=Math.pow(i,e),t=Math.pow(t,e)-i,e=1/e,function(n){return Math.pow(i+n*t,e)}}(t,e,i):Cl(isNaN(t)?e:t)}}(t);function n(r,l){var a=e((r=_n(r)).r,(l=_n(l)).r),o=e(r.g,l.g),s=e(r.b,l.b),d=Jl(r.opacity,l.opacity);return function(u){return r.r=a(u),r.g=o(u),r.b=s(u),r.opacity=d(u),r+""}}return n.gamma=i,n}(1);function jl(i){return function(t){var a,o,e=t.length,n=new Array(e),r=new Array(e),l=new Array(e);for(a=0;a<e;++a)o=_n(t[a]),n[a]=o.r||0,r[a]=o.g||0,l[a]=o.b||0;return n=i(n),r=i(r),l=i(l),o.opacity=1,function(s){return o.r=n(s),o.g=r(s),o.b=l(s),o+""}}}jl(function ed(i){var t=i.length-1;return function(e){var n=e<=0?e=0:e>=1?(e=1,t-1):Math.floor(e*t),r=i[n],l=i[n+1];return Il((e-n/t)*t,n>0?i[n-1]:2*r-l,r,l,n<t-1?i[n+2]:2*l-r)}}),jl(function id(i){var t=i.length;return function(e){var n=Math.floor(((e%=1)<0?++e:e)*t);return Il((e-n/t)*t,i[(n+t-1)%t],i[n%t],i[(n+1)%t],i[(n+2)%t])}});var xr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Sr=new RegExp(xr.source,"g");function od(i,t){var n,r,l,e=xr.lastIndex=Sr.lastIndex=0,a=-1,o=[],s=[];for(i+="",t+="";(n=xr.exec(i))&&(r=Sr.exec(t));)(l=r.index)>e&&(l=t.slice(e,l),o[a]?o[a]+=l:o[++a]=l),(n=n[0])===(r=r[0])?o[a]?o[a]+=r:o[++a]=r:(o[++a]=null,s.push({i:a,x:Ke(n,r)})),e=Sr.lastIndex;return e<t.length&&(l=t.slice(e),o[a]?o[a]+=l:o[++a]=l),o.length<2?s[0]?function ad(i){return function(t){return i(t)+""}}(s[0].x):function ld(i){return function(){return i}}(t):(t=s.length,function(d){for(var c,u=0;u<t;++u)o[(c=s[u]).i]=c.x(d);return o.join("")})}function zl(i,t){var e;return("number"==typeof t?Ke:t instanceof Ui?Rl:(e=Ui(t))?(t=e,Rl):od)(i,t)}function sd(i){return function(){this.removeAttribute(i)}}function dd(i){return function(){this.removeAttributeNS(i.space,i.local)}}function ud(i,t,e){var n,l,r=e+"";return function(){var a=this.getAttribute(i);return a===r?null:a===n?l:l=t(n=a,e)}}function cd(i,t,e){var n,l,r=e+"";return function(){var a=this.getAttributeNS(i.space,i.local);return a===r?null:a===n?l:l=t(n=a,e)}}function hd(i,t,e){var n,r,l;return function(){var a,s,o=e(this);return null==o?void this.removeAttribute(i):(a=this.getAttribute(i))===(s=o+"")?null:a===n&&s===r?l:(r=s,l=t(n=a,o))}}function fd(i,t,e){var n,r,l;return function(){var a,s,o=e(this);return null==o?void this.removeAttributeNS(i.space,i.local):(a=this.getAttributeNS(i.space,i.local))===(s=o+"")?null:a===n&&s===r?l:(r=s,l=t(n=a,o))}}function pd(i,t){var e,n;function r(){var l=t.apply(this,arguments);return l!==n&&(e=(n=l)&&function yd(i,t){return function(e){this.setAttributeNS(i.space,i.local,t.call(this,e))}}(i,l)),e}return r._value=t,r}function md(i,t){var e,n;function r(){var l=t.apply(this,arguments);return l!==n&&(e=(n=l)&&function gd(i,t){return function(e){this.setAttribute(i,t.call(this,e))}}(i,l)),e}return r._value=t,r}function bd(i,t){return function(){yr(this,i).delay=+t.apply(this,arguments)}}function xd(i,t){return t=+t,function(){yr(this,i).delay=t}}function kd(i,t){return function(){Ee(this,i).duration=+t.apply(this,arguments)}}function Od(i,t){return t=+t,function(){Ee(this,i).duration=t}}var Pd=Li.prototype.constructor;function Fl(i){return function(){this.style.removeProperty(i)}}var nu=0;function ze(i,t,e,n){this._groups=i,this._parents=t,this._name=e,this._id=n}function Ll(){return++nu}var Fe=Li.prototype;ze.prototype=function ru(i){return Li().transition(i)}.prototype={constructor:ze,select:function Ld(i){var t=this._name,e=this._id;"function"!=typeof i&&(i=dr(i));for(var n=this._groups,r=n.length,l=new Array(r),a=0;a<r;++a)for(var u,c,o=n[a],s=o.length,d=l[a]=new Array(s),h=0;h<s;++h)(u=o[h])&&(c=i.call(u,u.__data__,h,o))&&("__data__"in u&&(c.__data__=u.__data__),d[h]=c,Sn(d[h],t,e,h,d,we(u,e)));return new ze(l,this._parents,t,e)},selectAll:function Bd(i){var t=this._name,e=this._id;"function"!=typeof i&&(i=Wr(i));for(var n=this._groups,r=n.length,l=[],a=[],o=0;o<r;++o)for(var u,s=n[o],d=s.length,c=0;c<d;++c)if(u=s[c]){for(var f,h=i.call(u,u.__data__,c,s),v=we(u,e),b=0,p=h.length;b<p;++b)(f=h[b])&&Sn(f,t,e,b,h,v);l.push(h),a.push(u)}return new ze(l,a,t,e)},selectChild:Fe.selectChild,selectChildren:Fe.selectChildren,filter:function Cd(i){"function"!=typeof i&&(i=Yr(i));for(var t=this._groups,e=t.length,n=new Array(e),r=0;r<e;++r)for(var s,l=t[r],a=l.length,o=n[r]=[],d=0;d<a;++d)(s=l[d])&&i.call(s,s.__data__,d,l)&&o.push(s);return new ze(n,this._parents,this._name,this._id)},merge:function Ad(i){if(i._id!==this._id)throw new Error;for(var t=this._groups,e=i._groups,n=t.length,l=Math.min(n,e.length),a=new Array(n),o=0;o<l;++o)for(var h,s=t[o],d=e[o],u=s.length,c=a[o]=new Array(u),f=0;f<u;++f)(h=s[f]||d[f])&&(c[f]=h);for(;o<n;++o)a[o]=t[o];return new ze(a,this._parents,this._name,this._id)},selection:function Md(){return new Pd(this._groups,this._parents)},transition:function eu(){for(var i=this._name,t=this._id,e=Ll(),n=this._groups,r=n.length,l=0;l<r;++l)for(var s,a=n[l],o=a.length,d=0;d<o;++d)if(s=a[d]){var u=we(s,t);Sn(s,i,e,d,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new ze(n,this._parents,i,e)},call:Fe.call,nodes:Fe.nodes,node:Fe.node,size:Fe.size,empty:Fe.empty,each:Fe.each,on:function jd(i,t){var e=this._id;return arguments.length<2?we(this.node(),e).on.on(i):this.each(function Rd(i,t,e){var n,r,l=function Jd(i){return(i+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(t)?yr:Ee;return function(){var a=l(this,i),o=a.on;o!==n&&(r=(n=o).copy()).on(t,e),a.on=r}}(e,i,t))},attr:function vd(i,t){var e=vn(i),n="transform"===e?Ps:zl;return this.attrTween(i,"function"==typeof t?(e.local?fd:hd)(e,n,mr(this,"attr."+i,t)):null==t?(e.local?dd:sd)(e):(e.local?cd:ud)(e,n,t))},attrTween:function wd(i,t){var e="attr."+i;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;var n=vn(i);return this.tween(e,(n.local?pd:md)(n,t))},style:function Ud(i,t,e){var n="transform"==(i+="")?Bs:zl;return null==t?this.styleTween(i,function Kd(i,t){var e,n,r;return function(){var l=hi(this,i),a=(this.style.removeProperty(i),hi(this,i));return l===a?null:l===e&&a===n?r:r=t(e=l,n=a)}}(i,n)).on("end.style."+i,Fl(i)):"function"==typeof t?this.styleTween(i,function Gd(i,t,e){var n,r,l;return function(){var a=hi(this,i),o=e(this),s=o+"";return null==o&&(this.style.removeProperty(i),s=o=hi(this,i)),a===s?null:a===n&&s===r?l:(r=s,l=t(n=a,o))}}(i,n,mr(this,"style."+i,t))).each(function Qd(i,t){var e,n,r,o,l="style."+t,a="end."+l;return function(){var s=Ee(this,i),d=s.on,u=null==s.value[l]?o||(o=Fl(t)):void 0;(d!==e||r!==u)&&(n=(e=d).copy()).on(a,r=u),s.on=n}}(this._id,i)):this.styleTween(i,function Dd(i,t,e){var n,l,r=e+"";return function(){var a=hi(this,i);return a===r?null:a===n?l:l=t(n=a,e)}}(i,n,t),e).on("end.style."+i,null)},styleTween:function Yd(i,t,e){var n="style."+(i+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;return this.tween(n,function Wd(i,t,e){var n,r;function l(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&function Hd(i,t,e){return function(n){this.style.setProperty(i,t.call(this,n),e)}}(i,a,e)),n}return l._value=t,l}(i,t,null==e?"":e))},text:function Zd(i){return this.tween("text","function"==typeof i?function qd(i){return function(){var t=i(this);this.textContent=null==t?"":t}}(mr(this,"text",i)):function Xd(i){return function(){this.textContent=i}}(null==i?"":i+""))},textTween:function tu(i){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==i)return this.tween(t,null);if("function"!=typeof i)throw new Error;return this.tween(t,function $d(i){var t,e;function n(){var r=i.apply(this,arguments);return r!==e&&(t=(e=r)&&function Vd(i){return function(t){this.textContent=i.call(this,t)}}(r)),t}return n._value=i,n}(i))},remove:function Fd(){return this.on("end.remove",function zd(i){return function(){var t=this.parentNode;for(var e in this.__transition)if(+e!==i)return;t&&t.removeChild(this)}}(this._id))},tween:function Ds(i,t){var e=this._id;if(i+="",arguments.length<2){for(var a,n=we(this.node(),e).tween,r=0,l=n.length;r<l;++r)if((a=n[r]).name===i)return a.value;return null}return this.each((null==t?Ms:Ks)(e,i,t))},delay:function Sd(i){var t=this._id;return arguments.length?this.each(("function"==typeof i?bd:xd)(t,i)):we(this.node(),t).delay},duration:function Nd(i){var t=this._id;return arguments.length?this.each(("function"==typeof i?kd:Od)(t,i)):we(this.node(),t).duration},ease:function Ed(i){var t=this._id;return arguments.length?this.each(function _d(i,t){if("function"!=typeof t)throw new Error;return function(){Ee(this,i).ease=t}}(t,i)):we(this.node(),t).ease},easeVarying:function Id(i){if("function"!=typeof i)throw new Error;return this.each(function Td(i,t){return function(){var e=t.apply(this,arguments);if("function"!=typeof e)throw new Error;Ee(this,i).ease=e}}(this._id,i))},end:function iu(){var i,t,e=this,n=e._id,r=e.size();return new Promise(function(l,a){var o={value:a},s={value:function(){0==--r&&l()}};e.each(function(){var d=Ee(this,n),u=d.on;u!==i&&((t=(i=u).copy())._.cancel.push(o),t._.interrupt.push(o),t._.end.push(s)),d.on=t}),0===r&&l()})},[Symbol.iterator]:Fe[Symbol.iterator]};var au={time:null,delay:0,duration:250,ease:function lu(i){return((i*=2)<=1?i*i*i:(i-=2)*i*i+2)/2}};function ou(i,t){for(var e;!(e=i.__transition)||!(e=e[t]);)if(!(i=i.parentNode))throw new Error(`transition ${t} not found`);return e}Li.prototype.interrupt=function zs(i){return this.each(function(){!function js(i,t){var n,r,a,e=i.__transition,l=!0;if(e){for(a in t=null==t?null:t+"",e)(n=e[a]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",i,i.__data__,n.index,n.group),delete e[a]):l=!1;l&&delete i.__transition}}(this,i)})},Li.prototype.transition=function su(i){var t,e;i instanceof ze?(t=i._id,i=i._name):(t=Ll(),(e=au).time=hr(),i=null==i?null:i+"");for(var n=this._groups,r=n.length,l=0;l<r;++l)for(var s,a=n[l],o=a.length,d=0;d<o;++d)(s=a[d])&&Sn(s,i,t,d,a,e||ou(s,t));return new ze(n,this._parents,i,t)};Math;function Hi(i){return{type:i}}function pi(i){return function(){return i}}function Gl(i){this._context=i}function pu(i){return new Gl(i)}["w","e"].map(Hi),["n","s"].map(Hi),["n","w","e","s","nw","ne","sw","se"].map(Hi),Gl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(i,t){switch(i=+i,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(i,t):this._context.moveTo(i,t);break;case 1:this._point=2;default:this._context.lineTo(i,t)}}};const Er=Math.PI,Tr=2*Er,ei=1e-6,mu=Tr-ei;function Ql(i){this._+=i[0];for(let t=1,e=i.length;t<e;++t)this._+=arguments[t]+i[t]}class An{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?Ql:function wu(i){let t=Math.floor(i);if(!(t>=0))throw new Error(`invalid digits: ${i}`);if(t>15)return Ql;const e=10**t;return function(n){this._+=n[0];for(let r=1,l=n.length;r<l;++r)this._+=Math.round(arguments[r]*e)/e+n[r]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,r){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(t,e,n,r,l,a){this._append`C${+t},${+e},${+n},${+r},${this._x1=+l},${this._y1=+a}`}arcTo(t,e,n,r,l){if(t=+t,e=+e,n=+n,r=+r,(l=+l)<0)throw new Error(`negative radius: ${l}`);let a=this._x1,o=this._y1,s=n-t,d=r-e,u=a-t,c=o-e,h=u*u+c*c;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(h>ei)if(Math.abs(c*s-d*u)>ei&&l){let f=n-a,v=r-o,b=s*s+d*d,p=f*f+v*v,g=Math.sqrt(b),O=Math.sqrt(h),x=l*Math.tan((Er-Math.acos((b+h-p)/(2*g*O)))/2),w=x/O,S=x/g;Math.abs(w-1)>ei&&this._append`L${t+w*u},${e+w*c}`,this._append`A${l},${l},0,0,${+(c*f>u*v)},${this._x1=t+S*s},${this._y1=e+S*d}`}else this._append`L${this._x1=t},${this._y1=e}`}arc(t,e,n,r,l,a){if(t=+t,e=+e,a=!!a,(n=+n)<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(r),s=n*Math.sin(r),d=t+o,u=e+s,c=1^a,h=a?r-l:l-r;null===this._x1?this._append`M${d},${u}`:(Math.abs(this._x1-d)>ei||Math.abs(this._y1-u)>ei)&&this._append`L${d},${u}`,n&&(h<0&&(h=h%Tr+Tr),h>mu?this._append`A${n},${n},0,1,${c},${t-o},${e-s}A${n},${n},0,1,${c},${this._x1=d},${this._y1=u}`:h>ei&&this._append`A${n},${n},0,${+(h>=Er)},${c},${this._x1=t+n*Math.cos(l)},${this._y1=e+n*Math.sin(l)}`)}rect(t,e,n,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function Su(i){return i[0]}function ku(i){return i[1]}function Ul(i,t){var e=pi(!0),n=null,r=pu,l=null,a=function xu(i){let t=3;return i.digits=function(e){if(!arguments.length)return t;if(null==e)t=null;else{const n=Math.floor(e);if(!(n>=0))throw new RangeError(`invalid digits: ${e}`);t=n}return i},()=>new An(t)}(o);function o(s){var d,c,f,u=(s=function yu(i){return"object"==typeof i&&"length"in i?i:Array.from(i)}(s)).length,h=!1;for(null==n&&(l=r(f=a())),d=0;d<=u;++d)!(d<u&&e(c=s[d],d,s))===h&&((h=!h)?l.lineStart():l.lineEnd()),h&&l.point(+i(c,d,s),+t(c,d,s));if(f)return l=null,f+""||null}return i="function"==typeof i?i:void 0===i?Su:pi(i),t="function"==typeof t?t:void 0===t?ku:pi(t),o.x=function(s){return arguments.length?(i="function"==typeof s?s:pi(+s),o):i},o.y=function(s){return arguments.length?(t="function"==typeof s?s:pi(+s),o):t},o.defined=function(s){return arguments.length?(e="function"==typeof s?s:pi(!!s),o):e},o.curve=function(s){return arguments.length?(r=s,null!=n&&(l=r(n)),o):r},o.context=function(s){return arguments.length?(null==s?n=l=null:l=r(n=s),o):n},o}function Hl(i,t,e){i._context.bezierCurveTo((2*i._x0+i._x1)/3,(2*i._y0+i._y1)/3,(i._x0+2*i._x1)/3,(i._y0+2*i._y1)/3,(i._x0+4*i._x1+t)/6,(i._y0+4*i._y1+e)/6)}function Wl(i){this._context=i}function Yl(i){return new Wl(i)}function mi(i,t,e){this.k=i,this.x=t,this.y=e}Wl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Hl(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(i,t){switch(i=+i,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(i,t):this._context.moveTo(i,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Hl(this,i,t)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=t}},mi.prototype={constructor:mi,scale:function(i){return 1===i?this:new mi(this.k*i,this.x,this.y)},translate:function(i,t){return 0===i&0===t?this:new mi(this.k,this.x+this.k*i,this.y+this.k*t)},apply:function(i){return[i[0]*this.k+this.x,i[1]*this.k+this.y]},applyX:function(i){return i*this.k+this.x},applyY:function(i){return i*this.k+this.y},invert:function(i){return[(i[0]-this.x)/this.k,(i[1]-this.y)/this.k]},invertX:function(i){return(i-this.x)/this.k},invertY:function(i){return(i-this.y)/this.k},rescaleX:function(i){return i.copy().domain(i.range().map(this.invertX,this).map(i.invert,i))},rescaleY:function(i){return i.copy().domain(i.range().map(this.invertY,this).map(i.invert,i))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new mi(1,0,0);class Au{constructor(){let t={stroke:y.attribute.stroke,strokeWidth:y.attribute.strokeWidth,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:e,element:n,attribute:r,size:l}=_e(Math.ceil(1e9*Math.random()),{attribute:t});m(n,r);let a="",o="";return{start:d=>{a=`M ${d.x} ${d.y} L ${d.x} ${d.y}`},move:(d,u)=>{((d,u)=>{a+=` ${d} ${u}`,n.setAttribute("d",a)})(d.x,d.y)},end:(d,u)=>{var c;u.length>=3?(o=null!==(c=Ul().x(O=>O[0]).y(O=>O[1]).curve(Yl)(u))&&void 0!==c?c:"",n.setAttribute("d",o)):n.setAttribute("d",a);let h=Ue(o||a),{minX:f,minY:v,maxX:b,maxY:p}=He(h);l.x=f,l.y=v,l.width=b-f||1,l.height=p-v||1,l.ratioMaps=We(l,h),y.data.node=Object.assign({id:e,type:F.PATH,name:"Path"},{size:l,attribute:r})}}}}class Ju{constructor(){let t={stroke:y.attribute.stroke,strokeOpacity:.4,strokeWidth:y.attribute.strokeWidth,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:e,element:n,attribute:r,size:l}=_e(Math.ceil(1e9*Math.random()),{attribute:t});m(n,r);let a="";return{start:d=>{a=`M ${d.x} ${d.y} L ${d.x} ${d.y}`},move:(d,u)=>{((d,u)=>{a+=` ${d} ${u}`,n.setAttribute("d",a)})(d.x,d.y)},end:(d,u)=>{let c=Ue(a),{minX:h,minY:f,maxX:v,maxY:b}=He(c);l.x=h,l.y=f,l.width=v-h||1,l.height=b-f||1,l.ratioMaps=We(l,c),y.data.node=Object.assign({id:e,type:F.PATH,name:"Path"},{size:l,attribute:r})}}}}class ql{constructor(t,e){var n,r;let l={stroke:"#FF0000",strokeWidth:lt(2),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:lt(8)},{element:a}=_e(Math.ceil(1e9*Math.random()),{size:e});window.document.getElementById(rt.INTERACTIVE_GROUP).querySelectorAll("path").forEach(f=>null==f?void 0:f.remove()),window.document.getElementById(rt.INTERACTIVE_GROUP).querySelectorAll("circle").forEach(f=>null==f?void 0:f.remove()),null===(n=window.document.getElementById(rt.INTERACTIVE_GROUP))||void 0===n||n.appendChild(a);var d=f=>{if(!f.length)return;let v=[];if(1==f.length){var b;let{size:p}=null!==(b=null!=t?t:y.dataSelect.nodes[0])&&void 0!==b?b:{};if(!p)return;v=[[p.x+p.width/2,p.y+p.height/2],f[0]]}else v=[...f];c(v),u(v[0],"start"),u(v[v.length-1],"end")},u=(f,v)=>{f&&((b=>{let{element:p}=ke(Math.ceil(1e9*Math.random()),{attribute:{fill:"start"==v?"#FF0000":"#00BA00",strokeWidth:lt(1)},size:{x:f[0]-5,y:f[1]-5,width:10,height:10}});null===(b=window.document.getElementById(rt.INTERACTIVE_GROUP))||void 0===b||b.prepend(p)})(),((b,p)=>{let{size:g}=null!==(b=null!=t?t:y.dataSelect.nodes[0])&&void 0!==b?b:{};if(!g)return;let O=[[f[0]-g.width/2,f[1]-g.height/2],[f[0]+g.width/2,f[1]-g.height/2],[f[0]+g.width/2,f[1]+g.height/2],[f[0]-g.width/2,f[1]+g.height/2],[f[0]-g.width/2,f[1]-g.height/2]],{element:x}=_e(Math.ceil(1e9*Math.random()),{attribute:{fill:"#FFFFFF",fillOpacity:.6,stroke:"#5f6ce1",strokeWidth:lt(1),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:lt(8)},size:{x:0,y:0,width:10,height:10,points:O}});null===(p=window.document.getElementById(rt.INTERACTIVE_GROUP))||void 0===p||p.prepend(x)})())},c=f=>{let b=Ul().x(p=>p[0]).y(p=>p[1]).curve(Yl)(f);a.setAttribute("d",b)};m(a,l),d(null!==(r=null==e?void 0:e.points)&&void 0!==r?r:[]);let h="";return{start:f=>{h=`M ${f.x} ${f.y} L ${f.x} ${f.y}`},move:(f,v)=>{h+=` ${f.x} ${f.y}`,a.setAttribute("d",h)},end:(f,v)=>{d(v),v.length&&(window.interactivePoints=v)}}}}const Zl=i=>{var t,e;((i,t)=>{lt(-1),lt(1),lt(8),N("icdt-temp-interactive-rect-center","rect",{attribute:Object.assign({x:t.x,y:t.y,width:t.width,height:t.height,class:"cursor-draw"},{fill:"transparent"})},i)})(N(rt.INTERACTIVE_GROUP,"g"),null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:(()=>{let{width:l,height:a}=y.screen.get;return{x:0,y:0,width:l,height:a}})()),i&&Ct(i,new ql)};function ii(i,t,e,n){return Math.sqrt(Math.pow(e-i,2)+Math.pow(n-t,2))}function Wi(i,t,e,n,r){return ii(i,t,e,n)<r?1:0}function Ir(i,t,e,n,r,l,a){var o=[];return o.push(Wi(i,t,e,n,a)),o.push(Wi(i,t,r,l,a)),o.push(function Fu(i,t,e,n,r,l,a){var o=[r-e,l-n],s=[i-e,t-n],d=[-o[1],o[0]],u=Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)),c=[d[0]/u,d[1]/u],h=Math.sqrt(Math.pow(o[0],2)+Math.pow(o[1],2)),f=[o[0]/h,o[1]/h],v=s[0]*f[0]+s[1]*f[1];if(v<=0||v>=h)return 0;var b=s[0]*c[0]+s[1]*c[1];return b>=a||b<=-a?0:1}(i,t,e,n,r,l,a)),o}function Vl(i,t,e,n,r){var l=[e-i,n-t],a=[-l[1],l[0]],o=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)),s=[a[0]/o,a[1]/o];return[[i+r*s[0],t+r*s[1]],[i-r*s[0],t-r*s[1]],[e-r*s[0],n-r*s[1]],[e+r*s[0],n+r*s[1]]]}function wi(i,t,e,n,r,l,a){var v,o=[r-i,l-t],s=[e-i,n-t],d=Math.sqrt(Math.pow(s[0],2)+Math.pow(s[1],2)),u=[s[0]/d,s[1]/d],c=o[0]*u[0]+o[1]*u[1],h=[i+c*u[0],t+c*u[1]],f=Math.sqrt(Math.pow(r-h[0],2)+Math.pow(l-h[1],2));v=0===f?a:Math.sqrt(Math.pow(a,2)-Math.pow(f,2));var b=[i+c*u[0]+v*u[0],t+c*u[1]+v*u[1]];return b[0]===i&&b[1]===t?null:b}function ni(i,t,e,n,r,l,a){var o=[r-i,l-t],s=[e-i,n-t],d=[-s[1],s[0]],u=Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)),c=[d[0]/u,d[1]/u],h=o[0]*c[0]+o[1]*c[1],f=Pu([i,t],[e,n],[r,l]);if(ta([f[0]-r,f[1]-l])>=a)return null;var b=Math.sqrt(Math.pow(a,2)-Math.pow(h,2)),p=[r-h*c[0],l-h*c[1]],g=Math.sqrt(Math.pow(s[0],2)+Math.pow(s[1],2)),O=[s[0]/g,s[1]/g],x=[[p[0]-O[0]*b,p[1]-O[1]*b],[p[0]+O[0]*b,p[1]+O[1]*b]];return x[0][0]===i&&x[0][1]===t?null:x}function Ie(i,t,e,n,r,l,a,o){var s,d,u,c,h,f;return-(u=a-r)*(d=n-t)+(s=e-i)*(c=o-l)==0?null:(f=(u*(t-l)-c*(i-r))/(-u*d+s*c),(h=(-d*(i-r)+s*(t-l))/(-u*d+s*c))>=0&&h<=1&&f>=0&&f<=1?[i+f*s,t+f*d]:null)}function $l(i,t,e,n,r,l,a,o,s,d){var u=Vl(l,a,o,s,d),c=[];if(e[0]&&!e[1])c.push(wi(i,t,n,r,l,a,d)),c.push(Ie(i,t,n,r,u[0][0],u[0][1],u[3][0],u[3][1])),c.push(Ie(i,t,n,r,u[1][0],u[1][1],u[2][0],u[2][1])),(h=ni(i,t,n,r,o,s,d))&&c.push(h[0],h[1]);else if(!e[0]&&e[1])c.push(wi(i,t,n,r,o,s,d)),c.push(Ie(i,t,n,r,u[0][0],u[0][1],u[3][0],u[3][1])),c.push(Ie(i,t,n,r,u[1][0],u[1][1],u[2][0],u[2][1])),(h=ni(i,t,n,r,l,a,d))&&c.push(h[0],h[1]);else if(e[0]&&e[1])c.push(wi(i,t,n,r,l,a,d)),c.push(Ie(i,t,n,r,u[0][0],u[0][1],u[3][0],u[3][1])),c.push(Ie(i,t,n,r,u[1][0],u[1][1],u[2][0],u[2][1])),c.push(wi(i,t,n,r,o,s,d));else{var h=ni(i,t,n,r,o,s,d),f=ni(i,t,n,r,l,a,d);h&&c.push(h[0],h[1]),f&&c.push(f[0],f[1]),c.push(Ie(i,t,n,r,u[0][0],u[0][1],u[3][0],u[3][1])),c.push(Ie(i,t,n,r,u[1][0],u[1][1],u[2][0],u[2][1]))}for(var v=[i,t],b=0;b<c.length;b++)c[b]&&ii(c[b][0],c[b][1],n,r)<ii(v[0],v[1],n,r)&&(v=c[b]);return v[0]===i&&v[1]===t?null:v}function Lu(i,t,e,n,r,l,a,o,s){var d=Vl(r,l,a,o,s),u=[],c=ni(i,t,e,n,r,l,s);c&&u.push(c[0],c[1]),(c=ni(i,t,e,n,a,o,s))&&u.push(c[0],c[1]),u.push(Ie(i,t,e,n,d[0][0],d[0][1],d[3][0],d[3][1])),u.push(Ie(i,t,e,n,d[1][0],d[1][1],d[2][0],d[2][1]));for(var h=[e,n],f=[i,t],v=0;v<u.length;v++)u[v]&&ii(u[v][0],u[v][1],i,t)<ii(h[0],h[1],i,t)&&(h=u[v]);for(var b=0;b<u.length;b++)u[b]&&ii(u[b][0],u[b][1],e,n)<ii(f[0],f[1],e,n)&&(f=u[b]);return h[0]===e&&h[1]===n||f[0]===i&&f[1]===t?null:[h,f]}var ta=function(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])},Pu=function(i,t,e){var n=[t[0]-i[0],t[1]-i[1]],r=ta(n);if(r<1e-6)return i;var l=[e[0]-i[0],e[1]-i[1]],a=(n[0]*l[0]+n[1]*l[1])/r;return a<0?i:a>r?t:[i[0]+n[0]*a/r,i[1]+n[1]*a/r]};class Mu{constructor(){let{element:n,size:l}=_e(Math.ceil(1e9*Math.random()));m(n,{stroke:"#ddd",strokeWidth:10,strokeLinecap:"round",strokeLinejoin:"round"});let a="";return{start:d=>{a=`M ${d.x} ${d.y} L ${d.x} ${d.y}`},move:(d,u)=>{((d,u)=>{a+=` ${d} ${u}`,n.setAttribute("d",a)})(d.x,d.y)},end:(d,u)=>{n.remove(),(d=>{let u=9999,c=9999,h=-9999,f=-9999;d.forEach(b=>{u=Math.min(u,b[0]),c=Math.min(c,b[1]),h=Math.max(h,b[0]),f=Math.max(f,b[1])}),l=Qt(u,c,h,f,{points:d}),y.data.getNodeInArea(0,0,1920,1920,F.PATH).forEach(b=>{let g=((i,t,e)=>{e=e||20;var n=[],r=function(u){var c=t[0][0],h=t[0][1],f=0,v=0;if(1!==u.length||Wi(u[0][0],u[0][1],c,h,e)){for(var b;f<u.length-1;){var p=u[f],g=u[f+1],O=Wi(p[0],p[1],c,h,e),x=Wi(g[0],g[1],c,h,e);if(O&&x)v=++f;else if(O&&!x)(w=wi(p[0],p[1],g[0],g[1],c,h,e))?(u[f]=w,v=f):f++;else if(!O&&x){var w;(w=wi(g[0],g[1],p[0],p[1],c,h,e))&&((b=u.slice(v,f+1)).push(w),n.push(b)),v=++f}else{var S=ni(p[0],p[1],g[0],g[1],c,h,e);S?(((b=u.slice(v,f+1))[b.length-1][0]!==S[0][0]||b[b.length-1][1]!==S[0][1])&&b.push(S[0]),b.length>1&&n.push(b),u[f]=S[1],u[f+1]&&u[f+1][0]==S[1][0]&&u[f+1][1]==S[1][1]&&f++,v=f):f++}}v!==f&&(b=u.slice(v,u.length))&&n.push(b)}else n.push(u)},l=function(u,c){var g,h=t[c],f=t[c+1],v=0,b=0;if(1!==u.length||-1!==(p=Ir(u[0][0],u[0][1],h[0],h[1],f[0],f[1],e)).indexOf(1)){for(;v<u.length-1;){var O=u[v],x=u[v+1],p=Ir(O[0],O[1],h[0],h[1],f[0],f[1],e),w=Ir(x[0],x[1],h[0],h[1],f[0],f[1],e);if(-1!==p.indexOf(1)&&-1!==w.indexOf(1))b=++v;else if(-1!==p.indexOf(1)&&-1===w.indexOf(1))(S=$l(O[0],O[1],p,x[0],x[1],h[0],h[1],f[0],f[1],e))?(u[v]=S,b=v):v++;else if(-1===p.indexOf(1)&&-1!==w.indexOf(1)){var S;(S=$l(x[0],x[1],w,O[0],O[1],h[0],h[1],f[0],f[1],e))?((g=u.slice(b,v+1)).push(S),n.push(g),b=++v):v++}else{var R=Lu(O[0],O[1],x[0],x[1],h[0],h[1],f[0],f[1],e);R?(((g=u.slice(b,v+1))[g.length-1][0]!==R[0][0]||g[g.length-1][1]!==R[0][1])&&g.push(R[0]),g.length>1&&n.push(g),u[v]=R[1],u[v+1]&&u[v+1][0]==R[1][0]&&u[v+1][1]==R[1][1]&&v++,b=v):v++}}b!==v&&(g=u.slice(b,u.length))&&n.push(g)}else n.push(u)};if(t=function zu(i){var t=[];if(1===i.length)t=i;else{for(var e=0;e<i.length-1;)(i[e][0]!==i[e+1][0]||i[e][1]!==i[e+1][1])&&t.push(i[e]),e++;0!==i.length&&0===t.length&&t.push(i[0]),(i[i.length-1][0]!==i[t.length-1][0]||i[i.length-1][1]!==i[t.length-1][1])&&t.push(i[e])}return t}(t),1===t.length){for(var a=0;a<i.length;a++)r(i[a]);i=n}else for(var o=0;o<t.length-1;o++){for(a=0;a<i.length;a++)l(i[a],o);i=n,n=[]}for(var s=0;s<i.length;s++)for(var d=0;d<i[s].length;d++)i[s][d][0]=Math.round(i[s][d][0]),i[s][d][1]=Math.round(i[s][d][1]);return i})(y.data.getNode(b).size.points,d,2);console.log(g)})})(u)}}}}class Du{constructor(){let t=N(rt.CREATE_GROUP,"g"),{nodeId:e,element:n,attribute:r,size:l,source:a}=Je(Math.ceil(1e9*Math.random())),o=(s,d,u,c)=>{l=Qt(s,d,u,c),l.x=C(l.x),l.y=C(l.y),l.width=C(l.width),l.height=C(l.height),Object.assign(r,at(F.TEXT,l,r)),m(n,r),I(t,l)};return{start:s=>{o(s.x,s.y,s.x+l.width,s.y+l.height)},move:(s,d)=>{o(d[0][0],d[0][1],s.x,s.y)},end:(s,d)=>{l.width<100&&(l.width=100),l.height<20&&(l.height=20),l.width+l.height<8&&(l.width=100,l.height=20,l.x=l.x-l.width/2,l.y=l.y-l.height/2,Object.assign(r,at(F.TEXT,l,r)),m(n,r)),y.data.node=Object.assign({id:e,type:F.TEXT,name:"Text"},{size:l,attribute:r,source:a}),null==t||t.remove()}}}}const Yu=i=>{var t,e,n,r;let l=(null===(t=i.mouseEvent)||void 0===t?void 0:t.target)||(null===(e=i.touchEvent)||void 0===e?void 0:e.target),a=(null==l?void 0:l.getAttribute("id"))||"",o=null==l?void 0:l.nodeName,s=jQuery(l).parents("g[id]").attr("id")||"";if(![rt.INDEX_GROUP].includes(s))if(null!==(n=i.mouseEvent)&&void 0!==n&&n.altKey||null!==(r=i.touchEvent)&&void 0!==r&&r.altKey||!a||a.match(/[^0-9]/)||!y.dataSelect.nodeName.includes(o)){var d;y.dataSelect.ids.length&&(y.dataSelect.ids=[]),(0==(null===(d=i.mouseEvent)||void 0===d?void 0:d.button)||i.touchEvent)&&((i,t)=>{let a=N(rt.SCAN_GROUP,"g"),o=Qt(0,0,1,1);H(a,o),((i,t,e,n)=>{Ct(i,{start:a=>{},move:(a,o)=>{((a,o,s,d)=>{t=Qt(a,o,s,d),H(e,t)})(o[0][0],o[0][1],a.x,a.y)},end:(a,o)=>{null==e||e.remove(),y.dataSelect.ids=y.data.getNodeInArea(Math.min(o[0][0],a.x),Math.min(o[0][1],a.y),Math.max(o[0][0],a.x),Math.max(o[0][1],a.y)),n(y.dataSelect.nodes)}})})(i,o,a,t)})(i,ea)}else{var u,c;let h=parseFloat(a||"0");y.dataSelect.ids=null!==(u=i.mouseEvent)&&void 0!==u&&u.shiftKey||null!==(c=i.touchEvent)&&void 0!==c&&c.shiftKey?[h].concat(y.dataSelect.ids).filter((v,b,p)=>p.indexOf(v)==b):[h],ea(y.dataSelect.nodes)}},ea=i=>{var t,e;let n=1;var r,l;if(i.length&&(n=Math.max.apply(null,null!==(r=null===(l=y.data.slide)||void 0===l||null===(l=l.svg)||void 0===l?void 0:l.nodes.map(o=>{var s;return null!==(s=o.idx)&&void 0!==s?s:0}))&&void 0!==r?r:[0])+1),1==i.length)i[0].idx||(i[0].idx=n,i[0].time=0);else if(i.length>=0){let o=i.map(d=>{var u;return null!==(u=d.idx)&&void 0!==u?u:0}).filter(d=>d>0),s=o.length?Math.min.apply(null,o):n;i.forEach(d=>{var u;d.idx=s,d.time=null!==(u=d.time)&&void 0!==u?u:0})}let a=N(rt.INDEX_GROUP,"g");nt(a,null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.nodes)&&void 0!==t?t:[])},Xu=i=>{var t,e,n;null!=i&&null!==(t=i.svg)&&void 0!==t&&t.nodes&&i.svg.nodes.forEach(l=>{l.idx=0,l.time=null});let r=N(rt.INDEX_GROUP,"g");nt(r,null!==(e=null===(n=y.data.slide)||void 0===n||null===(n=n.svg)||void 0===n?void 0:n.nodes)&&void 0!==e?e:[])};class ia{constructor(){this._nodeName=["circle","ellipse","line","polygon","polyline","rect","text","tspan","path","image","foreignObject"],this._selected_Ids=[],this._contenteditable_Id=0,this._fnChanges=[]}get nodeName(){return this._nodeName}get ids(){return this._selected_Ids}set ids(t){this._selected_Ids=t,this.closeEditable(),this.change(this.ids)}get contenteditable_id(){return this._contenteditable_Id}get nodes(){return this._selected_Ids.map(t=>y.data.getNode(t)).filter(t=>!t.isfake)}set onchange(t){this._fnChanges.push(t)}change(t){this.cleanSelected(),this._fnChanges.forEach(e=>e(t))}deleteNode(){for(let t of this._selected_Ids){let e=y.data.deleteNode(t);y.history.push([{type:"delete",from:{id:e},to:{id:e}}])}y.dataSelect.ids=[]}groupNode(){let t=[];if(y.dataSelect.ids.length>=2){let e=y.data.getNode(y.dataSelect.ids[0]),{nodeId:n,attribute:r,size:l}=Pe(Math.ceil(1e9*Math.random()),void 0,e.pid?window.document.getElementById(e.pid):null);y.data.node=Object.assign({id:n,type:F.GROUP,name:"G"},{size:l,attribute:r});for(let a of y.dataSelect.ids)t.push(y.data.addGroup(a,n))}t.length&&(y.dataSelect.ids=t,te(y.dataSelect.nodes))}ungroupNode(){let t=[];for(let e of y.dataSelect.ids)t.push(y.data.unGroup(e));t.length&&(y.dataSelect.ids=t,te(y.dataSelect.nodes))}cleanSelected(){var t,e,n,r,l;null===(t=window.document.getElementById(rt.RESIZE_GROUP))||void 0===t||t.remove(),null===(e=window.document.getElementById(rt.SELECT_GROUP))||void 0===e||e.remove(),null===(n=window.document.getElementById(rt.SCAN_GROUP))||void 0===n||n.remove(),null===(r=window.document.getElementById(rt.CREATE_GROUP))||void 0===r||r.remove(),null===(l=window.document.getElementById(rt.INTERACTIVE_GROUP))||void 0===l||l.remove(),jQuery('[id^="icdt-temp-"]').remove()}openEditable(){1==this._selected_Ids.length&&(this._contenteditable_Id=this._selected_Ids[0]);let t=y.data.getNode(this._contenteditable_Id);if(t.id){let{id:e,source:n,size:r,attribute:l,style:a}=t;qt(e,F.FOREIGNOBJECT,"foreignObject",{source:n,size:r,attribute:l,style:a})}this.cleanSelected()}closeEditable(){if(!this._contenteditable_Id)return;let t=y.data.getNode(this._contenteditable_Id);if(t.id){this._contenteditable_Id=0;let{id:e,type:n,source:r,size:l,attribute:a,style:o}=t;qt(e,n,void 0,{source:r,size:l,attribute:a,style:o}),this.cleanSelected(),te(y.dataSelect.nodes)}}}class na{createNodeImage(t,e){var n,r,l,a;let{nodeId:s,element:d,size:u,attribute:c,source:h}=Se(Math.ceil(1e9*Math.random()),{size:{x:(null!==(n=null==e?void 0:e.x)&&void 0!==n?n:50)-50,y:(null!==(r=null==e?void 0:e.y)&&void 0!==r?r:50)-50,width:100,height:100},source:{type:"image",image:It(t)}});(f=>{if(!f)return;let v=new Image;v.onload=()=>{let b=C(v.naturalWidth/v.naturalHeight,100);b>=1?(u.width=Math.min(v.naturalWidth,512),u.height=C(u.width/b,100)):(u.height=Math.min(v.naturalHeight,512),u.width=C(u.height*b,100)),u.x=C(u.x+50-u.width/2,100),u.y=C(u.y+50-u.height/2,100),Object.assign(c,at(F.IMAGE,u,c)),m(d,c),y.data.node=Object.assign({id:s,type:F.IMAGE,name:"Image"},{size:u,attribute:c,source:h})},v.onerror=b=>{console.error(`ImgSrc load failed -> ${f}`,b),null==d||d.remove()},v.src=f})(null!==(l=null===(a=h.image)||void 0===a?void 0:a.url)&&void 0!==l?l:"")}createNodeIframe(t,e){var n,r;let{nodeId:a,element:o,size:s,attribute:d,style:u,source:c}=de(Math.ceil(1e9*Math.random()),{size:{x:(null!==(n=null==e?void 0:e.x)&&void 0!==n?n:50)-50,y:(null!==(r=null==e?void 0:e.y)&&void 0!==r?r:50)-50,width:100,height:100},style:{},source:{type:"iframe",iframe:It(t)}});(h=>{let f=(null===(h=y.data.slide)||void 0===h||null===(h=h.svg)||void 0===h?void 0:h.viewBox)||{x:0,y:0,width:100,height:100},v=C(f.width/f.height,100);v>=1?(s.width=Math.min(f.width,512),s.height=C(s.width/v,100)):(s.height=Math.min(f.height,512),s.width=C(s.height*v,100)),s.x=C(s.x+50-s.width/2,100),s.y=C(s.y+50-s.height/2,100),Object.assign(d,at(F.IMAGE,s,d)),m(o,d),y.data.node=Object.assign({id:a,type:F.FOREIGNOBJECT,name:"ForeignObject"},{size:s,attribute:d,style:u,source:c})})()}createNodeEmbed(t,e){var n,r;let l={x:50,y:50,width:640,height:360};902==t.type&&(l.width=480,l.height=80);let{nodeId:a,element:o,size:s,attribute:d,style:u,source:c}=de(Math.ceil(1e9*Math.random()),{size:{x:(null!==(n=null==e?void 0:e.x)&&void 0!==n?n:l.x)-l.x,y:(null!==(r=null==e?void 0:e.y)&&void 0!==r?r:l.y)-l.y,width:l.width,height:l.height},style:{},source:{type:"embed",embed:Object.assign(t,It(t))}});(()=>{let h=C(l.width/l.height,100);h>=1?(s.width=Math.min(s.width,l.width),s.height=C(s.width/h,1)):(s.height=Math.min(s.height,l.height),s.width=C(s.height*h,1)),s.x=C(s.x+l.x-s.width/2,1),s.y=C(s.y+l.y-s.height/2,1),Object.assign(d,at(F.FOREIGNOBJECT,s,d)),m(o,d),y.data.node=Object.assign({id:a,type:F.FOREIGNOBJECT,name:"ForeignObject"},{size:s,attribute:d,style:u,source:c})})()}createNodeMedia(t,e){var n,r,l,a;let{nodeId:s,element:d,size:u,attribute:c,source:h}=Se(Math.ceil(1e9*Math.random()),{size:{x:(null!==(n=null==e?void 0:e.x)&&void 0!==n?n:50)-50,y:(null!==(r=null==e?void 0:e.y)&&void 0!==r?r:50)-50,width:100,height:100},source:{type:"image",image:It(t.cover)}}),f={click:{media:t.media}};(v=>{if(!v)return;let b=new Image;b.onload=()=>{let p=C(b.naturalWidth/b.naturalHeight,100);p>=1?(u.width=Math.min(b.naturalWidth,512),u.height=C(u.width/p,100)):(u.height=Math.min(b.naturalHeight,512),u.width=C(u.height*p,100)),u.x=C(u.x+50-u.width/2,100),u.y=C(u.y+50-u.height/2,100),Object.assign(c,at(F.IMAGE,u,c)),m(d,c),y.data.node=Object.assign({id:s,type:F.IMAGE,name:"Image"},{size:u,attribute:c,source:h,interactive:f})},b.onerror=p=>{console.error(`ImgSrc load failed -> ${v}`,p),null==d||d.remove()},b.src=v})(null!==(l=null===(a=h.image)||void 0===a?void 0:a.url)&&void 0!==l?l:"")}createNodeText(t,e){var n,r;let{nodeId:a,element:o,size:s,attribute:d,style:u,source:c}=de(Math.ceil(1e9*Math.random()),{size:{x:(null!==(n=null==e?void 0:e.x)&&void 0!==n?n:0)-0,y:(null!==(r=null==e?void 0:e.y)&&void 0!==r?r:0)-0,width:320,height:80},style:{},source:{type:"html",html:{htmlContent:`<span style="font-family: Roboto; font-size: 24px;">${t.content}</span>`}}});(()=>{let h=C(4,100);h>=1?(s.width=Math.min(s.width,320),s.height=C(s.width/h,1)):(s.height=Math.min(s.height,80),s.width=C(s.height*h,1)),s.x=C(s.x+0-s.width/2,1),s.y=C(s.y+0-s.height/2,1),Object.assign(d,at(F.FOREIGNOBJECT,s,d)),m(o,d),y.data.node=Object.assign({id:a,type:F.FOREIGNOBJECT,name:"ForeignObject"},{size:s,attribute:d,style:u,source:c})})()}insert(t){var e;if(y.data.insertSlide(y.data.slideId,1),t.title){let{nodeId:n,size:r,attribute:l,style:a,source:o}=de(Math.ceil(1e9*Math.random()),{size:{x:100,y:100,width:800,height:150},source:{type:"html",html:{htmlContent:`<span style="font-size: 40px;">${t.title}</span>`}}});y.data.node=Object.assign({id:n,type:F.FOREIGNOBJECT,name:"ForeignObject"},{size:r,attribute:l,style:a,source:o})}if(t.description){let{nodeId:n,size:r,attribute:l,style:a,source:o}=de(Math.ceil(1e9*Math.random()),{size:{x:100,y:300,width:600,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 24px;">${t.description.replace(/\n/g,"<br/>")}</span>`}}});y.data.node=Object.assign({id:n,type:F.FOREIGNOBJECT,name:"ForeignObject"},{size:r,attribute:l,style:a,source:o})}null!==(e=t.media)&&void 0!==e&&e.prompt&&((()=>{let{nodeId:n,size:r,attribute:l}=ye(Math.ceil(1e9*Math.random()),{size:{x:775,y:275,width:350,height:350},attribute:{fill:"#FFFFFF",stroke:"#E6E6E6",strokeWidth:1,strokeDasharray:1,rx:4}});y.data.node=Object.assign({id:n,type:F.RECT,name:"Rect"},{size:r,attribute:l})})(),(n=>{let{nodeId:r,size:l,attribute:a,style:o,source:s}=de(Math.ceil(1e9*Math.random()),{size:{x:800,y:300,width:300,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 18px; color: #6633cc"><i>${null===(n=t.media)||void 0===n?void 0:n.prompt}</i></span>`}}});y.data.node=Object.assign({id:r,type:F.FOREIGNOBJECT,name:"ForeignObject"},{size:l,attribute:a,style:o,source:s})})())}}class ra{get newSlideId(){return Math.ceil(1e9*Math.random())}get _defaultSlide(){return JSON.parse(JSON.stringify({id:this.newSlideId,name:"Trang m\u1edbi",svg:{viewBox:y.screen.frameSize,nodes:[]}}))}constructor(){this._dataSource={slides:[],resources:[]},this._slideIdx=0,this._fnChangeSlides=[],this.getNodeAll=()=>{var t;let e=null===(t=this._dataSource.slides)||void 0===t?void 0:t.find((l,a)=>a==this._slideIdx),n=null==e?void 0:e.svg,r=l=>{let a=[];return l.filter(o=>!o.isdeleted).forEach(o=>{o.type==F.GROUP?a=a.concat(r(o.nodes||[])):a.push(o.id)}),a};return r((null==n?void 0:n.nodes)||[])}}get get(){var t;let e=n=>{var r,l;return null===(r=n)||void 0===r||r.filter(a=>a.type==F.GROUP).forEach(a=>{var o;a.nodes=e(null===(o=a.nodes)||void 0===o?void 0:o.filter(s=>!s.isdeleted))}),(n=null===(l=n)||void 0===l?void 0:l.filter(a=>{var o,s;return a.type!=F.GROUP||(null!==(o=null===(s=a.nodes)||void 0===s?void 0:s.length)&&void 0!==o?o:0)>0}))||[]};return null===(t=this._dataSource.slides)||void 0===t||t.forEach(n=>{var r;n.svg&&(n.svg.nodes=e(null===(r=n.svg)||void 0===r||null===(r=r.nodes)||void 0===r?void 0:r.filter(l=>!l.isdeleted)))}),this._dataSource}get getResource(){var t;let e=[];return null===(t=this._dataSource.slides)||void 0===t||t.forEach(n=>{var r,l,a,o,s,d,u,c;e.push(null===(r=n.svg)||void 0===r||null===(r=r.background)||void 0===r?void 0:r.path),null===(l=n.svg)||void 0===l||l.nodes.forEach(h=>{var f,v,b,p,g,O,x,w,S,R,J;e.push(null===(f=h.source)||void 0===f||null===(f=f.image)||void 0===f?void 0:f.path),e.push(null===(v=h.source)||void 0===v||null===(v=v.audio)||void 0===v?void 0:v.path),e.push(null===(b=h.source)||void 0===b||null===(b=b.video)||void 0===b?void 0:b.path),e.push(null===(p=h.source)||void 0===p||null===(p=p.file)||void 0===p?void 0:p.path),e.push(null===(g=h.source)||void 0===g||null===(g=g.iframe)||void 0===g?void 0:g.path),e.push(null===(O=h.source)||void 0===O||null===(O=O.embed)||void 0===O?void 0:O.path),e.push(null===(x=h.source)||void 0===x||null===(x=x.track)||void 0===x?void 0:x.path),e.push(null===(w=h.interactive)||void 0===w||null===(w=w.show)||void 0===w||null===(w=w.audio)||void 0===w||null===(w=w.source)||void 0===w?void 0:w.path),e.push(null===(S=h.interactive)||void 0===S||null===(S=S.click)||void 0===S||null===(S=S.audio)||void 0===S||null===(S=S.source)||void 0===S?void 0:S.path),e.push(null===(R=h.interactive)||void 0===R||null===(R=R.click)||void 0===R||null===(R=R.image)||void 0===R||null===(R=R.source)||void 0===R?void 0:R.path),e.push(null===(J=h.interactive)||void 0===J||null===(J=J.click)||void 0===J||null===(J=J.video)||void 0===J||null===(J=J.source)||void 0===J?void 0:J.path)}),e.push(null===(a=n.test)||void 0===a||null===(a=a.audiotrue)||void 0===a?void 0:a.path),e.push(null===(o=n.test)||void 0===o||null===(o=o.audiofalse)||void 0===o?void 0:o.path),e.push(null===(s=n.test)||void 0===s||null===(s=s.effecttrue)||void 0===s?void 0:s.path),e.push(null===(d=n.test)||void 0===d||null===(d=d.effectfalse)||void 0===d?void 0:d.path),e.push(null===(u=n.test)||void 0===u||null===(u=u.icontrue)||void 0===u?void 0:u.path),e.push(null===(c=n.test)||void 0===c||null===(c=c.iconfalse)||void 0===c?void 0:c.path)}),e.filter(n=>n).map(n=>n.replace(/(\?|\#)[^\?\#]+/g,"").toLowerCase()).filter((n,r,l)=>l.indexOf(n)==r)}get getFonts(){var t;return St(JSON.stringify(null!==(t=this._dataSource.slides)&&void 0!==t?t:[]))}set set(t){this._dataSource=t,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),ci(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get dataSource(){var t;let e=n=>{var r,l;return null===(r=n)||void 0===r||r.filter(a=>a.type==F.GROUP).forEach(a=>{var o;a.nodes=e(null===(o=a.nodes)||void 0===o?void 0:o.filter(s=>!s.isdeleted))}),(n=null===(l=n)||void 0===l?void 0:l.filter(a=>{var o,s;return a.type!=F.GROUP||(null!==(o=null===(s=a.nodes)||void 0===s?void 0:s.length)&&void 0!==o?o:0)>0}))||[]};return null===(t=this._dataSource.slides)||void 0===t||t.forEach(n=>{var r;n.svg&&(n.svg.nodes=e(null===(r=n.svg)||void 0===r||null===(r=r.nodes)||void 0===r?void 0:r.filter(l=>!l.isdeleted)))}),this._dataSource.resources=this.getResource,this._dataSource}set dataSource(t){this._dataSource=t,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),ci(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get slideId(){var t,e;return null!==(t=null===(e=this.slide)||void 0===e?void 0:e.id)&&void 0!==t?t:0}get slideIdx(){return this._slideIdx}get slide(){var t;return null===(t=this._dataSource.slides)||void 0===t?void 0:t.find((e,n)=>n==this._slideIdx)}get slides(){return this._dataSource.slides||[]}backSlide(){this._slideIdx>0&&(this._slideIdx-=1,this.openSlide(void 0,this._slideIdx))}nextSlide(){var t,e;this._slideIdx<(null!==(t=null===(e=this._dataSource.slides)||void 0===e?void 0:e.length)&&void 0!==t?t:0)-1&&(this._slideIdx+=1,this.openSlide(void 0,this._slideIdx))}refreshSlide(){ci(),ce(this.slide)}openSlide(t,e){var n,r,l,a,o;if(t)for(let h=0,f=null!==(s=null===(d=this._dataSource.slides)||void 0===d?void 0:d.length)&&void 0!==s?s:0;h<f;h++){var s,d,u;if((null!==(u=this._dataSource.slides)&&void 0!==u?u:[])[h].id==t){this._slideIdx=h;break}}else if(e&&e>=0&&e<(null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.length)&&void 0!==n?n:0))this._slideIdx=null!=e?e:0;else{var c;this._slideIdx=0,null!==(c=this._dataSource.slides)&&void 0!==c&&c.length||(this._dataSource.slides=[JSON.parse(JSON.stringify(this._defaultSlide))])}ci(),null!==(l=this.slide)&&void 0!==l&&null!==(l=l.svg)&&void 0!==l&&l.viewBox&&(y.screen.frameSize=this.slide.svg.viewBox),ce(this.slide),this.changeSlide(this.slides,this.slideIdx,null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.length)&&void 0!==a?a:0,this.slide)}addSlide(){var t,e,n;null===(t=this._dataSource.slides)||void 0===t||t.push(this._defaultSlide),this._slideIdx=(null!==(e=null===(n=this._dataSource.slides)||void 0===n?void 0:n.length)&&void 0!==e?e:0)-1,this.openSlide(void 0,this._slideIdx)}tryMergeSlide(t,e,n){var r,l,a;let o=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(s=>s.id==t);return o?null!==(l=o.test)&&void 0!==l&&l.type&&null!==(a=e.test)&&void 0!==a&&a.type?"boolean"!=typeof n?-1:n?this.mergeSlide(t,o,e):this.insertSlide(t,1,e):this.mergeSlide(t,o,e):this.insertSlide(t,1,e)}tryReplaceSlide(t,e){var n,r,l,a,o;let s=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find(u=>u.id==t);if(!s||null!=s&&null!==(r=s.svg)&&void 0!==r&&r.nodes.filter(u=>!u.isdeleted).length)return this.insertSlide(t,1,e);let d=null!==(l=null===(a=this._dataSource.slides)||void 0===a?void 0:a.indexOf(s))&&void 0!==l?l:0;return null===(o=this._dataSource.slides)||void 0===o||o.splice(d,1,e),this._slideIdx=d,this.openSlide(void 0,this._slideIdx),1}mergeSlide(t,e,n){var r,l,a,o;return e.test=null!==(r=n.test)&&void 0!==r?r:e.test,e.audio=null!==(l=n.audio)&&void 0!==l?l:e.audio,e.svg?e.svg.nodes=e.svg.nodes.concat(null!==(a=null===(o=n.svg)||void 0===o?void 0:o.nodes)&&void 0!==a?a:[]):e.svg=n.svg,this.openSlide(t),1}insertSlide(t,e,n){var r,l,a,o,s;let d=null!==(r=null===(l=this._dataSource.slides)||void 0===l?void 0:l.find(h=>h.id==t))&&void 0!==r?r:this._defaultSlide,u=(null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(d))&&void 0!==a?a:0)+e;var c;return n?(n.id=this.newSlideId,n.code=void 0,n.name||(n.name="Trang m\u1edbi"),null!==(c=n.svg)&&void 0!==c&&c.viewBox||n.svg&&(n.svg.viewBox=y.screen.frameSize)):n=this._defaultSlide,null===(s=this._dataSource.slides)||void 0===s||s.splice(u,0,n),this._slideIdx=u,this.openSlide(void 0,this._slideIdx),1}copySlide(t){var e,n,r,l,a,o,s;let d=null!==(e=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find(h=>h.id==t))&&void 0!==e?e:this._defaultSlide,u=(null!==(r=null===(l=this._dataSource.slides)||void 0===l?void 0:l.indexOf(d))&&void 0!==r?r:0)+1,c=Object.assign(JSON.parse(JSON.stringify(d)),{id:this.newSlideId,code:void 0,name:`${d.name} + (Copy)`});null===(a=this._dataSource.slides)||void 0===a||a.splice(u,0,c),this.changeSlide(this.slides,this.slideIdx,null!==(o=null===(s=this._dataSource.slides)||void 0===s?void 0:s.length)&&void 0!==o?o:0,this.slide)}moveSlide(t,e){var n,r,l,a,o,s;let d=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(c=>c.id==t))&&void 0!==n?n:this._defaultSlide,u=null!==(l=null===(a=this._dataSource.slides)||void 0===a?void 0:a.indexOf(d))&&void 0!==l?l:0;null===(o=this._dataSource.slides)||void 0===o||o.splice(u+e,0,null===(s=this._dataSource.slides)||void 0===s?void 0:s.splice(u,1)[0])}deleteSlide(t){var e,n,r,l,a,o;let s=null!==(e=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find(h=>h.id==t))&&void 0!==e?e:this._defaultSlide,d=null!==(r=null===(l=this._dataSource.slides)||void 0===l?void 0:l.indexOf(s))&&void 0!==r?r:0;if(null===(a=this._dataSource.slides)||void 0===a||a.splice(d,1),null!==(o=this._dataSource.slides)&&void 0!==o&&o.length)if(d<this._slideIdx){var u,c;--this._slideIdx,this.changeSlide(this.slides,this.slideIdx,null!==(u=null===(c=this._dataSource.slides)||void 0===c?void 0:c.length)&&void 0!==u?u:0,this.slide)}else d==this._slideIdx&&(--this._slideIdx,this.openSlide(void 0,this._slideIdx));else this.addSlide()}deleteSlide1(t){var e,n,r,l,a;let o=null!==(e=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find(d=>d.id==t))&&void 0!==e?e:this._defaultSlide,s=null!==(r=null===(l=this._dataSource.slides)||void 0===l?void 0:l.indexOf(o))&&void 0!==r?r:0;if(o.isdeleted=!0,null!==(a=this._dataSource.slides)&&void 0!==a&&null!==(a=a.filter(d=>!d.isdeleted))&&void 0!==a&&a.length){let d=!0;for(;o.isdeleted;)d?s++:s--,this._dataSource.slides[s]?o=this._dataSource.slides[s]:d=!d;this.openSlide(o.id)}else this.addSlide()}set onChangeSlide(t){this._fnChangeSlides.push(t)}changeSlide(t,e,n,r){this._fnChangeSlides.forEach(l=>l(t,e,n,r))}set node(t){var e,n;let r=null===(e=this._dataSource.slides)||void 0===e?void 0:e.find((l,a)=>a==this._slideIdx);null!=r&&null!==(n=r.svg)&&void 0!==n&&n.nodes&&r.svg.nodes.push(t),y.history.push([{type:"add",from:{id:t.id},to:{id:t.id}}]),ce(r),ce(r,null==r?void 0:r.id)}findNode(t){var e;let n=null===(e=this._dataSource.slides)||void 0===e?void 0:e.find((h,f)=>f==this._slideIdx),r=null==n?void 0:n.svg,l=(h,f)=>{let v=null==h?void 0:h.find(g=>g.id==t);if(v)return v.pid=f,v;let b=0,p=h.length||0;for(;b<p&&!v&&(v=l(h[b].nodes||[],h[b].id),!v);)b++;return v},a=l((null==r?void 0:r.nodes)||[]);var o,s,d,u,c;return a?(a.style=null!==(o=a.style)&&void 0!==o?o:{},a.source=null!==(s=a.source)&&void 0!==s?s:{},a.animate=null!==(d=a.animate)&&void 0!==d?d:{},a.interactive=null!==(u=a.interactive)&&void 0!==u?u:{},a.variable=null!==(c=a.variable)&&void 0!==c?c:{},a):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}getNode(t){var e;let n=null===(e=this._dataSource.slides)||void 0===e?void 0:e.find((o,s)=>s==this._slideIdx),r=null==n?void 0:n.svg,a=o=>{let s=(null==o?void 0:o.find(v=>v.id==t))||(o=>{let s=null,d=0,u=o.length||0;for(;d<u&&!s;){if(s=a(o[d].nodes),s){s.pid=o[d].id;break}d++}var c,h,f,v,b;return s&&(s.style=null!==(c=s.style)&&void 0!==c?c:{},s.source=null!==(h=s.source)&&void 0!==h?h:{},s.animate=null!==(f=s.animate)&&void 0!==f?f:{},s.interactive=null!==(v=s.interactive)&&void 0!==v?v:{},s.variable=null!==(b=s.variable)&&void 0!==b?b:{}),s})((null==o?void 0:o.filter(v=>v.type==F.GROUP))||[]);var d,u,c,h,f;return s&&(s.style=null!==(d=s.style)&&void 0!==d?d:{},s.source=null!==(u=s.source)&&void 0!==u?u:{},s.animate=null!==(c=s.animate)&&void 0!==c?c:{},s.interactive=null!==(h=s.interactive)&&void 0!==h?h:{},s.variable=null!==(f=s.variable)&&void 0!==f?f:{}),s};return a((null==r?void 0:r.nodes)||[])||{id:null,pid:null,type:null,element:document.createElement("div"),size:{x:0,y:0,width:0,height:0,points:[]},attribute:{},style:{},source:{},animate:{},interactive:{},variable:{},isfake:!0,isdeleted:!1,nodes:[]}}getNodeInArea(t,e,n,r,l){var a;let o=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find((u,c)=>c==this._slideIdx),s=null==o?void 0:o.svg,d=u=>{let c=[];return u.filter(h=>!h.isdeleted).forEach(h=>{h.type==F.GROUP?c=c.concat(d(h.nodes||[])):t>h.size.x||e>h.size.y||n<h.size.x+h.size.width||r<h.size.y+h.size.height||(l?h.type==l&&c.push(h.id):c.push(h.id))}),c};return d((null==s?void 0:s.nodes)||[])}getNodeOnArea(t,e,n,r,l){var a;let o=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find((u,c)=>c==this._slideIdx),s=null==o?void 0:o.svg,d=u=>{let c=[];return u.filter(h=>!h.isdeleted).forEach(h=>{h.type==F.GROUP?c=c.concat(d(h.nodes||[])):h.size.x+h.size.width<t||h.size.y+h.size.height<e||h.size.x>n||h.size.y>r||(l?h.type==l&&c.push(h.id):c.push(h.id))}),c};return d((null==s?void 0:s.nodes)||[])}deleteNode(t,e){var n;return this.getNode(t).isdeleted=null==e||e,ce(this.slide),ce(this.slide,null===(n=this.slide)||void 0===n?void 0:n.id),t}unGroup(t){var e,n;let r=this.getNode(t),l=Math.ceil(1e9*Math.random());return null===(e=this.slide)||void 0===e||null===(e=e.svg)||void 0===e||e.nodes.push(Object.assign(JSON.parse(JSON.stringify(r)),{id:l})),Object.assign(r,{isdeleted:!0}),ce(this.slide),ce(this.slide,null===(n=this.slide)||void 0===n?void 0:n.id),l}addGroup(t,e){var n;let r=this.getNode(t),l=this.getNode(e);l.nodes=l.nodes||[];let a=Math.ceil(1e9*Math.random());return l.nodes.push(Object.assign(JSON.parse(JSON.stringify(r)),{id:a})),Object.assign(r,{isdeleted:!0}),ce(this.slide),ce(this.slide,null===(n=this.slide)||void 0===n?void 0:n.id),a}setNodeP(t,e){var n;let r=null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n?void 0:n.nodes.find(l=>l.id==t);r&&(r.pid=e||null)}bringToFront(t){this.bringToFrontStep(t,0)}sendToBack(t){this.sendToBackStep(t,0)}bringToFrontStep(t,e){var n,r,l,a,o,s;null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((u,c)=>{u.index=c+1});let d=(null!==(r=null===(l=this.slide)||void 0===l||null===(l=l.svg)||void 0===l?void 0:l.nodes.length)&&void 0!==r?r:0)+1;t.map(u=>{var c,h;return{id:u,index:null!==(c=null===(h=this.slide)||void 0===h||null===(h=h.svg)||void 0===h||null===(h=h.nodes.find(f=>f.id==u))||void 0===h?void 0:h.index)&&void 0!==c?c:0}}).sort((u,c)=>u.index-c.index).forEach(u=>{var h,c;e?null===(h=this.slide)||void 0===h||null===(h=h.svg)||void 0===h||h.nodes.filter((f,v)=>f.id==u.id).forEach(f=>{f.index=e+u.index+u.index/1e3}):null===(c=this.slide)||void 0===c||null===(c=c.svg)||void 0===c||c.nodes.filter(f=>f.id==u.id).forEach(f=>{f.index=d+u.index})}),null===(a=this.slide)||void 0===a||null===(a=a.svg)||void 0===a||a.nodes.sort((u,c)=>{var h,f;return(null!==(h=u.index)&&void 0!==h?h:0)-(null!==(f=c.index)&&void 0!==f?f:0)}),hn(this.slide),null===(o=window.document.getElementById(rt.RESIZE_GROUP))||void 0===o||o.remove(),null===(s=window.document.getElementById(rt.SELECT_GROUP))||void 0===s||s.remove(),te(y.dataSelect.nodes)}sendToBackStep(t,e){var n,r,l,a;null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((o,s)=>{o.index=s+1}),t.map(o=>{var s,d;return{id:o,index:null!==(s=null===(d=this.slide)||void 0===d||null===(d=d.svg)||void 0===d||null===(d=d.nodes.find(u=>u.id==o))||void 0===d?void 0:d.index)&&void 0!==s?s:0}}).sort((o,s)=>o.index-s.index).forEach(o=>{var d,s;e?null===(d=this.slide)||void 0===d||null===(d=d.svg)||void 0===d||d.nodes.filter(u=>u.id==o.id).forEach(u=>{u.index=e+o.index+o.index/1e3}):null===(s=this.slide)||void 0===s||null===(s=s.svg)||void 0===s||s.nodes.filter(u=>u.id==o.id).forEach(u=>{u.index=o.index/100-1})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((o,s)=>{var d,u;return(null!==(d=o.index)&&void 0!==d?d:0)-(null!==(u=s.index)&&void 0!==u?u:0)}),hn(this.slide),null===(l=window.document.getElementById(rt.RESIZE_GROUP))||void 0===l||l.remove(),null===(a=window.document.getElementById(rt.SELECT_GROUP))||void 0===a||a.remove(),te(y.dataSelect.nodes)}bringToFrontArea(t){var e,n,r,l;let a=t.map(v=>y.data.getNode(v)).filter(v=>!v.isfake),{x1:o,y1:s,x2:d,y2:u}=la(a),c=this.getNodeOnArea(o,s,d,u);null===(e=this.slide)||void 0===e||null===(e=e.svg)||void 0===e||e.nodes.forEach((v,b)=>{v.index=b+1});let h=c.map(v=>{var b,p;return null!==(b=null===(p=this.slide)||void 0===p||null===(p=p.svg)||void 0===p||null===(p=p.nodes.find(g=>g.id==v))||void 0===p?void 0:p.index)&&void 0!==b?b:0}),f=Math.max.apply(null,h);t.forEach((v,b)=>{var p;null===(p=this.slide)||void 0===p||null===(p=p.svg)||void 0===p||p.nodes.filter(g=>g.id==v).forEach(g=>{g.index=f+(b+1)/100})}),null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.sort((v,b)=>{var p,g;return(null!==(p=v.index)&&void 0!==p?p:0)-(null!==(g=b.index)&&void 0!==g?g:0)}),hn(this.slide),null===(r=window.document.getElementById(rt.RESIZE_GROUP))||void 0===r||r.remove(),null===(l=window.document.getElementById(rt.SELECT_GROUP))||void 0===l||l.remove(),te(y.dataSelect.nodes)}sendToBackArea(t){var e,n,r,l;let a=t.map(v=>y.data.getNode(v)).filter(v=>!v.isfake),{x1:o,y1:s,x2:d,y2:u}=la(a),c=this.getNodeOnArea(o,s,d,u);null===(e=this.slide)||void 0===e||null===(e=e.svg)||void 0===e||e.nodes.forEach((v,b)=>{v.index=b+1});let h=c.map(v=>{var b,p;return null!==(b=null===(p=this.slide)||void 0===p||null===(p=p.svg)||void 0===p||null===(p=p.nodes.find(g=>g.id==v))||void 0===p?void 0:p.index)&&void 0!==b?b:0}),f=Math.min.apply(null,h)-1;t.forEach((v,b)=>{var p;null===(p=this.slide)||void 0===p||null===(p=p.svg)||void 0===p||p.nodes.filter(g=>g.id==v).forEach(g=>{g.index=f+(b+1)/100})}),null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.sort((v,b)=>{var p,g;return(null!==(p=v.index)&&void 0!==p?p:0)-(null!==(g=b.index)&&void 0!==g?g:0)}),hn(this.slide),null===(r=window.document.getElementById(rt.RESIZE_GROUP))||void 0===r||r.remove(),null===(l=window.document.getElementById(rt.SELECT_GROUP))||void 0===l||l.remove(),te(y.dataSelect.nodes)}}const la=i=>{let t=999999,e=999999,n=-999999,r=-999999;return i.forEach(l=>{t=Math.min(t,l.size.x),e=Math.min(e,l.size.y),n=Math.max(n,l.size.x+l.size.width),r=Math.max(r,l.size.y+l.size.height)}),{x1:t,y1:e,x2:n,y2:r}};class aa{constructor(){this._index=-1,this._dataSource=[],this.undoExecute=t=>{t.forEach(function(e){switch(e.type){case"add":y.data.deleteNode(e.from.id);break;case"edit":break;case"delete":y.data.deleteNode(e.from.id,!1);break;case"size":{let{id:n,type:r,size:l,attribute:a}=y.data.getNode(e.from.id);Object.assign(l,e.from.size),Object.assign(a,at(r,l,a)),m(window.document.getElementById(n),a);break}case"attribute":{let{id:n,attribute:r}=y.data.getNode(e.from.id);Object.assign(r,e.from.attribute),m(window.document.getElementById(n),r);break}case"style":{let{id:n,style:r}=y.data.getNode(e.from.id);Object.assign(null!=r?r:{},e.from.style),_(window.document.getElementById(n),r);break}case"source":{let{id:n,type:r,source:l}=y.data.getNode(e.from.id);Object.assign(null!=l?l:{},e.from.source),k(window.document.getElementById(n),r,null!=l?l:{});break}case"animate":{let{animate:n}=y.data.getNode(e.from.id);Object.assign(null!=n?n:{},e.from.animate);break}case"interactive":{let{interactive:n}=y.data.getNode(e.from.id);Object.assign(null!=n?n:{},e.from.interactive);break}case"variable":{let{variable:n}=y.data.getNode(e.from.id);Object.assign(null!=n?n:{},e.from.variable);break}}}),y.dataSelect.ids=[]},this.redoExecute=t=>{t.forEach(function(e){switch(e.type){case"add":y.data.deleteNode(e.to.id,!1);break;case"edit":break;case"delete":y.data.deleteNode(e.to.id,!0);break;case"size":{let{id:n,type:r,size:l,attribute:a}=y.data.getNode(e.to.id);Object.assign(l,e.to.size),Object.assign(a,at(r,l,a)),m(window.document.getElementById(n),a);break}case"attribute":{let{id:n,attribute:r}=y.data.getNode(e.to.id);Object.assign(r,e.to.attribute),m(window.document.getElementById(n),r);break}case"style":{let{id:n,style:r}=y.data.getNode(e.to.id);Object.assign(null!=r?r:{},e.to.style),_(window.document.getElementById(n),r);break}case"source":{let{id:n,type:r,source:l}=y.data.getNode(e.to.id);Object.assign(null!=l?l:{},e.to.source),k(window.document.getElementById(n),r,null!=l?l:{});break}case"animate":{let{animate:n}=y.data.getNode(e.to.id);Object.assign(null!=n?n:{},e.to.animate);break}case"interactive":{let{interactive:n}=y.data.getNode(e.to.id);Object.assign(null!=n?n:{},e.to.interactive);break}case"variable":{let{variable:n}=y.data.getNode(e.to.id);Object.assign(null!=n?n:{},e.to.variable);break}}}),y.dataSelect.ids=[]},this._fnChanges=[],this._index=-1,this._dataSource=[]}get index(){return this._index}get total(){return this._dataSource.length}get dataSource(){return this._dataSource}renew(){this._index=-1,this._dataSource=[],this.change()}push(t){this._index<0?(this._index=0,this._dataSource.length=0,this._dataSource[this._index]={data:t}):(this._index<this._dataSource.length-1&&this._dataSource.splice(this._index+1,this._dataSource.length-this._index-1),this._index++,this._dataSource.push({data:t})),this.change()}undo(){this._index<0||(this.undoExecute(this._dataSource[this._index].data),this._index--,this.change())}redo(){this._index>=this._dataSource.length-1||(this._index++,this.redoExecute(this._dataSource[this._index].data),this.change())}set onchange(t){this._fnChanges.push(t)}change(){this._fnChanges.forEach(t=>t(this.index,this.total))}}class oa{constructor(){this._x=0,this._y=0,this._width=0,this._height=0,this._scale=1,this._dislocation={x:0,y:0},this._offset={x:0,y:0},this._svgSize={x:0,y:0,width:0,height:0},this._svgViewBox={x:0,y:0,width:0,height:0},this._frameSize={x:0,y:0,width:1280,height:720},this._actived=!1,this._fnZoomChanges=[]}get actived(){return this._actived}set actived(t){this._actived=t}get get(){return{x:this._frameSize.x,y:this._frameSize.y,w:this._frameSize.width,h:this._frameSize.height,width:this._frameSize.width,height:this._frameSize.height}}set set(t){var e,n;this._frameSize.width=null!==(e=null==t?void 0:t.width)&&void 0!==e?e:1080,this._frameSize.height=null!==(n=null==t?void 0:t.height)&&void 0!==n?n:1080,this.zoomTo="fit"}get width(){return this._width}get height(){return this._height}get scale(){return this._scale}get dislocation(){return this._dislocation}get offset(){return this._offset}get svgSize(){return this._svgSize}get svgViewBox(){return this._svgViewBox}set svgViewBox(t){this._svgViewBox=t}get frameSize(){return this._frameSize}set frameSize(t){this._frameSize.x=t.x,this._frameSize.y=t.y,this._frameSize.width=t.width,this._frameSize.height=t.height,this.reset()}set screen(t){this._offset=t.offset,this._width=t.width,this._height=t.height,this.reset()}reset(){this.scaleTo(this._scale,void 0,!0)}scaleTo(t,e,n){var r;if(!(t<.01||t>100)){if(e=null!==(r=e)&&void 0!==r?r:{x:this._width/2,y:this._height/2},n)this._dislocation.x=this._width/t/2-e.x,this._dislocation.y=this._height/t/2-e.y,this._dislocation.x+=(this._width-this._frameSize.width)/2,this._dislocation.y+=(this._height-this._frameSize.height)/2;else{var l={x:Math.max(0,Math.min(C(e.x/this._width,1e3),1)),y:Math.max(0,Math.min(C(e.y/this._height,1e3),1))},a={x:(this._width/t-this._width/this._scale)*l.x,y:(this._height/t-this._height/this._scale)*l.y};this._dislocation.x+=a.x,this._dislocation.y+=a.y}this._scale=t,this.change(),this.zoomChange(this.scale)}}set zoomTo(t){"fit"==t?this.scaleTo(Math.min((this._width-80)/this._frameSize.width,(this._height-80)/this._frameSize.height),void 0,!0):"number"==typeof t&&this.scaleTo(t/100,void 0,!0)}zoomIn(){this.scaleTo(this._scale+.04*this._scale)}zoomOut(){this.scaleTo(this._scale-.04*this._scale)}init(){return{svgViewBox:this.svgViewBox,svgSize:this.svgSize}}move(t,e){this._dislocation.x=t.x+e.x/this._scale,this._dislocation.y=t.y+e.y/this._scale,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this.refScreen()}change(){this._svgSize.x=this._x,this._svgSize.y=this._y,this._svgSize.width=this._width,this._svgSize.height=this._height,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this._svgViewBox.width=this._width/this._scale,this._svgViewBox.height=this._height/this._scale,this.refScreen()}refScreen(){(()=>{let i=y.screen.svgViewBox,t=y.screen.svgSize;y.target&&(y.target.setAttributeNS(null,"viewBox",`${i.x} ${i.y} ${i.width} ${i.height}`),y.target.style.left=`${t.x}px`,y.target.style.top=`${t.y}px`,y.target.style.width=`${t.width}px`,y.target.style.height=`${t.height}px`)})()}set onZoomChange(t){this._fnZoomChanges.push(t)}zoomChange(t){this._fnZoomChanges.forEach(e=>e(t))}}class sa{constructor(){this._fill="#D9D9D9",this._stroke="#AAAAAA",this._strokeWidth=1,this._strokeLinecap="round",this._strokeLinejoin="round",this._fontFamily=void 0,this._fontSize=20,this._textLength=void 0,this._fnChangeFills=[],this._fnChangeStrokes=[],this._fnChangeStrokeWidths=[],this.loadConfig()}loadConfig(){La({callback:t=>{this._fill=(null==t?void 0:t.fill)||this._fill,this._stroke=(null==t?void 0:t.stroke)||this._stroke,this._strokeWidth=(null==t?void 0:t.strokeWidth)||this._strokeWidth,this._strokeLinecap=(null==t?void 0:t.strokeLinecap)||this._strokeLinecap,this._strokeLinejoin=(null==t?void 0:t.strokeLinejoin)||this._strokeLinejoin,this.changeFill(this.fill),this.changeStroke(this.stroke),this.changeStrokeWidth(this.strokeWidth)}})}saveConfig(){Ba({params:{fill:this._fill,stroke:this._stroke,strokeWidth:this._strokeWidth,strokeLinecap:this._strokeLinecap,strokeLinejoin:this._strokeLinejoin}})}get fill(){return this._fill}set fill(t){this._fill=t,this.changeFill(this.fill)}get stroke(){return this._stroke}set stroke(t){this._stroke=t,this.changeStroke(this.stroke)}get strokeWidth(){return this._strokeWidth}set strokeWidth(t){this._strokeWidth=t,this.changeStrokeWidth(this.strokeWidth)}get strokeLinecap(){return this._strokeLinecap}set strokeLinecap(t){this._strokeLinecap=t}get strokeLinejoin(){return this._strokeLinejoin}set strokeLinejoin(t){this._strokeLinejoin=t}get fontFamily(){return this._fontFamily}get fontSize(){return this._fontSize}get textLength(){return this._textLength}set onchangefill(t){this._fnChangeFills.push(t)}changeFill(t){this._fnChangeFills.forEach(e=>e(t)),this.saveConfig()}set onchangestroke(t){this._fnChangeStrokes.push(t)}changeStroke(t){this._fnChangeStrokes.forEach(e=>e(t)),this.saveConfig()}set onchangestrokewidth(t){this._fnChangeStrokeWidths.push(t)}changeStrokeWidth(t){this._fnChangeStrokeWidths.forEach(e=>e(t)),this.saveConfig()}}var le=function(i){return i&&JSON.parse(JSON.stringify(i))},Yi=[{key:"FinishedTest",type:"boolean",value:!1,note:"Ho\xe0n th\xe0nh BKT",system:!0,readonly:!1},{key:"TotalTest",type:"number",value:0,note:"T\u1ed5ng s\u1ed1 BKT",system:!0,readonly:!1},{key:"TotalTestDidNotPass",type:"number",value:0,note:"S\u1ed1 BKT kh\xf4ng v\u01b0\u1ee3t qua",system:!0,readonly:!1},{key:"TotalTestPassed",type:"number",value:0,note:"S\u1ed1 BKT \u0111\xe3 v\u01b0\u1ee3t qua",system:!0,readonly:!1}],Cr=[],Vu={key:"BienSo",value:"0",type:"number",note:null,readonly:!1},$u={if:[{type:"variable",variable:"BienSo",variables:null,slide:null,node:null,condition:">",operator:null,valuetype:"value",value:5}],then:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo > 5"}],else:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo <= 5"}],id:"57623302",idx:1,variables:["BienSo"]};class da{constructor(){this._data_variables=le(Yi).concat(le(Cr)),this._data_conditions=[],this.GetActionExecutings=[],this.GetActionExecuteds=[],this.FuncGetExecuteds=t=>{"function"==typeof t&&this.GetActionExecuteds.push(t)},this.OnGetActionExecuted=t=>{this.GetActionExecuteds.forEach(e=>{e(t)})},this.SetActionExecutings=[],this.FuncSetExecutings=t=>{"function"==typeof t&&this.SetActionExecutings.push(t)},this.OnSetActionExecuting=t=>{this.SetActionExecutings.forEach(e=>{e(t)})},this.SetActionExecuteds=[],this.FuncSetExecuteds=t=>{"function"==typeof t&&this.SetActionExecuteds.push(t)},this.OnSetActionExecuted=t=>{for(var e of(this.SetActionExecuteds.forEach(n=>{n(t)}),this.getCondition(t.key)||[]))e.if&&e.if.length>0&&(this.checkValueConditions(e.if)?this.setValueOperators(e.then||[]):this.setValueOperators(e.else||[]))}}renew(){this._data_variables=le(Yi).concat(le(Cr)),this._data_conditions=[]}get totalVariable(){return this._data_variables.length}get totalCondition(){return this._data_conditions.length}get get(){return{variables:this._data_variables||[],conditions:this._data_conditions||[]}}set set(t){if(!t)return;let e={};"string"==typeof t?e=JSON.parse(t):"object"==typeof t&&(e=t),this._data_variables=e.variables||[],this._data_conditions=e.conditions||(n=>(this._data_variables.map(r=>r.change||[]).forEach(r=>{n=n.concat(r)}),n))([]),Yi.forEach(n=>{var r=this._data_variables.filter(l=>l.key==n.key);r.length?r.forEach(function(l,a,o){l.type=n.type,l.readonly=n.readonly,l.system=n.system}):this._data_variables.push(n)})}getVariableTemp(){return le(Vu)}getConditionTemp(){return le($u)}getKeys(){return this._data_variables.map(function(t){return t.key}).sort(function(t,e){return t.localeCompare(e)})}getVariableAll(){return this._data_variables.length?le(function(i,t){return function(e){for(var n of i.map(function(r){return r[t]}).sort())i.filter(function(r){return r[t]==n}).forEach(function(r){e.push(r)}),i=i.filter(function(r){return r[t]!=n});return e}([])}(this._data_variables,"key")):le(Yi).concat(le(Cr))}setVariableAll(t){t&&("string"==typeof t&&(t=JSON.parse(t)),"object"==typeof t&&(this._data_variables=t),Yi.forEach(e=>{var n=this._data_variables.filter(r=>r.key==e.key);n.length?n.forEach((r,l,a)=>{r.type=e.type,r.readonly=e.readonly,r.system=e.system}):this._data_variables.push(e)}))}getVariable(t){return t?le(this._data_variables.filter(e=>e.key==t)[0]||{}):{}}setVariable(t,e,n){if(t){switch([null,void 0,NaN,1/0].indexOf(e)>=0&&(e=""),n||(n=(this._data_variables.filter(l=>l.key==t)[0]||{}).type||null),n){case"string":"string"!=typeof e&&(e=e.toString().trim());break;case"number":"number"!=typeof e&&(e=parseFloat(e)||0);break;case"boolean":"string"==typeof e&&(e=e.toLowerCase()),"boolean"!=typeof e&&(e="1"==e||"true"==e||"yes"==e||"dung"==e)}var r=this._data_variables.filter(l=>l.key==t);r.length?r.forEach(function(l,a,o){l.value=e,l.type=n}):this._data_variables.push({key:t,value:e,type:n})}}getValue(t,e){if(!t)return"";var n=this._data_variables.filter(function(a){return a.key==t});if(n.length){var l,r=n[0]||{};switch(this.OnGetActionExecuting(r),e||(e=r.type||null),e){case"string":l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":"string"==typeof r.value?r.value||"":r.value.toString().trim();break;case"number":l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?0:"number"==typeof r.value?r.value||0:parseFloat(r.value)||0;break;case"boolean":[null,void 0,NaN,1/0].indexOf(r.value)>=0?l=!1:"boolean"==typeof r.value?l=r.value:(l=(r.value+"").toLowerCase(),l="1"==r.value||"true"==r.value||"yes"==r.value||"dung"==r.value);break;case"audio-src":l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":r.value?`<audio controls style="width:280px;vertical-align:middle;"><source src="${r.value}"></source></audio>`:"";break;case"video-src":l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":r.value?`<video controls style="width:280px;vertical-align:middle;"><source src="${r.value}"></source></video>`:"";break;case"img-src":l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":r.value?`<img style="width:100%;vertical-align:middle;" src="${r.value}"/>`:"";break;default:l=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":r.value}return this.OnGetActionExecuted(r),l}return null}setValue(t,e,n){if(t){switch([null,void 0,NaN,1/0].indexOf(e)>=0&&(e=""),n||(n=(this._data_variables.filter(function(a){return a.key==t})[0]||{}).type||null),n){case"string":"string"!=typeof e&&(e=e.toString().trim());break;case"number":"number"!=typeof e&&(e=parseFloat(e)||0);break;case"boolean":"string"==typeof e&&(e=e.toLowerCase()),"boolean"!=typeof e&&(e="1"==e||"true"==e||"yes"==e||"dung"==e)}var r=this._data_variables.filter(function(a){return a.key==t});if(r.length){var l=r[0];this.OnSetActionExecuting(l),l&&(l.value=e),this.OnSetActionExecuted(l)}}}getConditionAll(){return le(this._data_conditions.sort(function(t,e){return t.idx-e.idx}))}setConditionAll(t){t&&("string"==typeof t&&(t=JSON.parse(t)),"object"==typeof t&&(this._data_conditions=t))}getCondition(t){return t?le(this._data_conditions.filter(e=>e.variable==t||(e.variables||[]).indexOf(t)>=0).sort(function(e,n){return e.idx-n.idx})):{}}switchCondition(t,e,n){switch(t){case"==":return"string"==typeof n?(n=n.toLowerCase().trim(),"string"==typeof e&&(e=e.toLowerCase().trim()),n.split(";").map(function(r){return e==r.trim()?1:0}).reduce(function(r,l){return r+l})>0):e==n;case"!=":return"string"==typeof n?(n=n.toLowerCase().trim(),"string"==typeof e&&(e=e.toLowerCase().trim()),0==n.split(";").map(function(r){return e==r.trim()?1:0}).reduce(function(r,l){return r+l})):e!=n;case">=":return e>=n;case"<=":return e<=n;case">":return e>n;case"<":return e<n;case"\u2208":return n=(n+"").toLowerCase().trim(),e=(e+"").toLowerCase().trim(),n.split(";").map(function(r){return e.indexOf(r.trim())>=0?1:0}).reduce(function(r,l){return r+l})>0;case"\u2209":return n=(n+"").toLowerCase().trim(),e=(e+"").toLowerCase().trim(),0==n.split(";").map(function(r){return e.indexOf(r.trim())>=0?1:0}).reduce(function(r,l){return r+l});default:return!1}}switchOperator(t,e,n){switch(t){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"/":return e/n;case"=":return n;case"=!":return!n;case"==":return e==n;case"!=":return e!=n}}switchFormula(t,e){switch(t){case"sum":return e.reduce(function(r,l){return r+l});case"sub":return e.reduce(function(r,l){return r-l});case"pro":return e.reduce(function(r,l){return r*l});case"div":return e.reduce(function(r,l){return r/l});case"avg":var n=e.reduce(function(r,l){return r+l})/(e.length||1);return Math.round(1e4*(n+Number.EPSILON))/1e4;case"min":return Math.min.apply(null,e);case"max":return Math.max.apply(null,e);case"and":return e.reduce(function(r,l){return r&&l});case"or":return e.reduce(function(r,l){return r||l});default:return 0}}switchValueType_Condition(t){switch(t.valuetype){case"value":return this.switchCondition(t.condition,this.getValue(t.variable),t.value);case"variable":return this.switchCondition(t.condition,this.getValue(t.variable),this.getValue(t.value));default:return 0}}switchValueType_Operator(t){switch(t.valuetype){case"value":return this.switchOperator(t.operator,this.getValue(t.variable),t.value);case"variable":return this.switchOperator(t.operator,this.getValue(t.variable),this.getValue(t.value));case"variables":var e=this.switchFormula(t.valueformula,t.value.map(n=>this.getValue(n)));return this.switchOperator(t.operator,this.getValue(t.variable),e)}}checkValueCondition(t){return this.switchValueType_Condition(t)}getValueOperator(t){return this.switchValueType_Operator(t)}setValueOperator(t){null!=t&&t.variable&&this.setValue(t.variable,this.getValueOperator(t))}checkValueConditions(t){return 0==t.map(e=>{switch(e.type){case"variable":return this.switchValueType_Condition(e)?0:1;case"variables":return 0==e.variables.map(n=>this.switchValueType_Condition(Object.assign(le(e),{variable:n}))?0:1).reduce(function(n,r){return n+r})?0:1;default:return 0}}).reduce((e,n)=>(null!=e?e:0)+(null!=n?n:0))}setValueOperators(t){for(var e of t)switch(e.type){case"variable":this.setValue(e.variable,this.getValueOperator(e));break;case"variables":for(var n of e.variables)this.setValue(n,this.getValueOperator(Object.assign(le(e),{variable:n})));break;case"slide":V.runSlide(void 0,void 0,e.slide);break;case"node":{var r;Ne({id:e.node,nodeStatus:V.nodeStatus,slideStatus:V.slideStatus});let l=V.findNode(e.node);null!=l&&null!==(r=l.interactive)&&void 0!==r&&r.click&&Ye(l,V.nodeStatus,V.slideStatus);break}}}FuncGetExecutings(t){"function"==typeof t&&this.GetActionExecutings.push(t)}OnGetActionExecuting(t){this.GetActionExecutings.forEach(e=>{e(t)})}}class ua{constructor(){this._fnChangePointerTypes=[],this._fnChangePointerTypeTemps=[],this._fnChangePenTypes=[],this._fnChangeShapeTypes=[],this._fnChangePolygonTypes=[],this._fnChanges=[],this._pointer_type=0,this._pointer_type_temp=0,this._pen_type=0,this._shape_type=0,this._polygon_type=0}setPointer_nochange(t,e,n){if(this._pointer_type=t,e)switch(t){case vt.PEN:this._pen_type=e;break;case vt.SHAPE:this._shape_type=e,n&&e===F.POLYGON&&(this._polygon_type=n)}}get pointer_type(){return this._pointer_type}set pointer_type(t){switch(this._pointer_type=t,t){case vt.PEN:this._pen_type||(this._pen_type=Dt.DRAW);break;case vt.SHAPE:this._shape_type||(this._shape_type=F.RECT)}this.changePointerType(this.pointer_type),this.change(this.pointer_type)}get pointer_type_temp(){return this._pointer_type_temp}set pointer_type_temp(t){this._pointer_type_temp=t,this.changePointerTypeTemp(this.pointer_type),this.change(this.pointer_type_temp)}get pen_type(){return this._pen_type}set pen_type(t){this._pen_type=t,this.changePenType(this.pointer_type,this.pen_type),this.change(this.pointer_type,this.pen_type)}get shape_type(){return this._shape_type}set shape_type(t){this._shape_type=t,this.changeShapeType(this.pointer_type,this.shape_type),this.change(this.pointer_type,this.shape_type)}get polygon_type(){return this._polygon_type}set polygon_type(t){this._polygon_type=t,this.changePolygonType(this.pointer_type,this.shape_type,this.polygon_type),this.change(this.pointer_type,this.shape_type,this.polygon_type)}set onchangePointerType(t){this._fnChangePointerTypes.push(t)}changePointerType(t,e,n){this._fnChangePointerTypes.forEach(r=>r(t,e,n))}set onchangePointerTypeTemp(t){this._fnChangePointerTypeTemps.push(t)}changePointerTypeTemp(t,e,n){this._fnChangePointerTypeTemps.forEach(r=>r(t,e,n))}set onchangePenType(t){this._fnChangePenTypes.push(t)}changePenType(t,e,n){this._fnChangePenTypes.forEach(r=>r(t,e,n))}set onchangeShapeType(t){this._fnChangeShapeTypes.push(t)}changeShapeType(t,e,n){this._fnChangeShapeTypes.forEach(r=>r(t,e,n))}set onchangePolygonType(t){this._fnChangePolygonTypes.push(t)}changePolygonType(t,e,n){this._fnChangePolygonTypes.forEach(r=>r(t,e,n))}set onchange(t){this._fnChanges.push(t)}change(t,e,n){this._fnChanges.forEach(r=>r(t,e,n))}}const y=new class tc{constructor(){this._container="",this._svg="",this._screen=oa.prototype,this._data=ra.prototype,this._dataSelect=ia.prototype,this._slide=na.prototype,this._history=aa.prototype,this._attribute=sa.prototype,this._pointer=ua.prototype,this._variable=da.prototype,this._data=new ra,this._dataSelect=new ia,this._slide=new na,this._history=new aa,this._attribute=new sa,this._pointer=new ua,this._variable=new da,this._pointer.onchangePointerType=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._data.onChangeSlide=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])}}get config(){return this._config}set config(t){this._config=t}get dataSource(){return{modules:"icdtV2",screen:this._screen.get,data:this._data.get,variable:this._variable.get,resources:this._data.getResource,fonts:this._data.getFonts,info:{}}}set dataSource(t){this._screen.set=t.screen||{width:1080,height:1080},this._data.set=t.data||{},this._variable.set=t.variable||{}}get container(){return this._container}set container(t){this._container=t}get svg(){return this._svg}set svg(t){this._svg=t}get target(){return window.document.querySelector(this._svg)}get screen(){return this._screen}get data(){return this._data}get dataSelect(){return this._dataSelect}get slide(){return this._slide}get history(){return this._history}get attribute(){return this._attribute}get pointer(){return this._pointer}get variable(){return this._variable}reloadView(){var t,e,n,r,l;this._screen.screen=(t=jQuery(this._container).offset(),e=jQuery(this._container).width(),n=jQuery(this._container).height(),{offset:{x:null!==(r=null==t?void 0:t.left)&&void 0!==r?r:0,y:null!==(l=null==t?void 0:t.top)&&void 0!==l?l:0},width:null!=e?e:0,height:null!=n?n:0})}init(t){this._container=t.container,this._svg=t.target,this._screen=new oa,(i=>{new lr(i.container,i.target);var t=(r,l,a,o)=>{switch(r){case vt.POINTER:jQuery(i.target).css({cursor:"auto"});break;case vt.HAND:o?jQuery(i.target).css({cursor:"grabbing"}):jQuery(i.target).css({cursor:"grab"});break;case vt.PEN:switch(l){case Dt.DRAW:jQuery(i.target).css({cursor:"url(assets/images/svg/icon/viet.png) 12 32,default"});break;case Dt.HIGHTLIGH:jQuery(i.target).css({cursor:"url(assets/images/svg/icon/highlight1.png) 12 32,default"})}break;case vt.ERASER:jQuery(i.target).css({cursor:"url(assets/images/svg/icon/gom.png) 22 22,default"});break;case vt.SHAPE:jQuery(i.target).css({cursor:"url(assets/images/svg/icon/point.png) 22 22,default"});break;case vt.TEXT:case vt.FOREIGNOBJECT:jQuery(i.target).css({cursor:"url(assets/images/svg/icon/textmouse.png) 22 22,default"})}};y.pointer.onchange=(r,l,a)=>{t(r,l)},jQuery(i.container).off("mousedown.icdt-init-icon").on("mousedown.icdt-init-icon",r=>{t(y.pointer.pointer_type,void 0,0,!0)}).off("mouseup.icdt-init-icon").on("mouseup.icdt-init-icon",r=>{t(y.pointer.pointer_type,void 0,0,!1)}),document.addEventListener("wheel",r=>{r.ctrlKey&&r.preventDefault()},{passive:!1}),jQuery(i.container).off("wheel.icdt-init").on("wheel.icdt-init",r=>{var l;r.preventDefault();let a=null!==(l=r.originalEvent)&&void 0!==l?l:r;if(!a.deltaX&&a.deltaY!=Math.floor(a.deltaY)||a.ctrlKey){var o=y.screen.scale;y.screen.scaleTo(o-.04*o*(a.deltaY>0?1:-1),Jt({x:r.clientX,y:r.clientY},1,{x:0,y:0},y.screen.offset))}else y.screen.move(y.screen.dislocation,{x:-a.deltaX,y:-a.deltaY})}),jQuery(window).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{y.screen.actived=!!jQuery(r.target).parents(y.container).length}),jQuery(i.container).off("mouseenter.icdt-init").on("mouseenter.icdt-init",r=>{}),jQuery(i.container).off("mouseleave.icdt-init").on("mouseleave.icdt-init",r=>{y.pointer.pointer_type_temp==vt.HAND&&(y.pointer.pointer_type_temp=vt.POINTER)}),jQuery(i.container).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{0==r.button&&(i.container.includes("#")&&i.container.includes(r.target.getAttribute("id"))||i.container.includes(".")&&i.container.includes(r.target.getAttribute("class"))||i.container.includes(r.target.nodeName))&&(y.pointer.pointer_type_temp||y.pointer.pointer_type)===vt.POINTER&&(y.dataSelect.ids=[])}),jQuery(i.container).off("touchmove.icdt-init").on("touchmove.icdt-init",r=>{r.preventDefault()});const e=r=>{switch(y.pointer.pointer_type_temp||y.pointer.pointer_type){case vt.POINTER:var a,o,s;("touchstart"==(null===(a=r.touchEvent)||void 0===a?void 0:a.type)||"mousedown"==(null===(o=r.mouseEvent)||void 0===o?void 0:o.type)||"dblclick"==(null===(s=r.mouseEvent)||void 0===s?void 0:s.type))&&_a(r);break;case vt.HAND:var d,u;("touchstart"==(null===(d=r.touchEvent)||void 0===d?void 0:d.type)||"mousedown"==(null===(u=r.mouseEvent)||void 0===u?void 0:u.type))&&(i=>{Ct(i,new Ta,1,{x:0,y:0})})(r);break;case vt.PEN:var c,h;("touchstart"==(null===(c=r.touchEvent)||void 0===c?void 0:c.type)||"mousedown"==(null===(h=r.mouseEvent)||void 0===h?void 0:h.type))&&(i=>{switch(y.pointer.pen_type){case Dt.DRAW:Ct(i,new Au);break;case Dt.HIGHTLIGH:Ct(i,new Ju);break;case Dt.INTERACTIVE:Zl(i)}})(r);break;case vt.SHAPE:var f,v;("touchstart"==(null===(f=r.touchEvent)||void 0===f?void 0:f.type)||"mousedown"==(null===(v=r.mouseEvent)||void 0===v?void 0:v.type))&&(i=>{var t=null;switch(y.pointer.shape_type){case F.CIRCLE:t=new Ia;break;case F.ELLIPSE:t=new Ca;break;case F.LINE:t=new Ra;break;case F.RECT:t=new Aa;break;case F.POLYGON:var e;t=new Ja(null===(e=Wt.find(n=>n.type==y.pointer.polygon_type))||void 0===e?void 0:e.ratios);break;case F.FOREIGNOBJECT:t=new Kr;break;case F.IMAGE:t=new Dr;break;case F.TEXT:case F.PATH:t=new Mr}t&&Ct(i,t)})(r);break;case vt.FOREIGNOBJECT:var b,p;("touchstart"==(null===(b=r.touchEvent)||void 0===b?void 0:b.type)||"mousedown"==(null===(p=r.mouseEvent)||void 0===p?void 0:p.type))&&(i=>{Ct(i,new Kr)})(r);break;case vt.IMAGE:var g,O;("touchstart"==(null===(g=r.touchEvent)||void 0===g?void 0:g.type)||"mousedown"==(null===(O=r.mouseEvent)||void 0===O?void 0:O.type))&&(i=>{Ct(i,new Dr)})(r);break;case vt.TEXT:var x,w;("touchstart"==(null===(x=r.touchEvent)||void 0===x?void 0:x.type)||"mousedown"==(null===(w=r.mouseEvent)||void 0===w?void 0:w.type))&&(i=>{Ct(i,new Du)})(r);break;case vt.ERASER:var S,R;("touchstart"==(null===(S=r.touchEvent)||void 0===S?void 0:S.type)||"mousedown"==(null===(R=r.mouseEvent)||void 0===R?void 0:R.type))&&(i=>{Ct(i,new Mu)})(r);break;case vt.INDEX:var J,B;("touchstart"==(null===(J=r.touchEvent)||void 0===J?void 0:J.type)||"mousedown"==(null===(B=r.mouseEvent)||void 0===B?void 0:B.type))&&Yu(r)}};let n=!1;jQuery(i.target).off("touchstart.icdt-init").on("touchstart.icdt-init",r=>{n=!0,e({touchEvent:r})}),jQuery(i.target).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{if(1!=r.button){if(n)return void(n=!1);e({mouseEvent:r})}}),jQuery(i.target).off("dblclick.icdt-init").on("dblclick.icdt-init",r=>{if(1!=r.button){if(n)return void(n=!1);e({mouseEvent:r})}}),i.iskeyboard&&(jQuery(window).off("keydown.icdt-init").on("keydown.icdt-init",r=>{y.screen.actived&&(y.dataSelect.contenteditable_id||((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),Hr(r)))}),jQuery(window).off("keyup.icdt-init").on("keyup.icdt-init",r=>{y.screen.actived&&(y.dataSelect.contenteditable_id||((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),Hr(r)))}))})({container:t.container,target:t.target,iskeyboard:t.iskeyboard})}},De=i=>!!i.match("^#[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$"),Ar=i=>!!i.match(/^rgba?/),ca=i=>!!i.match(/^none|transparent$/),ec=(i,t)=>{fa(i,null,t,i);var n=s=>{var d;"text"==s.nodeName?(s=>{var d;null!==(d=s.child)&&void 0!==d&&d.length&&(s.nodeName="g",s.child=s.child.reduce((u,c,h,f)=>{if("tspan"==c.nodeName){let p=u.find(g=>g.fill==c.fill&&g.y==c.y&&g["font-family"]==c["font-family"]&&g["font-weight"]==c["font-weight"]&&g["font-style"]==c["font-style"]&&g["font-size"]==c["font-size"]);var v,b;p?(p.x=Math.min(parseFloat(null!==(v=p.x)&&void 0!==v?v:"0"),parseFloat(null!==(b=c.x)&&void 0!==b?b:"0")),p.textContent+=c.textContent):(c.nodeName="text",u.push(c))}else u.push(c);return u},[]))})(s):null!==(d=s.child)&&void 0!==d&&d.length&&s.child.forEach(u=>n(u))},r=s=>s.reduce((d,u,c,h)=>{var f;if("g"==u.nodeName&&null!==(f=u.child)&&void 0!==f&&f.length&&(u.child=r(u.child)),"text"==u.nodeName){let p=d.find(g=>g.fill==u.fill&&g.y==u.y&&g["font-family"]==u["font-family"]&&g["font-weight"]==u["font-weight"]&&g["font-style"]==u["font-style"]&&g["font-size"]==u["font-size"]);var v,b;p?(p.x=Math.min(parseFloat(null!==(v=p.x)&&void 0!==v?v:"0"),parseFloat(null!==(b=u.x)&&void 0!==b?b:"0")),p.textContent+=u.textContent):d.push(u)}else d.push(u);return d},[]);t.forEach(s=>n(s)),t=r(t),console.log("SVG2JSON",t);let l=((s,d,u,c,h)=>{let f=null===(s=i.getAttribute("viewBox"))||void 0===s||null===(s=s.replace(/^([0-9\.]+)[\s]([0-9\.]+)[\s\,]([0-9\.]+)[\s\,]([0-9\.]+)$/g,"$1,$2,$3,$4"))||void 0===s||null===(s=s.split(","))||void 0===s?void 0:s.map(v=>C(parseFloat(v),1));return 4==(null==f?void 0:f.length)?{x:f[0],y:f[1],width:f[2],height:f[3]}:{x:null!==(d=Rn(i.getAttribute("x")))&&void 0!==d?d:0,y:null!==(u=Rn(i.getAttribute("y")))&&void 0!==u?u:0,width:null!==(c=Rn(i.getAttribute("width")))&&void 0!==c?c:0,height:null!==(h=Rn(i.getAttribute("height")))&&void 0!==h?h:0}})(),a={id:y.data.newSlideId,name:"SVG",svg:{viewBox:l,nodes:ha(t)}};if(console.log(a),a.svg&&(!a.svg.viewBox.width||!a.svg.viewBox.height)){var o;let s=0,d=0,u=c=>{c.forEach(h=>{var f;let{size:v}=h;s=Math.max(s,v.width),d=Math.max(d,v.height),u(null!==(f=h.nodes)&&void 0!==f?f:[])})};u(null!==(o=a.svg.nodes)&&void 0!==o?o:[]),a.svg.viewBox.width=s,a.svg.viewBox.height=d}return a},ha=(i,t)=>{let e=[];return i.forEach(n=>{let r={id:Math.ceil(1e9*Math.random()),pid:t,name:n.nodeName,type:(()=>{switch(n.nodeName){case"polygon":return F.POLYGON;case"polyline":return F.POLYLINE;case"path":return F.PATH;case"circle":return F.CIRCLE;case"ellipse":return F.ELLIPSE;case"line":return F.LINE;case"rect":return F.RECT;case"foreignObject":return F.FOREIGNOBJECT;case"image":return F.IMAGE;case"text":return F.TEXT;case"tspan":return F.TSPAN;case"g":return F.GROUP}return 0})(),size:((l,a)=>{let o={},s=0,d=0,u=0,c=0,h=null!==(l=n.rotate)&&void 0!==l?l:null;switch(n.nodeName){case"circle":{let f=parseFloat(n.cx||"0"),v=parseFloat(n.cy||"0"),b=parseFloat(n.r||"0");s=f-b,d=v-b,u=2*b,c=2*b;break}case"ellipse":{let f=parseFloat(n.cx||"0"),v=parseFloat(n.cy||"0"),b=parseFloat(n.rx||"0"),p=parseFloat(n.ry||"0");s=f-b,d=v-p,u=2*b,c=2*p;break}case"line":{let f=parseFloat(n.x1||"0"),v=parseFloat(n.y1||"0"),b=parseFloat(n.x2||"0"),p=parseFloat(n.y2||"0"),g=999999999,O=999999999,x=0,w=0;g=Math.min(f,b),O=Math.min(v,p),x=Math.max(f,b),w=Math.max(v,p),s=g,d=O,u=x-s||1,c=w-d||1,Object.assign(o,{ratios:[[(f-s)/u,(v-d)/c],[(b-s)/u,(p-d)/c]]});break}case"rect":s=parseFloat(n.x||"0"),d=parseFloat(n.y||"0"),u=parseFloat(n.width||"0"),c=parseFloat(n.height||"0"),Object.assign(o,{x:s,y:d,width:u,height:c});break;case"foreignObject":case"image":s=parseFloat(n.x||"0"),d=parseFloat(n.y||"0"),u=parseFloat(n.width||"0"),c=parseFloat(n.height||"0");break;case"text":case"tspan":o.x||o.y||(n.x&&(s=parseFloat(n.x||"0")),n.y&&(d=parseFloat(n.y||"0"))),(f=>{let v=16;var b,p,g;f&&(v=f.match(/rem/)?16*parseInt(f):parseInt(f)),c=1.2*(b=v),u=b/14*8*(null!==(p=null===(g=n.textContent)||void 0===g?void 0:g.length)&&void 0!==p?p:1),n["alignment-baseline"]||n["dominant-baseline"]||(d-=b)})(n["font-size"]||"16");break;case"polygon":case"polyline":{if(!n.points)break;let f=(i=>{return(t=i.replace(/\,/g," ").replace(/\-/g," -").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim())?t.split(/\s/).map(e=>parseFloat(e)):[];var t})(n.points),{minX:v,minY:b,maxX:p,maxY:g}=(i=>{let t=[],e=[];return i.forEach((n,r)=>{r%2==0?t.push(n):e.push(n)}),{minX:Math.min.apply(null,t),minY:Math.min.apply(null,e),maxX:Math.max.apply(null,t),maxY:Math.max.apply(null,e)}})(f);s=v,d=b,u=p-s||1,c=g-d||1,Object.assign(o,{ratios:Ln({x:s,y:d,width:u,height:c},f)});break}case"path":{if(!n.d)break;let f=Ue(n.d),{minX:v,minY:b,maxX:p,maxY:g}=He(f);s=v,d=b,u=p-s||1,c=g-d||1,Object.assign(o,{ratioMaps:We({x:s,y:d,width:u,height:c},f)});break}}return null!=(f=null===(a=n.transform)||void 0===a||null===(a=a.replace(/\,/," "))||void 0===a?void 0:a.replace(/\s+/g," "))&&f.match(/rotate\([^\)]+\)/)&&(O=null===(v=null!==(b=null==f?void 0:f.match(/rotate\([^\)]+\)/))&&void 0!==b?b:[])||void 0===v||null===(v=v.shift())||void 0===v?void 0:v.toString())&&(w=null==O||null===(x=O.replace(/[^0-9\-\.\,\ ]/g,""))||void 0===x||null===(x=x.replace(/\,/g," "))||void 0===x||null===(x=x.replace(/\s+/g," "))||void 0===x?void 0:x.split(" ")).length&&Object.assign(o,{rotate:parseFloat(w[0]||"0")}),null!=f&&f.match(/translate\([^\)]+\)/)&&(O=>{var x;O&&(w=>{w.length>=2&&(s+=parseFloat(w[0]||"0"),d+=parseFloat(w[1]||"0"))})(null==O||null===(x=O.replace(/[^0-9\-\.\,\ ]/g,""))||void 0===x||null===(x=x.replace(/\,/g," "))||void 0===x||null===(x=x.replace(/\s+/g," "))||void 0===x?void 0:x.split(" "))})(null===(p=null!==(g=null==f?void 0:f.match(/translate\([^\)]+\)/))&&void 0!==g?g:[])||void 0===p||null===(p=p.shift())||void 0===p?void 0:p.toString()),null!=f&&f.match(/matrix\([^\)]+\)/)&&(O=>{if(O){var x;let w=oe({x:s,y:d},O);s=w.x,d=w.y,h=null!==(x=w.rotate)&&void 0!==x?x:null}})(f),Object.assign(o,{x:s,y:d,width:u,height:c,rotate:h}),o;var f,v,b,O,x,w,p,g})(),attribute:(()=>{let l={};switch(n.fill&&(l.fill=Ar(w=n.fill)?ht(w):De(w)?w:ca(w)?"rgba(0,0,0,0)":"#000000"),n["fill-opacity"]&&(l.fillOpacity=n["fill-opacity"]),n["fill-rule"]&&(l.fillRule=n["fill-rule"]),n.stroke&&(w=>{l.stroke=Ar(w)?ht(w):De(w)?w:ca(w)?"rgba(0,0,0,0)":"#000000"})(n.stroke),n["stroke-opacity"]&&(l.strokeOpacity=n["stroke-opacity"]),n["stroke-width"]&&(l.strokeWidth=parseFloat(n["stroke-width"])||0),n["stroke-linecap"]&&(l.strokeLinecap=n["stroke-linecap"]),n["stroke-linejoin"]&&(l.strokeLinejoin=n["stroke-linejoin"]),n["stroke-miterlimit"]&&(l.strokeMiterlimit=parseFloat(n["stroke-miterlimit"])||0),n["stroke-dasharray"]&&(l.strokeDasharray=parseFloat(n["stroke-dasharray"])||0),n.nodeName){case"polygon":case"polyline":{var a;let w=null!==(a=n.points)&&void 0!==a?a:null;Object.assign(l,{points:w});break}case"path":{var o;let w=null!==(o=n.d)&&void 0!==o?o:null;Object.assign(l,{d:w});break}case"circle":case"ellipse":case"line":case"rect":case"foreignObject":case"image":break;case"text":case"tspan":{var s,d,u,c,h,f,v,b,p;let w=null!==(s=n["font-family"])&&void 0!==s?s:null,S=null!==(d=n["font-weight"])&&void 0!==d?d:null,R=null!==(u=n["font-style"])&&void 0!==u?u:null,J=null!==(c=n["font-size"])&&void 0!==c?c:null,B=null!==(h=n["letter-spacing"])&&void 0!==h?h:null,z=null!==(f=n["word-spacing"])&&void 0!==f?f:null,T=null!==(v=n["alignment-baseline"])&&void 0!==v?v:null,A=null!==(b=n["dominant-baseline"])&&void 0!==b?b:null,Q=null!==(p=n["text-anchor"])&&void 0!==p?p:null;if(w){var g,O,x;let D=et(w);w=null!==(g=D.fontFamily)&&void 0!==g?g:w,S=null!==(O=D.fontWeight)&&void 0!==O?O:S,R=null!==(x=D.fontStyle)&&void 0!==x?x:R}T||A||(A="text-before-edge"),Object.assign(l,{fontFamily:w,fontWeight:S,fontStyle:R,letterSpacing:B,wordSpacing:z,alignmentBaseline:T,dominantBaseline:A,textAnchor:Q}),J&&(J.match(/rem/)?Object.assign(l,{fontSize:16*parseInt(J)}):Object.assign(l,{fontSize:parseInt(J)}));break}}var w;return l})(),style:{},source:(()=>{let l={};switch(n.nodeName){case"polygon":case"polyline":case"circle":case"ellipse":case"line":case"rect":case"foreignObject":break;case"image":n.base64&&Object.assign(l,{type:"image",image:{base64:n.base64}});break;case"text":case"tspan":n.textContent&&Object.assign(l,{type:"text",text:{textContent:n.textContent}})}return l})()};if(e.push(r),n.child){let l=ha(n.child,r.id);e=[...e,...l]}}),e},fa=(i,t,e,n)=>{i.querySelectorAll(":scope > *").forEach(r=>{if(["defs","script"].includes(r.nodeName))return;let l=[],a={};switch("use"===(Jn(r,a),a=Object.assign({},null!=t?t:{},a),a.nodeName)&&(a.href?Jn(n.querySelector(a.href),a):a["xlink:href"]&&Jn(n.querySelector(a["xlink:href"]),a)),a.nodeName){case"circle":case"ellipse":var o;if(null!==(o=a.transform)&&void 0!==o&&o.match(/matrix\([^\)]+\)/)){var s,d;let A=parseFloat(null!==(s=a.x)&&void 0!==s?s:"0"),Q=parseFloat(null!==(d=a.y)&&void 0!==d?d:"0");(D=>{if(D){var E;let P=oe({x:A,y:Q},D);a.x=P.x,a.y=P.y,a.rotate=null!==(E=P.rotate)&&void 0!==E?E:null}})(a.transform),a.transform=null}break;case"text":{var u,c;if(null!==(u=a.transform)&&void 0!==u&&u.match(/matrix\([^\)]+\)/)){var h,f;let Q=parseFloat(null!==(h=a.x)&&void 0!==h?h:"0"),D=parseFloat(null!==(f=a.y)&&void 0!==f?f:"0");(E=>{if(E){var P;let L=oe({x:Q,y:D},E);a.x=L.x,a.y=L.y,a.rotate=null!==(P=L.rotate)&&void 0!==P?P:null}})(a.transform),a.transform=null}else if(null!==(c=a.transform)&&void 0!==c&&c.match(/translate\([^\)]+\)/)){var v,b,p,g,O;let Q=parseFloat(null!==(v=a.x)&&void 0!==v?v:"0"),D=parseFloat(null!==(b=a.y)&&void 0!==b?b:"0");(E=null===(p=null!==(g=null===(O=a.transform)||void 0===O?void 0:O.match(/translate\([^\)]+\)/))&&void 0!==g?g:[])||void 0===p||null===(p=p.shift())||void 0===p?void 0:p.toString())&&(L=null==E||null===(P=E.replace(/[^0-9\-\.\,\ ]/g,""))||void 0===P||null===(P=P.replace(/\,/g," "))||void 0===P||null===(P=P.replace(/\s+/g," "))||void 0===P?void 0:P.split(" ")).length>=2&&(a.x=Q+parseFloat(L[0]||"0"),a.y=D+parseFloat(L[1]||"0")),a.transform=null}let A=r.textContent;A&&Object.assign(a,{textContent:A}),!a.fill&&!a.stroke&&(a.fill="#000000");break}case"tspan":{var x;if(null!==(x=a.transform)&&void 0!==x&&x.match(/matrix\([^\)]+\)/)){var w,S;let Q=parseFloat(null!==(w=a.x)&&void 0!==w?w:"0"),D=parseFloat(null!==(S=a.y)&&void 0!==S?S:"0");(E=>{if(E){let P=oe({x:Q,y:D},E);a.x=P.x,a.y=P.y}})(a.transform),a.transform=null}else{var R,J,B,z;let Q=parseFloat(null!==(R=a.x)&&void 0!==R?R:"0"),D=parseFloat(null!==(J=a.y)&&void 0!==J?J:"0");a.x=C(null!==(B=Q+(null==t?void 0:t.x))&&void 0!==B?B:0,10),a.y=C(null!==(z=D+(null==t?void 0:t.y))&&void 0!==z?z:0,10)}let A=r.textContent;A&&Object.assign(a,{textContent:A}),!a.fill&&!a.stroke&&(a.fill="#000000");break}case"path":if(a.d){var T;let A=((i,t)=>{let e=Vi(t);return e?window.Snap.path.map(i,window.Snap.matrix(e.a,e.b,e.c,e.d,e.e,e.f)).toString():i})(a.d,null!==(T=a.transform)&&void 0!==T&&T.match(/matrix/)?a.transform:"matrix(1 0 0 1 0 0)");Object.assign(a,{d:A}),a.transform=null}!a.fill&&!a.stroke&&(a.fill="#000000");break;case"image":{let A=a["xlink:href"]||a.href;null!=A&&A.match(/;base64,/)&&Object.assign(a,{base64:A});break}}var E,P,L;fa(r,a,l,n),l.length&&Object.assign(a,{child:l}),e.push(a)})},Jn=(i,t)=>{if(i){if(["symbol"].includes(i.nodeName))return void Jn((i.querySelectorAll(":scope > *")||[])[0],t);t.nodeName=i.nodeName,[["x","y","width","height"],["x1","x2","y1","y2"],["rx","ry","r"],["cx","cy"],["fill","fill-opacity","fill-rule"],["stroke","stroke-opacity","stroke-width","stroke-miterlimit","stroke-linecap","stroke-linejoin","stroke-dasharray"],["d","points"],["font-family","font-weight","font-style","font-size","letter-spacing","word-spacing","alignment-baseline","dominant-baseline","text-anchor"],["transform","transform-origin"],["href","xlink:href"]].forEach(e=>{e.forEach(n=>{ic(i,t,n)})})}},ic=(i,t,e)=>{let n=i.getAttribute(e);if(n){let r={};r[e]=n.trim(),Object.assign(t,r)}},Rn=i=>{return i?"string"==typeof i?i.match(/in/)?C(96*parseFloat(null!==(t=i.replace(/[^0-9\.]/g,""))&&void 0!==t?t:"0"),1):C(parseFloat(null!==(e=i.replace(/[^0-9\.]/g,""))&&void 0!==e?e:"0"),1):"number"==typeof i?i:0:0;var t,e},nc=(i,t)=>{var e={data:{slides:[]},info:{},resources:[],screen:{w:0,h:0,width:0,height:0},variable:{conditions:[],variables:[]}};return(e=i.shift()).data=e.data||{},e.data.slides=e.data.slides||[],e.variable=e.variable||{},e.variable.conditions=e.variable.conditions||[],e.variable.variables=e.variable.variables||[],i.forEach((n,r)=>{var a=(n.data||{}).slides||[],o=n.variable||{},s=o.conditions||[],d=o.variables||[];a.forEach(function(h){if(a.find(function(b){return b.id==h.id})){var f=h.id.toString(),v=y.data.newSlideId;h.id=v,a.forEach(function(b){var p;null!==(p=b.svg)&&void 0!==p&&p.nodes&&(b.svg.nodes=JSON.parse(JSON.stringify(b.svg.nodes).replace(new RegExp(f,"g"),v.toString())))}),s=JSON.parse(JSON.stringify(s).replace(new RegExp(f,"g"),v.toString()))}});var u=e.variable.variables.map(function(h){return h.key});d=d.filter(function(h){return u.indexOf(h.key)<0});var c=e.variable.conditions.length;s.sort(function(h,f){return h.idx-f.idx}).map(function(h,f){return h.idx=f+1,h}).forEach(function(h,f){console.log(`${r}(b=${n.board_id}) -> ${h.idx} + ${c} = ${h.idx+c}`),h.idx=h.idx+c}),e.data.slides=e.data.slides.concat(a),e.variable.conditions=e.variable.conditions.concat(s),e.variable.variables=e.variable.variables.concat(d)}),e},rc=(i,t)=>{let{id:e,size:n,animate:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,animate:r}));r?r.value=t:r={value:t},y.history.push([{type:"animate",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,animate:r}))}])},lc=(i,t)=>{let{id:e,size:n,animate:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,animate:r}));r?r.in=t:r={in:t},y.history.push([{type:"animate",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,animate:r}))}])},ac=(i,t)=>{let{id:e,size:n,animate:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,animate:r}));r?r.out=t:r={out:t},y.history.push([{type:"animate",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,animate:r}))}])},oc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.action?n.show.action.value=t:n.show.action={value:t}:n.show={action:{value:t}}:n={show:{action:{value:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},sc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.action?n.show.action.points=t:n.show.action={points:t}:n.show={action:{points:t}}:n={show:{action:{points:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},dc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.action?n.show.action.time=t:n.show.action={time:t}:n.show={action:{time:t}}:n={show:{action:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},uc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.action?n.show.action.iteration=t:n.show.action={iteration:t}:n.show={action:{iteration:t}}:n={show:{action:{iteration:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},cc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.action?n.show.action.finish=t:n.show.action={finish:t}:n.show={action:{finish:t}}:n={show:{action:{finish:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},hc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.audio?n.show.audio.source=t:n.show.audio={source:t}:n.show={audio:{source:t}}:n={show:{audio:{source:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},fc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.audio?n.show.audio.iteration=t:n.show.audio={iteration:t}:n.show={audio:{iteration:t}}:n={show:{audio:{iteration:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}]),-1==t&&Jr(i,"change-slide")},vc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.audio?n.show.audio.finish=t:n.show.audio={finish:t}:n.show={audio:{finish:t}}:n={show:{audio:{finish:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Jr=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.audio?n.show.audio.async=t:n.show.audio={async:t}:n.show={audio:{async:t}}:n={show:{audio:{async:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},gc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.audio?n.show.audio.time=t:n.show.audio={time:t}:n.show={audio:{time:t}}:n={show:{audio:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},yc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggershow?n.show.triggershow.id=t:n.show.triggershow={id:t}:n.show={triggershow:{id:t}}:n={show:{triggershow:{id:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},pc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggershow?n.show.triggershow.ids=t:n.show.triggershow={ids:t}:n.show={triggershow:{ids:t}}:n={show:{triggershow:{ids:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},mc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggershow?n.show.triggershow.async=t:n.show.triggershow={async:t}:n.show={triggershow:{async:t}}:n={show:{triggershow:{async:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},wc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggershow?n.show.triggershow.time=t:n.show.triggershow={time:t}:n.show={triggershow:{time:t}}:n={show:{triggershow:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},bc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerrun?n.show.triggerrun.id=t:n.show.triggerrun={id:t}:n.show={triggerrun:{id:t}}:n={show:{triggerrun:{id:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},xc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerrun?n.show.triggerrun.ids=t:n.show.triggerrun={ids:t}:n.show={triggerrun:{ids:t}}:n={show:{triggerrun:{ids:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Sc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerrun?n.show.triggerrun.async=t:n.show.triggerrun={async:t}:n.show={triggerrun:{async:t}}:n={show:{triggerrun:{async:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},kc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerrun?n.show.triggerrun.time=t:n.show.triggerrun={time:t}:n.show={triggerrun:{time:t}}:n={show:{triggerrun:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Oc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerhide?n.show.triggerhide.id=t:n.show.triggerhide={id:t}:n.show={triggerhide:{id:t}}:n={show:{triggerhide:{id:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Nc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerhide?n.show.triggerhide.ids=t:n.show.triggerhide={ids:t}:n.show={triggerhide:{ids:t}}:n={show:{triggerhide:{ids:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},_c=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerhide?n.show.triggerhide.async=t:n.show.triggerhide={async:t}:n.show={triggerhide:{async:t}}:n={show:{triggerhide:{async:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Ec=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.show?n.show.triggerhide?n.show.triggerhide.time=t:n.show.triggerhide={time:t}:n.show={triggerhide:{time:t}}:n={show:{triggerhide:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Tc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.action?n.click.action.value=t:n.click.action={value:t}:n.click={action:{value:t}}:n={click:{action:{value:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Ic=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.action?n.click.action.points=t:n.click.action={points:t}:n.click={action:{points:t}}:n={click:{action:{points:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Cc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.action?n.click.action.time=t:n.click.action={time:t}:n.click={action:{time:t}}:n={click:{action:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Ac=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.action?n.click.action.iteration=t:n.click.action={iteration:t}:n.click={action:{iteration:t}}:n={click:{action:{iteration:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Jc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.action?n.click.action.finish=t:n.click.action={finish:t}:n.click={action:{finish:t}}:n={click:{action:{finish:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Rc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.audio?n.click.audio.source=t:n.click.audio={source:t}:n.click={audio:{source:t}}:n={click:{audio:{source:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},jc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.audio?n.click.audio.iteration=t:n.click.audio={iteration:t}:n.click={audio:{iteration:t}}:n={click:{audio:{iteration:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}]),-1==t&&Jr(i,"change-slide")},zc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.audio?n.click.audio.finish=t:n.click.audio={finish:t}:n.click={audio:{finish:t}}:n={click:{audio:{finish:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Fc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.audio?n.click.audio.async=t:n.click.audio={async:t}:n.click={audio:{async:t}}:n={click:{audio:{async:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Lc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.audio?n.click.audio.time=t:n.click.audio={time:t}:n.click={audio:{time:t}}:n={click:{audio:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Bc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggershow?n.click.triggershow.id=t:n.click.triggershow={id:t}:n.click={triggershow:{id:t}}:n={click:{triggershow:{id:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Pc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggershow?n.click.triggershow.ids=t:n.click.triggershow={ids:t}:n.click={triggershow:{ids:t}}:n={click:{triggershow:{ids:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Mc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggershow?n.click.triggershow.async=t:n.click.triggershow={async:t}:n.click={triggershow:{async:t}}:n={click:{triggershow:{async:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Kc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggershow?n.click.triggershow.time=t:n.click.triggershow={time:t}:n.click={triggershow:{time:t}}:n={click:{triggershow:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Dc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerrun?n.click.triggerrun.id=t:n.click.triggerrun={id:t}:n.click={triggerrun:{id:t}}:n={click:{triggerrun:{id:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Gc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerrun?n.click.triggerrun.ids=t:n.click.triggerrun={ids:t}:n.click={triggerrun:{ids:t}}:n={click:{triggerrun:{ids:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Qc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerrun?n.click.triggerrun.async=t:n.click.triggerrun={async:t}:n.click={triggerrun:{async:t}}:n={click:{triggerrun:{async:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Uc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerrun?n.click.triggerrun.time=t:n.click.triggerrun={time:t}:n.click={triggerrun:{time:t}}:n={click:{triggerrun:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Hc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerhide?n.click.triggerhide.id=t:n.click.triggerhide={id:t}:n.click={triggerhide:{id:t}}:n={click:{triggerhide:{id:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Wc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerhide?n.click.triggerhide.ids=t:n.click.triggerhide={ids:t}:n.click={triggerhide:{ids:t}}:n={click:{triggerhide:{ids:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Yc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerhide?n.click.triggerhide.async=t:n.click.triggerhide={async:t}:n.click={triggerhide:{async:t}}:n={click:{triggerhide:{async:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Xc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.triggerhide?n.click.triggerhide.time=t:n.click.triggerhide={time:t}:n.click={triggerhide:{time:t}}:n={click:{triggerhide:{time:t}}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},qc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.slide?(n.click.slide.id=null==t?void 0:t.id,n.click.slide.code=null==t?void 0:t.code):n.click.slide=t:n.click={slide:t}:n={click:{slide:t}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Zc=(i,t)=>{let{id:e,interactive:n}=i,r=JSON.parse(JSON.stringify({id:e,interactive:n}));n?n.click?n.click.media=t:n.click={media:t}:n={click:{media:t}},y.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:e,interactive:n}))}])},Vc=(i,t)=>{let{id:e,variable:n}=i,r=JSON.parse(JSON.stringify({id:e,variable:n}));n?n.input?n.input.variable=t:n.input={variable:t}:n={input:{variable:t}},y.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:e,variable:n}))}])},$c=(i,t)=>{let{id:e,variable:n}=i,r=JSON.parse(JSON.stringify({id:e,variable:n}));n?n.click?n.click.variable=t:n.click={variable:t}:n={click:{variable:t}},y.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:e,variable:n}))}])},th=(i,t)=>{let{id:e,variable:n}=i,r=JSON.parse(JSON.stringify({id:e,variable:n}));n?n.click?n.click.operator=t:n.click={operator:t}:n={click:{operator:t}},y.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:e,variable:n}))}])},eh=(i,t)=>{let{id:e,variable:n}=i,r=JSON.parse(JSON.stringify({id:e,variable:n}));n?n.click?n.click.valuetype=t:n.click={valuetype:t}:n={click:{valuetype:t}},y.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:e,variable:n}))}])},ih=(i,t)=>{let{id:e,variable:n}=i,r=JSON.parse(JSON.stringify({id:e,variable:n}));n?n.click?n.click.value=t:n.click={value:t}:n={click:{value:t}},y.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:e,variable:n}))}])},nh=i=>{let t=[];i.forEach((n,r)=>{let{id:l,size:a,attribute:o}=n;t.push(JSON.parse(JSON.stringify({id:l,size:a,attribute:o})))});let e=999999;for(let{size:n}of i)e=Math.min(e,n.x);for(let{id:n,type:r,size:l,attribute:a}of i)l.x=e,Object.assign(a,at(r,l,a)),m(window.document.getElementById(n),a);y.history.push(i.map((n,r)=>{let{id:l,size:a,attribute:o}=n;return{type:"size",from:t[r],to:JSON.parse(JSON.stringify({id:l,size:a,attribute:o}))}}))},rh=i=>{let t=[];i.forEach((n,r)=>{let{id:l,size:a,attribute:o}=n;t.push(JSON.parse(JSON.stringify({id:l,size:a,attribute:o})))});let e=999999;for(let{size:n}of i)e=Math.min(e,n.y);for(let{id:n,type:r,size:l,attribute:a}of i)l.y=e,Object.assign(a,at(r,l,a)),m(window.document.getElementById(n),a);y.history.push(i.map((n,r)=>{let{id:l,size:a,attribute:o}=n;return{type:"size",from:t[r],to:JSON.parse(JSON.stringify({id:l,size:a,attribute:o}))}}))},lh=i=>{let t=[];i.forEach((n,r)=>{let{id:l,size:a,attribute:o}=n;t.push(JSON.parse(JSON.stringify({id:l,size:a,attribute:o})))});let e=-999999;for(let{size:n}of i)e=Math.max(e,n.x+n.width);for(let{id:n,type:r,size:l,attribute:a}of i)l.x=e-l.width,Object.assign(a,at(r,l,a)),m(window.document.getElementById(n),a);y.history.push(i.map((n,r)=>{let{id:l,size:a,attribute:o}=n;return{type:"size",from:t[r],to:JSON.parse(JSON.stringify({id:l,size:a,attribute:o}))}}))},ah=i=>{let t=[];i.forEach((n,r)=>{let{id:l,size:a,attribute:o}=n;t.push(JSON.parse(JSON.stringify({id:l,size:a,attribute:o})))});let e=-999999;for(let{size:n}of i)e=Math.max(e,n.y+n.height);for(let{id:n,type:r,size:l,attribute:a}of i)l.y=e-l.height,Object.assign(a,at(r,l,a)),m(window.document.getElementById(n),a);y.history.push(i.map((n,r)=>{let{id:l,size:a,attribute:o}=n;return{type:"size",from:t[r],to:JSON.parse(JSON.stringify({id:l,size:a,attribute:o}))}}))},oh=i=>{let t=[];i.forEach((l,a)=>{let{id:o,size:s,attribute:d}=l;t.push(JSON.parse(JSON.stringify({id:o,size:s,attribute:d})))});let e=999999,n=-999999,r=0;for(let{size:l}of i)e=Math.min(e,l.x),n=Math.max(n,l.x+l.width);r=C((e+n)/2);for(let{id:l,type:a,size:o,attribute:s}of i)o.x=C(r-o.width/2),Object.assign(s,at(a,o,s)),m(window.document.getElementById(l),s);y.history.push(i.map((l,a)=>{let{id:o,size:s,attribute:d}=l;return{type:"size",from:t[a],to:JSON.parse(JSON.stringify({id:o,size:s,attribute:d}))}}))},sh=i=>{let t=[];i.forEach((l,a)=>{let{id:o,size:s,attribute:d}=l;t.push(JSON.parse(JSON.stringify({id:o,size:s,attribute:d})))});let e=999999,n=-999999,r=0;for(let{size:l}of i)e=Math.min(e,l.y),n=Math.max(n,l.y+l.height);r=C((e+n)/2);for(let{id:l,type:a,size:o,attribute:s}of i)o.y=C(r-o.height/2),Object.assign(s,at(a,o,s)),m(window.document.getElementById(l),s);y.history.push(i.map((l,a)=>{let{id:o,size:s,attribute:d}=l;return{type:"size",from:t[a],to:JSON.parse(JSON.stringify({id:o,size:s,attribute:d}))}}))},dh=i=>{var t,e;let n=[];i.forEach((l,a)=>{let{id:o,size:s,attribute:d}=l;n.push(JSON.parse(JSON.stringify({id:o,size:s,attribute:d})))});let r=null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox.x)&&void 0!==t?t:0;for(let{id:l,type:a,size:o,attribute:s}of i)o.x=r,Object.assign(s,at(a,o,s)),m(window.document.getElementById(l),s);y.history.push(i.map((l,a)=>{let{id:o,size:s,attribute:d}=l;return{type:"size",from:n[a],to:JSON.parse(JSON.stringify({id:o,size:s,attribute:d}))}}))},uh=i=>{var t,e;let n=[];i.forEach((l,a)=>{let{id:o,size:s,attribute:d}=l;n.push(JSON.parse(JSON.stringify({id:o,size:s,attribute:d})))});let r=null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox.y)&&void 0!==t?t:0;for(let{id:l,type:a,size:o,attribute:s}of i)o.y=r,Object.assign(s,at(a,o,s)),m(window.document.getElementById(l),s);y.history.push(i.map((l,a)=>{let{id:o,size:s,attribute:d}=l;return{type:"size",from:n[a],to:JSON.parse(JSON.stringify({id:o,size:s,attribute:d}))}}))},ch=i=>{var t,e;let n=[];i.forEach((o,s)=>{let{id:d,size:u,attribute:c}=o;n.push(JSON.parse(JSON.stringify({id:d,size:u,attribute:c})))});let{x:r,width:l}=null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{x:0,width:0},a=r+l;for(let{id:o,type:s,size:d,attribute:u}of i)d.x=a-d.width,Object.assign(u,at(s,d,u)),m(window.document.getElementById(o),u);y.history.push(i.map((o,s)=>{let{id:d,size:u,attribute:c}=o;return{type:"size",from:n[s],to:JSON.parse(JSON.stringify({id:d,size:u,attribute:c}))}}))},hh=i=>{var t,e;let n=[];i.forEach((o,s)=>{let{id:d,size:u,attribute:c}=o;n.push(JSON.parse(JSON.stringify({id:d,size:u,attribute:c})))});let{y:r,height:l}=null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{y:0,height:0},a=r+l;for(let{id:o,type:s,size:d,attribute:u}of i)d.y=a-d.height,Object.assign(u,at(s,d,u)),m(window.document.getElementById(o),u);y.history.push(i.map((o,s)=>{let{id:d,size:u,attribute:c}=o;return{type:"size",from:n[s],to:JSON.parse(JSON.stringify({id:d,size:u,attribute:c}))}}))},fh=i=>{var t,e;let n=[];i.forEach((d,u)=>{let{id:c,size:h,attribute:f}=d;n.push(JSON.parse(JSON.stringify({id:c,size:h,attribute:f})))});let{x:r,width:l}=null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{x:0,width:0},s=C((r+(r+l))/2);for(let{id:d,type:u,size:c,attribute:h}of i)c.x=C(s-c.width/2),Object.assign(h,at(u,c,h)),m(window.document.getElementById(d),h);y.history.push(i.map((d,u)=>{let{id:c,size:h,attribute:f}=d;return{type:"size",from:n[u],to:JSON.parse(JSON.stringify({id:c,size:h,attribute:f}))}}))},vh=i=>{var t,e;let n=[];i.forEach((d,u)=>{let{id:c,size:h,attribute:f}=d;n.push(JSON.parse(JSON.stringify({id:c,size:h,attribute:f})))});let{y:r,height:l}=null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{y:0,height:0},s=C((r+(r+l))/2);for(let{id:d,type:u,size:c,attribute:h}of i)c.y=C(s-c.height/2),Object.assign(h,at(u,c,h)),m(window.document.getElementById(d),h);y.history.push(i.map((d,u)=>{let{id:c,size:h,attribute:f}=d;return{type:"size",from:n[u],to:JSON.parse(JSON.stringify({id:c,size:h,attribute:f}))}}))},gh=i=>{if(i.length<3)return;let t=[];i.forEach((o,s)=>{let{id:d,size:c,attribute:h}=o;t.push(JSON.parse(JSON.stringify({id:d,size:c,attribute:h})))});let e=999999,n=-999999,r=[],l=i.length;for(let o=0;o<l;o++){let{id:s,size:d}=i[o];r.push({idx:o,id:s,x:d.x+d.width/2})}r=r.sort((o,s)=>o.x-s.x),e=r[0].x,n=r[l-1].x;let a=n-e;for(let o=1,s=r.length-2;o<=s;o++){let{id:d,type:u,size:c,attribute:h}=i[r[o].idx];c.x=e+a*o/(l-1)-c.width/2,Object.assign(h,at(u,c,h)),m(window.document.getElementById(d),h)}y.history.push(i.map((o,s)=>{let{id:d,size:c,attribute:h}=o;return{type:"size",from:t[s],to:JSON.parse(JSON.stringify({id:d,size:c,attribute:h}))}}))},yh=i=>{if(i.length<3)return;let t=[];i.forEach((o,s)=>{let{id:d,size:u,attribute:c}=o;t.push(JSON.parse(JSON.stringify({id:d,size:u,attribute:c})))});let e=999999,n=-999999,r=[],l=i.length;for(let o=0;o<l;o++){let{id:s,size:d}=i[o];r.push({idx:o,id:s,y:d.y+d.height/2})}r=r.sort((o,s)=>o.y-s.y),e=r[0].y,n=r[l-1].y;let a=n-e;for(let o=1,s=r.length-2;o<=s;o++){let{id:d,type:u,size:c,attribute:h}=i[r[o].idx];c.y=e+a*o/(l-1)-c.height/2,Object.assign(h,at(u,c,h)),m(window.document.getElementById(d),h)}y.history.push(i.map((o,s)=>{let{id:d,size:u,attribute:c}=o;return{type:"size",from:t[s],to:JSON.parse(JSON.stringify({id:d,size:u,attribute:c}))}}))},ph=i=>{var t,e;let n=[];i.forEach((a,o)=>{let{id:s,size:u,attribute:c}=a;n.push(JSON.parse(JSON.stringify({id:s,size:u,attribute:c})))});let{x:r,width:l}=null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{x:0,width:0};for(let{id:a,type:o,size:s,attribute:d}of i)s.x=r,s.width=l,Object.assign(d,at(o,s,d)),m(window.document.getElementById(a),d);y.history.push(i.map((a,o)=>{let{id:s,size:u,attribute:c}=a;return{type:"size",from:n[o],to:JSON.parse(JSON.stringify({id:s,size:u,attribute:c}))}}))},mh=i=>{var t,e;let n=[];i.forEach((a,o)=>{let{id:s,size:d,attribute:u}=a;n.push(JSON.parse(JSON.stringify({id:s,size:d,attribute:u})))});let{y:r,height:l}=null!==(t=null===(e=y.data.slide)||void 0===e||null===(e=e.svg)||void 0===e?void 0:e.viewBox)&&void 0!==t?t:{y:0,height:0};for(let{id:a,type:o,size:s,attribute:d}of i)s.y=r,s.height=l,Object.assign(d,at(o,s,d)),m(window.document.getElementById(a),d);y.history.push(i.map((a,o)=>{let{id:s,size:d,attribute:u}=a;return{type:"size",from:n[o],to:JSON.parse(JSON.stringify({id:s,size:d,attribute:u}))}}))},wh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));t?De(t)&&(r.fill=t):r.fill=void 0,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},bh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.fillOpacity="number"==typeof t?C(t/100,100):void 0,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},xh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));t?De(t)&&(r.stroke=t):r.stroke=void 0,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Sh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.strokeOpacity="number"==typeof t?C(t/100,100):void 0,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},kh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.strokeWidth="number"==typeof t?C(t,100):void 0,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Oh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.strokeDasharray="number"==typeof t?C(t,100):void 0,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Nh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.strokeLinecap=t,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},_h=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.strokeLinejoin=t,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Eh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.fontFamily=t,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Th=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.fontWeight=t,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Ih=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.fontStyle=t,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Ch=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.fontSize="number"==typeof t?C(t,100):void 0,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Ah=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.textLength="number"==typeof t?C(t,100):void 0,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Jh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.letterSpacing="number"==typeof t?C(t,100):void 0,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Rh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.wordSpacing="number"==typeof t?C(t,100):void 0,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},jh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.textDecoration=t,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},zh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.textAnchor=t,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Fh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.dominantBaseline=t,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Lh=(i,t)=>{let{id:e,size:n,attribute:r}=i,l=JSON.parse(JSON.stringify({id:e,size:n,attribute:r}));r.rx="number"==typeof t?C(t,100):void 0,m(window.document.getElementById(e),r),y.history.push([{type:"attribute",from:l,to:JSON.parse(JSON.stringify({id:e,size:n,attribute:r}))}])},Bh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.padding=C(t):n={padding:C(t)},_(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Ph=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.borderWidth=t:n={borderWidth:t},_(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Mh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.borderStyle=t:n={borderStyle:t},_(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Kh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n})),l=a=>{n?n.borderColor=a:n={borderColor:a}};t?De(t)&&l(t):l(),_(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Dh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.borderOpacity="number"==typeof t?C(t/100,100):void 0:n={borderOpacity:"number"==typeof t?C(t/100,100):void 0},_(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Gh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.borderRadius=C(t):n={borderRadius:C(t)},_(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Qh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.fontFamily=t:n={fontFamily:t},_(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Uh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.fontSize=t:n={fontSize:t},_(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Hh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n})),l=a=>{n?n.color=a:n={color:a}};t?De(t)&&l(t):l(),_(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Wh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.opacity="number"==typeof t?C(t/100,100):void 0:n={opacity:"number"==typeof t?C(t/100,100):void 0},_(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Yh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n})),l=a=>{n?n.backgroundColor=a:n={backgroundColor:a}};t?De(t)&&l(t):l(),_(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},Xh=(i,t)=>{let{id:e,style:n}=i,r=JSON.parse(JSON.stringify({id:e,style:n}));n?n.backgroundOpacity="number"==typeof t?C(t/100,100):void 0:n={backgroundOpacity:"number"==typeof t?C(t/100,100):void 0},_(window.document.getElementById(e),n),y.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:e,style:n}))}])},qh=(i,t)=>{i.svg?i.svg.viewBox?i.svg.viewBox.x=C(t):i.svg.viewBox={x:C(t),y:0,width:1e3,height:1e3}:i.svg={viewBox:{x:C(t),y:0,width:1e3,height:1e3}}},Zh=(i,t)=>{i.svg?i.svg.viewBox?i.svg.viewBox.y=C(t):i.svg.viewBox={x:0,y:C(t),width:1e3,height:1e3}:i.svg={viewBox:{x:0,y:C(t),width:1e3,height:1e3}}},Vh=(i,t,e)=>{i.svg?i.svg.viewBox?(e&&(i.svg.viewBox.height=C(t*i.svg.viewBox.height/i.svg.viewBox.width)),i.svg.viewBox.width=C(t)):i.svg.viewBox={x:0,y:0,width:C(t),height:C(t)}:i.svg={viewBox:{x:0,y:0,width:C(t),height:C(t)}}},$h=(i,t,e)=>{i.svg?i.svg.viewBox?(e&&(i.svg.viewBox.width=C(t*i.svg.viewBox.width/i.svg.viewBox.height)),i.svg.viewBox.height=C(t)):i.svg.viewBox={x:0,y:0,width:C(t),height:C(t)}:i.svg={viewBox:{x:0,y:0,width:C(t),height:C(t)}}},tf=(i,t)=>{i.svg?i.svg.background?i.svg.background.color=t:i.svg.background={color:t}:i.svg={background:{color:t}},ui(i)},ef=(i,t)=>{i.svg?i.svg.background?i.svg.background.opacity="number"==typeof t?C(t/100,100):void 0:i.svg.background={opacity:"number"==typeof t?C(t/100,100):void 0}:i.svg={background:{opacity:"number"==typeof t?C(t/100,100):void 0}},ui(i)},nf=(i,t)=>{i.svg?i.svg.background?(i.svg.background.path=null==t?void 0:t.path,i.svg.background.url=null==t?void 0:t.url,i.svg.background.name=null==t?void 0:t.name):i.svg.background=t:i.svg={background:t},ui(i)}},8547:zr=>{zr.exports=function vt(Dt,F,mt){function Wt(Bt,bt){if(!F[Bt]){if(!Dt[Bt]){if(_t)return _t(Bt,!0);var ot=new Error("Cannot find module '"+Bt+"'");throw ot.code="MODULE_NOT_FOUND",ot}var wt=F[Bt]={exports:{}};Dt[Bt][0].call(wt.exports,function(Et){return Wt(Dt[Bt][1][Et]||Et)},wt,wt.exports,vt,Dt,F,mt)}return F[Bt].exports}for(var _t=void 0,pt=0;pt<mt.length;pt++)Wt(mt[pt]);return Wt}({1:[function(vt,Dt,F){(function(mt){"use strict";var _t,Wt=mt.MutationObserver||mt.WebKitMutationObserver;if(Wt){var pt=0,Bt=new Wt(Et),bt=mt.document.createTextNode("");Bt.observe(bt,{characterData:!0}),_t=function(){bt.data=pt=++pt%2}}else if(!mt.setImmediate&&typeof mt.MessageChannel<"u"){var it=new mt.MessageChannel;it.port1.onmessage=Et,_t=function(){it.port2.postMessage(0)}}else _t="document"in mt&&"onreadystatechange"in mt.document.createElement("script")?function(){var zt=mt.document.createElement("script");zt.onreadystatechange=function(){Et(),zt.onreadystatechange=null,zt.parentNode.removeChild(zt),zt=null},mt.document.documentElement.appendChild(zt)}:function(){setTimeout(Et,0)};var ot,wt=[];function Et(){ot=!0;for(var zt,ie,Rt=wt.length;Rt;){for(ie=wt,wt=[],zt=-1;++zt<Rt;)ie[zt]();Rt=wt.length}ot=!1}Dt.exports=function Xt(zt){1===wt.push(zt)&&!ot&&_t()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(vt,Dt,F){"use strict";var mt=vt(1);function Wt(){}var _t={},pt=["REJECTED"],Bt=["FULFILLED"],bt=["PENDING"];function it(et){if("function"!=typeof et)throw new TypeError("resolver must be a function");this.state=bt,this.queue=[],this.outcome=void 0,et!==Wt&&Xt(this,et)}function ot(et,St,ht){this.promise=et,"function"==typeof St&&(this.onFulfilled=St,this.callFulfilled=this.otherCallFulfilled),"function"==typeof ht&&(this.onRejected=ht,this.callRejected=this.otherCallRejected)}function wt(et,St,ht){mt(function(){var kt;try{kt=St(ht)}catch(Gt){return _t.reject(et,Gt)}kt===et?_t.reject(et,new TypeError("Cannot resolve promise with itself")):_t.resolve(et,kt)})}function Et(et){var St=et&&et.then;if(et&&("object"==typeof et||"function"==typeof et)&&"function"==typeof St)return function(){St.apply(et,arguments)}}function Xt(et,St){var ht=!1;function kt(Yt){ht||(ht=!0,_t.reject(et,Yt))}function Gt(Yt){ht||(ht=!0,_t.resolve(et,Yt))}var ne=zt(function $t(){St(Gt,kt)});"error"===ne.status&&kt(ne.value)}function zt(et,St){var ht={};try{ht.value=et(St),ht.status="success"}catch(kt){ht.status="error",ht.value=kt}return ht}Dt.exports=it,it.prototype.catch=function(et){return this.then(null,et)},it.prototype.then=function(et,St){if("function"!=typeof et&&this.state===Bt||"function"!=typeof St&&this.state===pt)return this;var ht=new this.constructor(Wt);return this.state!==bt?wt(ht,this.state===Bt?et:St,this.outcome):this.queue.push(new ot(ht,et,St)),ht},ot.prototype.callFulfilled=function(et){_t.resolve(this.promise,et)},ot.prototype.otherCallFulfilled=function(et){wt(this.promise,this.onFulfilled,et)},ot.prototype.callRejected=function(et){_t.reject(this.promise,et)},ot.prototype.otherCallRejected=function(et){wt(this.promise,this.onRejected,et)},_t.resolve=function(et,St){var ht=zt(Et,St);if("error"===ht.status)return _t.reject(et,ht.value);var kt=ht.value;if(kt)Xt(et,kt);else{et.state=Bt,et.outcome=St;for(var Gt=-1,$t=et.queue.length;++Gt<$t;)et.queue[Gt].callFulfilled(St)}return et},_t.reject=function(et,St){et.state=pt,et.outcome=St;for(var ht=-1,kt=et.queue.length;++ht<kt;)et.queue[ht].callRejected(St);return et},it.resolve=function ie(et){return et instanceof this?et:_t.resolve(new this(Wt),et)},it.reject=function Rt(et){var St=new this(Wt);return _t.reject(St,et)},it.all=function Si(et){var St=this;if("[object Array]"!==Object.prototype.toString.call(et))return this.reject(new TypeError("must be an array"));var ht=et.length,kt=!1;if(!ht)return this.resolve([]);for(var Gt=new Array(ht),$t=0,ne=-1,Yt=new this(Wt);++ne<ht;)ae(et[ne],ne);return Yt;function ae(Qe,ri){St.resolve(Qe).then(function C(lt){Gt[ri]=lt,++$t===ht&&!kt&&(kt=!0,_t.resolve(Yt,Gt))},function(lt){kt||(kt=!0,_t.reject(Yt,lt))})}},it.race=function se(et){var St=this;if("[object Array]"!==Object.prototype.toString.call(et))return this.reject(new TypeError("must be an array"));var ht=et.length,kt=!1;if(!ht)return this.resolve([]);for(var Gt=-1,$t=new this(Wt);++Gt<ht;)St.resolve(et[Gt]).then(function(ae){kt||(kt=!0,_t.resolve($t,ae))},function(ae){kt||(kt=!0,_t.reject($t,ae))});return $t}},{1:1}],3:[function(vt,Dt,F){(function(mt){"use strict";"function"!=typeof mt.Promise&&(mt.Promise=vt(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(vt,Dt,F){"use strict";var mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(m){return typeof m}:function(m){return m&&"function"==typeof Symbol&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m};var pt=function _t(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}();function bt(m,_){m=m||[],_=_||{};try{return new Blob(m,_)}catch(I){if("TypeError"!==I.name)throw I;for(var j=new(typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder),N=0;N<m.length;N+=1)j.append(m[N]);return j.getBlob(_.type)}}typeof Promise>"u"&&vt(3);var it=Promise;function ot(m,_){_&&m.then(function(k){_(null,k)},function(k){_(k)})}function wt(m,_,k){"function"==typeof _&&m.then(_),"function"==typeof k&&m.catch(k)}function Et(m){return"string"!=typeof m&&(console.warn(m+" used as a key, but it is not a string."),m=String(m)),m}function Xt(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var zt="local-forage-detect-blob-support",ie=void 0,Rt={},Si=Object.prototype.toString,se="readonly",et="readwrite";function St(m){for(var _=m.length,k=new ArrayBuffer(_),j=new Uint8Array(k),N=0;N<_;N++)j[N]=m.charCodeAt(N);return k}function kt(m){return"boolean"==typeof ie?it.resolve(ie):function ht(m){return new it(function(_){var k=m.transaction(zt,et),j=bt([""]);k.objectStore(zt).put(j,"key"),k.onabort=function(N){N.preventDefault(),N.stopPropagation(),_(!1)},k.oncomplete=function(){var N=navigator.userAgent.match(/Chrome\/(\d+)/),I=navigator.userAgent.match(/Edge\//);_(I||!N||parseInt(N[1],10)>=43)}}).catch(function(){return!1})}(m).then(function(_){return ie=_})}function Gt(m){var _=Rt[m.name],k={};k.promise=new it(function(j,N){k.resolve=j,k.reject=N}),_.deferredOperations.push(k),_.dbReady=_.dbReady?_.dbReady.then(function(){return k.promise}):k.promise}function $t(m){var k=Rt[m.name].deferredOperations.pop();if(k)return k.resolve(),k.promise}function ne(m,_){var j=Rt[m.name].deferredOperations.pop();if(j)return j.reject(_),j.promise}function Yt(m,_){return new it(function(k,j){if(Rt[m.name]=Rt[m.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},m.db){if(!_)return k(m.db);Gt(m),m.db.close()}var N=[m.name];_&&N.push(m.version);var I=pt.open.apply(pt,N);_&&(I.onupgradeneeded=function(G){var U=I.result;try{U.createObjectStore(m.storeName),G.oldVersion<=1&&U.createObjectStore(zt)}catch(Y){if("ConstraintError"!==Y.name)throw Y;console.warn('The database "'+m.name+'" has been upgraded from version '+G.oldVersion+" to version "+G.newVersion+', but the storage "'+m.storeName+'" already exists.')}}),I.onerror=function(G){G.preventDefault(),j(I.error)},I.onsuccess=function(){var G=I.result;G.onversionchange=function(U){U.target.close()},k(G),$t(m)}})}function ae(m){return Yt(m,!1)}function Qe(m){return Yt(m,!0)}function ri(m,_){if(!m.db)return!0;var k=!m.db.objectStoreNames.contains(m.storeName),N=m.version>m.db.version;if(m.version<m.db.version&&(m.version!==_&&console.warn('The database "'+m.name+"\" can't be downgraded from version "+m.db.version+" to version "+m.version+"."),m.version=m.db.version),N||k){if(k){var I=m.db.version+1;I>m.version&&(m.version=I)}return!0}return!1}function lt(m){return bt([St(atob(m.data))],{type:m.type})}function ye(m){return m&&m.__local_forage_encoded_blob}function Se(m){var _=this,k=_._initReady().then(function(){var j=Rt[_._dbInfo.name];if(j&&j.dbReady)return j.dbReady});return wt(k,m,m),k}function pe(m,_,k,j){void 0===j&&(j=1);try{var N=m.db.transaction(m.storeName,_);k(null,N)}catch(I){if(j>0&&(!m.db||"InvalidStateError"===I.name||"NotFoundError"===I.name))return it.resolve().then(function(){if(!m.db||"NotFoundError"===I.name&&!m.db.objectStoreNames.contains(m.storeName)&&m.version<=m.db.version)return m.db&&(m.version=m.db.version+1),Qe(m)}).then(function(){return function ke(m){Gt(m);for(var _=Rt[m.name],k=_.forages,j=0;j<k.length;j++){var N=k[j];N._dbInfo.db&&(N._dbInfo.db.close(),N._dbInfo.db=null)}return m.db=null,ae(m).then(function(I){return m.db=I,ri(m)?Qe(m):I}).then(function(I){m.db=_.db=I;for(var G=0;G<k.length;G++)k[G]._dbInfo.db=I}).catch(function(I){throw ne(m,I),I})}(m).then(function(){pe(m,_,k,j-1)})}).catch(k);k(I)}}var Ln={_driver:"asyncStorage",_initStorage:function li(m){var _=this,k={db:null};if(m)for(var j in m)k[j]=m[j];var N=Rt[k.name];N||(Rt[k.name]=N={forages:[],db:null,dbReady:null,deferredOperations:[]}),N.forages.push(_),_._initReady||(_._initReady=_.ready,_.ready=Se);var I=[];function G(){return it.resolve()}for(var U=0;U<N.forages.length;U++){var Y=N.forages[U];Y!==_&&I.push(Y._initReady().catch(G))}var H=N.forages.slice(0);return it.all(I).then(function(){return k.db=N.db,ae(k)}).then(function(q){return k.db=q,ri(k,_._defaultConfig.version)?Qe(k):q}).then(function(q){k.db=N.db=q,_._dbInfo=k;for(var nt=0;nt<H.length;nt++){var st=H[nt];st!==_&&(st._dbInfo.db=k.db,st._dbInfo.version=k.version)}})},_support:function Bt(){try{if(!pt||!pt.open)return!1;var m=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),_="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!m||_)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}(),iterate:function ai(m,_){var k=this,j=new it(function(N,I){k.ready().then(function(){pe(k._dbInfo,se,function(G,U){if(G)return I(G);try{var H=U.objectStore(k._dbInfo.storeName).openCursor(),q=1;H.onsuccess=function(){var nt=H.result;if(nt){var st=nt.value;ye(st)&&(st=lt(st));var ct=m(st,nt.key,q++);void 0!==ct?N(ct):nt.continue()}else N()},H.onerror=function(){I(H.error)}}catch(nt){I(nt)}})}).catch(I)});return ot(j,_),j},getItem:function Zi(m,_){var k=this;m=Et(m);var j=new it(function(N,I){k.ready().then(function(){pe(k._dbInfo,se,function(G,U){if(G)return I(G);try{var H=U.objectStore(k._dbInfo.storeName).get(m);H.onsuccess=function(){var q=H.result;void 0===q&&(q=null),ye(q)&&(q=lt(q)),N(q)},H.onerror=function(){I(H.error)}}catch(q){I(q)}})}).catch(I)});return ot(j,_),j},setItem:function Ue(m,_,k){var j=this;m=Et(m);var N=new it(function(I,G){var U;j.ready().then(function(){return U=j._dbInfo,"[object Blob]"===Si.call(_)?kt(U.db).then(function(Y){return Y?_:function C(m){return new it(function(_,k){var j=new FileReader;j.onerror=k,j.onloadend=function(N){var I=btoa(N.target.result||"");_({__local_forage_encoded_blob:!0,data:I,type:m.type})},j.readAsBinaryString(m)})}(_)}):_}).then(function(Y){pe(j._dbInfo,et,function(H,q){if(H)return G(H);try{var nt=q.objectStore(j._dbInfo.storeName);null===Y&&(Y=void 0);var st=nt.put(Y,m);q.oncomplete=function(){void 0===Y&&(Y=null),I(Y)},q.onabort=q.onerror=function(){G(st.error?st.error:st.transaction.error)}}catch(ct){G(ct)}})}).catch(G)});return ot(N,k),N},removeItem:function Fr(m,_){var k=this;m=Et(m);var j=new it(function(N,I){k.ready().then(function(){pe(k._dbInfo,et,function(G,U){if(G)return I(G);try{var H=U.objectStore(k._dbInfo.storeName).delete(m);U.oncomplete=function(){N()},U.onerror=function(){I(H.error)},U.onabort=function(){I(H.error?H.error:H.transaction.error)}}catch(q){I(q)}})}).catch(I)});return ot(j,_),j},clear:function He(m){var _=this,k=new it(function(j,N){_.ready().then(function(){pe(_._dbInfo,et,function(I,G){if(I)return N(I);try{var Y=G.objectStore(_._dbInfo.storeName).clear();G.oncomplete=function(){j()},G.onabort=G.onerror=function(){N(Y.error?Y.error:Y.transaction.error)}}catch(H){N(H)}})}).catch(N)});return ot(k,m),k},length:function We(m){var _=this,k=new it(function(j,N){_.ready().then(function(){pe(_._dbInfo,se,function(I,G){if(I)return N(I);try{var Y=G.objectStore(_._dbInfo.storeName).count();Y.onsuccess=function(){j(Y.result)},Y.onerror=function(){N(Y.error)}}catch(H){N(H)}})}).catch(N)});return ot(k,m),k},key:function jn(m,_){var k=this,j=new it(function(N,I){m<0?N(null):k.ready().then(function(){pe(k._dbInfo,se,function(G,U){if(G)return I(G);try{var Y=U.objectStore(k._dbInfo.storeName),H=!1,q=Y.openKeyCursor();q.onsuccess=function(){var nt=q.result;nt?0===m||H?N(nt.key):(H=!0,nt.advance(m)):N(null)},q.onerror=function(){I(q.error)}}catch(nt){I(nt)}})}).catch(I)});return ot(j,_),j},keys:function zn(m){var _=this,k=new it(function(j,N){_.ready().then(function(){pe(_._dbInfo,se,function(I,G){if(I)return N(I);try{var Y=G.objectStore(_._dbInfo.storeName).openKeyCursor(),H=[];Y.onsuccess=function(){var q=Y.result;q?(H.push(q.key),q.continue()):j(H)},Y.onerror=function(){N(Y.error)}}catch(q){N(q)}})}).catch(N)});return ot(k,m),k},dropInstance:function Fn(m,_){_=Xt.apply(this,arguments);var N,k=this.config();return(m="function"!=typeof m&&m||{}).name||(m.name=m.name||k.name,m.storeName=m.storeName||k.storeName),ot(N=m.name?(m.name===k.name&&this._dbInfo.db?it.resolve(this._dbInfo.db):ae(m).then(function(U){var Y=Rt[m.name],H=Y.forages;Y.db=U;for(var q=0;q<H.length;q++)H[q]._dbInfo.db=U;return U})).then(m.storeName?function(U){if(U.objectStoreNames.contains(m.storeName)){var Y=U.version+1;Gt(m);var H=Rt[m.name],q=H.forages;U.close();for(var nt=0;nt<q.length;nt++){var st=q[nt];st._dbInfo.db=null,st._dbInfo.version=Y}return new it(function(Ot,Jt){var Lt=pt.open(m.name,Y);Lt.onerror=function(Ct){Lt.result.close(),Jt(Ct)},Lt.onupgradeneeded=function(){Lt.result.deleteObjectStore(m.storeName)},Lt.onsuccess=function(){var Ct=Lt.result;Ct.close(),Ot(Ct)}}).then(function(Ot){H.db=Ot;for(var Jt=0;Jt<q.length;Jt++){var Lt=q[Jt];Lt._dbInfo.db=Ot,$t(Lt._dbInfo)}}).catch(function(Ot){throw(ne(m,Ot)||it.resolve()).catch(function(){}),Ot})}}:function(U){Gt(m);var Y=Rt[m.name],H=Y.forages;U.close();for(var q=0;q<H.length;q++)H[q]._dbInfo.db=null;return new it(function(ct,Ot){var Jt=pt.deleteDatabase(m.name);Jt.onerror=function(){var Lt=Jt.result;Lt&&Lt.close(),Ot(Jt.error)},Jt.onblocked=function(){console.warn('dropInstance blocked for database "'+m.name+'" until all open connections are closed')},Jt.onsuccess=function(){var Lt=Jt.result;Lt&&Lt.close(),ct(Lt)}}).then(function(ct){Y.db=ct;for(var Ot=0;Ot<H.length;Ot++)$t(H[Ot]._dbInfo)}).catch(function(ct){throw(ne(m,ct)||it.resolve()).catch(function(){}),ct})}):it.reject("Invalid arguments"),_),N}};var oe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$i=/^~~local_forage_type~([^~]+)~/,oi="__lfsc__:",Qt="arbf",at="blob",Pe=Object.prototype.toString;function Mn(m){var j,I,G,U,Y,_=.75*m.length,k=m.length,N=0;"="===m[m.length-1]&&(_--,"="===m[m.length-2]&&_--);var H=new ArrayBuffer(_),q=new Uint8Array(H);for(j=0;j<k;j+=4)I=oe.indexOf(m[j]),G=oe.indexOf(m[j+1]),U=oe.indexOf(m[j+2]),Y=oe.indexOf(m[j+3]),q[N++]=I<<2|G>>4,q[N++]=(15&G)<<4|U>>2,q[N++]=(3&U)<<6|63&Y;return H}function _i(m){var j,_=new Uint8Array(m),k="";for(j=0;j<_.length;j+=3)k+=oe[_[j]>>2],k+=oe[(3&_[j])<<4|_[j+1]>>4],k+=oe[(15&_[j+1])<<2|_[j+2]>>6],k+=oe[63&_[j+2]];return _.length%3==2?k=k.substring(0,k.length-1)+"=":_.length%3==1&&(k=k.substring(0,k.length-2)+"=="),k}var Ei={serialize:function Kn(m,_){var k="";if(m&&(k=Pe.call(m)),m&&("[object ArrayBuffer]"===k||m.buffer&&"[object ArrayBuffer]"===Pe.call(m.buffer))){var j,N=oi;m instanceof ArrayBuffer?(j=m,N+=Qt):(j=m.buffer,"[object Int8Array]"===k?N+="si08":"[object Uint8Array]"===k?N+="ui08":"[object Uint8ClampedArray]"===k?N+="uic8":"[object Int16Array]"===k?N+="si16":"[object Uint16Array]"===k?N+="ur16":"[object Int32Array]"===k?N+="si32":"[object Uint32Array]"===k?N+="ui32":"[object Float32Array]"===k?N+="fl32":"[object Float64Array]"===k?N+="fl64":_(new Error("Failed to get type for BinaryArray"))),_(N+_i(j))}else if("[object Blob]"===k){var I=new FileReader;I.onload=function(){var G="~~local_forage_type~"+m.type+"~"+_i(this.result);_(oi+at+G)},I.readAsArrayBuffer(m)}else try{_(JSON.stringify(m))}catch(G){console.error("Couldn't convert value into a JSON string: ",m),_(null,G)}},deserialize:function Dn(m){if(m.substring(0,9)!==oi)return JSON.parse(m);var j,_=m.substring(13),k=m.substring(9,13);if(k===at&&$i.test(_)){var N=_.match($i);j=N[1],_=_.substring(N[0].length)}var I=Mn(_);switch(k){case Qt:return I;case at:return bt([I],{type:j});case"si08":return new Int8Array(I);case"ui08":return new Uint8Array(I);case"uic8":return new Uint8ClampedArray(I);case"si16":return new Int16Array(I);case"ur16":return new Uint16Array(I);case"si32":return new Int32Array(I);case"ui32":return new Uint32Array(I);case"fl32":return new Float32Array(I);case"fl64":return new Float64Array(I);default:throw new Error("Unkown type: "+k)}},stringToBuffer:Mn,bufferToString:_i};function Ti(m,_,k,j){m.executeSql("CREATE TABLE IF NOT EXISTS "+_.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],k,j)}function Ut(m,_,k,j,N,I){m.executeSql(k,j,N,function(G,U){U.code===U.SYNTAX_ERR?G.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[_.storeName],function(Y,H){H.rows.length?I(Y,U):Ti(Y,_,function(){Y.executeSql(k,j,N,I)},I)},I):I(G,U)},I)}function rn(m,_,k,j){var N=this;m=Et(m);var I=new it(function(G,U){N.ready().then(function(){void 0===_&&(_=null);var Y=_,H=N._dbInfo;H.serializer.serialize(_,function(q,nt){nt?U(nt):H.db.transaction(function(st){Ut(st,H,"INSERT OR REPLACE INTO "+H.storeName+" (key, value) VALUES (?, ?)",[m,q],function(){G(Y)},function(ct,Ot){U(Ot)})},function(st){if(st.code===st.QUOTA_ERR){if(j>0)return void G(rn.apply(N,[m,Y,k,j-1]));U(st)}})})}).catch(U)});return ot(I,k),I}var qn={_driver:"webSQLStorage",_initStorage:function Gn(m){var _=this,k={db:null};if(m)for(var j in m)k[j]="string"!=typeof m[j]?m[j].toString():m[j];var N=new it(function(I,G){try{k.db=openDatabase(k.name,String(k.version),k.description,k.size)}catch(U){return G(U)}k.db.transaction(function(U){Ti(U,k,function(){_._dbInfo=k,I()},function(Y,H){G(H)})},G)});return k.serializer=Ei,N},_support:function Bn(){return"function"==typeof openDatabase}(),iterate:function nn(m,_){var k=this,j=new it(function(N,I){k.ready().then(function(){var G=k._dbInfo;G.db.transaction(function(U){Ut(U,G,"SELECT * FROM "+G.storeName,[],function(Y,H){for(var q=H.rows,nt=q.length,st=0;st<nt;st++){var ct=q.item(st),Ot=ct.value;if(Ot&&(Ot=G.serializer.deserialize(Ot)),void 0!==(Ot=m(Ot,ct.key,st+1)))return void N(Ot)}N()},function(Y,H){I(H)})})}).catch(I)});return ot(j,_),j},getItem:function Qn(m,_){var k=this;m=Et(m);var j=new it(function(N,I){k.ready().then(function(){var G=k._dbInfo;G.db.transaction(function(U){Ut(U,G,"SELECT * FROM "+G.storeName+" WHERE key = ? LIMIT 1",[m],function(Y,H){var q=H.rows.length?H.rows.item(0).value:null;q&&(q=G.serializer.deserialize(q)),N(q)},function(Y,H){I(H)})})}).catch(I)});return ot(j,_),j},setItem:function Un(m,_,k){return rn.apply(this,[m,_,k,1])},removeItem:function Hn(m,_){var k=this;m=Et(m);var j=new it(function(N,I){k.ready().then(function(){var G=k._dbInfo;G.db.transaction(function(U){Ut(U,G,"DELETE FROM "+G.storeName+" WHERE key = ?",[m],function(){N()},function(Y,H){I(H)})})}).catch(I)});return ot(j,_),j},clear:function Ii(m){var _=this,k=new it(function(j,N){_.ready().then(function(){var I=_._dbInfo;I.db.transaction(function(G){Ut(G,I,"DELETE FROM "+I.storeName,[],function(){j()},function(U,Y){N(Y)})})}).catch(N)});return ot(k,m),k},length:function Wn(m){var _=this,k=new it(function(j,N){_.ready().then(function(){var I=_._dbInfo;I.db.transaction(function(G){Ut(G,I,"SELECT COUNT(key) as c FROM "+I.storeName,[],function(U,Y){var H=Y.rows.item(0).c;j(H)},function(U,Y){N(Y)})})}).catch(N)});return ot(k,m),k},key:function Yn(m,_){var k=this,j=new it(function(N,I){k.ready().then(function(){var G=k._dbInfo;G.db.transaction(function(U){Ut(U,G,"SELECT key FROM "+G.storeName+" WHERE id = ? LIMIT 1",[m+1],function(Y,H){var q=H.rows.length?H.rows.item(0).key:null;N(q)},function(Y,H){I(H)})})}).catch(I)});return ot(j,_),j},keys:function Xn(m){var _=this,k=new it(function(j,N){_.ready().then(function(){var I=_._dbInfo;I.db.transaction(function(G){Ut(G,I,"SELECT key FROM "+I.storeName,[],function(U,Y){for(var H=[],q=0;q<Y.rows.length;q++)H.push(Y.rows.item(q).key);j(H)},function(U,Y){N(Y)})})}).catch(N)});return ot(k,m),k},dropInstance:function Ft(m,_){_=Xt.apply(this,arguments);var k=this.config();(m="function"!=typeof m&&m||{}).name||(m.name=m.name||k.name,m.storeName=m.storeName||k.storeName);var N,j=this;return ot(N=m.name?new it(function(I){var G;G=m.name===k.name?j._dbInfo.db:openDatabase(m.name,"","",0),I(m.storeName?{db:G,storeNames:[m.storeName]}:function It(m){return new it(function(_,k){m.transaction(function(j){j.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(N,I){for(var G=[],U=0;U<I.rows.length;U++)G.push(I.rows.item(U).name);_({db:m,storeNames:G})},function(N,I){k(I)})},function(j){k(j)})})}(G))}).then(function(I){return new it(function(G,U){I.db.transaction(function(Y){function H(ct){return new it(function(Ot,Jt){Y.executeSql("DROP TABLE IF EXISTS "+ct,[],function(){Ot()},function(Lt,Ct){Jt(Ct)})})}for(var q=[],nt=0,st=I.storeNames.length;nt<st;nt++)q.push(H(I.storeNames[nt]));it.all(q).then(function(){G()}).catch(function(ct){U(ct)})},function(Y){U(Y)})})}):it.reject("Invalid arguments"),_),N}};function ln(m,_){var k=m.name+"/";return m.storeName!==_.storeName&&(k+=m.storeName+"/"),k}function $n(){return!function Vn(){var m="_localforage_support_test";try{return localStorage.setItem(m,!0),localStorage.removeItem(m),!1}catch{return!0}}()||localStorage.length>0}var de={_driver:"localStorageWrapper",_initStorage:function tr(m){var k={};if(m)for(var j in m)k[j]=m[j];return k.keyPrefix=ln(m,this._defaultConfig),$n()?(this._dbInfo=k,k.serializer=Ei,it.resolve()):it.reject()},_support:function Zn(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}(),iterate:function ir(m,_){var k=this,j=k.ready().then(function(){for(var N=k._dbInfo,I=N.keyPrefix,G=I.length,U=localStorage.length,Y=1,H=0;H<U;H++){var q=localStorage.key(H);if(0===q.indexOf(I)){var nt=localStorage.getItem(q);if(nt&&(nt=N.serializer.deserialize(nt)),void 0!==(nt=m(nt,q.substring(G),Y++)))return nt}}});return ot(j,_),j},getItem:function an(m,_){var k=this;m=Et(m);var j=k.ready().then(function(){var N=k._dbInfo,I=localStorage.getItem(N.keyPrefix+m);return I&&(I=N.serializer.deserialize(I)),I});return ot(j,_),j},setItem:function Ai(m,_,k){var j=this;m=Et(m);var N=j.ready().then(function(){void 0===_&&(_=null);var I=_;return new it(function(G,U){var Y=j._dbInfo;Y.serializer.serialize(_,function(H,q){if(q)U(q);else try{localStorage.setItem(Y.keyPrefix+m,H),G(I)}catch(nt){("QuotaExceededError"===nt.name||"NS_ERROR_DOM_QUOTA_REACHED"===nt.name)&&U(nt),U(nt)}})})});return ot(N,k),N},removeItem:function Ci(m,_){var k=this;m=Et(m);var j=k.ready().then(function(){localStorage.removeItem(k._dbInfo.keyPrefix+m)});return ot(j,_),j},clear:function er(m){var _=this,k=_.ready().then(function(){for(var j=_._dbInfo.keyPrefix,N=localStorage.length-1;N>=0;N--){var I=localStorage.key(N);0===I.indexOf(j)&&localStorage.removeItem(I)}});return ot(k,m),k},length:function nr(m){var k=this.keys().then(function(j){return j.length});return ot(k,m),k},key:function Me(m,_){var k=this,j=k.ready().then(function(){var I,N=k._dbInfo;try{I=localStorage.key(m)}catch{I=null}return I&&(I=I.substring(N.keyPrefix.length)),I});return ot(j,_),j},keys:function on(m){var _=this,k=_.ready().then(function(){for(var j=_._dbInfo,N=localStorage.length,I=[],G=0;G<N;G++){var U=localStorage.key(G);0===U.indexOf(j.keyPrefix)&&I.push(U.substring(j.keyPrefix.length))}return I});return ot(k,m),k},dropInstance:function Ji(m,_){if(_=Xt.apply(this,arguments),!(m="function"!=typeof m&&m||{}).name){var k=this.config();m.name=m.name||k.name,m.storeName=m.storeName||k.storeName}var N,j=this;return ot(N=m.name?new it(function(I){I(m.storeName?ln(m,j._defaultConfig):m.name+"/")}).then(function(I){for(var G=localStorage.length-1;G>=0;G--){var U=localStorage.key(G);0===U.indexOf(I)&&localStorage.removeItem(U)}}):it.reject("Invalid arguments"),_),N}},_e=function(_,k){return _===k||"number"==typeof _&&"number"==typeof k&&isNaN(_)&&isNaN(k)},sn=function(_,k){for(var j=_.length,N=0;N<j;){if(_e(_[N],k))return!0;N++}return!1},Ri=Array.isArray||function(m){return"[object Array]"===Object.prototype.toString.call(m)},Xe={},si={},Re={INDEXEDDB:Ln,WEBSQL:qn,LOCALSTORAGE:de},rr=[Re.INDEXEDDB._driver,Re.WEBSQL._driver,Re.LOCALSTORAGE._driver],V=["dropInstance"],di=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(V),lr={description:"",driver:rr.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ui(m,_){m[_]=function(){var k=arguments;return m.ready().then(function(){return m[_].apply(m,k)})}}function ji(){for(var m=1;m<arguments.length;m++){var _=arguments[m];if(_)for(var k in _)_.hasOwnProperty(k)&&(arguments[0][k]=Ri(_[k])?_[k].slice():_[k])}return arguments[0]}var ci=function(){function m(_){for(var k in function Wt(m,_){if(!(m instanceof _))throw new TypeError("Cannot call a class as a function")}(this,m),Re)if(Re.hasOwnProperty(k)){var j=Re[k],N=j._driver;this[k]=N,Xe[N]||this.defineDriver(j)}this._defaultConfig=ji({},lr),this._config=ji({},this._defaultConfig,_),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return m.prototype.config=function(k){if("object"===(typeof k>"u"?"undefined":mt(k))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var j in k){if("storeName"===j&&(k[j]=k[j].replace(/\W/g,"_")),"version"===j&&"number"!=typeof k[j])return new Error("Database version must be a number.");this._config[j]=k[j]}return!("driver"in k)||!k.driver||this.setDriver(this._config.driver)}return"string"==typeof k?this._config[k]:this._config},m.prototype.defineDriver=function(k,j,N){var I=new it(function(G,U){try{var Y=k._driver,H=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!k._driver)return void U(H);for(var q=di.concat("_initStorage"),nt=0,st=q.length;nt<st;nt++){var ct=q[nt];if((!sn(V,ct)||k[ct])&&"function"!=typeof k[ct])return void U(H)}!function(){for(var qe=function(un){return function(){var ar=new Error("Method "+un+" is not implemented by the current driver"),cn=it.reject(ar);return ot(cn,arguments[arguments.length-1]),cn}},zi=0,dn=V.length;zi<dn;zi++){var Fi=V[zi];k[Fi]||(k[Fi]=qe(Fi))}}();var Lt=function(qe){Xe[Y]&&console.info("Redefining LocalForage driver: "+Y),Xe[Y]=k,si[Y]=qe,G()};"_support"in k?k._support&&"function"==typeof k._support?k._support().then(Lt,U):Lt(!!k._support):Lt(!0)}catch(Ct){U(Ct)}});return wt(I,j,N),I},m.prototype.driver=function(){return this._driver||null},m.prototype.getDriver=function(k,j,N){var I=Xe[k]?it.resolve(Xe[k]):it.reject(new Error("Driver not found."));return wt(I,j,N),I},m.prototype.getSerializer=function(k){var j=it.resolve(Ei);return wt(j,k),j},m.prototype.ready=function(k){var j=this,N=j._driverSet.then(function(){return null===j._ready&&(j._ready=j._initDriver()),j._ready});return wt(N,k,k),N},m.prototype.setDriver=function(k,j,N){var I=this;Ri(k)||(k=[k]);var G=this._getSupportedDrivers(k);function U(){I._config.driver=I.driver()}function Y(nt){return I._extend(nt),U(),I._ready=I._initStorage(I._config),I._ready}var q=null!==this._driverSet?this._driverSet.catch(function(){return it.resolve()}):it.resolve();return this._driverSet=q.then(function(){var nt=G[0];return I._dbInfo=null,I._ready=null,I.getDriver(nt).then(function(st){I._driver=st._driver,U(),I._wrapLibraryMethodsWithReady(),I._initDriver=function H(nt){return function(){var st=0;return function ct(){for(;st<nt.length;){var Ot=nt[st];return st++,I._dbInfo=null,I._ready=null,I.getDriver(Ot).then(Y).catch(ct)}U();var Jt=new Error("No available storage method found.");return I._driverSet=it.reject(Jt),I._driverSet}()}}(G)})}).catch(function(){U();var nt=new Error("No available storage method found.");return I._driverSet=it.reject(nt),I._driverSet}),wt(this._driverSet,j,N),this._driverSet},m.prototype.supports=function(k){return!!si[k]},m.prototype._extend=function(k){ji(this,k)},m.prototype._getSupportedDrivers=function(k){for(var j=[],N=0,I=k.length;N<I;N++){var G=k[N];this.supports(G)&&j.push(G)}return j},m.prototype._wrapLibraryMethodsWithReady=function(){for(var k=0,j=di.length;k<j;k++)ui(this,di[k])},m.prototype.createInstance=function(k){return new m(k)},m}(),qt=new ci;Dt.exports=qt},{3:3}]},{},[4])(4)}}]);