<!DOCTYPE html>
<html>

<head>
    <title>OnlyOffice Viewer</title>
    <script src="https://office.surelrn.vn/web-apps/apps/api/documents/api.js"></script>
</head>

<body>
    <div id="onlyoffice-viewer" style="width: 100%; height: 100vh;"></div>
    <script>
        window.addEventListener('load', function () {
            var url = decodeURIComponent((new RegExp('[?|&]url=' + '([^&;]+?)(&|#|;|$)').exec(location.search) || ["", ""])[1].replace(/\+/g, '%20')) || null;
            if (!url) {
                return;
            }

            var config = {
                "type": "embedded",
                "document": {
                    "fileType": url.split('.').pop(),
                    "key": Math.floor(Math.random() * 999999999),
                    "title": url.split('/').pop(),
                    "url": url,
                    "permissions": {
                        "edit": false,
                        "download": false,
                        "print": false
                    }
                },
                "documentType": "presentation",
                "editorConfig": {
                    "mode": "embedded",
                    "lang": "vi",
                    "region": "VN",
                    "customization": {
                        "anonymous": {
                            "request": false,
                        },
                        "about": false,
                        "chat": false,
                        "comments": false,
                    },
                    "embedded": {
                        //"fullscreenUrl": url,
                        "toolbarDocked": "top"
                    },
                }
            };

            var viewer = new DocsAPI.DocEditor("onlyoffice-viewer", config);
        })
    </script>
</body>

</html>