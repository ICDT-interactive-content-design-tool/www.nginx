"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2379],{2635:(Rt,rt,T)=>{T.d(rt,{N$:()=>$,Nk:()=>E,kD:()=>G,xy:()=>M});var R=T(467),o=T(369),Z=T(5972);const U=new o.w({name:"_userDB",driverOrder:[o.C.IndexedDB,o.C.LocalStorage]}),E=function(){var F=(0,R.A)(function*(f){yield U.create();try{var j=(yield U.get("user-local"))||{};return"function"==typeof(null==f?void 0:f.callback)&&f.callback(Object.assign({},j||{})),j}catch(H){"function"==typeof(null==f?void 0:f.callback)&&f.callback(),console.error(H)}return{}});return function(j){return F.apply(this,arguments)}}(),M=function(){var F=(0,R.A)(function*(f){yield U.create(),f.params=f.params||{};try{var j=Object.assign({},f.params);yield U.set("user-local",j),"function"==typeof f.callback&&f.callback(Object.assign({},j||{}))}catch(H){"function"==typeof f.callback&&f.callback(),console.error(H)}});return function(j){return F.apply(this,arguments)}}(),G=function(){var F=(0,R.A)(function*(f){return f&&(f.params={}),M(null!=f?f:{})});return function(j){return F.apply(this,arguments)}}(),$=function(){var F=(0,R.A)(function*(f,j){let H=yield(0,Z.AC)();if(j){let S=[];f.params.profilephoto&&S.push(new Promise((V,X)=>{let N=new Image;N.onload=()=>{f.params.url_profilephoto=N.src,V(1)},N.onerror=()=>{f.params.url_profilephoto="assets/image/user-avatar-default.png",V(0)},N.src=H.readfileuploadurl+f.params.profilephoto})),f.params.banner&&S.push(new Promise((V,X)=>{let N=new Image;N.onload=()=>{f.params.url_banner=N.src,V(1)},N.onerror=()=>{f.params.url_banner="assets/image/user-banner-default.png",V(0)},N.src=H.readfileuploadurl+f.params.banner})),S.length>0?Promise.all(S).then(()=>{M(f)}):M(f)}else E({callback:S=>{if(S){let V=[];f.params.profilephoto&&V.push(new Promise((X,N)=>{let Y=new Image;Y.onload=()=>{f.params.url_profilephoto=Y.src,X(1)},Y.onerror=()=>{f.params.url_profilephoto="assets/image/user-avatar-default.png",X(0)},Y.src=H.readfileuploadurl+f.params.profilephoto})),f.params.banner&&V.push(new Promise((X,N)=>{let Y=new Image;Y.onload=()=>{f.params.url_banner=Y.src,X(1)},Y.onerror=()=>{f.params.url_banner="assets/image/user-banner-default.png",X(0)},Y.src=H.readfileuploadurl+f.params.banner})),V.length>0?Promise.all(V).then(()=>{M({params:Object.assign({},S,f.params),callback:f.callback})}):M({params:Object.assign({},S,f.params),callback:f.callback})}else"function"==typeof f.callback&&f.callback()}})});return function(j,H){return F.apply(this,arguments)}}()},3890:(Rt,rt,T)=>{T.d(rt,{x:()=>tt});var R=T(177),o=T(9417),Z=T(6637),U=T(2706),E=T(4342),M=T(9445),G=T(9362),$=T(4438);let tt=(()=>{var D;class F{}return(D=F).\u0275fac=function(j){return new(j||D)},D.\u0275mod=$.$C({type:D}),D.\u0275inj=$.G2t({imports:[R.MD,o.YN,Z.bv,U.G,E.LP,M.w,G._D,U.G,E.LP]}),F})()},5414:(Rt,rt,T)=>{T.d(rt,{c:()=>o});var R=T(467);const o=function(){var Z=(0,R.A)(function*(U,E,M){var G,$,tt;M&&(E.message||(E.message=null!==(tt=null==M?void 0:M.returnmsg)&&void 0!==tt?tt:0==(null==M?void 0:M.returncode)?"Th\xe0nh c\xf4ng!":null!=M&&M.returncode?`L\u1ed7i: #${null==M?void 0:M.returncode}`:"H\u1ec7 th\u1ed1ng kh\xf4ng c\xf3 ph\u1ea3n h\u1ed3i!"),E.icon||(E.icon=0==(null==M?void 0:M.returncode)?"checkmark-circle-sharp":null!=M&&M.returncode?"alert-circle-outline":"close-circle-sharp"),E.color||(E.color=0==(null==M?void 0:M.returncode)?"success":null!=M&&M.returncode?"warning":"danger"));return E.position||(E.position="bottom"),E.icon||(E.icon="bulb-outline"),E.color||(E.color="secondary"),E.duration=null!==(G=E.duration)&&void 0!==G?G:3e3,E.animated=null===($=E.animated)||void 0===$||$,E.buttons=[{icon:"close-outline",side:"end",role:"cancel"}],yield U.create(E)});return function(E,M,G){return Z.apply(this,arguments)}}()},9445:(Rt,rt,T)=>{T.d(rt,{h:()=>Ds,w:()=>Ps});var R=T(467),o=T(4438);class Z{constructor(e){if(this.crashes=[],this.state="initializing",this._now=Date.now,this.crashes=[],this._crashNumberLimit="number"==typeof e.crashNumberLimit?e.crashNumberLimit:3,this._minimumNonErrorTimePeriod="number"==typeof e.minimumNonErrorTimePeriod?e.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=i=>{const s="error"in i?i.error:i.reason;s instanceof Error&&this._handleError(s,i)},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.")}destroy(){this._stopErrorHandling(),this._listeners={}}on(e,i){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(i)}off(e,i){this._listeners[e]=this._listeners[e].filter(s=>s!==i)}_fire(e,...i){const s=this._listeners[e]||[];for(const d of s)d.apply(this,[null,...i])}_startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler)}_stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler)}_handleError(e,i){if(this._shouldReactToError(e)){this.crashes.push({message:e.message,stack:e.stack,filename:i instanceof ErrorEvent?i.filename:void 0,lineno:i instanceof ErrorEvent?i.lineno:void 0,colno:i instanceof ErrorEvent?i.colno:void 0,date:this._now()});const s=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:e,causesRestart:s}),s?this._restart():(this.state="crashedPermanently",this._fire("stateChange"))}}_shouldReactToError(e){return e.is&&e.is("CKEditorError")&&null!=e.context&&"ready"===this.state&&this._isErrorComingFromThisItem(e)}_shouldRestart(){return this.crashes.length<=this._crashNumberLimit||(this.crashes[this.crashes.length-1].date-this.crashes[this.crashes.length-1-this._crashNumberLimit].date)/this._crashNumberLimit>this._minimumNonErrorTimePeriod}}function U(t,e=new Set){const i=[t],s=new Set;let d=0;for(;i.length>d;){const g=i[d++];if(!s.has(g)&&E(g)&&!e.has(g))if(s.add(g),Symbol.iterator in g)try{for(const _ of g)i.push(_)}catch{}else for(const _ in g)"defaultValue"!==_&&i.push(g[_])}return s}function E(t){const e=Object.prototype.toString.call(t),i=typeof t;return!("number"===i||"boolean"===i||"string"===i||"symbol"===i||"function"===i||"[object Date]"===e||"[object RegExp]"===e||"[object Module]"===e||null==t||t._watchdogExcluded||t instanceof EventTarget||t instanceof Event)}const D=function tt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},f="object"==typeof global&&global&&global.Object===Object&&global;var j="object"==typeof self&&self&&self.Object===Object&&self;const S=f||j||Function("return this")(),X=function(){return S.Date.now()};var N=/\s/;var Qt=/^\s+/;const Xt=function Kt(t){return t&&t.slice(0,function Y(t){for(var e=t.length;e--&&N.test(t.charAt(e)););return e}(t)+1).replace(Qt,"")},at=S.Symbol;var Bt=Object.prototype,$t=Bt.hasOwnProperty,Jt=Bt.toString,gt=at?at.toStringTag:void 0;var r=Object.prototype.toString;var l=at?at.toStringTag:void 0;const C=function b(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":l&&l in Object(t)?function p(t){var e=$t.call(t,gt),i=t[gt];try{t[gt]=void 0;var s=!0}catch{}var d=Jt.call(t);return s&&(e?t[gt]=i:delete t[gt]),d}(t):function n(t){return r.call(t)}(t)},w=function A(t){return null!=t&&"object"==typeof t};var nt=/^[-+]0x[0-9a-f]+$/i,B=/^0b[01]+$/i,et=/^0o[0-7]+$/i,Dt=parseInt;const At=function zt(t){if("number"==typeof t)return t;if(function k(t){return"symbol"==typeof t||w(t)&&"[object Symbol]"==C(t)}(t))return NaN;if(D(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=D(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Xt(t);var i=B.test(t);return i||et.test(t)?Dt(t.slice(2),i?2:8):nt.test(t)?NaN:+t};var Wt=Math.max,Zt=Math.min;const Ut=function pt(t,e,i){var s=!0,d=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return D(i)&&(s="leading"in i?!!i.leading:s,d="trailing"in i?!!i.trailing:d),function qt(t,e,i){var s,d,g,_,m,v,x=0,W=!1,K=!1,ct=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function Ct(z){var ht=s,Ot=d;return s=d=void 0,x=z,_=t.apply(Ot,ht)}function q(z){var ht=z-v;return void 0===v||ht>=e||ht<0||K&&z-x>=g}function J(){var z=X();if(q(z))return lr(z);m=setTimeout(J,function Vt(z){var dr=e-(z-v);return K?Zt(dr,g-(z-x)):dr}(z))}function lr(z){return m=void 0,ct&&s?Ct(z):(s=d=void 0,_)}function me(){var z=X(),ht=q(z);if(s=arguments,d=this,v=z,ht){if(void 0===m)return function fe(z){return x=z,m=setTimeout(J,e),W?Ct(z):_}(v);if(K)return clearTimeout(m),m=setTimeout(J,e),Ct(v)}return void 0===m&&(m=setTimeout(J,e)),_}return e=At(e)||0,D(i)&&(W=!!i.leading,g=(K="maxWait"in i)?Wt(At(i.maxWait)||0,e):g,ct="trailing"in i?!!i.trailing:ct),me.cancel=function Ws(){void 0!==m&&clearTimeout(m),x=0,s=v=d=m=void 0},me.flush=function Us(){return void 0===m?_:lr(X())},me}(t,e,{leading:s,maxWait:e,trailing:d})},Ft=function te(t,e){return function(i){return t(e(i))}},ft=Ft(Object.getPrototypeOf,Object);var ye=Function.prototype.toString,gr=Object.prototype.hasOwnProperty,pr=ye.call(Object);const be=function mr(t){return w(t)&&1===t.nodeType&&!function _r(t){if(!w(t)||"[object Object]"!=C(t))return!1;var e=ft(t);if(null===e)return!0;var i=gr.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&ye.call(i)==pr}(t)},xe=function xr(t,e){return t===e||t!=t&&e!=e},kt=function vr(t,e){for(var i=t.length;i--;)if(xe(t[i][0],e))return i;return-1};var Ar=Array.prototype.splice;function mt(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var s=t[e];this.set(s[0],s[1])}}mt.prototype.clear=function yr(){this.__data__=[],this.size=0},mt.prototype.delete=function Mr(t){var e=this.__data__,i=kt(e,t);return!(i<0||(i==e.length-1?e.pop():Ar.call(e,i,1),--this.size,0))},mt.prototype.get=function Tr(t){var e=this.__data__,i=kt(e,t);return i<0?void 0:e[i][1]},mt.prototype.has=function Sr(t){return kt(this.__data__,t)>-1},mt.prototype.set=function Or(t,e){var i=this.__data__,s=kt(i,t);return s<0?(++this.size,i.push([t,e])):i[s][1]=e,this};const Lt=mt,ve=function Gr(t){if(!D(t))return!1;var e=C(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e};var t,Vr=S["__core-js_shared__"],Ce=(t=/[^.]+$/.exec(Vr&&Vr.keys&&Vr.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"";var Yr=Function.prototype.toString;const lt=function $r(t){if(null!=t){try{return Yr.call(t)}catch{}try{return t+""}catch{}}return""};var Zr=/^\[object .+?Constructor\]$/,ii=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const ai=function ni(t){return!(!D(t)||function Qr(t){return!!Ce&&Ce in t}(t))&&(ve(t)?ii:Zr).test(lt(t))},dt=function ci(t,e){var i=function oi(t,e){return null==t?void 0:t[e]}(t,e);return ai(i)?i:void 0},Tt=dt(S,"Map"),Et=dt(Object,"create");var mi=Object.prototype.hasOwnProperty;var vi=Object.prototype.hasOwnProperty;function yt(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var s=t[e];this.set(s[0],s[1])}}yt.prototype.clear=function di(){this.__data__=Et?Et(null):{},this.size=0},yt.prototype.delete=function gi(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},yt.prototype.get=function yi(t){var e=this.__data__;if(Et){var i=e[t];return"__lodash_hash_undefined__"===i?void 0:i}return mi.call(e,t)?e[t]:void 0},yt.prototype.has=function Ci(t){var e=this.__data__;return Et?void 0!==e[t]:vi.call(e,t)},yt.prototype.set=function wi(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=Et&&void 0===e?"__lodash_hash_undefined__":e,this};const Ae=yt,Ht=function Ri(t,e){var i=t.__data__;return function Ii(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?i["string"==typeof e?"string":"hash"]:i.map};function bt(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var s=t[e];this.set(s[0],s[1])}}bt.prototype.clear=function Ei(){this.size=0,this.__data__={hash:new Ae,map:new(Tt||Lt),string:new Ae}},bt.prototype.delete=function ji(t){var e=Ht(this,t).delete(t);return this.size-=e?1:0,e},bt.prototype.get=function Di(t){return Ht(this,t).get(t)},bt.prototype.has=function Pi(t){return Ht(this,t).has(t)},bt.prototype.set=function Ui(t,e){var i=Ht(this,t),s=i.size;return i.set(t,e),this.size+=i.size==s?0:1,this};const ki=bt;function xt(t){var e=this.__data__=new Lt(t);this.size=e.size}xt.prototype.clear=function jr(){this.__data__=new Lt,this.size=0},xt.prototype.delete=function Dr(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i},xt.prototype.get=function Pr(t){return this.__data__.get(t)},xt.prototype.has=function Ur(t){return this.__data__.has(t)},xt.prototype.set=function Hi(t,e){var i=this.__data__;if(i instanceof Lt){var s=i.__data__;if(!Tt||s.length<199)return s.push([t,e]),this.size=++i.size,this;i=this.__data__=new ki(s)}return i.set(t,e),this.size=i.size,this};const Gi=xt;var Ki=function(){try{var t=dt(Object,"defineProperty");return t({},"",{}),t}catch{}}();const Me=Ki,we=function Xi(t,e,i){"__proto__"==e&&Me?Me(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i};var $i=Object.prototype.hasOwnProperty;const Te=function Ji(t,e,i){var s=t[e];(!$i.call(t,e)||!xe(s,i)||void 0===i&&!(e in t))&&we(t,e,i)},Nt=function Zi(t,e,i,s){var d=!i;i||(i={});for(var g=-1,_=e.length;++g<_;){var m=e[g],v=s?s(i[m],t[m],m,i,t):void 0;void 0===v&&(v=t[m]),d?we(i,m,v):Te(i,m,v)}return i},Ee=function rn(t){return w(t)&&"[object Arguments]"==C(t)};var Se=Object.prototype,nn=Se.hasOwnProperty,an=Se.propertyIsEnumerable,on=Ee(function(){return arguments}())?Ee:function(t){return w(t)&&nn.call(t,"callee")&&!an.call(t,"callee")};const sn=on,re=Array.isArray;var Ie="object"==typeof exports&&exports&&!exports.nodeType&&exports,Oe=Ie&&"object"==typeof module&&module&&!module.nodeType&&module,Re=Oe&&Oe.exports===Ie?S.Buffer:void 0;const je=(Re?Re.isBuffer:void 0)||function hn(){return!1};var _n=/^(?:0|[1-9]\d*)$/;const mn=function fn(t,e){var i=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==i||"symbol"!=i&&_n.test(t))&&t>-1&&t%1==0&&t<e},Be=function bn(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var O={};O["[object Float32Array]"]=O["[object Float64Array]"]=O["[object Int8Array]"]=O["[object Int16Array]"]=O["[object Int32Array]"]=O["[object Uint8Array]"]=O["[object Uint8ClampedArray]"]=O["[object Uint16Array]"]=O["[object Uint32Array]"]=!0,O["[object Arguments]"]=O["[object Array]"]=O["[object ArrayBuffer]"]=O["[object Boolean]"]=O["[object DataView]"]=O["[object Date]"]=O["[object Error]"]=O["[object Function]"]=O["[object Map]"]=O["[object Number]"]=O["[object Object]"]=O["[object RegExp]"]=O["[object Set]"]=O["[object String]"]=O["[object WeakMap]"]=!1;const ie=function Qn(t){return function(e){return t(e)}};var De="object"==typeof exports&&exports&&!exports.nodeType&&exports,St=De&&"object"==typeof module&&module&&!module.nodeType&&module,ne=St&&St.exports===De&&f.process;const vt=function(){try{return St&&St.require&&St.require("util").types||ne&&ne.binding&&ne.binding("util")}catch{}}();var ze=vt&&vt.isTypedArray;const $n=ze?ie(ze):function Gn(t){return w(t)&&Be(t.length)&&!!O[C(t)]};var Zn=Object.prototype.hasOwnProperty;const Pe=function qn(t,e){var i=re(t),s=!i&&sn(t),d=!i&&!s&&je(t),g=!i&&!s&&!d&&$n(t),_=i||s||d||g,m=_?function qi(t,e){for(var i=-1,s=Array(t);++i<t;)s[i]=e(i);return s}(t.length,String):[],v=m.length;for(var x in t)(e||Zn.call(t,x))&&(!_||!("length"==x||d&&("offset"==x||"parent"==x)||g&&("buffer"==x||"byteLength"==x||"byteOffset"==x)||mn(x,v)))&&m.push(x);return m};var ta=Object.prototype;const ae=function ea(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||ta)},ia=Ft(Object.keys,Object);var aa=Object.prototype.hasOwnProperty;const We=function ca(t){return null!=t&&Be(t.length)&&!ve(t)},oe=function ha(t){return We(t)?Pe(t):function oa(t){if(!ae(t))return ia(t);var e=[];for(var i in Object(t))aa.call(t,i)&&"constructor"!=i&&e.push(i);return e}(t)};var _a=Object.prototype.hasOwnProperty;const ma=function fa(t){if(!D(t))return function ua(t){var e=[];if(null!=t)for(var i in Object(t))e.push(i);return e}(t);var e=ae(t),i=[];for(var s in t)"constructor"==s&&(e||!_a.call(t,s))||i.push(s);return i},se=function ya(t){return We(t)?Pe(t,!0):ma(t)};var Ue="object"==typeof exports&&exports&&!exports.nodeType&&exports,Fe=Ue&&"object"==typeof module&&module&&!module.nodeType&&module,ke=Fe&&Fe.exports===Ue?S.Buffer:void 0,Le=ke?ke.allocUnsafe:void 0;const He=function Sa(){return[]};var Oa=Object.prototype.propertyIsEnumerable,Ne=Object.getOwnPropertySymbols,Ra=Ne?function(t){return null==t?[]:(t=Object(t),function Ta(t,e){for(var i=-1,s=null==t?0:t.length,d=0,g=[];++i<s;){var _=t[i];e(_,i,t)&&(g[d++]=_)}return g}(Ne(t),function(e){return Oa.call(t,e)}))}:He;const ce=Ra,Ge=function Da(t,e){for(var i=-1,s=e.length,d=t.length;++i<s;)t[d+i]=e[i];return t};var Pa=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Ge(e,ce(t)),t=ft(t);return e}:He;const Ve=Pa,Qe=function Fa(t,e,i){var s=e(t);return re(t)?s:Ge(s,i(t))},La=function ka(t){return Qe(t,oe,ce)},Na=function Ha(t){return Qe(t,se,Ve)},he=dt(S,"DataView"),le=dt(S,"Promise"),de=dt(S,"Set"),ue=dt(S,"WeakMap");var Ke="[object Map]",Xe="[object Promise]",Ye="[object Set]",$e="[object WeakMap]",Je="[object DataView]",Ya=lt(he),$a=lt(Tt),Ja=lt(le),Za=lt(de),qa=lt(ue),ut=C;(he&&ut(new he(new ArrayBuffer(1)))!=Je||Tt&&ut(new Tt)!=Ke||le&&ut(le.resolve())!=Xe||de&&ut(new de)!=Ye||ue&&ut(new ue)!=$e)&&(ut=function(t){var e=C(t),i="[object Object]"==e?t.constructor:void 0,s=i?lt(i):"";if(s)switch(s){case Ya:return Je;case $a:return Ke;case Ja:return Xe;case Za:return Ye;case qa:return $e}return e});const ge=ut;var eo=Object.prototype.hasOwnProperty;const Ze=S.Uint8Array,pe=function ao(t){var e=new t.constructor(t.byteLength);return new Ze(e).set(new Ze(t)),e};var co=/\w*$/;var qe=at?at.prototype:void 0,tr=qe?qe.valueOf:void 0;const Po=function zo(t,e,i){var s=t.constructor;switch(e){case"[object ArrayBuffer]":return pe(t);case"[object Boolean]":case"[object Date]":return new s(+t);case"[object DataView]":return function oo(t,e){var i=e?pe(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}(t,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function po(t,e){var i=e?pe(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}(t,i);case"[object Map]":case"[object Set]":return new s;case"[object Number]":case"[object String]":return new s(t);case"[object RegExp]":return function ho(t){var e=new t.constructor(t.source,co.exec(t));return e.lastIndex=t.lastIndex,e}(t);case"[object Symbol]":return function uo(t){return tr?Object(tr.call(t)):{}}(t)}};var er=Object.create,Wo=function(){function t(){}return function(e){if(!D(e))return{};if(er)return er(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}();const Uo=Wo;var rr=vt&&vt.isMap;const Vo=rr?ie(rr):function Ho(t){return w(t)&&"[object Map]"==ge(t)};var ir=vt&&vt.isSet;const $o=ir?ie(ir):function Ko(t){return w(t)&&"[object Set]"==ge(t)};var nr="[object Arguments]",ar="[object Function]",or="[object Object]",I={};I[nr]=I["[object Array]"]=I["[object ArrayBuffer]"]=I["[object DataView]"]=I["[object Boolean]"]=I["[object Date]"]=I["[object Float32Array]"]=I["[object Float64Array]"]=I["[object Int8Array]"]=I["[object Int16Array]"]=I["[object Int32Array]"]=I["[object Map]"]=I["[object Number]"]=I[or]=I["[object RegExp]"]=I["[object Set]"]=I["[object String]"]=I["[object Symbol]"]=I["[object Uint8Array]"]=I["[object Uint8ClampedArray]"]=I["[object Uint16Array]"]=I["[object Uint32Array]"]=!0,I["[object Error]"]=I[ar]=I["[object WeakMap]"]=!1;const As=function Gt(t,e,i,s,d,g){var _,m=1&e,v=2&e,x=4&e;if(i&&(_=d?i(t,s,d,g):i(t)),void 0!==_)return _;if(!D(t))return t;var W=re(t);if(W){if(_=function ro(t){var e=t.length,i=new t.constructor(e);return e&&"string"==typeof t[0]&&eo.call(t,"index")&&(i.index=t.index,i.input=t.input),i}(t),!m)return function Ma(t,e){var i=-1,s=t.length;for(e||(e=Array(s));++i<s;)e[i]=t[i];return e}(t,_)}else{var K=ge(t),ct=K==ar||"[object GeneratorFunction]"==K;if(je(t))return function Ca(t,e){if(e)return t.slice();var i=t.length,s=Le?Le(i):new t.constructor(i);return t.copy(s),s}(t,m);if(K==or||K==nr||ct&&!d){if(_=v||ct?{}:function Fo(t){return"function"!=typeof t.constructor||ae(t)?{}:Uo(ft(t))}(t),!m)return v?function Wa(t,e){return Nt(t,Ve(t),e)}(t,function ba(t,e){return t&&Nt(e,se(e),t)}(_,t)):function ja(t,e){return Nt(t,ce(t),e)}(t,function la(t,e){return t&&Nt(e,oe(e),t)}(_,t))}else{if(!I[K])return d?t:{};_=Po(t,K,m)}}g||(g=new Gi);var Ct=g.get(t);if(Ct)return Ct;g.set(t,_),$o(t)?t.forEach(function(q){_.add(Gt(q,e,i,q,t,g))}):Vo(t)&&t.forEach(function(q,J){_.set(J,Gt(q,e,i,J,t,g))});var Vt=W?void 0:(x?v?Na:La:v?se:oe)(t);return function Vi(t,e){for(var i=-1,s=null==t?0:t.length;++i<s&&!1!==e(t[i],i,t););}(Vt||t,function(q,J){Vt&&(q=t[J=q]),Te(_,J,Gt(q,e,i,J,t,g))}),_};class sr extends Z{constructor(e,i={}){super(i),this._editor=null,this._lifecyclePromise=null,this._initUsingData=!0,this._editables={},this._throttledSave=Ut(this._save.bind(this),"number"==typeof i.saveInterval?i.saveInterval:5e3),e&&(this._creator=(s,d)=>e.create(s,d)),this._destructor=s=>s.destroy()}get editor(){return this._editor}get _item(){return this._editor}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}_restart(){return Promise.resolve().then(()=>(this.state="initializing",this._fire("stateChange"),this._destroy())).catch(e=>{console.error("An error happened during the editor destroying.",e)}).then(()=>{const e={},i=[],s=this._config.rootsAttributes||{},d={};for(const[_,m]of Object.entries(this._data.roots))m.isLoaded?(e[_]="",d[_]=s[_]||{}):i.push(_);const g={...this._config,extraPlugins:this._config.extraPlugins||[],lazyRoots:i,rootsAttributes:d,_watchdogInitialData:this._data};return delete g.initialData,g.extraPlugins.push(Ss),this._initUsingData?this.create(e,g,g.context):be(this._elementOrData)?this.create(this._elementOrData,g,g.context):this.create(this._editables,g,g.context)}).then(()=>{this._fire("restart")})}create(e=this._elementOrData,i=this._config,s){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(super._startErrorHandling(),this._elementOrData=e,this._initUsingData="string"==typeof e||Object.keys(e).length>0&&"string"==typeof Object.values(e)[0],this._config=this._cloneEditorConfiguration(i)||{},this._config.context=s,this._creator(e,this._config))).then(d=>{this._editor=d,d.model.document.on("change:data",this._throttledSave),this._lastDocumentVersion=d.model.document.version,this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this.state="ready",this._fire("stateChange")}).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}destroy(){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy())).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling(),this._throttledSave.cancel();const e=this._editor;return this._editor=null,e.model.document.off("change:data",this._throttledSave),this._destructor(e)})}_save(){const e=this._editor.model.document.version;try{this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this._lastDocumentVersion=e}catch(i){console.error(i,"An error happened during restoring editor data. Editor will be restored from the previously saved data.")}}_setExcludedProperties(e){this._excludedProps=e}_getData(){const e=this._editor,i=e.model.document.roots.filter(m=>m.isAttached()&&"$graveyard"!=m.rootName),{plugins:s}=e,d=s.has("CommentsRepository")&&s.get("CommentsRepository"),g=s.has("TrackChanges")&&s.get("TrackChanges"),_={roots:{},markers:{},commentThreads:JSON.stringify([]),suggestions:JSON.stringify([])};i.forEach(m=>{_.roots[m.rootName]={content:JSON.stringify(Array.from(m.getChildren())),attributes:JSON.stringify(Array.from(m.getAttributes())),isLoaded:m._isLoaded}});for(const m of e.model.markers)m._affectsData&&(_.markers[m.name]={rangeJSON:m.getRange().toJSON(),usingOperation:m._managedUsingOperations,affectsData:m._affectsData});return d&&(_.commentThreads=JSON.stringify(d.getCommentThreads({toJSON:!0,skipNotAttached:!0}))),g&&(_.suggestions=JSON.stringify(g.getSuggestions({toJSON:!0,skipNotAttached:!0}))),_}_getEditables(){const e={};for(const i of this.editor.model.document.getRootNames()){const s=this.editor.ui.getEditableElement(i);s&&(e[i]=s)}return e}_isErrorComingFromThisItem(e){return function M(t,e,i=new Set){if(t===e&&function $(t){return"object"==typeof t&&null!==t}(t))return!0;const s=U(t,i),d=U(e,i);for(const g of s)if(d.has(g))return!0;return!1}(this._editor,e.context,this._excludedProps)}_cloneEditorConfiguration(e){return function Ts(t,e){return As(t,5,e="function"==typeof e?e:void 0)}(e,(i,s)=>{if(be(i)||"context"===s)return i})}}class Ss{constructor(e){this.editor=e,this._data=e.config.get("_watchdogInitialData")}init(){this.editor.data.on("init",e=>{e.stop(),this.editor.model.enqueueChange({isUndoable:!1},i=>{this._restoreCollaborationData(),this._restoreEditorData(i)}),this.editor.data.fire("ready")},{priority:999})}_createNode(e,i){if("name"in i){const s=e.createElement(i.name,i.attributes);if(i.children)for(const d of i.children)s._appendChild(this._createNode(e,d));return s}return e.createText(i.data,i.attributes)}_restoreEditorData(e){const i=this.editor;Object.entries(this._data.roots).forEach(([s,{content:d,attributes:g}])=>{const _=JSON.parse(d),m=JSON.parse(g),v=i.model.document.getRoot(s);for(const[x,W]of m)e.setAttribute(x,W,v);for(const x of _){const W=this._createNode(e,x);e.insert(W,v,"end")}}),Object.entries(this._data.markers).forEach(([s,d])=>{const{document:g}=i.model,{rangeJSON:{start:_,end:m},...v}=d,x=g.getRoot(_.root),W=e.createPositionFromPath(x,_.path,_.stickiness),K=e.createPositionFromPath(x,m.path,m.stickiness),ct=e.createRange(W,K);e.addMarker(s,{range:ct,...v})})}_restoreCollaborationData(){const e=JSON.parse(this._data.commentThreads),i=JSON.parse(this._data.suggestions);e.forEach(s=>{const d=this.editor.config.get("collaboration.channelId"),g=this.editor.plugins.get("CommentsRepository");g.hasCommentThread(s.threadId)&&g.getCommentThread(s.threadId).remove(),g.addCommentThread({channelId:d,...s})}),i.forEach(s=>{const d=this.editor.plugins.get("TrackChangesEditing");d.hasSuggestion(s.id)?d.getSuggestion(s.id).attributes=s.attributes:d.addSuggestionData(s)})}}Symbol("MainQueueId");var Os=T(4046),hr=T(9417),Rs=T(177);function js(t,e){}const L=new Array(256).fill(0).map((t,e)=>("0"+e.toString(16)).slice(-2)),_e="Lock from Angular integration (@ckeditor/ckeditor5-angular)";let Ds=(()=>{class t{constructor(i,s){this.config={},this.data="",this.tagName="div",this.disableTwoWayDataBinding=!1,this.ready=new o.bkB,this.change=new o.bkB,this.blur=new o.bkB,this.focus=new o.bkB,this.error=new o.bkB,this.initiallyDisabled=!1,this.isEditorSettingData=!1,this.id=function Bs(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0,s=4294967296*Math.random()>>>0;return"e"+L[255&t]+L[t>>8&255]+L[t>>16&255]+L[t>>24&255]+L[255&e]+L[e>>8&255]+L[e>>16&255]+L[e>>24&255]+L[255&i]+L[i>>8&255]+L[i>>16&255]+L[i>>24&255]+L[255&s]+L[s>>8&255]+L[s>>16&255]+L[s>>24&255]}(),this.ngZone=s,this.elementRef=i;const{CKEDITOR_VERSION:d}=window;if(d){const[g]=d.split(".").map(Number);g<37&&console.warn("The <CKEditor> component requires using CKEditor 5 in version 37 or higher.")}else console.warn('Cannot find the "CKEDITOR_VERSION" in the "window" scope.')}set disabled(i){this.setDisabledState(i)}get disabled(){return this.editorInstance?this.editorInstance.isReadOnly:this.initiallyDisabled}get editorInstance(){let i=this.editorWatchdog;return this.watchdog&&(i=this.watchdog._watchdogs.get(this.id)),i?i.editor:null}getId(){return this.id}ngOnChanges(i){Object.prototype.hasOwnProperty.call(i,"data")&&i.data&&!i.data.isFirstChange()&&this.writeValue(i.data.currentValue)}ngAfterViewInit(){this.attachToWatchdog()}ngOnDestroy(){var i=this;return(0,R.A)(function*(){i.watchdog?yield i.watchdog.remove(i.id):i.editorWatchdog&&i.editorWatchdog.editor&&(yield i.editorWatchdog.destroy(),i.editorWatchdog=void 0)})()}writeValue(i){null===i&&(i=""),this.editorInstance?(this.isEditorSettingData=!0,this.editorInstance.data.set(i),this.isEditorSettingData=!1):(this.data=i,this.ready.pipe((0,Os.$)()).subscribe(s=>{s.data.set(this.data)}))}registerOnChange(i){this.cvaOnChange=i}registerOnTouched(i){this.cvaOnTouched=i}setDisabledState(i){this.editorInstance&&(i?this.editorInstance.enableReadOnlyMode(_e):this.editorInstance.disableReadOnlyMode(_e)),this.initiallyDisabled=i}attachToWatchdog(){var i=this;const s=(v,x)=>this.ngZone.runOutsideAngular((0,R.A)(function*(){i.elementRef.nativeElement.appendChild(v);const W=yield i.editor.create(v,x);return i.initiallyDisabled&&W.enableReadOnlyMode(_e),i.ngZone.run(()=>{i.ready.emit(W)}),i.setUpEditorEvents(W),W})),d=function(){var v=(0,R.A)(function*(x){yield x.destroy(),i.elementRef.nativeElement.removeChild(i.editorElement)});return function(W){return v.apply(this,arguments)}}(),g=v=>{(function zs(t){return t.observed||t.observers.length>0})(this.error)&&this.ngZone.run(()=>this.error.emit(v))},_=document.createElement(this.tagName),m=this.getConfig();if(this.editorElement=_,this.watchdog)this.watchdog.add({id:this.id,type:"editor",creator:s,destructor:d,sourceElementOrData:_,config:m}).catch(v=>{g(v)}),this.watchdog.on("itemError",(v,{itemId:x})=>{x===this.id&&g()});else{const v=new sr(this.editor,this.editorWatchdogConfig);v.setCreator(s),v.setDestructor(d),v.on("error",g),this.editorWatchdog=v,this.ngZone.runOutsideAngular(()=>{v.create(_,m).catch(x=>{g(x)})})}}getConfig(){if(this.data&&this.config.initialData)throw new Error("Editor data should be provided either using `config.initialData` or `data` properties.");const i={...this.config},s=this.config.initialData||this.data;return s&&(i.initialData=s),i}setUpEditorEvents(i){const d=i.editing.view.document;i.model.document.on("change:data",g=>{this.ngZone.run(()=>{if(!this.disableTwoWayDataBinding){if(this.cvaOnChange&&!this.isEditorSettingData){const _=i.data.get();this.cvaOnChange(_)}this.change.emit({event:g,editor:i})}})}),d.on("focus",g=>{this.ngZone.run(()=>{this.focus.emit({event:g,editor:i})})}),d.on("blur",g=>{this.ngZone.run(()=>{this.cvaOnTouched&&this.cvaOnTouched(),this.blur.emit({event:g,editor:i})})})}}return t.\u0275fac=function(i){return new(i||t)(o.rXU(o.aKT),o.rXU(o.SKi))},t.\u0275cmp=o.VBU({type:t,selectors:[["ckeditor"]],inputs:{editor:"editor",config:"config",data:"data",tagName:"tagName",watchdog:"watchdog",editorWatchdogConfig:"editorWatchdogConfig",disableTwoWayDataBinding:"disableTwoWayDataBinding",disabled:"disabled"},outputs:{ready:"ready",change:"change",blur:"blur",focus:"focus",error:"error"},features:[o.Jv_([{provide:hr.kq,useExisting:(0,o.Rfq)(()=>t),multi:!0}]),o.OA$],decls:1,vars:0,template:function(i,s){1&i&&o.DNE(0,js,0,0,"ng-template")},encapsulation:2}),t})(),Ps=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=o.$C({type:t}),t.\u0275inj=o.G2t({imports:[[hr.YN,Rs.MD]]}),t})()},9362:(Rt,rt,T)=>{T.d(rt,{_D:()=>Jt});var R=T(467),o=T(4438),Z=T(345),U=T(7605),E=T(4046),M=T(4670),G=T(3586),$=T(177);const tt=["wrapper"],D=["sourceImage"];function F(p,y){if(1&p){const u=o.RV6();o.j41(0,"img",5,1),o.bIt("load",function(){o.eBV(u);const n=o.XpG();return o.Njj(n.imageLoadedInView())})("mousedown",function(n){o.eBV(u);const a=o.XpG();return o.Njj(a.startMove(n,a.moveTypes.Drag))})("touchstart",function(n){o.eBV(u);const a=o.XpG();return o.Njj(a.startMove(n,a.moveTypes.Drag))})("error",function(n){o.eBV(u);const a=o.XpG();return o.Njj(a.loadImageError(n))}),o.k0s()}if(2&p){const u=o.XpG();o.xc7("visibility",u.imageVisible?"visible":"hidden")("transform",u.safeTransformStyle),o.AVh("ngx-ic-draggable",!u.disabled&&u.allowMoveImage),o.Y8G("src",u.safeImgDataUrl,o.B4B),o.BMQ("alt",u.imageAltText)}}function f(p,y){if(1&p){const u=o.RV6();o.qex(0),o.j41(1,"span",9),o.bIt("mousedown",function(n){o.eBV(u);const a=o.XpG(2);return o.Njj(a.startMove(n,a.moveTypes.Resize,"topleft"))})("touchstart",function(n){o.eBV(u);const a=o.XpG(2);return o.Njj(a.startMove(n,a.moveTypes.Resize,"topleft"))}),o.nrm(2,"span",10),o.k0s(),o.j41(3,"span",11),o.nrm(4,"span",10),o.k0s(),o.j41(5,"span",12),o.bIt("mousedown",function(n){o.eBV(u);const a=o.XpG(2);return o.Njj(a.startMove(n,a.moveTypes.Resize,"topright"))})("touchstart",function(n){o.eBV(u);const a=o.XpG(2);return o.Njj(a.startMove(n,a.moveTypes.Resize,"topright"))}),o.nrm(6,"span",10),o.k0s(),o.j41(7,"span",13),o.nrm(8,"span",10),o.k0s(),o.j41(9,"span",14),o.bIt("mousedown",function(n){o.eBV(u);const a=o.XpG(2);return o.Njj(a.startMove(n,a.moveTypes.Resize,"bottomright"))})("touchstart",function(n){o.eBV(u);const a=o.XpG(2);return o.Njj(a.startMove(n,a.moveTypes.Resize,"bottomright"))}),o.nrm(10,"span",10),o.k0s(),o.j41(11,"span",15),o.nrm(12,"span",10),o.k0s(),o.j41(13,"span",16),o.bIt("mousedown",function(n){o.eBV(u);const a=o.XpG(2);return o.Njj(a.startMove(n,a.moveTypes.Resize,"bottomleft"))})("touchstart",function(n){o.eBV(u);const a=o.XpG(2);return o.Njj(a.startMove(n,a.moveTypes.Resize,"bottomleft"))}),o.nrm(14,"span",10),o.k0s(),o.j41(15,"span",17),o.nrm(16,"span",10),o.k0s(),o.j41(17,"span",18),o.bIt("mousedown",function(n){o.eBV(u);const a=o.XpG(2);return o.Njj(a.startMove(n,a.moveTypes.Resize,"top"))})("touchstart",function(n){o.eBV(u);const a=o.XpG(2);return o.Njj(a.startMove(n,a.moveTypes.Resize,"top"))}),o.k0s(),o.j41(18,"span",19),o.bIt("mousedown",function(n){o.eBV(u);const a=o.XpG(2);return o.Njj(a.startMove(n,a.moveTypes.Resize,"right"))})("touchstart",function(n){o.eBV(u);const a=o.XpG(2);return o.Njj(a.startMove(n,a.moveTypes.Resize,"right"))}),o.k0s(),o.j41(19,"span",20),o.bIt("mousedown",function(n){o.eBV(u);const a=o.XpG(2);return o.Njj(a.startMove(n,a.moveTypes.Resize,"bottom"))})("touchstart",function(n){o.eBV(u);const a=o.XpG(2);return o.Njj(a.startMove(n,a.moveTypes.Resize,"bottom"))}),o.k0s(),o.j41(20,"span",21),o.bIt("mousedown",function(n){o.eBV(u);const a=o.XpG(2);return o.Njj(a.startMove(n,a.moveTypes.Resize,"left"))})("touchstart",function(n){o.eBV(u);const a=o.XpG(2);return o.Njj(a.startMove(n,a.moveTypes.Resize,"left"))}),o.k0s(),o.bVm()}}function j(p,y){if(1&p){const u=o.RV6();o.j41(0,"div",6),o.bIt("keydown",function(n){o.eBV(u);const a=o.XpG();return o.Njj(a.keyboardAccess(n))}),o.j41(1,"div",7),o.bIt("mousedown",function(n){o.eBV(u);const a=o.XpG();return o.Njj(a.startMove(n,a.moveTypes.Move))})("touchstart",function(n){o.eBV(u);const a=o.XpG();return o.Njj(a.startMove(n,a.moveTypes.Move))}),o.k0s(),o.DNE(2,f,21,0,"ng-container",8),o.k0s()}if(2&p){const u=o.XpG();o.xc7("top",u.cropper.y1,"px")("left",u.cropper.x1,"px")("width",u.cropper.x2-u.cropper.x1,"px")("height",u.cropper.y2-u.cropper.y1,"px")("margin-left","center"===u.alignImage?u.marginLeft:null)("visibility",u.imageVisible?"visible":"hidden"),o.AVh("ngx-ic-round",u.roundCropper),o.BMQ("aria-label",u.cropperFrameAriaLabel),o.R7$(2),o.Y8G("ngIf",!u.hideResizeSquares)}}class H{constructor(){this.format="png",this.output="blob",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperFrameAriaLabel="Crop photo",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(y){Object.keys(y).filter(u=>u in this).forEach(u=>this[u]=y[u]),this.validateOptions()}setOptionsFromChanges(y){Object.keys(y).filter(u=>u in this).forEach(u=>this[u]=y[u].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}var S=function(p){return p.Drag="drag",p.Move="move",p.Resize="resize",p.Pinch="pinch",p}(S||{});function jt(p,y){return p/100*y}let Qt=(()=>{var p;class y{crop(r,n,a,h,c){const l=this.getImagePosition(r,n,a,c),b=l.x2-l.x1,C=l.y2-l.y1,A=document.createElement("canvas");A.width=b,A.height=C;const w=A.getContext("2d");if(!w)return null;null!=a.backgroundColor&&(w.fillStyle=a.backgroundColor,w.fillRect(0,0,b,C));const P=(a.transform.scale||1)*(a.transform.flipH?-1:1),k=(a.transform.scale||1)*(a.transform.flipV?-1:1),{translateH:Q,translateV:it}=this.getCanvasTranslate(r,a,c),nt=r.transformed;w.setTransform(P,0,0,k,nt.size.width/2+Q,nt.size.height/2+it),w.translate(-l.x1/P,-l.y1/k),w.rotate((a.transform.rotate||0)*Math.PI/180),w.drawImage(nt.image,-nt.size.width/2,-nt.size.height/2);const B={width:b,height:C,imagePosition:l,cropperPosition:{...n}};a.containWithinAspectRatio&&(B.offsetImagePosition=this.getOffsetImagePosition(r,n,a,c));const et=this.getResizeRatio(b,C,a);return 1!==et&&(B.width=Math.round(b*et),B.height=a.maintainAspectRatio?Math.round(B.width/a.aspectRatio):Math.round(C*et),function Y(p,y,u){const r=p.width,n=p.height,a=r/(y=Math.round(y)),h=n/(u=Math.round(u)),c=Math.ceil(a/2),l=Math.ceil(h/2),b=p.getContext("2d");if(b){const C=b.getImageData(0,0,r,n),A=b.createImageData(y,u),w=C.data,P=A.data;for(let k=0;k<u;k++)for(let Q=0;Q<y;Q++){const it=4*(Q+k*y),nt=k*h;let B=0,et=0,Dt=0,zt=0,At=0,Pt=0,Wt=0;const Zt=Math.floor(Q*a),qt=Math.floor(k*h);let Mt=Math.ceil((Q+1)*a),wt=Math.ceil((k+1)*h);Mt=Math.min(Mt,r),wt=Math.min(wt,n);for(let pt=qt;pt<wt;pt++){const Ut=Math.abs(nt-pt)/l,te=Q*a,Ft=Ut*Ut;for(let _t=Zt;_t<Mt;_t++){const ft=Math.abs(te-_t)/c,ot=Math.sqrt(Ft+ft*ft);if(ot>=1)continue;B=2*ot*ot*ot-3*ot*ot+1;const st=4*(_t+pt*r);Wt+=B*w[st+3],Dt+=B,w[st+3]<255&&(B=B*w[st+3]/250),zt+=B*w[st],At+=B*w[st+1],Pt+=B*w[st+2],et+=B}}P[it]=zt/et,P[it+1]=At/et,P[it+2]=Pt/et,P[it+3]=Wt/Dt}p.width=y,p.height=u,b.putImageData(A,0,0)}}(A,B.width,B.height)),"blob"===h?this.cropToBlob(B,A,a):(B.base64=A.toDataURL("image/"+a.format,this.getQuality(a)),B)}cropToBlob(r,n,a){var h=this;return(0,R.A)(function*(){return r.blob=yield new Promise(c=>n.toBlob(c,"image/"+a.format,h.getQuality(a))),r.blob&&(r.objectUrl=URL.createObjectURL(r.blob)),r})()}getCanvasTranslate(r,n,a){if("px"===n.transform.translateUnit){const h=this.getRatio(r,a);return{translateH:(n.transform.translateH||0)*h,translateV:(n.transform.translateV||0)*h}}return{translateH:n.transform.translateH?jt(n.transform.translateH,r.transformed.size.width):0,translateV:n.transform.translateV?jt(n.transform.translateV,r.transformed.size.height):0}}getRatio(r,n){return r.transformed.size.width/n.width}getImagePosition(r,n,a,h){const c=this.getRatio(r,h),l={x1:Math.round(n.x1*c),y1:Math.round(n.y1*c),x2:Math.round(n.x2*c),y2:Math.round(n.y2*c)};return a.containWithinAspectRatio||(l.x1=Math.max(l.x1,0),l.y1=Math.max(l.y1,0),l.x2=Math.min(l.x2,r.transformed.size.width),l.y2=Math.min(l.y2,r.transformed.size.height)),l}getOffsetImagePosition(r,n,a,h){const c=a.canvasRotation+r.exifTransform.rotate,l=this.getRatio(r,h);let b,C;c%2?(b=(r.transformed.size.width-r.original.size.height)/2,C=(r.transformed.size.height-r.original.size.width)/2):(b=(r.transformed.size.width-r.original.size.width)/2,C=(r.transformed.size.height-r.original.size.height)/2);const A={x1:Math.round(n.x1*l)-b,y1:Math.round(n.y1*l)-C,x2:Math.round(n.x2*l)-b,y2:Math.round(n.y2*l)-C};return a.containWithinAspectRatio||(A.x1=Math.max(A.x1,0),A.y1=Math.max(A.y1,0),A.x2=Math.min(A.x2,r.transformed.size.width),A.y2=Math.min(A.y2,r.transformed.size.height)),A}getResizeRatio(r,n,a){const h=a.resizeToWidth/r,c=a.resizeToHeight/n,l=new Array;a.resizeToWidth>0&&l.push(h),a.resizeToHeight>0&&l.push(c);const b=0===l.length?1:Math.min(...l);return b>1&&!a.onlyScaleDown?b:Math.min(b,1)}getQuality(r){return Math.min(1,Math.max(0,r.imageQuality/100))}}return(p=y).\u0275fac=function(r){return new(r||p)},p.\u0275prov=o.jDH({token:p,factory:p.\u0275fac,providedIn:"root"}),y})(),Kt=(()=>{var p;class y{resetCropperPosition(r,n,a,h){if(null!=r&&r.nativeElement)if(a.cropperStaticHeight&&a.cropperStaticWidth)n.x1=0,n.x2=h.width>a.cropperStaticWidth?a.cropperStaticWidth:h.width,n.y1=0,n.y2=h.height>a.cropperStaticHeight?a.cropperStaticHeight:h.height;else{const c=Math.min(a.cropperScaledMaxWidth,h.width),l=Math.min(a.cropperScaledMaxHeight,h.height);if(a.maintainAspectRatio)if(h.width/a.aspectRatio<h.height){n.x1=0,n.x2=c;const b=c/a.aspectRatio;n.y1=(h.height-b)/2,n.y2=n.y1+b}else{n.y1=0,n.y2=l;const b=l*a.aspectRatio;n.x1=(h.width-b)/2,n.x2=n.x1+b}else n.x1=0,n.x2=c,n.y1=0,n.y2=l}}move(r,n,a){const h=this.getClientX(r)-n.clientX,c=this.getClientY(r)-n.clientY;a.x1=n.x1+h,a.y1=n.y1+c,a.x2=n.x2+h,a.y2=n.y2+c}resize(r,n,a,h,c){const l=this.getClientX(r)-n.clientX,b=this.getClientY(r)-n.clientY;switch(n.position){case"left":a.x1=Math.min(Math.max(n.x1+l,a.x2-c.cropperScaledMaxWidth),a.x2-c.cropperScaledMinWidth);break;case"topleft":a.x1=Math.min(Math.max(n.x1+l,a.x2-c.cropperScaledMaxWidth),a.x2-c.cropperScaledMinWidth),a.y1=Math.min(Math.max(n.y1+b,a.y2-c.cropperScaledMaxHeight),a.y2-c.cropperScaledMinHeight);break;case"top":a.y1=Math.min(Math.max(n.y1+b,a.y2-c.cropperScaledMaxHeight),a.y2-c.cropperScaledMinHeight);break;case"topright":a.x2=Math.max(Math.min(n.x2+l,a.x1+c.cropperScaledMaxWidth),a.x1+c.cropperScaledMinWidth),a.y1=Math.min(Math.max(n.y1+b,a.y2-c.cropperScaledMaxHeight),a.y2-c.cropperScaledMinHeight);break;case"right":a.x2=Math.max(Math.min(n.x2+l,a.x1+c.cropperScaledMaxWidth),a.x1+c.cropperScaledMinWidth);break;case"bottomright":a.x2=Math.max(Math.min(n.x2+l,a.x1+c.cropperScaledMaxWidth),a.x1+c.cropperScaledMinWidth),a.y2=Math.max(Math.min(n.y2+b,a.y1+c.cropperScaledMaxHeight),a.y1+c.cropperScaledMinHeight);break;case"bottom":a.y2=Math.max(Math.min(n.y2+b,a.y1+c.cropperScaledMaxHeight),a.y1+c.cropperScaledMinHeight);break;case"bottomleft":a.x1=Math.min(Math.max(n.x1+l,a.x2-c.cropperScaledMaxWidth),a.x2-c.cropperScaledMinWidth),a.y2=Math.max(Math.min(n.y2+b,a.y1+c.cropperScaledMaxHeight),a.y1+c.cropperScaledMinHeight);break;case"center":const C=r.scale,A=Math.min(Math.max(c.cropperScaledMinWidth,Math.abs(n.x2-n.x1)*C),c.cropperScaledMaxWidth),w=Math.min(Math.max(c.cropperScaledMinHeight,Math.abs(n.y2-n.y1)*C),c.cropperScaledMaxHeight);a.x1=n.clientX-A/2,a.x2=n.clientX+A/2,a.y1=n.clientY-w/2,a.y2=n.clientY+w/2,a.x1<0?(a.x2-=a.x1,a.x1=0):a.x2>h.width&&(a.x1-=a.x2-h.width,a.x2=h.width),a.y1<0?(a.y2-=a.y1,a.y1=0):a.y2>h.height&&(a.y1-=a.y2-h.height,a.y2=h.height)}c.maintainAspectRatio&&this.checkAspectRatio(n.position,a,h,c)}checkAspectRatio(r,n,a,h){let c=0,l=0;switch(r){case"top":n.x2=n.x1+(n.y2-n.y1)*h.aspectRatio,c=Math.max(n.x2-a.width,0),l=Math.max(0-n.y1,0),(c>0||l>0)&&(n.x2-=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y1+=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"bottom":n.x2=n.x1+(n.y2-n.y1)*h.aspectRatio,c=Math.max(n.x2-a.width,0),l=Math.max(n.y2-a.height,0),(c>0||l>0)&&(n.x2-=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y2-=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"topleft":n.y1=n.y2-(n.x2-n.x1)/h.aspectRatio,c=Math.max(0-n.x1,0),l=Math.max(0-n.y1,0),(c>0||l>0)&&(n.x1+=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y1+=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"topright":n.y1=n.y2-(n.x2-n.x1)/h.aspectRatio,c=Math.max(n.x2-a.width,0),l=Math.max(0-n.y1,0),(c>0||l>0)&&(n.x2-=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y1+=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"right":case"bottomright":n.y2=n.y1+(n.x2-n.x1)/h.aspectRatio,c=Math.max(n.x2-a.width,0),l=Math.max(n.y2-a.height,0),(c>0||l>0)&&(n.x2-=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y2-=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"left":case"bottomleft":n.y2=n.y1+(n.x2-n.x1)/h.aspectRatio,c=Math.max(0-n.x1,0),l=Math.max(n.y2-a.height,0),(c>0||l>0)&&(n.x1+=l*h.aspectRatio>c?l*h.aspectRatio:c,n.y2-=l*h.aspectRatio>c?l:c/h.aspectRatio);break;case"center":n.x2=n.x1+(n.y2-n.y1)*h.aspectRatio,n.y2=n.y1+(n.x2-n.x1)/h.aspectRatio;const b=Math.max(0-n.x1,0),C=Math.max(n.x2-a.width,0),A=Math.max(n.y2-a.height,0),w=Math.max(0-n.y1,0);(b>0||C>0||A>0||w>0)&&(n.x1+=A*h.aspectRatio>b?A*h.aspectRatio:b,n.x2-=w*h.aspectRatio>C?w*h.aspectRatio:C,n.y1+=w*h.aspectRatio>C?w:C/h.aspectRatio,n.y2-=A*h.aspectRatio>b?A:b/h.aspectRatio)}}getClientX(r){return"touches"in r&&r.touches[0]?r.touches[0].clientX:"clientX"in r?r.clientX:0}getClientY(r){return"touches"in r&&r.touches[0]?r.touches[0].clientY:"clientX"in r?r.clientY:0}}return(p=y).\u0275fac=function(r){return new(r||p)},p.\u0275prov=o.jDH({token:p,factory:p.\u0275fac,providedIn:"root"}),y})();let $t=(()=>{var p;class y{constructor(){this.autoRotateSupported=function Yt(){return new Promise(p=>{const y=new Image;y.onload=()=>{p(1===y.width&&2===y.height)},y.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(r,n){var a=this;return(0,R.A)(function*(){const h=yield r.arrayBuffer();return yield a.checkImageTypeAndLoadImageFromArrayBuffer(h,r.type,n)})()}checkImageTypeAndLoadImageFromArrayBuffer(r,n,a){return this.isValidImageType(n)?this.loadImageFromArrayBuffer(r,a,n):Promise.reject(new Error("Invalid image type"))}isValidImageType(r){return/image\/(png|jpg|jpeg|bmp|gif|tiff|svg|webp|x-icon|vnd.microsoft.icon)/.test(r)}loadImageFromURL(r,n){var a=this;return(0,R.A)(function*(){const c=yield(yield fetch(r)).blob(),l=yield c.arrayBuffer();return yield a.loadImageFromArrayBuffer(l,n,c.type)})()}loadBase64Image(r,n){const a=this.base64ToArrayBuffer(r);return this.loadImageFromArrayBuffer(a,n)}base64ToArrayBuffer(r){r=r.replace(/^data:([^;]+);base64,/gim,"");const n=atob(r),a=n.length,h=new Uint8Array(a);for(let c=0;c<a;c++)h[c]=n.charCodeAt(c);return h.buffer}loadImageFromArrayBuffer(r,n,a){var h=this;return(0,R.A)(function*(){const c=yield new Promise(function(){var l=(0,R.A)(function*(b,C){try{const A=new Blob([r],a?{type:a}:void 0),w=URL.createObjectURL(A),P=new Image,Q="image/svg+xml"===a?yield h.getSvgImageSize(A):void 0;P.onload=()=>b({originalImage:P,originalImageSize:Q,originalObjectUrl:w,originalArrayBuffer:r}),P.onerror=C,P.src=w}catch(A){C(A)}});return function(b,C){return l.apply(this,arguments)}}());return yield h.transformImageFromArrayBuffer(c,n,null!=c.originalImageSize)})()}getSvgImageSize(r){return(0,R.A)(function*(){const h=(new DOMParser).parseFromString(yield r.text(),"image/svg+xml").querySelector("svg");if(!h)throw Error("Failed to parse SVG image");const c=h.getAttribute("width"),l=h.getAttribute("height");if(c&&l)return null;const b=h.getAttribute("viewBox")||h.getAttribute("viewbox");if(b){const C=b.split(" ");return{width:+C[2],height:+C[3]}}throw Error("Failed to load SVG image. SVG must have width + height or viewBox definition.")})()}transformImageFromArrayBuffer(r,n,a=!1){var h=this;return(0,R.A)(function*(){var c;const b=function at(p){switch("object"==typeof p&&(p=function Bt(p){const y=new DataView(p);if(65496!==y.getUint16(0,!1))return-2;const u=y.byteLength;let r=2;for(;r<u;){if(y.getUint16(r+2,!1)<=8)return-1;const n=y.getUint16(r,!1);if(r+=2,65505==n){if(1165519206!==y.getUint32(r+=2,!1))return-1;const a=18761==y.getUint16(r+=6,!1);r+=y.getUint32(r+4,a);const h=y.getUint16(r,a);r+=2;for(let c=0;c<h;c++)if(274==y.getUint16(r+12*c,a))return y.getUint16(r+12*c+8,a)}else{if(65280&~n)break;r+=y.getUint16(r,!1)}}return-1}(p)),p){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}((yield h.autoRotateSupported)?-1:r.originalArrayBuffer);if(!r.originalImage||!r.originalImage.complete)return Promise.reject(new Error("No image loaded"));const C={original:{objectUrl:r.originalObjectUrl,image:r.originalImage,size:null!==(c=r.originalImageSize)&&void 0!==c?c:{width:r.originalImage.naturalWidth,height:r.originalImage.naturalHeight}},exifTransform:b};return h.transformLoadedImage(C,n,a)})()}transformLoadedImage(r,n,a=!1){var h=this;return(0,R.A)(function*(){const c=n.canvasRotation+r.exifTransform.rotate,l=r.original.size;if(!a&&0===c&&!r.exifTransform.flip&&!n.containWithinAspectRatio)return{original:{objectUrl:r.original.objectUrl,image:r.original.image,size:{...l}},transformed:{objectUrl:r.original.objectUrl,image:r.original.image,size:{...l}},exifTransform:r.exifTransform};const b=h.getTransformedSize(l,r.exifTransform,n),C=document.createElement("canvas");C.width=b.width,C.height=b.height;const A=C.getContext("2d");null==A||A.setTransform(r.exifTransform.flip?-1:1,0,0,1,C.width/2,C.height/2),null==A||A.rotate(Math.PI*(c/2)),null==A||A.drawImage(r.original.image,-l.width/2,-l.height/2);const w=yield new Promise(Q=>C.toBlob(Q,n.format));if(!w)throw new Error("Failed to get Blob for transformed image.");const P=URL.createObjectURL(w),k=yield h.loadImageFromObjectUrl(P);return{original:{objectUrl:r.original.objectUrl,image:r.original.image,size:{...l}},transformed:{objectUrl:P,image:k,size:{width:k.width,height:k.height}},exifTransform:r.exifTransform}})()}loadImageFromObjectUrl(r){return new Promise((n,a)=>{const h=new Image;h.onload=()=>n(h),h.onerror=a,h.src=r})}getTransformedSize(r,n,a){const h=a.canvasRotation+n.rotate;if(a.containWithinAspectRatio){if(h%2){const l=r.height/a.aspectRatio;return{width:Math.max(r.height,r.width*a.aspectRatio),height:Math.max(r.width,l)}}{const l=r.width/a.aspectRatio;return{width:Math.max(r.width,r.height*a.aspectRatio),height:Math.max(r.height,l)}}}return h%2?{height:r.width,width:r.height}:{width:r.width,height:r.height}}}return(p=y).\u0275fac=function(r){return new(r||p)},p.\u0275prov=o.jDH({token:p,factory:p.\u0275fac,providedIn:"root"}),y})(),Jt=(()=>{var p;class y{constructor(r,n,a,h,c,l,b){this.cropService=r,this.cropperPositionService=n,this.loadImageService=a,this.sanitizer=h,this.cd=c,this.zone=l,this.hammerLoader=b,this.settings=new H,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.marginLeft="0px",this.maxSize={width:0,height:0},this.moveTypes=S,this.imageVisible=!1,this.cropperFrameAriaLabel=this.settings.cropperFrameAriaLabel,this.output=this.settings.output,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resetCropOnAspectRatioChange=this.settings.resetCropOnAspectRatioChange,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.allowMoveImage=!1,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.hidden=!1,this.imageCropped=new o.bkB,this.startCropImage=new o.bkB,this.imageLoaded=new o.bkB,this.cropperReady=new o.bkB,this.loadImageFailed=new o.bkB,this.transformChange=new o.bkB,this.reset()}ngOnChanges(r){var n;this.onChangesUpdateSettings(r),this.onChangesInputImage(r),null!==(n=this.loadedImage)&&void 0!==n&&n.original.image.complete&&(r.containWithinAspectRatio||r.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(a=>this.setLoadedImage(a)).catch(a=>this.loadImageError(a)),(r.cropper||r.maintainAspectRatio||r.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),!this.maintainAspectRatio||!this.resetCropOnAspectRatioChange&&this.aspectRatioIsCorrect()||!r.maintainAspectRatio&&!r.aspectRatio?r.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()):this.resetCropperPosition()),r.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop()),r.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesUpdateSettings(r){this.settings.setOptionsFromChanges(r),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&(this.hideResizeSquares=!0,this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1}))}onChangesInputImage(r){(r.imageChangedEvent||r.imageURL||r.imageBase64||r.imageFile)&&this.reset(),r.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),r.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),r.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),r.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){var r;const n=null===(r=this.imageChangedEvent)||void 0===r||null===(r=r.target)||void 0===r?void 0:r.files;return n instanceof FileList&&n.length>0}setCssTransform(){var r;const n=(null===(r=this.transform)||void 0===r?void 0:r.translateUnit)||"%";this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle(`translate(${this.transform.translateH||0}${n}, ${this.transform.translateV||0}${n}) scaleX(`+(this.transform.scale||1)*(this.transform.flipH?-1:1)+") scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+") rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=void 0,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(r){this.loadImageService.loadImageFile(r,this.settings).then(n=>this.setLoadedImage(n)).catch(n=>this.loadImageError(n))}loadBase64Image(r){this.loadImageService.loadBase64Image(r,this.settings).then(n=>this.setLoadedImage(n)).catch(n=>this.loadImageError(n))}loadImageFromURL(r){this.loadImageService.loadImageFromURL(r,this.settings).then(n=>this.setLoadedImage(n)).catch(n=>this.loadImageError(n))}setLoadedImage(r){this.loadedImage=r,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(r.transformed.objectUrl),this.cd.markForCheck()}loadImageError(r){console.error(r),this.loadImageFailed.emit()}imageLoadedInView(){null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit({...this.maxSize}),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){var r;return(null===(r=this.sourceImage)||void 0===r||null===(r=r.nativeElement)||void 0===r?void 0:r.offsetWidth)>0}onResize(){if(this.loadedImage)if(this.hidden)this.resizedWhileHidden=!0;else{const r={...this.maxSize};this.setMaxSize(),this.resizeCropperPosition(r),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()}}activatePinchGesture(){var r=this;return(0,R.A)(function*(){var n,a;yield null===(n=r.hammerLoader)||void 0===n?void 0:n.call(r);const h=(null===(a=window)||void 0===a?void 0:a.Hammer)||null;if(h){const c=new h(r.wrapper.nativeElement);c.get("pinch").set({enable:!0}),c.on("pinchmove",r.onPinch.bind(r)),c.on("pinchend",r.pinchStop.bind(r)),c.on("pinchstart",r.startPinch.bind(r))}else(0,o.naY)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")})()}resizeCropperPosition(r){(r.width!==this.maxSize.width||r.height!==this.maxSize.height)&&(this.cropper.x1=this.cropper.x1*this.maxSize.width/r.width,this.cropper.x2=this.cropper.x2*this.maxSize.width/r.width,this.cropper.y1=this.cropper.y1*this.maxSize.height/r.height,this.cropper.y2=this.cropper.y2*this.maxSize.height/r.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings,this.maxSize),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(r){this.changeKeyboardStepSize(r),this.keyboardMoveCropper(r)}changeKeyboardStepSize(r){const n=+r.key;n>=1&&n<=9&&(this.settings.stepSize=n)}keyboardMoveCropper(r){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(r.key))return;const a=r.shiftKey?S.Resize:S.Move,h=r.altKey?function X(p){switch(p){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";default:return"right"}}(r.key):function V(p){switch(p){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";default:return"left"}}(r.key),c=function N(p,y){switch(p){case"ArrowUp":return{clientX:0,clientY:-1*y};case"ArrowRight":return{clientX:y,clientY:0};case"ArrowDown":return{clientX:0,clientY:y};default:return{clientX:-1*y,clientY:0}}}(r.key,this.settings.stepSize);r.preventDefault(),r.stopPropagation(),this.startMove({clientX:0,clientY:0},a,h),this.handleMouseMove(c),this.handleMouseUp()}startMove(r,n,a=null){var h,c;this.disabled||null!==(h=this.moveStart)&&void 0!==h&&h.active&&(null===(c=this.moveStart)||void 0===c?void 0:c.type)===S.Pinch||n===S.Drag&&!this.allowMoveImage||("preventDefault"in r&&r.preventDefault(),this.moveStart={active:!0,type:n,position:a,transform:{...this.transform},clientX:this.cropperPositionService.getClientX(r),clientY:this.cropperPositionService.getClientY(r),...this.cropper},this.initMouseMove())}initMouseMove(){(0,M.h)((0,G.R)(document,"mousemove"),(0,G.R)(document,"touchmove")).pipe((0,U.Q)((0,M.h)((0,G.R)(document,"mouseup"),(0,G.R)(document,"touchend")).pipe((0,E.$)()))).subscribe({next:r=>this.zone.run(()=>{this.handleMouseMove(r),this.cd.markForCheck()}),complete:()=>this.zone.run(()=>{this.handleMouseUp(),this.cd.markForCheck()})})}startPinch(r){this.safeImgDataUrl&&(r.preventDefault&&r.preventDefault(),this.moveStart={active:!0,type:S.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2,...this.cropper})}handleMouseMove(r){if(this.moveStart.active)if("stopPropagation"in r&&r.stopPropagation(),"preventDefault"in r&&r.preventDefault(),this.moveStart.type===S.Move)this.cropperPositionService.move(r,this.moveStart,this.cropper),this.checkCropperPosition(!0);else if(this.moveStart.type===S.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(r,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1);else if(this.moveStart.type===S.Drag){var n,a;const h=this.cropperPositionService.getClientX(r)-this.moveStart.clientX,c=this.cropperPositionService.getClientY(r)-this.moveStart.clientY;this.transform={...this.transform,translateH:((null===(n=this.moveStart.transform)||void 0===n?void 0:n.translateH)||0)+h,translateV:((null===(a=this.moveStart.transform)||void 0===a?void 0:a.translateV)||0)+c},this.setCssTransform()}}onPinch(r){this.moveStart.active&&(r.stopPropagation&&r.stopPropagation(),r.preventDefault&&r.preventDefault(),this.moveStart.type===S.Pinch&&(this.cropperPositionService.resize(r,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.markForCheck())}setMaxSize(){if(this.sourceImage){const r=getComputedStyle(this.sourceImage.nativeElement);this.maxSize.width=parseFloat(r.width),this.maxSize.height=parseFloat(r.height),this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){var r;null!==(r=this.loadedImage)&&void 0!==r&&null!==(r=r.transformed)&&void 0!==r&&r.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}setCropperScaledMaxSize(){var r;if(null!==(r=this.loadedImage)&&void 0!==r&&null!==(r=r.transformed)&&void 0!==r&&r.image){const n=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/n:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/n:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(r=!1){this.cropper.x1<0&&(this.cropper.x2-=r?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=r?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=r?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=r?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}handleMouseUp(){var r;this.moveStart.active&&(this.moveStart.active=!1,(null===(r=this.moveStart)||void 0===r?void 0:r.type)===S.Drag?this.transformChange.emit(this.transform):this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(r=this.settings.output){var n;if(null!=(null===(n=this.loadedImage)||void 0===n||null===(n=n.transformed)||void 0===n?void 0:n.image)){if(this.startCropImage.emit(),"blob"===r)return this.cropToBlob();if("base64"===r)return this.cropToBase64()}return null}cropToBlob(){var r=this;return new Promise((n,a)=>this.zone.run((0,R.A)(function*(){const h=yield r.cropService.crop(r.loadedImage,r.cropper,r.settings,"blob",r.maxSize);h?(r.imageCropped.emit(h),n(h)):a("Crop image failed")})))}cropToBase64(){const r=this.cropService.crop(this.loadedImage,this.cropper,this.settings,"base64",this.maxSize);return r?(this.imageCropped.emit(r),r):null}aspectRatioIsCorrect(){return(this.cropper.x2-this.cropper.x1)/(this.cropper.y2-this.cropper.y1)===this.aspectRatio}}return(p=y).\u0275fac=function(r){return new(r||p)(o.rXU(Qt),o.rXU(Kt),o.rXU($t),o.rXU(Z.up),o.rXU(o.gRc),o.rXU(o.SKi),o.rXU(Z.Bn,8))},p.\u0275cmp=o.VBU({type:p,selectors:[["image-cropper"]],viewQuery:function(r,n){if(1&r&&(o.GBs(tt,7),o.GBs(D,5)),2&r){let a;o.mGM(a=o.lsd())&&(n.wrapper=a.first),o.mGM(a=o.lsd())&&(n.sourceImage=a.first)}},hostVars:6,hostBindings:function(r,n){1&r&&o.bIt("resize",function(){return n.onResize()},!1,o.tSv),2&r&&(o.xc7("text-align",n.alignImage),o.AVh("disabled",n.disabled)("ngx-ix-hidden",n.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",cropperFrameAriaLabel:"cropperFrameAriaLabel",output:"output",format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange"},standalone:!0,features:[o.OA$,o.aNF],decls:5,vars:10,consts:[["wrapper",""],["sourceImage",""],["class","ngx-ic-source-image","role","presentation",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart","error",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],["role","presentation",1,"ngx-ic-source-image",3,"load","mousedown","touchstart","error","src"],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],["role","presentation",1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(r,n){1&r&&(o.j41(0,"div",null,0),o.DNE(2,F,2,8,"img",2),o.nrm(3,"div",3),o.DNE(4,j,3,16,"div",4),o.k0s()),2&r&&(o.xc7("background",n.imageVisible&&n.backgroundColor),o.R7$(2),o.Y8G("ngIf",n.safeImgDataUrl),o.R7$(),o.xc7("width",n.maxSize.width,"px")("height",n.maxSize.height,"px")("margin-left","center"===n.alignImage?n.marginLeft:null),o.R7$(),o.Y8G("ngIf",n.imageVisible))},dependencies:[$.bT],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535c;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ix-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0}),y})()}}]);